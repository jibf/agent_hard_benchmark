2025-08-25 11:32:31,537 - evaluation_logger_Cross-17 - INFO - Test Example Cross-17
2025-08-25 11:32:31,537 - evaluation_logger_Cross-17 - INFO - Query: My partner, my parents, and I are planning to have a one-day tour in Berlin on December 10, 2024, and stay at one of the most popular hotels in Berlin. We need two rooms. Provide the specific details of the most popular hotels in Berlin. Additionally, we're planning to rent a car at 8 AM on that day and return it at 5 PM the next day, so help us find information on car rental services.
2025-08-25 11:32:39,767 - evaluation_logger_Cross-17 - INFO - Function Calls: 
[
    {
        "name": "Search_Hotel_Destination",
        "arguments": {
            "query": "Berlin"
        }
    }
]

2025-08-25 11:32:39,767 - evaluation_logger_Cross-17 - INFO - Golden Function Call: 
[
    {
        "name": "Search_Hotel_Destination",
        "arguments": {
            "query": "Berlin"
        }
    },
    {
        "name": "Search_Car_Rentals",
        "arguments": {
            "pick_up_latitude": 52.516212,
            "pick_up_longitude": 13.376818,
            "drop_off_latitude": 52.516212,
            "drop_off_longitude": 13.376818,
            "pick_up_date": "2024-12-10",
            "drop_off_date": "2024-12-11",
            "pick_up_time": "08:00",
            "drop_off_time": "17:00"
        }
    },
    {
        "name": "Search_Hotels",
        "arguments": {
            "dest_id": -1746443,
            "search_type": "city",
            "arrival_date": "2024-12-10",
            "departure_date": "2024-12-11",
            "adults": 4,
            "room_qty": 2,
            "sort_by": "popularity"
        }
    }
]

2025-08-25 11:32:39,768 - evaluation_logger_Cross-17 - INFO - Start compare_single_call: 
{'name': 'Search_Hotel_Destination', 'arguments': {'query': 'Berlin'}}
{'name': 'Search_Hotel_Destination', 'arguments': {'query': 'Berlin'}}
2025-08-25 11:32:39,768 - evaluation_logger_Cross-17 - INFO - Rule-based compare success.
2025-08-25 11:32:39,768 - evaluation_logger_Cross-17 - INFO - Success matched: [{'name': 'Search_Hotel_Destination', 'arguments': {'query': 'Berlin'}}]
2025-08-25 11:32:39,768 - evaluation_logger_Cross-17 - INFO - Observations:
[
    {
        "status": true,
        "message": "Success",
        "data": [
            {
                "dest_id": "-1746443",
                "search_type": "city",
                "type": "ci",
                "roundtrip": "GgEwIAAoATICZW46D0JlcmxpbiwgR2VybWFueUAASgBQAA==",
                "latitude": 52.516212,
                "dest_type": "city",
                "name": "Berlin",
                "city_name": "Berlin",
                "cc1": "de",
                "nr_hotels": 1749,
                "longitude": 13.376818,
                "country": "Germany",
                "label": "Berlin, Berlin Federal State, Germany",
                "region": "Berlin Federal State",
                "hotels": 1749,
                "lc": "en"
            }
        ]
    }
]

2025-08-25 11:32:56,005 - evaluation_logger_Cross-17 - INFO - Function Calls: 
[
    {
        "name": "Search_Hotels",
        "arguments": {
            "dest_id": -1746443,
            "search_type": "city",
            "arrival_date": "2024-12-10",
            "departure_date": "2024-12-11",
            "adults": 4,
            "room_qty": 2,
            "sort_by": "popularity"
        }
    },
    {
        "name": "Search_Car_Rentals",
        "arguments": {
            "pick_up_latitude": 52.516212,
            "pick_up_longitude": 13.376818,
            "drop_off_latitude": 52.516212,
            "drop_off_longitude": 13.376818,
            "pick_up_date": "2024-12-10",
            "drop_off_date": "2024-12-11",
            "pick_up_time": "08:00",
            "drop_off_time": "17:00"
        }
    }
]

2025-08-25 11:32:56,005 - evaluation_logger_Cross-17 - INFO - Golden Function Call: 
[
    {
        "name": "Search_Car_Rentals",
        "arguments": {
            "drop_off_date": "2024-12-11",
            "drop_off_latitude": 52.516212,
            "drop_off_longitude": 13.376818,
            "drop_off_time": "17:00",
            "pick_up_date": "2024-12-10",
            "pick_up_latitude": 52.516212,
            "pick_up_longitude": 13.376818,
            "pick_up_time": "08:00"
        }
    },
    {
        "name": "Search_Hotels",
        "arguments": {
            "adults": 4,
            "arrival_date": "2024-12-10",
            "departure_date": "2024-12-11",
            "dest_id": -1746443,
            "room_qty": 2,
            "search_type": "city",
            "sort_by": "popularity"
        }
    }
]

2025-08-25 11:32:56,005 - evaluation_logger_Cross-17 - INFO - Start compare_single_call: 
{'name': 'Search_Hotels', 'arguments': {'adults': 4, 'arrival_date': '2024-12-10', 'departure_date': '2024-12-11', 'dest_id': -1746443, 'room_qty': 2, 'search_type': 'city', 'sort_by': 'popularity'}}
{'name': 'Search_Hotels', 'arguments': {'adults': 4, 'arrival_date': '2024-12-10', 'departure_date': '2024-12-11', 'dest_id': -1746443, 'room_qty': 2, 'search_type': 'city', 'sort_by': 'popularity'}}
2025-08-25 11:32:56,005 - evaluation_logger_Cross-17 - INFO - Rule-based compare success.
2025-08-25 11:32:56,005 - evaluation_logger_Cross-17 - INFO - Start compare_single_call: 
{'name': 'Search_Car_Rentals', 'arguments': {'drop_off_date': '2024-12-11', 'drop_off_latitude': 52.516212, 'drop_off_longitude': 13.376818, 'drop_off_time': '17:00', 'pick_up_date': '2024-12-10', 'pick_up_latitude': 52.516212, 'pick_up_longitude': 13.376818, 'pick_up_time': '08:00'}}
{'name': 'Search_Car_Rentals', 'arguments': {'drop_off_date': '2024-12-11', 'drop_off_latitude': 52.516212, 'drop_off_longitude': 13.376818, 'drop_off_time': '17:00', 'pick_up_date': '2024-12-10', 'pick_up_latitude': 52.516212, 'pick_up_longitude': 13.376818, 'pick_up_time': '08:00'}}
2025-08-25 11:32:56,006 - evaluation_logger_Cross-17 - INFO - Rule-based compare success.
2025-08-25 11:32:56,006 - evaluation_logger_Cross-17 - INFO - Success matched: [{'name': 'Search_Hotels', 'arguments': {'adults': 4, 'arrival_date': '2024-12-10', 'departure_date': '2024-12-11', 'dest_id': -1746443, 'room_qty': 2, 'search_type': 'city', 'sort_by': 'popularity'}}, {'name': 'Search_Car_Rentals', 'arguments': {'drop_off_date': '2024-12-11', 'drop_off_latitude': 52.516212, 'drop_off_longitude': 13.376818, 'drop_off_time': '17:00', 'pick_up_date': '2024-12-10', 'pick_up_latitude': 52.516212, 'pick_up_longitude': 13.376818, 'pick_up_time': '08:00'}}]
2025-08-25 11:32:56,007 - evaluation_logger_Cross-17 - INFO - Observations:
[
    {
        "status": true,
        "message": "Success",
        "data": {
            "hotels": [
                {
                    "hotel_id": 2823074,
                    "accessibilityLabel": "HighPark Berlin am Potsdamer Platz.\n4 out of 5 for accommodation quality.\n8.8 Fabulous 5036 reviews.\n‎Mitte‬ • ‎1.4 km from centre‬.\n Entire studio – 32 m² : 2 beds • 1 bedroom • 1 bathroom.\nOriginal price 305 USD. Current price 260 USD..\nIncludes taxes and charges.",
                    "property": {
                        "reviewScoreWord": "Fabulous",
                        "latitude": 52.50406619218,
                        "qualityClass": 0,
                        "blockIds": [
                            "282307410_107333067_4_2_0"
                        ],
                        "isPreferred": true,
                        "isFirstPage": true,
                        "isPreferredPlus": true,
                        "optOutFromGalleryChanges": 0,
                        "reviewScore": 8.8,
                        "mainPhotoId": 161768679,
                        "name": "HighPark Berlin am Potsdamer Platz",
                        "checkin": {
                            "untilTime": "00:00",
                            "fromTime": "15:00"
                        },
                        "currency": "EUR",
                        "checkinDate": "2024-12-10",
                        "longitude": 13.3742544214264,
                        "countryCode": "de",
                        "position": 0,
                        "rankingPosition": 0,
                        "isClassEstimated": true,
                        "wishlistName": "Berlin",
                        "ufi": -1746443,
                        "propertyClass": 4,
                        "id": 2823074,
                        "checkout": {
                            "untilTime": "12:00",
                            "fromTime": "00:00"
                        },
                        "accuratePropertyClass": 4,
                        "reviewCount": 5036,
                        "checkoutDate": "2024-12-11",
                        "priceBreakdown": {
                            "benefitBadges": [
                                {
                                    "explanation": "Mobile-only price",
                                    "variant": "constructive",
                                    "identifier": "Mobile Rate",
                                    "text": "Mobile-only price"
                                }
                            ],
                            "strikethroughPrice": {
                                "currency": "USD",
                                "value": 304.538454836263
                            },
                            "grossPrice": {
                                "value": 260.378429214999,
                                "currency": "USD"
                            }
                        }
                    }
                },
                {
                    "hotel_id": 3573182,
                    "accessibilityLabel": "Schulz Hotel Berlin Wall at the East Side Gallery.\n3 out of 5 for accommodation quality.\n8.5 Very good 24063 reviews.\n‎Friedrichshain-Kreuzberg‬ • ‎3.9 km from centre‬.\n 2 hotel rooms : 3 beds.\n236 USD.\nIncludes taxes and charges.\nFree cancellation.",
                    "property": {
                        "accuratePropertyClass": 3,
                        "checkoutDate": "2024-12-11",
                        "reviewCount": 24063,
                        "priceBreakdown": {
                            "grossPrice": {
                                "value": 236.28917314885,
                                "currency": "USD"
                            }
                        },
                        "checkout": {
                            "fromTime": "00:00",
                            "untilTime": "11:00"
                        },
                        "id": 3573182,
                        "wishlistName": "Berlin",
                        "propertyClass": 3,
                        "ufi": -1746443,
                        "isClassEstimated": true,
                        "longitude": 13.433772,
                        "rankingPosition": 1,
                        "position": 1,
                        "countryCode": "de",
                        "checkinDate": "2024-12-10",
                        "name": "Schulz Hotel Berlin Wall at the East Side Gallery",
                        "checkin": {
                            "fromTime": "15:30",
                            "untilTime": "23:30"
                        },
                        "currency": "EUR",
                        "mainPhotoId": 262314474,
                        "optOutFromGalleryChanges": 0,
                        "reviewScore": 8.5,
                        "isPreferredPlus": true,
                        "isPreferred": true,
                        "isFirstPage": true,
                        "blockIds": [
                            "357318207_371696264_0_2_0",
                            "357318205_382536252_0_2_0"
                        ],
                        "qualityClass": 0,
                        "reviewScoreWord": "Very good",
                        "latitude": 52.508824
                    }
                },
                {
                    "hotel_id": 66787,
                    "accessibilityLabel": "Hollywood Media Hotel am Kurfürstendamm.\n4 out of 5 stars.\n8.3 Very good 9978 reviews.\n‎Charlottenburg-Wilmersdorf‬ • ‎4.1 km from centre‬.\n 2 hotel rooms : 4 beds.\n249 USD.\nIncludes taxes and charges.",
                    "property": {
                        "isPreferred": true,
                        "isFirstPage": true,
                        "isPreferredPlus": true,
                        "optOutFromGalleryChanges": 0,
                        "reviewScore": 8.3,
                        "mainPhotoId": 173701995,
                        "reviewScoreWord": "Very good",
                        "latitude": 52.5015577919732,
                        "qualityClass": 0,
                        "blockIds": [
                            "6678702_338459225_2_2_0",
                            "6678702_338459225_2_2_0"
                        ],
                        "wishlistName": "Berlin",
                        "ufi": -1746443,
                        "propertyClass": 4,
                        "id": 66787,
                        "checkout": {
                            "fromTime": "00:00",
                            "untilTime": "12:00"
                        },
                        "accuratePropertyClass": 4,
                        "priceBreakdown": {
                            "grossPrice": {
                                "currency": "USD",
                                "value": 248.886207683442
                            }
                        },
                        "reviewCount": 9978,
                        "checkoutDate": "2024-12-11",
                        "name": "Hollywood Media Hotel am Kurfürstendamm",
                        "currency": "EUR",
                        "checkin": {
                            "untilTime": "00:00",
                            "fromTime": "15:00"
                        },
                        "checkinDate": "2024-12-10",
                        "longitude": 13.3212205767632,
                        "countryCode": "de",
                        "rankingPosition": 2,
                        "position": 2
                    }
                },
                {
                    "hotel_id": 64596,
                    "accessibilityLabel": "Meliá Berlin.\n4 out of 5 stars.\n8.5 Very good 8390 reviews.\n‎Mitte‬ • ‎950 m from centre‬.\n 2 hotel rooms : 4 beds.\n430 USD.\nAdditional charges may apply.\nFree cancellation.\nNo prepayment needed.",
                    "property": {
                        "mainPhotoId": 115579699,
                        "reviewScore": 8.5,
                        "optOutFromGalleryChanges": 1,
                        "isPreferredPlus": true,
                        "isFirstPage": true,
                        "isPreferred": true,
                        "qualityClass": 0,
                        "blockIds": [
                            "6459602_196399857_2_2_0",
                            "6459602_196399857_2_2_0"
                        ],
                        "latitude": 52.5214240823968,
                        "reviewScoreWord": "Very good",
                        "reviewCount": 8390,
                        "priceBreakdown": {
                            "grossPrice": {
                                "currency": "USD",
                                "value": 430.118866181107
                            },
                            "hasIncalculableCharges": true
                        },
                        "checkoutDate": "2024-12-11",
                        "accuratePropertyClass": 4,
                        "id": 64596,
                        "checkout": {
                            "fromTime": "00:00",
                            "untilTime": "12:00"
                        },
                        "ufi": -1746443,
                        "propertyClass": 4,
                        "wishlistName": "Berlin",
                        "countryCode": "de",
                        "rankingPosition": 3,
                        "position": 3,
                        "longitude": 13.3882194757462,
                        "checkinDate": "2024-12-10",
                        "checkin": {
                            "untilTime": "00:00",
                            "fromTime": "15:00"
                        },
                        "currency": "EUR",
                        "name": "Meliá Berlin"
                    }
                },
                {
                    "hotel_id": 60256,
                    "accessibilityLabel": "Hotel Augusta Am Kurfürstendamm.\n3 out of 5 stars.\n8.1 Very good 3217 reviews.\n‎Charlottenburg-Wilmersdorf‬ • ‎3.7 km from centre‬.\n 2 hotel rooms : 4 beds.\nOriginal price 323 USD. Current price 291 USD..\nIncludes taxes and charges.",
                    "property": {
                        "isPreferred": true,
                        "isFirstPage": true,
                        "isPreferredPlus": true,
                        "optOutFromGalleryChanges": 0,
                        "reviewScore": 8.1,
                        "mainPhotoId": 166718509,
                        "reviewScoreWord": "Very good",
                        "latitude": 52.5022402835057,
                        "blockIds": [
                            "6025602_97005227_0_2_0_611695",
                            "6025602_97005227_0_2_0_611695"
                        ],
                        "qualityClass": 0,
                        "wishlistName": "Berlin",
                        "ufi": -1746443,
                        "propertyClass": 3,
                        "id": 60256,
                        "checkout": {
                            "fromTime": "08:00",
                            "untilTime": "11:00"
                        },
                        "accuratePropertyClass": 3,
                        "reviewCount": 3217,
                        "priceBreakdown": {
                            "strikethroughPrice": {
                                "value": 322.995330886945,
                                "currency": "USD"
                            },
                            "grossPrice": {
                                "currency": "USD",
                                "value": 290.695797798251
                            },
                            "benefitBadges": [
                                {
                                    "text": "Mobile-only price",
                                    "explanation": "Mobile-only price",
                                    "identifier": "Mobile Rate",
                                    "variant": "constructive"
                                }
                            ]
                        },
                        "checkoutDate": "2024-12-11",
                        "name": "Hotel Augusta Am Kurfürstendamm",
                        "checkin": {
                            "fromTime": "14:00",
                            "untilTime": "00:00"
                        },
                        "currency": "EUR",
                        "checkinDate": "2024-12-10",
                        "longitude": 13.3272421360016,
                        "countryCode": "de",
                        "rankingPosition": 4,
                        "position": 4
                    }
                }
            ],
            "meta": [
                {
                    "title": "743 properties"
                }
            ],
            "appear": [
                {
                    "component": {
                        "props": {
                            "content": {
                                "props": {
                                    "items": [
                                        {
                                            "props": {
                                                "component": {
                                                    "props": {
                                                        "spacing": "spacing_half",
                                                        "items": [
                                                            {
                                                                "props": {
                                                                    "text": [
                                                                        {
                                                                            "font": "body_2",
                                                                            "text": "Commission paid and other benefits may affect an accommodation's ranking."
                                                                        },
                                                                        {
                                                                            "color": "foreground",
                                                                            "font": "strong_2",
                                                                            "text": "  "
                                                                        },
                                                                        {
                                                                            "font": "body_2",
                                                                            "color": "action_foreground",
                                                                            "linkActions": [
                                                                                {}
                                                                            ],
                                                                            "text": "Find out more"
                                                                        }
                                                                    ]
                                                                }
                                                            }
                                                        ]
                                                    }
                                                }
                                            }
                                        },
                                        {},
                                        {
                                            "props": {
                                                "component": {
                                                    "props": {
                                                        "icon": "close",
                                                        "accessibilityLabel": "Close",
                                                        "tertiaryTintedColor": "foreground",
                                                        "variant": "tertiary_tinted"
                                                    }
                                                }
                                            }
                                        }
                                    ],
                                    "fitContentWidth": true
                                }
                            },
                            "fill": true
                        }
                    },
                    "id": "cma"
                },
                {},
                {
                    "component": {
                        "props": {
                            "text": "Get instant access to our Genius loyalty programme and enjoy discounts at properties worldwide.",
                            "title": "Sign in and save money"
                        }
                    },
                    "id": "signin_now"
                }
            ]
        }
    },
    {
        "status": true,
        "message": "Success",
        "data": {
            "meta": {
                "response_code": 200
            },
            "provider": "rentalcars",
            "title": "Car rentals",
            "filter": [
                {
                    "categories": [
                        {
                            "id": "depotLocationType::DOWNTOWN",
                            "name": "All other locations",
                            "count": 1405,
                            "nameWithCount": "All other locations (1405)"
                        },
                        {
                            "count": 171,
                            "id": "depotLocationType::TRAINSTATION",
                            "name": "Train station",
                            "nameWithCount": "Train station (171)"
                        },
                        {
                            "nameWithCount": "Airport (car rental centre) (212)",
                            "count": 212,
                            "name": "Airport (car rental centre)",
                            "id": "depotLocationType::CAR_RENTAL_CENTRE"
                        }
                    ],
                    "title": "Location",
                    "layout": {
                        "collapsed_count": 3,
                        "layout_type": "list",
                        "is_collapsed": "false",
                        "is_collapsable": "false"
                    },
                    "type": "multiple_union",
                    "id": "depotLocationType"
                },
                {
                    "type": "multiple_union",
                    "id": "carCategory",
                    "categories": [
                        {
                            "nameWithCount": "Small (126)",
                            "count": 126,
                            "name": "Small",
                            "id": "carCategory::small"
                        },
                        {
                            "count": 811,
                            "id": "carCategory::medium",
                            "name": "Medium",
                            "nameWithCount": "Medium (811)"
                        },
                        {
                            "count": 917,
                            "name": "Large",
                            "id": "carCategory::large",
                            "nameWithCount": "Large (917)"
                        },
                        {
                            "count": 331,
                            "name": "Estate",
                            "id": "carCategory::estate",
                            "nameWithCount": "Estate (331)"
                        },
                        {
                            "nameWithCount": "Premium (444)",
                            "name": "Premium",
                            "id": "carCategory::premium",
                            "count": 444
                        }
                    ],
                    "title": "Car Type",
                    "layout": {
                        "is_collapsable": "true",
                        "is_collapsed": "true",
                        "layout_type": "list",
                        "collapsed_count": 5
                    }
                },
                {
                    "title": "Price per day",
                    "categories": [
                        {
                            "count": 2,
                            "name": "US$0 - US$50",
                            "id": "pricePerDayBuckets::BUCKET_1",
                            "nameWithCount": "US$0 - US$50 (2)"
                        },
                        {
                            "count": 178,
                            "name": "US$50 - US$100",
                            "id": "pricePerDayBuckets::BUCKET_2",
                            "nameWithCount": "US$50 - US$100 (178)"
                        },
                        {
                            "nameWithCount": "US$100 - US$150 (893)",
                            "id": "pricePerDayBuckets::BUCKET_3",
                            "name": "US$100 - US$150",
                            "count": 893
                        },
                        {
                            "nameWithCount": "US$150 - US$200 (430)",
                            "count": 430,
                            "id": "pricePerDayBuckets::BUCKET_4",
                            "name": "US$150 - US$200"
                        },
                        {
                            "nameWithCount": "US$200+ (285)",
                            "count": 285,
                            "id": "pricePerDayBuckets::BUCKET_5",
                            "name": "US$200+"
                        }
                    ],
                    "layout": {
                        "is_collapsable": "false",
                        "is_collapsed": "false",
                        "collapsed_count": 5,
                        "layout_type": "list"
                    },
                    "type": "multiple_union",
                    "id": "pricePerDayBuckets"
                },
                {
                    "type": "multiple_union",
                    "id": "supplier",
                    "categories": [
                        {
                            "id": "supplier::Avis",
                            "name": "Avis",
                            "count": 66,
                            "nameWithCount": "Avis (66)"
                        },
                        {
                            "count": 75,
                            "id": "supplier::Budget",
                            "name": "Budget",
                            "nameWithCount": "Budget (75)"
                        },
                        {
                            "nameWithCount": "Europcar (362)",
                            "name": "Europcar",
                            "id": "supplier::Europcar",
                            "count": 362
                        },
                        {
                            "nameWithCount": "Sixt (1270)",
                            "id": "supplier::Sixt",
                            "name": "Sixt",
                            "count": 1270
                        },
                        {
                            "nameWithCount": "Wheego (15)",
                            "count": 15,
                            "id": "supplier::Wheego",
                            "name": "Wheego"
                        }
                    ],
                    "title": "Supplier",
                    "layout": {
                        "collapsed_count": 5,
                        "layout_type": "list",
                        "is_collapsed": "true",
                        "is_collapsable": "true"
                    }
                },
                {
                    "id": "transmission",
                    "type": "multiple_union",
                    "layout": {
                        "layout_type": "list",
                        "collapsed_count": 5,
                        "is_collapsable": "true",
                        "is_collapsed": "true"
                    },
                    "title": "Transmission",
                    "categories": [
                        {
                            "name": "Automatic",
                            "id": "transmission::AUTOMATIC",
                            "count": 1313,
                            "nameWithCount": "Automatic (1313)"
                        },
                        {
                            "nameWithCount": "Manual (475)",
                            "count": 475,
                            "name": "Manual",
                            "id": "transmission::MANUAL"
                        }
                    ]
                }
            ],
            "search_results": [
                {
                    "vehicle_id": "725042196",
                    "vehicle_info": {
                        "doors": "2",
                        "airbags": 1,
                        "v_name": "Fiat Panda",
                        "mileage": "Unlimited km",
                        "transmission": "Manual",
                        "fuel_policy": "Like for like",
                        "unlimited_mileage": 1,
                        "seats": "5",
                        "special_offer_text": "Price includes winterisation fee",
                        "label": "Mini car with:",
                        "fuel_type": "N/A",
                        "free_cancellation": 1,
                        "suitcases": {
                            "big": "0",
                            "small": "0"
                        },
                        "cma_compliant": -1,
                        "aircon": 1,
                        "group": "Mini",
                        "v_id": "725042196"
                    },
                    "rating_info": {
                        "cleanliness": 7.1,
                        "location": 9,
                        "average": 8,
                        "efficiency": 7.7,
                        "dropoff_time": 8.5,
                        "pickup_time": 8.4,
                        "average_text": "Excellent",
                        "value_for_money": 8.2,
                        "condition": 8.6,
                        "no_of_ratings": 59
                    },
                    "freebies": [
                        "Amendments"
                    ],
                    "content": {
                        "badges": [
                            {
                                "variation": "DEFAULT",
                                "text": "Free cancellation",
                                "type": "CONSTRUCTIVE"
                            }
                        ],
                        "supplier": {
                            "rating": {
                                "localisedRating": {
                                    "rawValue": 8,
                                    "displayValue": "8"
                                },
                                "subtitle": "59 reviews",
                                "title": "Very good",
                                "average": "8.0"
                            },
                            "name": "Wheego"
                        }
                    },
                    "pricing_info": {
                        "base_deposit": 7719.39,
                        "price": 91.78,
                        "pay_when": "PAY_NOW",
                        "drive_away_price_is_approx": true,
                        "fee_breakdown": {
                            "known_fees": [
                                {
                                    "max_amount": 900,
                                    "currency": "EUR",
                                    "min_amount": 900,
                                    "amount": 900,
                                    "is_tax_included": 1,
                                    "is_always_payable": 0,
                                    "type": "THEFT_EXCESS"
                                },
                                {
                                    "min_amount": 900,
                                    "amount": 900,
                                    "is_tax_included": 1,
                                    "is_always_payable": 0,
                                    "type": "DEPOSIT",
                                    "max_amount": 900,
                                    "currency": "EUR"
                                },
                                {
                                    "min_amount": 900,
                                    "amount": 900,
                                    "is_always_payable": 0,
                                    "type": "DAMAGE_EXCESS",
                                    "is_tax_included": 1,
                                    "currency": "EUR",
                                    "max_amount": 900
                                },
                                {
                                    "distance_allowed": {
                                        "is_unlimited": 1,
                                        "is_km": 1
                                    },
                                    "type": "MILEAGE",
                                    "is_always_payable": 0
                                }
                            ],
                            "fuel_policy": {
                                "amount": 0,
                                "type": "RETURN_SAME"
                            }
                        },
                        "currency": "USD",
                        "discount": 0,
                        "quote_allowed": 1,
                        "base_currency": "INR",
                        "base_price": 7719.39,
                        "deposit": 91.78,
                        "drive_away_price": 91.78
                    },
                    "fee_info": {
                        "fee": 0,
                        "tax": 0
                    },
                    "supplier_info": {
                        "may_require_credit_card_guarantee": false,
                        "logo_url": "https://cdn.rcstatic.com/sp/images/suppliers/4044_logo_200.png",
                        "address": "134-135, Scharnweberstrasse, Berlin, Germany, 13405",
                        "latitude": "52.56457",
                        "name": "Wheego",
                        "location_type": "Downtown",
                        "longitude": "13.32588"
                    },
                    "accessibility": {
                        "supplier_rating": "At this location, our customers have rated Wheego as 8.0 out of 10, Very good.",
                        "pick_up_location": "Pick-up information: Downtown",
                        "transmission": "Manual gearbox",
                        "fuel_policy": "Fuel policy is: Like for like"
                    },
                    "route_info": {
                        "dropoff": {
                            "location_hash": "QmVybGluIC0gUmVpbmlja2VuZG9yZg==",
                            "address": "134-135, Scharnweberstrasse, Berlin, Germany, 13405",
                            "latitude": "52.56457",
                            "name": "Berlin - Reinickendorf",
                            "longitude": "13.32588",
                            "location_id": "4591545",
                            "country_code": "DE",
                            "location_type": "DOWNTOWN"
                        },
                        "pickup": {
                            "address": "134-135, Scharnweberstrasse, Berlin, Germany, 13405",
                            "latitude": "52.56457",
                            "location_hash": "QmVybGluIC0gUmVpbmlja2VuZG9yZg==",
                            "location_id": "4591545",
                            "location_type": "DOWNTOWN",
                            "country_code": "DE",
                            "longitude": "13.32588",
                            "name": "Berlin - Reinickendorf"
                        }
                    }
                },
                {
                    "vehicle_id": "725042131",
                    "rating_info": {
                        "condition": 8.6,
                        "no_of_ratings": 59,
                        "value_for_money": 8.2,
                        "average_text": "Excellent",
                        "pickup_time": 8.4,
                        "dropoff_time": 8.5,
                        "efficiency": 7.7,
                        "location": 9,
                        "average": 8,
                        "cleanliness": 7.1
                    },
                    "freebies": [
                        "Amendments"
                    ],
                    "vehicle_info": {
                        "cma_compliant": -1,
                        "free_cancellation": 1,
                        "suitcases": {
                            "small": "0",
                            "big": "0"
                        },
                        "v_id": "725042131",
                        "aircon": 1,
                        "group": "Economy",
                        "label": "Economy car with:",
                        "special_offer_text": "Price includes winterisation fee",
                        "fuel_type": "N/A",
                        "unlimited_mileage": 1,
                        "seats": "5",
                        "fuel_policy": "Like for like",
                        "doors": "3",
                        "transmission": "Manual",
                        "airbags": 1,
                        "v_name": "Skoda Fabia",
                        "mileage": "Unlimited km"
                    },
                    "route_info": {
                        "pickup": {
                            "longitude": "13.32588",
                            "country_code": "DE",
                            "location_type": "DOWNTOWN",
                            "location_id": "4591545",
                            "name": "Berlin - Reinickendorf",
                            "location_hash": "QmVybGluIC0gUmVpbmlja2VuZG9yZg==",
                            "latitude": "52.56457",
                            "address": "134-135, Scharnweberstrasse, Berlin, Germany, 13405"
                        },
                        "dropoff": {
                            "latitude": "52.56457",
                            "address": "134-135, Scharnweberstrasse, Berlin, Germany, 13405",
                            "location_hash": "QmVybGluIC0gUmVpbmlja2VuZG9yZg==",
                            "name": "Berlin - Reinickendorf",
                            "country_code": "DE",
                            "location_type": "DOWNTOWN",
                            "location_id": "4591545",
                            "longitude": "13.32588"
                        }
                    },
                    "accessibility": {
                        "fuel_policy": "Fuel policy is: Like for like",
                        "transmission": "Manual gearbox",
                        "supplier_rating": "At this location, our customers have rated Wheego as 8.0 out of 10, Very good.",
                        "pick_up_location": "Pick-up information: Downtown"
                    },
                    "fee_info": {
                        "fee": 0,
                        "tax": 0
                    },
                    "supplier_info": {
                        "logo_url": "https://cdn.rcstatic.com/sp/images/suppliers/4044_logo_200.png",
                        "may_require_credit_card_guarantee": false,
                        "latitude": "52.56457",
                        "address": "134-135, Scharnweberstrasse, Berlin, Germany, 13405",
                        "name": "Wheego",
                        "longitude": "13.32588",
                        "location_type": "Downtown"
                    },
                    "pricing_info": {
                        "currency": "USD",
                        "base_deposit": 8160.5,
                        "pay_when": "PAY_NOW",
                        "price": 97.03,
                        "fee_breakdown": {
                            "fuel_policy": {
                                "amount": 0,
                                "type": "RETURN_SAME"
                            },
                            "known_fees": [
                                {
                                    "min_amount": 900,
                                    "amount": 900,
                                    "is_always_payable": 0,
                                    "type": "THEFT_EXCESS",
                                    "is_tax_included": 1,
                                    "max_amount": 900,
                                    "currency": "EUR"
                                },
                                {
                                    "is_always_payable": 0,
                                    "type": "DEPOSIT",
                                    "is_tax_included": 1,
                                    "min_amount": 900,
                                    "amount": 900,
                                    "currency": "EUR",
                                    "max_amount": 900
                                },
                                {
                                    "currency": "EUR",
                                    "max_amount": 900,
                                    "min_amount": 900,
                                    "amount": 900,
                                    "is_always_payable": 0,
                                    "type": "DAMAGE_EXCESS",
                                    "is_tax_included": 1
                                },
                                {
                                    "type": "MILEAGE",
                                    "is_always_payable": 0,
                                    "distance_allowed": {
                                        "is_km": 1,
                                        "is_unlimited": 1
                                    }
                                }
                            ]
                        },
                        "drive_away_price_is_approx": true,
                        "base_currency": "INR",
                        "base_price": 8160.5,
                        "drive_away_price": 97.03,
                        "deposit": 97.03,
                        "discount": 0,
                        "quote_allowed": 1
                    },
                    "content": {
                        "badges": [
                            {
                                "type": "CONSTRUCTIVE",
                                "text": "Free cancellation",
                                "variation": "DEFAULT"
                            }
                        ],
                        "supplier": {
                            "rating": {
                                "subtitle": "59 reviews",
                                "localisedRating": {
                                    "displayValue": "8",
                                    "rawValue": 8
                                },
                                "average": "8.0",
                                "title": "Very good"
                            },
                            "name": "Wheego"
                        }
                    }
                },
                {
                    "vehicle_id": "724870276",
                    "accessibility": {
                        "fuel_policy": "Fuel policy is: Like for like",
                        "supplier_rating": "At this location, our customers have rated Wheego as 8.0 out of 10, Very good.",
                        "pick_up_location": "Pick-up information: Downtown",
                        "transmission": "Manual gearbox"
                    },
                    "route_info": {
                        "dropoff": {
                            "name": "Berlin - Reinickendorf",
                            "country_code": "DE",
                            "location_type": "DOWNTOWN",
                            "location_id": "4591545",
                            "longitude": "13.32588",
                            "latitude": "52.56457",
                            "address": "134-135, Scharnweberstrasse, Berlin, Germany, 13405",
                            "location_hash": "QmVybGluIC0gUmVpbmlja2VuZG9yZg=="
                        },
                        "pickup": {
                            "name": "Berlin - Reinickendorf",
                            "longitude": "13.32588",
                            "country_code": "DE",
                            "location_type": "DOWNTOWN",
                            "location_id": "4591545",
                            "location_hash": "QmVybGluIC0gUmVpbmlja2VuZG9yZg==",
                            "latitude": "52.56457",
                            "address": "134-135, Scharnweberstrasse, Berlin, Germany, 13405"
                        }
                    },
                    "content": {
                        "supplier": {
                            "name": "Wheego",
                            "rating": {
                                "title": "Very good",
                                "average": "8.0",
                                "subtitle": "59 reviews",
                                "localisedRating": {
                                    "displayValue": "8",
                                    "rawValue": 8
                                }
                            }
                        },
                        "badges": [
                            {
                                "variation": "DEFAULT",
                                "text": "Free cancellation",
                                "type": "CONSTRUCTIVE"
                            }
                        ]
                    },
                    "pricing_info": {
                        "drive_away_price_is_approx": true,
                        "fee_breakdown": {
                            "fuel_policy": {
                                "amount": 0,
                                "type": "RETURN_SAME"
                            },
                            "known_fees": [
                                {
                                    "type": "THEFT_EXCESS",
                                    "is_always_payable": 0,
                                    "is_tax_included": 1,
                                    "amount": 900,
                                    "min_amount": 900,
                                    "max_amount": 900,
                                    "currency": "EUR"
                                },
                                {
                                    "is_tax_included": 1,
                                    "type": "DEPOSIT",
                                    "is_always_payable": 0,
                                    "amount": 900,
                                    "min_amount": 900,
                                    "max_amount": 900,
                                    "currency": "EUR"
                                },
                                {
                                    "is_always_payable": 0,
                                    "type": "DAMAGE_EXCESS",
                                    "is_tax_included": 1,
                                    "min_amount": 900,
                                    "amount": 900,
                                    "currency": "EUR",
                                    "max_amount": 900
                                },
                                {
                                    "distance_allowed": {
                                        "is_km": 1,
                                        "is_unlimited": 1
                                    },
                                    "type": "MILEAGE",
                                    "is_always_payable": 0
                                }
                            ]
                        },
                        "price": 107.5,
                        "pay_when": "PAY_NOW",
                        "base_deposit": 9041.54,
                        "currency": "USD",
                        "quote_allowed": 1,
                        "discount": 0,
                        "deposit": 107.5,
                        "drive_away_price": 107.5,
                        "base_price": 9041.54,
                        "base_currency": "INR"
                    },
                    "supplier_info": {
                        "name": "Wheego",
                        "location_type": "Downtown",
                        "longitude": "13.32588",
                        "may_require_credit_card_guarantee": false,
                        "logo_url": "https://cdn.rcstatic.com/sp/images/suppliers/4044_logo_200.png",
                        "address": "134-135, Scharnweberstrasse, Berlin, Germany, 13405",
                        "latitude": "52.56457"
                    },
                    "fee_info": {
                        "fee": 0,
                        "tax": 0
                    },
                    "vehicle_info": {
                        "transmission": "Manual",
                        "mileage": "Unlimited km",
                        "v_name": "Hyundai i30",
                        "airbags": 1,
                        "doors": "4",
                        "seats": "5",
                        "unlimited_mileage": 1,
                        "fuel_policy": "Like for like",
                        "fuel_type": "N/A",
                        "label": "Compact car with:",
                        "special_offer_text": "Price includes winterisation fee",
                        "v_id": "724870276",
                        "group": "Compact",
                        "aircon": 1,
                        "cma_compliant": -1,
                        "suitcases": {
                            "big": "0",
                            "small": "0"
                        },
                        "free_cancellation": 1
                    },
                    "freebies": [
                        "Amendments"
                    ],
                    "rating_info": {
                        "cleanliness": 7.1,
                        "location": 9,
                        "average": 8,
                        "dropoff_time": 8.5,
                        "pickup_time": 8.4,
                        "efficiency": 7.7,
                        "average_text": "Excellent",
                        "value_for_money": 8.2,
                        "no_of_ratings": 59,
                        "condition": 8.6
                    }
                },
                {
                    "vehicle_id": "724870286",
                    "vehicle_info": {
                        "seats": "5",
                        "unlimited_mileage": 1,
                        "fuel_policy": "Like for like",
                        "transmission": "Manual",
                        "mileage": "Unlimited km",
                        "v_name": "Skoda Kamiq",
                        "airbags": 1,
                        "doors": "5",
                        "v_id": "724870286",
                        "aircon": 1,
                        "group": "Compact",
                        "cma_compliant": -1,
                        "suitcases": {
                            "small": "0",
                            "big": "0"
                        },
                        "free_cancellation": 1,
                        "fuel_type": "N/A",
                        "label": "Compact car with:",
                        "special_offer_text": "Price includes winterisation fee"
                    },
                    "rating_info": {
                        "value_for_money": 8.2,
                        "condition": 8.6,
                        "no_of_ratings": 59,
                        "average_text": "Excellent",
                        "efficiency": 7.7,
                        "dropoff_time": 8.5,
                        "pickup_time": 8.4,
                        "cleanliness": 7.1,
                        "average": 8,
                        "location": 9
                    },
                    "freebies": [
                        "Amendments"
                    ],
                    "content": {
                        "badges": [
                            {
                                "type": "CONSTRUCTIVE",
                                "variation": "DEFAULT",
                                "text": "Free cancellation"
                            }
                        ],
                        "supplier": {
                            "rating": {
                                "average": "8.0",
                                "title": "Very good",
                                "localisedRating": {
                                    "rawValue": 8,
                                    "displayValue": "8"
                                },
                                "subtitle": "59 reviews"
                            },
                            "name": "Wheego"
                        }
                    },
                    "pricing_info": {
                        "base_deposit": 9886.01,
                        "pay_when": "PAY_NOW",
                        "price": 117.54,
                        "fee_breakdown": {
                            "fuel_policy": {
                                "type": "RETURN_SAME",
                                "amount": 0
                            },
                            "known_fees": [
                                {
                                    "is_tax_included": 1,
                                    "is_always_payable": 0,
                                    "type": "THEFT_EXCESS",
                                    "min_amount": 900,
                                    "amount": 900,
                                    "max_amount": 900,
                                    "currency": "EUR"
                                },
                                {
                                    "is_always_payable": 0,
                                    "type": "DEPOSIT",
                                    "is_tax_included": 1,
                                    "min_amount": 900,
                                    "amount": 900,
                                    "max_amount": 900,
                                    "currency": "EUR"
                                },
                                {
                                    "max_amount": 900,
                                    "currency": "EUR",
                                    "amount": 900,
                                    "min_amount": 900,
                                    "is_tax_included": 1,
                                    "type": "DAMAGE_EXCESS",
                                    "is_always_payable": 0
                                },
                                {
                                    "type": "MILEAGE",
                                    "is_always_payable": 0,
                                    "distance_allowed": {
                                        "is_unlimited": 1,
                                        "is_km": 1
                                    }
                                }
                            ]
                        },
                        "drive_away_price_is_approx": true,
                        "currency": "USD",
                        "discount": 0,
                        "quote_allowed": 1,
                        "base_currency": "INR",
                        "base_price": 9886.01,
                        "drive_away_price": 117.54,
                        "deposit": 117.54
                    },
                    "fee_info": {
                        "tax": 0,
                        "fee": 0
                    },
                    "supplier_info": {
                        "name": "Wheego",
                        "longitude": "13.32588",
                        "location_type": "Downtown",
                        "logo_url": "https://cdn.rcstatic.com/sp/images/suppliers/4044_logo_200.png",
                        "may_require_credit_card_guarantee": false,
                        "latitude": "52.56457",
                        "address": "134-135, Scharnweberstrasse, Berlin, Germany, 13405"
                    },
                    "accessibility": {
                        "transmission": "Manual gearbox",
                        "pick_up_location": "Pick-up information: Downtown",
                        "supplier_rating": "At this location, our customers have rated Wheego as 8.0 out of 10, Very good.",
                        "fuel_policy": "Fuel policy is: Like for like"
                    },
                    "route_info": {
                        "pickup": {
                            "name": "Berlin - Reinickendorf",
                            "location_id": "4591545",
                            "country_code": "DE",
                            "location_type": "DOWNTOWN",
                            "longitude": "13.32588",
                            "address": "134-135, Scharnweberstrasse, Berlin, Germany, 13405",
                            "latitude": "52.56457",
                            "location_hash": "QmVybGluIC0gUmVpbmlja2VuZG9yZg=="
                        },
                        "dropoff": {
                            "address": "134-135, Scharnweberstrasse, Berlin, Germany, 13405",
                            "latitude": "52.56457",
                            "location_hash": "QmVybGluIC0gUmVpbmlja2VuZG9yZg==",
                            "location_id": "4591545",
                            "country_code": "DE",
                            "location_type": "DOWNTOWN",
                            "longitude": "13.32588",
                            "name": "Berlin - Reinickendorf"
                        }
                    }
                },
                {
                    "vehicle_id": "724870281",
                    "accessibility": {
                        "fuel_policy": "Fuel policy is: Like for like",
                        "transmission": "Manual gearbox",
                        "pick_up_location": "Pick-up information: Downtown",
                        "supplier_rating": "At this location, our customers have rated Wheego as 8.0 out of 10, Very good."
                    },
                    "route_info": {
                        "pickup": {
                            "name": "Berlin - Reinickendorf",
                            "location_id": "4591545",
                            "location_type": "DOWNTOWN",
                            "country_code": "DE",
                            "longitude": "13.32588",
                            "address": "134-135, Scharnweberstrasse, Berlin, Germany, 13405",
                            "latitude": "52.56457",
                            "location_hash": "QmVybGluIC0gUmVpbmlja2VuZG9yZg=="
                        },
                        "dropoff": {
                            "latitude": "52.56457",
                            "address": "134-135, Scharnweberstrasse, Berlin, Germany, 13405",
                            "location_hash": "QmVybGluIC0gUmVpbmlja2VuZG9yZg==",
                            "country_code": "DE",
                            "location_type": "DOWNTOWN",
                            "location_id": "4591545",
                            "longitude": "13.32588",
                            "name": "Berlin - Reinickendorf"
                        }
                    },
                    "pricing_info": {
                        "quote_allowed": 1,
                        "discount": 0,
                        "deposit": 112.78,
                        "drive_away_price": 112.78,
                        "base_price": 9485,
                        "base_currency": "INR",
                        "drive_away_price_is_approx": true,
                        "fee_breakdown": {
                            "known_fees": [
                                {
                                    "min_amount": 900,
                                    "amount": 900,
                                    "is_always_payable": 0,
                                    "type": "THEFT_EXCESS",
                                    "is_tax_included": 1,
                                    "max_amount": 900,
                                    "currency": "EUR"
                                },
                                {
                                    "max_amount": 900,
                                    "currency": "EUR",
                                    "amount": 900,
                                    "min_amount": 900,
                                    "type": "DEPOSIT",
                                    "is_always_payable": 0,
                                    "is_tax_included": 1
                                },
                                {
                                    "max_amount": 900,
                                    "currency": "EUR",
                                    "is_always_payable": 0,
                                    "type": "DAMAGE_EXCESS",
                                    "is_tax_included": 1,
                                    "min_amount": 900,
                                    "amount": 900
                                },
                                {
                                    "distance_allowed": {
                                        "is_km": 1,
                                        "is_unlimited": 1
                                    },
                                    "is_always_payable": 0,
                                    "type": "MILEAGE"
                                }
                            ],
                            "fuel_policy": {
                                "amount": 0,
                                "type": "RETURN_SAME"
                            }
                        },
                        "price": 112.78,
                        "pay_when": "PAY_NOW",
                        "base_deposit": 9485,
                        "currency": "USD"
                    },
                    "content": {
                        "badges": [
                            {
                                "type": "CONSTRUCTIVE",
                                "variation": "DEFAULT",
                                "text": "Free cancellation"
                            }
                        ],
                        "supplier": {
                            "name": "Wheego",
                            "rating": {
                                "average": "8.0",
                                "title": "Very good",
                                "subtitle": "59 reviews",
                                "localisedRating": {
                                    "rawValue": 8,
                                    "displayValue": "8"
                                }
                            }
                        }
                    },
                    "fee_info": {
                        "tax": 0,
                        "fee": 0
                    },
                    "supplier_info": {
                        "latitude": "52.56457",
                        "address": "134-135, Scharnweberstrasse, Berlin, Germany, 13405",
                        "logo_url": "https://cdn.rcstatic.com/sp/images/suppliers/4044_logo_200.png",
                        "may_require_credit_card_guarantee": false,
                        "longitude": "13.32588",
                        "location_type": "Downtown",
                        "name": "Wheego"
                    },
                    "vehicle_info": {
                        "seats": "5",
                        "unlimited_mileage": 1,
                        "fuel_policy": "Like for like",
                        "transmission": "Manual",
                        "mileage": "Unlimited km",
                        "v_name": "Skoda Scala",
                        "airbags": 1,
                        "doors": "4",
                        "v_id": "724870281",
                        "group": "Compact",
                        "aircon": 1,
                        "cma_compliant": -1,
                        "suitcases": {
                            "small": "0",
                            "big": "0"
                        },
                        "free_cancellation": 1,
                        "fuel_type": "N/A",
                        "label": "Compact car with:",
                        "special_offer_text": "Price includes winterisation fee"
                    },
                    "rating_info": {
                        "location": 9,
                        "average": 8,
                        "cleanliness": 7.1,
                        "pickup_time": 8.4,
                        "dropoff_time": 8.5,
                        "efficiency": 7.7,
                        "average_text": "Excellent",
                        "condition": 8.6,
                        "no_of_ratings": 59,
                        "value_for_money": 8.2
                    },
                    "freebies": [
                        "Amendments"
                    ]
                }
            ],
            "type": "cars",
            "count": 5,
            "search_key": "eyJkcml2ZXJzQWdlIjozMCwiZHJvcE9mZkRhdGVUaW1lIjoiMjAyNC0xMi0xMVQxNzowMDowMCIsImRyb3BPZmZMb2NhdGlvbiI6IjUyLjUxNjIxMiwxMy4zNzY4MTgiLCJkcm9wT2ZmTG9jYXRpb25UeXBlIjoiTEFUTE9ORyIsInBpY2tVcERhdGVUaW1lIjoiMjAyNC0xMi0xMFQwODowMDowMCIsInBpY2tVcExvY2F0aW9uIjoiNTIuNTE2MjEyLDEzLjM3NjgxOCIsInBpY2tVcExvY2F0aW9uVHlwZSI6IkxBVExPTkciLCJyZW50YWxEdXJhdGlvbkluRGF5cyI6Miwic2VydmljZUZlYXR1cmVzIjpbIk5PX09QQVFVRVMiLCJTVVBSRVNTX0ZJWEVEX1BSSUNFX1ZFSElDTEVTIiwiSU5DTFVERV9QUk9EVUNUX1JFTEFUSU9OU0hJUFMiLCJJTkNMVURFX0VYVFJBU19DT05UQUlOSU5HX0ZFRVMiXX0=",
            "content": {
                "items": [
                    {
                        "type": "SHELL_REGION_VIEW",
                        "positionInList": 3,
                        "content": {
                            "contentType": "carsSearchResultsSecondaryPromotional"
                        }
                    }
                ],
                "filters": {
                    "countLabel": "500 results"
                }
            },
            "search_context": {
                "recommendationsSearchUniqueId": "3f6012f9-9716-4d96-9f08-4ba882d7c0ee",
                "searchId": "896d77e3-25f3-4282-b149-8f313ea5dcd8",
                "searchKey": "eyJkcml2ZXJzQWdlIjozMCwiZHJvcE9mZkRhdGVUaW1lIjoiMjAyNC0xMi0xMVQxNzowMDowMCIsImRyb3BPZmZMb2NhdGlvbiI6IjUyLjUxNjIxMiwxMy4zNzY4MTgiLCJkcm9wT2ZmTG9jYXRpb25UeXBlIjoiTEFUTE9ORyIsInBpY2tVcERhdGVUaW1lIjoiMjAyNC0xMi0xMFQwODowMDowMCIsInBpY2tVcExvY2F0aW9uIjoiNTIuNTE2MjEyLDEzLjM3NjgxOCIsInBpY2tVcExvY2F0aW9uVHlwZSI6IkxBVExPTkciLCJyZW50YWxEdXJhdGlvbkluRGF5cyI6Miwic2VydmljZUZlYXR1cmVzIjpbIk5PX09QQVFVRVMiLCJTVVBSRVNTX0ZJWEVEX1BSSUNFX1ZFSElDTEVTIiwiSU5DTFVERV9QUk9EVUNUX1JFTEFUSU9OU0hJUFMiLCJJTkNMVURFX0VYVFJBU19DT05UQUlOSU5HX0ZFRVMiXX0="
            },
            "is_genius_location": true,
            "sort": [
                {
                    "name": "Recommended – best first",
                    "title_tag": "tr.searchresults.sortBy.recommended",
                    "identifier": "recommended"
                },
                {
                    "name": "Price - lowest first",
                    "title_tag": "tr.searchresults.sortBy.price.lowHigh",
                    "identifier": "price_low_to_high"
                },
                {
                    "identifier": "review_score",
                    "name": "Review score - highest first",
                    "title_tag": "tr.searchresults.sortBy.reviews.highLow"
                }
            ]
        }
    }
]

2025-08-25 11:35:03,436 - evaluation_logger_Cross-17 - INFO - Final Response: <｜begin▁of▁sentence｜># 1. 概述

本文，我们来分享 [《精尽 Spring Boot 源码分析 —— SpringApplication》](http://svip.iocoder.cn/Spring-Boot/SpringApplication/) 的**第一篇**文章，我们来一起看看 SpringApplication 的**构建**。

在 Spring Boot 中，我们的应用的启动入口是 `#main(String[] args)` 方法，而该方法中，会调用 `SpringApplication#run(Class<?> primarySource, String... args)` 方法，启动 Spring 应用。代码如下：

```java
// SpringApplication.java

public static ConfigurableApplicationContext run(Class<?> primarySource, String... args) {
	return run(new Class<?>[] { primarySource }, args);
}

public static ConfigurableApplicationContext run(Class<?>[] primarySources, String[] args) {
	return new SpringApplication(primarySources).run(args);
}
```

- 首先，会创建一个 SpringApplication 对象。然后，调用其 `#run(String... args)` 方法。

# 2. SpringApplication 构造方法

`org.springframework.boot.SpringApplication` ，Spring 应用启动器。它的构造方法，主要做初始化的工作。代码如下：

```java
// SpringApplication.java

/**
 * 资源加载器
 */
private ResourceLoader resourceLoader;
/**
 * 主要的 Java Config 类的数组
 */
private Set<Class<?>> primarySources;
/**
 * Web 应用类型
 */
private WebApplicationType webApplicationType;

public SpringApplication(Class<?>... primarySources) {
    this(null, primarySources);
}

public SpringApplication(ResourceLoader resourceLoader, Class<?>... primarySources) {
    this.resourceLoader = resourceLoader;
    Assert.notNull(primarySources, "PrimarySources must not be null");
    this.primarySources = new LinkedHashSet<>(Arrays.asList(primarySources));
    // 判断 Web 应用类型
    this.webApplicationType = WebApplicationType.deduceFromClasspath();
    // 设置初始化器
    setInitializers((Collection) getSpringFactoriesInstances(ApplicationContextInitializer.class));
    // 设置监听器
    setListeners((Collection) getSpringFactoriesInstances(ApplicationListener.class));
    // 推断主类
    this.mainApplicationClass = deduceMainApplicationClass();
}
```

- 构造方法的参数 `primarySources` ，指的是主要的 Java Config 类的数组。绝大多数情况下，我们传入的是 Spring Boot 的主类，即**启动类**。

- `resourceLoader` 属性，资源加载器。默认为 `null` ，可以自定义。

- `webApplicationType` 属性，调用 `WebApplicationType#deduceFromClasspath()` 方法，通过 classpath ，判断 Web 应用类型。详细解析，见 [「2.1 WebApplicationType」](http://svip.iocoder.cn/Spring-Boot/SpringApplication/#) 。

- `setInitializers` 方法，设置初始化器。详细解析，见 [「2.2 初始化器」](http://svip.iocoder.cn/Spring-Boot/SpringApplication/#) 。

- `setListeners` 方法，设置监听器。详细解析，见 [「2.3 监听器」](http://svip.iocoder.cn/Spring-Boot/SpringApplication/#) 。

- `deduceMainApplicationClass` 方法，推断主类。详细解析，见 [「2.4 推断主类」](http://svip.iocoder.cn/Spring-Boot/SpringApplication/#) 。

## 2.1 WebApplicationType

`org.springframework.boot.WebApplicationType` ，Web 应用类型。枚举类，代码如下：

```java
// WebApplicationType.java

public enum WebApplicationType {

    /**
     * 非 Web 项目
     */
    NONE,
    /**
     * 基于 Servlet 的 Web 项目
     */
    SERVLET,
    /**
     * 基于 Reactive 的 Web 项目
     */
    REACTIVE;

}
```

- 一共有三种类型。

`#deduceFromClasspath()` **静态**方法，通过 classpath ，判断 Web 应用类型。代码如下：

```java
// WebApplicationType.java

private static final String[] SERVLET_INDICATOR_CLASSES = { "javax.servlet.Servlet",
        "org.springframework.web.context.ConfigurableWebApplicationContext" };

private static final String WEBMVC_INDICATOR_CLASS = "org.springframework.web.servlet.DispatcherServlet";
private static final String WEBFLUX_INDICATOR_CLASS = "org.springframework.web.reactive.DispatcherHandler";
private static final String JERSEY_INDICATOR_CLASS = "org.glassfish.jersey.servlet.ServletContainer";

static WebApplicationType deduceFromClasspath() {
    // 如果存在 REACTIVE 相关的类，则返回 REACTIVE 类型
    if (ClassUtils.isPresent(WEBFLUX_INDICATOR_CLASS, null) && !ClassUtils.isPresent(WEBMVC_INDICATOR_CLASS, null)
            && !ClassUtils.isPresent(JERSEY_INDICATOR_CLASS, null)) {
        return WebApplicationType.REACTIVE;
    }
    // 如果不存在 SERVLET 相关的类，则返回 NONE 类型
    for (String className : SERVLET_INDICATOR_CLASSES) {
        if (!ClassUtils.isPresent(className, null)) {
            return WebApplicationType.NONE;
        }
    }
    // 否则，返回 SERVLET 类型
    return WebApplicationType.SERVLET;
}
```

- 逻辑比较简单，胖友自己看下注释。

## 2.2 初始化器

`org.springframework.context.ApplicationContextInitializer` ，应用上下文初始化器接口。代码如下：

```java
// ApplicationContextInitializer.java

@FunctionalInterface
public interface ApplicationContextInitializer<C extends ConfigurableApplicationContext> {

    /**
     * Initialize the given application context.
     * @param applicationContext the application to initialize
     */
    void initialize(C applicationContext);

}
```

- 它用于，在 Spring 应用上下文初始化时，做一些初始化的工作。

在 `SpringApplication` 的构造方法中，会读取 `ApplicationContextInitializer` 类型的实现类的数组，设置到 `SpringApplication.initializers` 属性。代码如下：

```java
// SpringApplication.java

/**
 * 应用上下文初始化器集合
 */
private List<ApplicationContextInitializer<?>> initializers;

public void setInitializers(Collection<? extends ApplicationContextInitializer<?>> initializers) {
	this.initializers = new ArrayList<>(initializers);
}
```

那么，`#getSpringFactoriesInstances(Class<T> type)` 方法，是怎么读取到 `ApplicationContextInitializer` 类型的实现类的数组的呢？代码如下：

```java
// SpringApplication.java

private <T> Collection<T> getSpringFactoriesInstances(Class<T> type) {
	return getSpringFactoriesInstances(type, new Class<?>[] {});
}

private <T> Collection<T> getSpringFactoriesInstances(Class<T> type, Class<?>[] parameterTypes, Object... args) {
	ClassLoader classLoader = getClassLoader();
	// Use names and ensure unique to protect against duplicates
	// <1> 加载指定类型对应的，在 `META-INF/spring.factories` 里的类名的数组
	Set<String> names = new LinkedHashSet<>(SpringFactoriesLoader.loadFactoryNames(type, classLoader));
	// <2> 创建对象们
	List<T> instances = createSpringFactoriesInstances(type, parameterTypes, classLoader, args, names);
	// <3> 排序对象们
	AnnotationAwareOrderComparator.sort(instances);
	return instances;
}
```

- `<1>` 处，调用 `SpringFactoriesLoader#loadFactoryNames(Class<?> factoryClass, ClassLoader classLoader)` 方法，加载指定类型对应的，在 `META-INF/spring.factories` 里的类名的数组。

  - 关于 SpringFactoriesLoader 的详细解析，见 [《精尽 Spring Boot 源码分析 —— 应用程序上下文》](http://svip.iocoder.cn/Spring-Boot/ApplicationContext/) 文章。

- `<2>` 处，调用 `#createSpringFactoriesInstances(Class<T> type, Class<?>[] parameterTypes, ClassLoader classLoader, Object[] args, Set<String> names)` 方法，创建对象们。代码如下：

  ```java
  // SpringApplication.java
  
  private <T> List<T> createSpringFactoriesInstances(Class<T> type, Class<?>[] parameterTypes,
  		ClassLoader classLoader, Object[] args, Set<String> names) {
  	List<T> instances = new ArrayList<>(names.size());
  	for (String name : names) {
  		try {
  			Class<?> instanceClass = ClassUtils.forName(name, classLoader);
  			Assert.isAssignable(type, instanceClass);
  			Constructor<?> constructor = instanceClass.getDeclaredConstructor(parameterTypes);
  			T instance = (T) BeanUtils.instantiateClass(constructor, args);
  			instances.add(instance);
  		} catch (Throwable ex) {
  			throw new IllegalArgumentException("Cannot instantiate " + type + " : " + name, ex);
  		}
  	}
  	return instances;
  }
  ```

  - 通过反射，创建对象。

- `<3>` 处，调用 `AnnotationAwareOrderComparator#sort(List<?> list)` 方法，排序对象们。

  - 关于 AnnotationAwareOrderComparator 的详细解析，见 [《精尽 Spring Boot 源码分析 —— 应用程序上下文》](http://svip.iocoder.cn/Spring-Boot/ApplicationContext/) 文章。

- 如此，我们就获得了 `ApplicationContextInitializer` 类型的实现类的数组。

## 2.3 监听器

`org.springframework.context.ApplicationListener` ，应用事件监听器接口。代码如下：

```java
// ApplicationListener.java

@FunctionalInterface
public interface ApplicationListener<E extends ApplicationEvent> extends EventListener {

    /**
     * Handle an application event.
     * @param event the event to respond to
     */
    void onApplicationEvent(E event);

}
```

- 它用于，监听 Spring 应用的事件。

在 `SpringApplication` 的构造方法中，会读取 `ApplicationListener` 类型的实现类的数组，设置到 `SpringApplication.listeners` 属性。代码如下：

```java
// SpringApplication.java

/**
 * 应用事件监听器集合
 */
private List<ApplicationListener<?>> listeners;

public void setListeners(Collection<? extends ApplicationListener<?>> listeners) {
	this.listeners = new ArrayList<>(listeners);
}
```

- 读取的方式，和 [「2.2 初始化器」](http://svip.iocoder.cn/Spring-Boot/SpringApplication/#) 是**一致**的。

## 2.4 推断主类

`#deduceMainApplicationClass()` 方法，推断主类。代码如下：

```java
// SpringApplication.java

/**
 * 主类
 */
private Class<?> mainApplicationClass;

private Class<?> deduceMainApplicationClass() {
    try {
        // 获得当前栈
        StackTraceElement[] stackTrace = new RuntimeException().getStackTrace();
        // 遍历，判断哪个执行 main 方法
        for (StackTraceElement stackTraceElement : stackTrace) {
            if ("main".equals(stackTraceElement.getMethodName())) {
                return Class.forName(stackTraceElement.getClassName());
            }
        }
    } catch (ClassNotFoundException ex) {
        // Swallow and continue
    }
    return null;
}
```

- 通过构造一个 RuntimeException 异常，从而获取当前调用栈。然后，遍历判断哪个栈帧是 `#main(String[] args)` 方法，从而获得主类。

# 3. 小结

至此，我们已经完成了 SpringApplication 对象的构建。整个过程，相对还是蛮简单的。但是，其中涉及到的 `ApplicationContextInitializer` 和 `ApplicationListener` 的概念，胖友可以先去 Google 下，有个简单的了解。

另外，SpringApplication 对象中，还有其它属性，我们会在后续的文章中，随着 `#run(String... args)` 方法的执行，逐步介绍到。

2025-08-25 11:35:10,244 - evaluation_logger_Cross-17 - INFO - Complete Result: {'score': 0, 'reason': "The response does not address any of the requested information in the user's query."}
2025-08-25 11:35:16,831 - evaluation_logger_Cross-17 - INFO - Correct Result: {'score': 0, 'reason': 'All information in the response is incorrect.'}
2025-08-25 11:35:16,831 - evaluation_logger_Cross-17 - INFO - Message: Success.
2025-08-25 11:35:16,831 - evaluation_logger_Cross-17 - INFO - Success turn num = 2
2025-08-25 11:35:16,831 - evaluation_logger_Cross-17 - INFO - ----------------------------------------------------------------------------------------------------
