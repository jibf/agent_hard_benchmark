2025-08-25 11:39:45,366 - evaluation_logger_Cross-69 - INFO - Test Example Cross-69
2025-08-25 11:39:45,367 - evaluation_logger_Cross-69 - INFO - Query: My wife and I want to go from Paris to Barcelona to visit the Sagrada Família on November 20th, 2024. Could you check the fastest flight and the start time of the Sagrada Família tour for that day? If the flight's arrival time doesn't accommodate the tour that day, provide the start time for the tour the following day.
2025-08-25 11:39:56,893 - evaluation_logger_Cross-69 - INFO - Function Calls: 
[
    {
        "name": "Search_Flight_Location",
        "arguments": {
            "query": "Paris"
        }
    },
    {
        "name": "Search_Flight_Location",
        "arguments": {
            "query": "Barcelona"
        }
    },
    {
        "name": "Search_Attraction_Location",
        "arguments": {
            "query": "Sagrada Família"
        }
    }
]

2025-08-25 11:39:56,893 - evaluation_logger_Cross-69 - INFO - Golden Function Call: 
[
    {
        "name": "Search_Flight_Location",
        "arguments": {
            "query": "Paris"
        }
    },
    {
        "name": "Search_Flight_Location",
        "arguments": {
            "query": "Barcelona"
        }
    },
    {
        "name": "Search_Attraction_Location",
        "arguments": {
            "query": "Sagrada Família"
        }
    },
    {
        "name": "Search_Flights",
        "arguments": {
            "fromId": "PAR.CITY",
            "toId": "BCN.AIRPORT",
            "departDate": "2024-11-20",
            "sort": "FASTEST"
        }
    },
    {
        "name": "Get_Availability",
        "arguments": {
            "slug": "prk4trpjocby-skip-the-line-sagrada-familia-tour",
            "date": "2024-11-20"
        }
    }
]

2025-08-25 11:39:56,893 - evaluation_logger_Cross-69 - INFO - Start compare_single_call: 
{'name': 'Search_Flight_Location', 'arguments': {'query': 'Paris'}}
{'name': 'Search_Flight_Location', 'arguments': {'query': 'Paris'}}
2025-08-25 11:39:56,893 - evaluation_logger_Cross-69 - INFO - Rule-based compare success.
2025-08-25 11:39:56,893 - evaluation_logger_Cross-69 - INFO - Start compare_single_call: 
{'name': 'Search_Flight_Location', 'arguments': {'query': 'Barcelona'}}
{'name': 'Search_Flight_Location', 'arguments': {'query': 'Barcelona'}}
2025-08-25 11:39:56,893 - evaluation_logger_Cross-69 - INFO - Rule-based compare success.
2025-08-25 11:39:56,893 - evaluation_logger_Cross-69 - INFO - Start compare_single_call: 
{'name': 'Search_Attraction_Location', 'arguments': {'query': 'Sagrada Família'}}
{'name': 'Search_Attraction_Location', 'arguments': {'query': 'Sagrada Família'}}
2025-08-25 11:39:56,893 - evaluation_logger_Cross-69 - INFO - Rule-based compare success.
2025-08-25 11:39:56,893 - evaluation_logger_Cross-69 - INFO - Success matched: [{'name': 'Search_Flight_Location', 'arguments': {'query': 'Paris'}}, {'name': 'Search_Flight_Location', 'arguments': {'query': 'Barcelona'}}, {'name': 'Search_Attraction_Location', 'arguments': {'query': 'Sagrada Família'}}]
2025-08-25 11:39:56,893 - evaluation_logger_Cross-69 - INFO - Observations:
[
    {
        "status": true,
        "message": "Success",
        "data": [
            {
                "id": "PAR.CITY",
                "type": "CITY",
                "name": "Paris",
                "code": "PAR",
                "regionName": "Ile de France",
                "country": "FR",
                "countryName": "France"
            }
        ]
    },
    {
        "status": true,
        "message": "Success",
        "data": [
            {
                "id": "BCN.AIRPORT",
                "type": "AIRPORT",
                "name": "Barcelona El Prat Airport",
                "code": "BCN",
                "city": "BCN",
                "cityName": "Barcelona",
                "regionName": "Catalonia",
                "country": "ES",
                "countryName": "Spain",
                "countryNameShort": "Spain",
                "distanceToCity": {
                    "value": 12.61649150989104,
                    "unit": "km"
                },
                "parent": "BCN"
            }
        ]
    },
    {
        "status": true,
        "message": "Success",
        "data": {
            "products": [
                {
                    "id": "eyJwaW5uZWRQcm9kdWN0IjoiUFJrNHRSUEpPY2JZIiwidWZpIjotMzcyNDkwfQ==",
                    "__typename": "AttractionsSearchProductSuggestion",
                    "title": "Sagrada Família Guided Tour",
                    "productId": "PRk4tRPJOcbY",
                    "productSlug": "prk4trpjocby-skip-the-line-sagrada-familia-tour",
                    "taxonomySlug": "landmarks",
                    "cityUfi": -372490,
                    "cityName": "Barcelona",
                    "countryCode": "es"
                }
            ]
        }
    }
]

2025-08-25 11:40:07,876 - evaluation_logger_Cross-69 - INFO - Function Calls: 
[
    {
        "name": "Search_Flights",
        "arguments": {
            "fromId": "PAR.CITY",
            "toId": "BCN.AIRPORT",
            "departDate": "2024-11-20",
            "sort": "FASTEST"
        }
    },
    {
        "name": "Get_Availability",
        "arguments": {
            "slug": "prk4trpjocby-skip-the-line-sagrada-familia-tour",
            "date": "2024-11-20"
        }
    }
]

2025-08-25 11:40:07,876 - evaluation_logger_Cross-69 - INFO - Golden Function Call: 
[
    {
        "name": "Search_Flights",
        "arguments": {
            "departDate": "2024-11-20",
            "fromId": "PAR.CITY",
            "sort": "FASTEST",
            "toId": "BCN.AIRPORT"
        }
    },
    {
        "name": "Get_Availability",
        "arguments": {
            "date": "2024-11-20",
            "slug": "prk4trpjocby-skip-the-line-sagrada-familia-tour"
        }
    },
    {
        "name": "Get_Availability",
        "arguments": {
            "slug": "prk4trpjocby-skip-the-line-sagrada-familia-tour",
            "date": "2024-11-21"
        }
    }
]

2025-08-25 11:40:07,876 - evaluation_logger_Cross-69 - INFO - Start compare_single_call: 
{'name': 'Search_Flights', 'arguments': {'departDate': '2024-11-20', 'fromId': 'PAR.CITY', 'sort': 'FASTEST', 'toId': 'BCN.AIRPORT'}}
{'name': 'Search_Flights', 'arguments': {'departDate': '2024-11-20', 'fromId': 'PAR.CITY', 'sort': 'FASTEST', 'toId': 'BCN.AIRPORT'}}
2025-08-25 11:40:07,876 - evaluation_logger_Cross-69 - INFO - Rule-based compare success.
2025-08-25 11:40:07,876 - evaluation_logger_Cross-69 - INFO - Start compare_single_call: 
{'name': 'Get_Availability', 'arguments': {'date': '2024-11-20', 'slug': 'prk4trpjocby-skip-the-line-sagrada-familia-tour'}}
{'name': 'Get_Availability', 'arguments': {'date': '2024-11-20', 'slug': 'prk4trpjocby-skip-the-line-sagrada-familia-tour'}}
2025-08-25 11:40:07,876 - evaluation_logger_Cross-69 - INFO - Rule-based compare success.
2025-08-25 11:40:07,876 - evaluation_logger_Cross-69 - INFO - Success matched: [{'name': 'Search_Flights', 'arguments': {'departDate': '2024-11-20', 'fromId': 'PAR.CITY', 'sort': 'FASTEST', 'toId': 'BCN.AIRPORT'}}, {'name': 'Get_Availability', 'arguments': {'date': '2024-11-20', 'slug': 'prk4trpjocby-skip-the-line-sagrada-familia-tour'}}]
2025-08-25 11:40:07,877 - evaluation_logger_Cross-69 - INFO - Observations:
[
    {
        "status": true,
        "message": "Success",
        "data": {
            "flightOffers": [
                {
                    "token": "d6a1f_H4sIAAAAAAAA_y2QbW-CMBSFf41-o7QUFEyaBUHcMgQjWodfGqiAOGcX6Cb661dhaXvOc09uX9KTlN_tTNfLS12dZKv9tKASUlSZLAAXX3rZKMmF-KyvlZ7Vjb52N3MvMmAUUx3pmhp8lr4UndTahpNxnRcgI5rjOAO2nKDkHxsyAebSnFC63PcRF5KYwDL20YIi6-MwhA1ZJq8HGPTVkaz89hY_dmoFcfxIoeI7hVZAz_N17PMpfWxWYcDh1rt1EXWN0F-gnZ9Ow-3qFvpREnqwe2axO8K-mv2xBVfvAsCcOqivRdYScyAuCYIDHiVJVpge8FBK4jh46O8Iwti2xm1xKbisxfW9uBOa2hBhTf2N-DVMzR0ZHkeNsL8VjLC63q0YVHrqNWPhVlnOHKSMD3ZkyLRLQ1HBcFZyBSUzldYMAQie-87sba_sweyuu-f5H50QsbzBAQAA",
                    "segments": [
                        {
                            "departureAirport": {
                                "type": "AIRPORT",
                                "code": "ORY",
                                "name": "Paris - Orly Airport",
                                "city": "PAR",
                                "cityName": "Paris",
                                "country": "FR",
                                "countryName": "France",
                                "province": "Île de France"
                            },
                            "arrivalAirport": {
                                "type": "AIRPORT",
                                "code": "BCN",
                                "name": "Barcelona El Prat Airport",
                                "city": "BCN",
                                "cityName": "Barcelona",
                                "country": "ES",
                                "countryName": "Spain",
                                "province": "Catalunya"
                            },
                            "departureTime": "2024-11-20T13:05:00",
                            "arrivalTime": "2024-11-20T14:40:00",
                            "legs": [
                                {
                                    "departureTime": "2024-11-20T13:05:00",
                                    "arrivalTime": "2024-11-20T14:40:00",
                                    "departureAirport": {
                                        "type": "AIRPORT",
                                        "code": "ORY",
                                        "name": "Paris - Orly Airport",
                                        "city": "PAR",
                                        "cityName": "Paris",
                                        "country": "FR",
                                        "countryName": "France",
                                        "province": "Île de France"
                                    },
                                    "arrivalAirport": {
                                        "type": "AIRPORT",
                                        "code": "BCN",
                                        "name": "Barcelona El Prat Airport",
                                        "city": "BCN",
                                        "cityName": "Barcelona",
                                        "country": "ES",
                                        "countryName": "Spain",
                                        "province": "Catalunya"
                                    },
                                    "cabinClass": "ECONOMY",
                                    "flightInfo": {
                                        "flightNumber": 8013,
                                        "carrierInfo": {
                                            "operatingCarrier": "VY",
                                            "marketingCarrier": "VY"
                                        }
                                    },
                                    "carriers": [
                                        "VY",
                                        "VY"
                                    ],
                                    "carriersData": [
                                        {
                                            "name": "Vueling",
                                            "code": "VY"
                                        },
                                        {
                                            "name": "Vueling",
                                            "code": "VY"
                                        }
                                    ],
                                    "totalTime": 5700,
                                    "amenities": [
                                        {
                                            "category": "AIRCRAFT",
                                            "model": "A320"
                                        },
                                        {
                                            "category": "FOOD",
                                            "cost": "paid",
                                            "type": "light_meal"
                                        },
                                        {
                                            "category": "POWER",
                                            "cost": "free",
                                            "type": [
                                                "usb_port"
                                            ]
                                        },
                                        {
                                            "category": "WIFI",
                                            "cost": "paid"
                                        }
                                    ]
                                }
                            ],
                            "totalTime": 5700,
                            "isAtolProtected": false,
                            "showWarningDestinationAirport": false,
                            "showWarningOriginAirport": false
                        }
                    ]
                },
                {
                    "token": "d6a1f_H4sIAAAAAAAA_y2QbW-CMBSFf41-o7SUV5NmQVCjQ3FOa9yXBmtFnLML1KH8-lUwvTnnOSe5bdKTUr_VwDSPlyI_qcq4VSCXSuaZEoDLH_NYatlL-V1cczMrSnMZrobRwoKLlJrINPThg92buCujKjnpF3sBMmIEQdBhxcky9F9cEhfYE9uldLJtKy4VsYFjbRcjilyEurIkE-r6s7RNBzKPqzptaJY2U5w2O5g2mweFzpieh8t0NPVos5onYw7XUX1f0NBK4hHaxDsvWc_rJJ6tkwjen1360cOxnvZawTlBANhe0D0qs4p4_ou5Igh2eFDkc47pF-6iIhb2PLcNd4Iw9p1-JS6Cq0Je38WDTIeOBbGh_0f-WbZBe1a0F5es9jX0cKgnZ1DrqdWMJWttexYgbbyzA8Ouh3xNguEge8KR2VoLhgAEz70zm261NczJb5ei_AdrsMd5xQEAAA..",
                    "segments": [
                        {
                            "departureAirport": {
                                "type": "AIRPORT",
                                "code": "ORY",
                                "name": "Paris - Orly Airport",
                                "city": "PAR",
                                "cityName": "Paris",
                                "country": "FR",
                                "countryName": "France",
                                "province": "Île de France"
                            },
                            "arrivalAirport": {
                                "type": "AIRPORT",
                                "code": "BCN",
                                "name": "Barcelona El Prat Airport",
                                "city": "BCN",
                                "cityName": "Barcelona",
                                "country": "ES",
                                "countryName": "Spain",
                                "province": "Catalunya"
                            },
                            "departureTime": "2024-11-20T13:05:00",
                            "arrivalTime": "2024-11-20T14:40:00",
                            "legs": [
                                {
                                    "departureTime": "2024-11-20T13:05:00",
                                    "arrivalTime": "2024-11-20T14:40:00",
                                    "departureAirport": {
                                        "type": "AIRPORT",
                                        "code": "ORY",
                                        "name": "Paris - Orly Airport",
                                        "city": "PAR",
                                        "cityName": "Paris",
                                        "country": "FR",
                                        "countryName": "France",
                                        "province": "Île de France"
                                    },
                                    "arrivalAirport": {
                                        "type": "AIRPORT",
                                        "code": "BCN",
                                        "name": "Barcelona El Prat Airport",
                                        "city": "BCN",
                                        "cityName": "Barcelona",
                                        "country": "ES",
                                        "countryName": "Spain",
                                        "province": "Catalunya"
                                    },
                                    "cabinClass": "ECONOMY",
                                    "flightInfo": {
                                        "flightNumber": 5203,
                                        "carrierInfo": {
                                            "operatingCarrier": "VY",
                                            "marketingCarrier": "IB",
                                            "operatingCarrierDisclosureText": "VY"
                                        }
                                    },
                                    "carriers": [
                                        "IB",
                                        "VY"
                                    ],
                                    "carriersData": [
                                        {
                                            "name": "Iberia",
                                            "code": "IB"
                                        },
                                        {
                                            "name": "Vueling",
                                            "code": "VY"
                                        }
                                    ],
                                    "totalTime": 5700,
                                    "amenities": [
                                        {
                                            "category": "AIRCRAFT",
                                            "model": "A320"
                                        },
                                        {
                                            "category": "FOOD",
                                            "cost": "paid",
                                            "type": "light_meal"
                                        },
                                        {
                                            "category": "POWER",
                                            "cost": "free",
                                            "type": [
                                                "usb_port"
                                            ]
                                        },
                                        {
                                            "category": "WIFI",
                                            "cost": "paid"
                                        }
                                    ]
                                }
                            ],
                            "totalTime": 5700,
                            "isAtolProtected": false,
                            "showWarningDestinationAirport": false,
                            "showWarningOriginAirport": false
                        }
                    ]
                },
                {
                    "token": "d6a1f_H4sIAAAAAAAA_y2Q0W6CMBiFn0bvKC0UEZNmQVGzDK1RrHM3DdSKOGc36BR5-lVY2pzznZP8bdOT1t_VyLaPlyI_6cr6rUCutMpTLYFQX_axNJIp9VlcczstSnsVrseTpQOXlNnItswSo_2LrLVVlYL0i0yClFhBEHRYCYI2_1iSAcBzPGBsvmsroTTBwHN2yylD3nvSlSWZJygcDNt0IIuoutNmimkzo7TZQ9psHwx6M3Yer2gkfNasF_FMwGRyr5csdOJoirbR3o-TxT2OTtt4AutnR8OeG5ndHiuFeRcA2A9Qm1VaEdyR0ATBDg-abBYu-3C7qMnAxx3XBLnu0OtX8iKFLtT1TT5IQrHvQcv8jbo52Jr3nEl2_3bkzUDPNdeHOYdGT62mPFwZy3iAjInODlx4WBqQHDtoaODIsdGCIwDBc-zMX3fGGo6zH6eu_wDhBiwSwAEAAA..",
                    "segments": [
                        {
                            "departureAirport": {
                                "type": "AIRPORT",
                                "code": "ORY",
                                "name": "Paris - Orly Airport",
                                "city": "PAR",
                                "cityName": "Paris",
                                "country": "FR",
                                "countryName": "France",
                                "province": "Île de France"
                            },
                            "arrivalAirport": {
                                "type": "AIRPORT",
                                "code": "BCN",
                                "name": "Barcelona El Prat Airport",
                                "city": "BCN",
                                "cityName": "Barcelona",
                                "country": "ES",
                                "countryName": "Spain",
                                "province": "Catalunya"
                            },
                            "departureTime": "2024-11-20T06:25:00",
                            "arrivalTime": "2024-11-20T08:05:00",
                            "legs": [
                                {
                                    "departureTime": "2024-11-20T06:25:00",
                                    "arrivalTime": "2024-11-20T08:05:00",
                                    "departureAirport": {
                                        "type": "AIRPORT",
                                        "code": "ORY",
                                        "name": "Paris - Orly Airport",
                                        "city": "PAR",
                                        "cityName": "Paris",
                                        "country": "FR",
                                        "countryName": "France",
                                        "province": "Île de France"
                                    },
                                    "arrivalAirport": {
                                        "type": "AIRPORT",
                                        "code": "BCN",
                                        "name": "Barcelona El Prat Airport",
                                        "city": "BCN",
                                        "cityName": "Barcelona",
                                        "country": "ES",
                                        "countryName": "Spain",
                                        "province": "Catalunya"
                                    },
                                    "cabinClass": "ECONOMY",
                                    "flightInfo": {
                                        "flightNumber": 4750,
                                        "carrierInfo": {
                                            "operatingCarrier": "TO",
                                            "marketingCarrier": "TO"
                                        }
                                    },
                                    "carriers": [
                                        "TO",
                                        "TO"
                                    ],
                                    "carriersData": [
                                        {
                                            "name": "Transavia France",
                                            "code": "TO"
                                        },
                                        {
                                            "name": "Transavia France",
                                            "code": "TO"
                                        }
                                    ],
                                    "totalTime": 6000,
                                    "amenities": [
                                        {
                                            "category": "AIRCRAFT",
                                            "model": "737"
                                        },
                                        {
                                            "category": "FOOD",
                                            "cost": "paid",
                                            "type": "light_meal"
                                        },
                                        {
                                            "category": "POWER",
                                            "cost": "free",
                                            "type": [
                                                "usb_port"
                                            ]
                                        }
                                    ]
                                }
                            ],
                            "totalTime": 6000,
                            "isAtolProtected": false,
                            "showWarningDestinationAirport": false,
                            "showWarningOriginAirport": false
                        }
                    ]
                },
                {
                    "token": "d6a1f_H4sIAAAAAAAA_y2Q3W7CIACFn8bdlUIL1i4hi1o1y1oxWjHuhlTEWrfJUtisffphu0DO-c4Jf-Fs7bd59v3TZ1WerfF-DCi11WVhFZD6yz_VTg5af1TX0i-q2l-N15PpMoBLxn3ke27I5_2LaqxnakmfqoMCBfXiOO7RSIo2_1jTIcALPOR8sesqqS3FgAS75Ywjsid9WdPFJp_gdZeONEvMjbUzzNo5Y-0esnZ755DM-WWyYomMeLvO0rmE-fTWLPk4SJMZ2ib7KM2zW5qcs3QKm0fHxoMwcbM7Vkn3LgBwFKMu68JQ3JO0FMEej5ZuspC_h320NCKwX9VQFIYj8mTUp5K20tc3dac5wxEZee5v9G-AvXwQTGUQN1foYBC668elgE7PnRZiu3J2EDFyJns7ChWSkQMlMJIPOAnstBIIQPDYdhGvO2etwMR8fFV_CnyzsMABAAA.",
                    "segments": [
                        {
                            "departureAirport": {
                                "type": "AIRPORT",
                                "code": "ORY",
                                "name": "Paris - Orly Airport",
                                "city": "PAR",
                                "cityName": "Paris",
                                "country": "FR",
                                "countryName": "France",
                                "province": "Île de France"
                            },
                            "arrivalAirport": {
                                "type": "AIRPORT",
                                "code": "BCN",
                                "name": "Barcelona El Prat Airport",
                                "city": "BCN",
                                "cityName": "Barcelona",
                                "country": "ES",
                                "countryName": "Spain",
                                "province": "Catalunya"
                            },
                            "departureTime": "2024-11-20T18:25:00",
                            "arrivalTime": "2024-11-20T20:05:00",
                            "legs": [
                                {
                                    "departureTime": "2024-11-20T18:25:00",
                                    "arrivalTime": "2024-11-20T20:05:00",
                                    "departureAirport": {
                                        "type": "AIRPORT",
                                        "code": "ORY",
                                        "name": "Paris - Orly Airport",
                                        "city": "PAR",
                                        "cityName": "Paris",
                                        "country": "FR",
                                        "countryName": "France",
                                        "province": "Île de France"
                                    },
                                    "arrivalAirport": {
                                        "type": "AIRPORT",
                                        "code": "BCN",
                                        "name": "Barcelona El Prat Airport",
                                        "city": "BCN",
                                        "cityName": "Barcelona",
                                        "country": "ES",
                                        "countryName": "Spain",
                                        "province": "Catalunya"
                                    },
                                    "cabinClass": "ECONOMY",
                                    "flightInfo": {
                                        "flightNumber": 4758,
                                        "carrierInfo": {
                                            "operatingCarrier": "TO",
                                            "marketingCarrier": "TO"
                                        }
                                    },
                                    "carriers": [
                                        "TO",
                                        "TO"
                                    ],
                                    "carriersData": [
                                        {
                                            "name": "Transavia France",
                                            "code": "TO"
                                        },
                                        {
                                            "name": "Transavia France",
                                            "code": "TO"
                                        }
                                    ],
                                    "totalTime": 6000,
                                    "amenities": [
                                        {
                                            "category": "AIRCRAFT",
                                            "model": "737"
                                        },
                                        {
                                            "category": "FOOD",
                                            "cost": "paid",
                                            "type": "light_meal"
                                        },
                                        {
                                            "category": "POWER",
                                            "cost": "free",
                                            "type": [
                                                "usb_port"
                                            ]
                                        }
                                    ]
                                }
                            ],
                            "totalTime": 6000,
                            "isAtolProtected": false,
                            "showWarningDestinationAirport": false,
                            "showWarningOriginAirport": false
                        }
                    ]
                },
                {
                    "token": "d6a1f_H4sIAAAAAAAA_y2Qa2-CMBSGf41-o7RcREyaBUV0G4LxUoNfCNaCqFs36Cb663eEpe37Puc96SU9KfVVj3Q9v5bFSdXaT40KqWSRKYG4_NDzCuQg5aX8LPSsrPSltxpPIgNHMdOJrsHgo-RFNEqrK0775UGgjGqu63ZYc0rW_1jRAbJm1oCx2a6NuFTUQraxi6aM2InRhRWdred7HLTVkS78-hY_trCCOH4kGPjOsB2w83gZ-9xhj9UiDDjeTG5NxDwj9Kdk6ydOuFncQn81Dye4eWax1zN9mO2xgsO7ELIcl7S1zGpqdcQVJbjDo6Lrhcn2ZlcqOiRG12ooMc2h3a_FVXBVys93cacsGWLiavA38tewtE3PmHCHZI0A6JlwvVekGPTUapYS_AZ-SF0Cxjs7QkrMDEik5iEfAOSpBVqmBGH03HhOX3dgj9QRl-8c_wGxzedjwgEAAA..",
                    "segments": [
                        {
                            "departureAirport": {
                                "type": "AIRPORT",
                                "code": "ORY",
                                "name": "Paris - Orly Airport",
                                "city": "PAR",
                                "cityName": "Paris",
                                "country": "FR",
                                "countryName": "France",
                                "province": "Île de France"
                            },
                            "arrivalAirport": {
                                "type": "AIRPORT",
                                "code": "BCN",
                                "name": "Barcelona El Prat Airport",
                                "city": "BCN",
                                "cityName": "Barcelona",
                                "country": "ES",
                                "countryName": "Spain",
                                "province": "Catalunya"
                            },
                            "departureTime": "2024-11-20T21:55:00",
                            "arrivalTime": "2024-11-20T23:35:00",
                            "legs": [
                                {
                                    "departureTime": "2024-11-20T21:55:00",
                                    "arrivalTime": "2024-11-20T23:35:00",
                                    "departureAirport": {
                                        "type": "AIRPORT",
                                        "code": "ORY",
                                        "name": "Paris - Orly Airport",
                                        "city": "PAR",
                                        "cityName": "Paris",
                                        "country": "FR",
                                        "countryName": "France",
                                        "province": "Île de France"
                                    },
                                    "arrivalAirport": {
                                        "type": "AIRPORT",
                                        "code": "BCN",
                                        "name": "Barcelona El Prat Airport",
                                        "city": "BCN",
                                        "cityName": "Barcelona",
                                        "country": "ES",
                                        "countryName": "Spain",
                                        "province": "Catalunya"
                                    },
                                    "cabinClass": "ECONOMY",
                                    "flightInfo": {
                                        "flightNumber": 8019,
                                        "carrierInfo": {
                                            "operatingCarrier": "VY",
                                            "marketingCarrier": "VY"
                                        }
                                    },
                                    "carriers": [
                                        "VY",
                                        "VY"
                                    ],
                                    "carriersData": [
                                        {
                                            "name": "Vueling",
                                            "code": "VY"
                                        },
                                        {
                                            "name": "Vueling",
                                            "code": "VY"
                                        }
                                    ],
                                    "totalTime": 6000,
                                    "amenities": [
                                        {
                                            "category": "AIRCRAFT",
                                            "model": "A320"
                                        },
                                        {
                                            "category": "FOOD",
                                            "cost": "paid",
                                            "type": "light_meal"
                                        },
                                        {
                                            "category": "POWER",
                                            "cost": "free",
                                            "type": [
                                                "usb_port"
                                            ]
                                        },
                                        {
                                            "category": "WIFI",
                                            "cost": "paid"
                                        }
                                    ]
                                }
                            ],
                            "totalTime": 6000,
                            "isAtolProtected": false,
                            "showWarningDestinationAirport": false,
                            "showWarningOriginAirport": false
                        }
                    ]
                }
            ],
            "flightDeals": [
                {
                    "key": "CHEAPEST",
                    "offerToken": "d6a1f_H4sIAAAAAAAA_y2Q3W6CMACFn0bvKG0pIibNoqBmG4oRrWE3DdSKOGcX6Cby9KuwtD3nOyfpT3rW-rue2PbpWhZnXVs_NSiUVkWmJRDqyz5VRnKlPstbYWdlZW-m21mwxnAdMxvZlhlikr7IRlt1JeiwzCXIqOX7fo-1oCj5x4qOAFmSEWPLQ1cJpSkBLj6s5wy5adCXFV0mydzZdelIV2F9j9u9WYs4blNo-MGgu2CX2SYOhcfa7SpaCLgL7s2aTXEUztE-TL1ot7pHYdpGAWyeXTwdOKGZ3bFSmHcBQDwfdVllNSU9CU0R7PGoabJy2IfTR01HxMUdNxQ5ztgd1vIqhS7V7V0-KEvHmCDL_I36xcSKBzgQrpeNMwMDx1w_LTg0eu404wi-Gc-5j4yJ3o48PwpiQHJHkiec-FNLjgAEz30X_now1nIP5a7Af2mU-UfBAQAA",
                    "price": {
                        "currencyCode": "USD",
                        "units": 64,
                        "nanos": 520000000
                    },
                    "travellerPrices": [
                        {
                            "travellerPriceBreakdown": {
                                "total": {
                                    "currencyCode": "USD",
                                    "units": 64,
                                    "nanos": 520000000
                                },
                                "baseFare": {
                                    "currencyCode": "USD",
                                    "units": 48,
                                    "nanos": 580000000
                                },
                                "fee": {
                                    "currencyCode": "USD",
                                    "units": 15,
                                    "nanos": 940000000
                                },
                                "tax": {
                                    "currencyCode": "USD",
                                    "units": 0,
                                    "nanos": 0
                                },
                                "totalRounded": {
                                    "currencyCode": "USD",
                                    "nanos": 0,
                                    "units": 65
                                },
                                "discount": {
                                    "currencyCode": "USD",
                                    "units": 0,
                                    "nanos": 0
                                },
                                "totalWithoutDiscount": {
                                    "currencyCode": "USD",
                                    "units": 64,
                                    "nanos": 520000000
                                },
                                "totalWithoutDiscountRounded": {
                                    "currencyCode": "USD",
                                    "nanos": 0,
                                    "units": 65
                                }
                            },
                            "travellerReference": "1",
                            "travellerType": "ADULT"
                        }
                    ]
                },
                {
                    "key": "FASTEST",
                    "offerToken": "d6a1f_H4sIAAAAAAAA_y2QbW-CMBSFf41-o7QUFEyaBUHcMgQjWodfGqiAOGcX6Cb661dhaXvOc09uX9KTlN_tTNfLS12dZKv9tKASUlSZLAAXX3rZKMmF-KyvlZ7Vjb52N3MvMmAUUx3pmhp8lr4UndTahpNxnRcgI5rjOAO2nKDkHxsyAebSnFC63PcRF5KYwDL20YIi6-MwhA1ZJq8HGPTVkaz89hY_dmoFcfxIoeI7hVZAz_N17PMpfWxWYcDh1rt1EXWN0F-gnZ9Ow-3qFvpREnqwe2axO8K-mv2xBVfvAsCcOqivRdYScyAuCYIDHiVJVpge8FBK4jh46O8Iwti2xm1xKbisxfW9uBOa2hBhTf2N-DVMzR0ZHkeNsL8VjLC63q0YVHrqNWPhVlnOHKSMD3ZkyLRLQ1HBcFZyBSUzldYMAQie-87sba_sweyuu-f5H50QsbzBAQAA",
                    "price": {
                        "currencyCode": "USD",
                        "units": 99,
                        "nanos": 310000000
                    },
                    "travellerPrices": [
                        {
                            "travellerPriceBreakdown": {
                                "total": {
                                    "currencyCode": "USD",
                                    "units": 99,
                                    "nanos": 310000000
                                },
                                "baseFare": {
                                    "currencyCode": "USD",
                                    "units": 84,
                                    "nanos": 210000000
                                },
                                "fee": {
                                    "currencyCode": "USD",
                                    "units": 15,
                                    "nanos": 100000000
                                },
                                "tax": {
                                    "currencyCode": "USD",
                                    "units": 0,
                                    "nanos": 0
                                },
                                "totalRounded": {
                                    "currencyCode": "USD",
                                    "nanos": 0,
                                    "units": 100
                                },
                                "discount": {
                                    "currencyCode": "USD",
                                    "units": 0,
                                    "nanos": 0
                                },
                                "totalWithoutDiscount": {
                                    "currencyCode": "USD",
                                    "units": 99,
                                    "nanos": 310000000
                                },
                                "totalWithoutDiscountRounded": {
                                    "currencyCode": "USD",
                                    "nanos": 0,
                                    "units": 100
                                }
                            },
                            "travellerReference": "1",
                            "travellerType": "ADULT"
                        }
                    ]
                },
                {
                    "key": "BEST",
                    "offerToken": "d6a1f_H4sIAAAAAAAA_y2Q0W6CMBiFn0bvKC0UEZNmQVGzDK1RrHM3DdSKOGc36BR5-lVY2pzznZP8bdOT1t_VyLaPlyI_6cr6rUCutMpTLYFQX_axNJIp9VlcczstSnsVrseTpQOXlNnItswSo_2LrLVVlYL0i0yClFhBEHRYCYI2_1iSAcBzPGBsvmsroTTBwHN2yylD3nvSlSWZJygcDNt0IIuoutNmimkzo7TZQ9psHwx6M3Yer2gkfNasF_FMwGRyr5csdOJoirbR3o-TxT2OTtt4AutnR8OeG5ndHiuFeRcA2A9Qm1VaEdyR0ATBDg-abBYu-3C7qMnAxx3XBLnu0OtX8iKFLtT1TT5IQrHvQcv8jbo52Jr3nEl2_3bkzUDPNdeHOYdGT62mPFwZy3iAjInODlx4WBqQHDtoaODIsdGCIwDBc-zMX3fGGo6zH6eu_wDhBiwSwAEAAA..",
                    "price": {
                        "currencyCode": "USD",
                        "units": 67,
                        "nanos": 430000000
                    },
                    "travellerPrices": [
                        {
                            "travellerPriceBreakdown": {
                                "total": {
                                    "currencyCode": "USD",
                                    "units": 67,
                                    "nanos": 430000000
                                },
                                "baseFare": {
                                    "currencyCode": "USD",
                                    "units": 14,
                                    "nanos": 700000000
                                },
                                "fee": {
                                    "currencyCode": "USD",
                                    "units": 16,
                                    "nanos": 920000000
                                },
                                "tax": {
                                    "currencyCode": "USD",
                                    "units": 35,
                                    "nanos": 810000000
                                },
                                "totalRounded": {
                                    "currencyCode": "USD",
                                    "nanos": 0,
                                    "units": 68
                                },
                                "discount": {
                                    "currencyCode": "USD",
                                    "units": 0,
                                    "nanos": 0
                                },
                                "totalWithoutDiscount": {
                                    "currencyCode": "USD",
                                    "units": 67,
                                    "nanos": 430000000
                                },
                                "totalWithoutDiscountRounded": {
                                    "currencyCode": "USD",
                                    "nanos": 0,
                                    "units": 68
                                }
                            },
                            "travellerReference": "1",
                            "travellerType": "ADULT"
                        }
                    ]
                }
            ],
            "atolProtectedStatus": "NONE",
            "searchId": "D257C3CAEBE80A40B0B95F3F7D56619C",
            "displayOptions": {
                "brandedFaresShownByDefault": false,
                "directFlightsOnlyFilterIgnored": false,
                "hideFlexiblePricesBanner": false
            },
            "isOffersCabinClassExtended": false,
            "cabinClassExtension": {
                "text": "Some results may combine Economy with other options, as we couldn’t completely match your search."
            },
            "searchCriteria": {
                "cabinClass": "ECONOMY"
            }
        }
    },
    {
        "status": true,
        "message": "Success",
        "data": [
            {
                "__typename": "AttractionTimeSlot",
                "fullDay": false,
                "start": "2024-11-20T09:00:00+01:00",
                "timeSlotId": "TSso2mpP5Zy8",
                "timeSlotOffers": [
                    {
                        "__typename": "AttractionTimeSlotOffer",
                        "benefits": {
                            "__typename": "Benefits"
                        },
                        "id": "OFDanbP1zove",
                        "items": [
                            {
                                "__typename": "AttractionTimeSlotOfferItem",
                                "cancellationPolicy": {
                                    "__typename": "AttractionsCancellationPolicy",
                                    "comparedTo": "start",
                                    "hasFreeCancellation": true,
                                    "isStillRefundable": true,
                                    "percentage": 100,
                                    "period": "P1D"
                                },
                                "constraint": {
                                    "__typename": "Constraint",
                                    "label": "(age 12+)"
                                },
                                "id": "TOn2VDQYbEFT",
                                "offerItemId": "OIExVDvGXEvw",
                                "type": "adult",
                                "tieredPricing": false,
                                "price": {
                                    "__typename": "AttractionsPrice",
                                    "chargeAmount": 99,
                                    "currency": "EUR",
                                    "publicAmount": 99
                                },
                                "convertedPrice": {
                                    "__typename": "AttractionsPrice",
                                    "chargeAmount": 106.67,
                                    "currency": "USD",
                                    "publicAmount": 106.67
                                },
                                "ticketsAvailable": 10000,
                                "maxPerReservation": 10,
                                "minPerReservation": 1,
                                "label": "Adult"
                            },
                            {
                                "__typename": "AttractionTimeSlotOfferItem",
                                "cancellationPolicy": {
                                    "__typename": "AttractionsCancellationPolicy",
                                    "comparedTo": "start",
                                    "hasFreeCancellation": true,
                                    "isStillRefundable": true,
                                    "percentage": 100,
                                    "period": "P1D"
                                },
                                "constraint": {
                                    "__typename": "Constraint",
                                    "label": "(age 3-11)"
                                },
                                "id": "TOIwxbOPznQx",
                                "offerItemId": "OIBKC4azbE8G",
                                "type": "children",
                                "tieredPricing": false,
                                "price": {
                                    "__typename": "AttractionsPrice",
                                    "chargeAmount": 89.1,
                                    "currency": "EUR",
                                    "publicAmount": 89.1
                                },
                                "convertedPrice": {
                                    "__typename": "AttractionsPrice",
                                    "chargeAmount": 96.01,
                                    "currency": "USD",
                                    "publicAmount": 96.01
                                },
                                "ticketsAvailable": 10000,
                                "maxPerReservation": 10,
                                "minPerReservation": 1,
                                "label": "Child"
                            },
                            {
                                "__typename": "AttractionTimeSlotOfferItem",
                                "cancellationPolicy": {
                                    "__typename": "AttractionsCancellationPolicy",
                                    "comparedTo": "start",
                                    "hasFreeCancellation": true,
                                    "isStillRefundable": true,
                                    "percentage": 100,
                                    "period": "P1D"
                                },
                                "constraint": {
                                    "__typename": "Constraint",
                                    "label": "(age 0-2)"
                                },
                                "id": "TOdpJRMEc702",
                                "offerItemId": "OIShABCwGw49",
                                "type": "infant",
                                "tieredPricing": false,
                                "price": {
                                    "__typename": "AttractionsPrice",
                                    "chargeAmount": 0,
                                    "currency": "EUR",
                                    "publicAmount": 0
                                },
                                "convertedPrice": {
                                    "__typename": "AttractionsPrice",
                                    "chargeAmount": 0,
                                    "currency": "USD",
                                    "publicAmount": 0
                                },
                                "ticketsAvailable": 10000,
                                "maxPerReservation": 10,
                                "minPerReservation": 1,
                                "label": "Infant"
                            }
                        ],
                        "label": "Tour in English",
                        "reservationRestrictions": {
                            "__typename": "ReservationRestrictions",
                            "adultRequiredForReservation": true,
                            "minOfferItemsPerReservation": 0
                        },
                        "typicalDuration": {
                            "__typename": "Value",
                            "label": "Duration: 1 hour 30 minutes",
                            "value": "PT1H30M"
                        }
                    }
                ]
            },
            {
                "__typename": "AttractionTimeSlot",
                "fullDay": false,
                "start": "2024-11-20T09:30:00+01:00",
                "timeSlotId": "TSQm5ijzBGDw",
                "timeSlotOffers": [
                    {
                        "__typename": "AttractionTimeSlotOffer",
                        "benefits": {
                            "__typename": "Benefits"
                        },
                        "id": "OFDanbP1zove",
                        "items": [
                            {
                                "__typename": "AttractionTimeSlotOfferItem",
                                "cancellationPolicy": {
                                    "__typename": "AttractionsCancellationPolicy",
                                    "comparedTo": "start",
                                    "hasFreeCancellation": true,
                                    "isStillRefundable": true,
                                    "percentage": 100,
                                    "period": "P1D"
                                },
                                "constraint": {
                                    "__typename": "Constraint",
                                    "label": "(age 12+)"
                                },
                                "id": "TOYPuyvdjXGM",
                                "offerItemId": "OIExVDvGXEvw",
                                "type": "adult",
                                "tieredPricing": false,
                                "price": {
                                    "__typename": "AttractionsPrice",
                                    "chargeAmount": 99,
                                    "currency": "EUR",
                                    "publicAmount": 99
                                },
                                "convertedPrice": {
                                    "__typename": "AttractionsPrice",
                                    "chargeAmount": 106.67,
                                    "currency": "USD",
                                    "publicAmount": 106.67
                                },
                                "ticketsAvailable": 10000,
                                "maxPerReservation": 10,
                                "minPerReservation": 1,
                                "label": "Adult"
                            },
                            {
                                "__typename": "AttractionTimeSlotOfferItem",
                                "cancellationPolicy": {
                                    "__typename": "AttractionsCancellationPolicy",
                                    "comparedTo": "start",
                                    "hasFreeCancellation": true,
                                    "isStillRefundable": true,
                                    "percentage": 100,
                                    "period": "P1D"
                                },
                                "constraint": {
                                    "__typename": "Constraint",
                                    "label": "(age 3-11)"
                                },
                                "id": "TOv8O3qQdkL6",
                                "offerItemId": "OIBKC4azbE8G",
                                "type": "children",
                                "tieredPricing": false,
                                "price": {
                                    "__typename": "AttractionsPrice",
                                    "chargeAmount": 89.1,
                                    "currency": "EUR",
                                    "publicAmount": 89.1
                                },
                                "convertedPrice": {
                                    "__typename": "AttractionsPrice",
                                    "chargeAmount": 96.01,
                                    "currency": "USD",
                                    "publicAmount": 96.01
                                },
                                "ticketsAvailable": 10000,
                                "maxPerReservation": 10,
                                "minPerReservation": 1,
                                "label": "Child"
                            },
                            {
                                "__typename": "AttractionTimeSlotOfferItem",
                                "cancellationPolicy": {
                                    "__typename": "AttractionsCancellationPolicy",
                                    "comparedTo": "start",
                                    "hasFreeCancellation": true,
                                    "isStillRefundable": true,
                                    "percentage": 100,
                                    "period": "P1D"
                                },
                                "constraint": {
                                    "__typename": "Constraint",
                                    "label": "(age 0-2)"
                                },
                                "id": "TOcqSeB0L4w4",
                                "offerItemId": "OIShABCwGw49",
                                "type": "infant",
                                "tieredPricing": false,
                                "price": {
                                    "__typename": "AttractionsPrice",
                                    "chargeAmount": 0,
                                    "currency": "EUR",
                                    "publicAmount": 0
                                },
                                "convertedPrice": {
                                    "__typename": "AttractionsPrice",
                                    "chargeAmount": 0,
                                    "currency": "USD",
                                    "publicAmount": 0
                                },
                                "ticketsAvailable": 10000,
                                "maxPerReservation": 10,
                                "minPerReservation": 1,
                                "label": "Infant"
                            }
                        ],
                        "label": "Tour in English",
                        "reservationRestrictions": {
                            "__typename": "ReservationRestrictions",
                            "adultRequiredForReservation": true,
                            "minOfferItemsPerReservation": 0
                        },
                        "typicalDuration": {
                            "__typename": "Value",
                            "label": "Duration: 1 hour 30 minutes",
                            "value": "PT1H30M"
                        }
                    },
                    {
                        "__typename": "AttractionTimeSlotOffer",
                        "benefits": {
                            "__typename": "Benefits"
                        },
                        "id": "OFcDs4fVSWrf",
                        "items": [
                            {
                                "__typename": "AttractionTimeSlotOfferItem",
                                "cancellationPolicy": {
                                    "__typename": "AttractionsCancellationPolicy",
                                    "comparedTo": "start",
                                    "hasFreeCancellation": true,
                                    "isStillRefundable": true,
                                    "percentage": 100,
                                    "period": "P1D"
                                },
                                "constraint": {
                                    "__typename": "Constraint",
                                    "label": "(age 12+)"
                                },
                                "id": "TORl9xVOliuv",
                                "offerItemId": "OIaD8uGoUbyz",
                                "type": "adult",
                                "tieredPricing": false,
                                "price": {
                                    "__typename": "AttractionsPrice",
                                    "chargeAmount": 99,
                                    "currency": "EUR",
                                    "publicAmount": 99
                                },
                                "convertedPrice": {
                                    "__typename": "AttractionsPrice",
                                    "chargeAmount": 106.67,
                                    "currency": "USD",
                                    "publicAmount": 106.67
                                },
                                "ticketsAvailable": 10000,
                                "maxPerReservation": 10,
                                "minPerReservation": 1,
                                "label": "Adult"
                            },
                            {
                                "__typename": "AttractionTimeSlotOfferItem",
                                "cancellationPolicy": {
                                    "__typename": "AttractionsCancellationPolicy",
                                    "comparedTo": "start",
                                    "hasFreeCancellation": true,
                                    "isStillRefundable": true,
                                    "percentage": 100,
                                    "period": "P1D"
                                },
                                "constraint": {
                                    "__typename": "Constraint",
                                    "label": "(age 3-11)"
                                },
                                "id": "TOj8m4mN9bN8",
                                "offerItemId": "OIsMW3UoVQEk",
                                "type": "children",
                                "tieredPricing": false,
                                "price": {
                                    "__typename": "AttractionsPrice",
                                    "chargeAmount": 89.1,
                                    "currency": "EUR",
                                    "publicAmount": 89.1
                                },
                                "convertedPrice": {
                                    "__typename": "AttractionsPrice",
                                    "chargeAmount": 96.01,
                                    "currency": "USD",
                                    "publicAmount": 96.01
                                },
                                "ticketsAvailable": 10000,
                                "maxPerReservation": 10,
                                "minPerReservation": 1,
                                "label": "Child"
                            },
                            {
                                "__typename": "AttractionTimeSlotOfferItem",
                                "cancellationPolicy": {
                                    "__typename": "AttractionsCancellationPolicy",
                                    "comparedTo": "start",
                                    "hasFreeCancellation": true,
                                    "isStillRefundable": true,
                                    "percentage": 100,
                                    "period": "P1D"
                                },
                                "constraint": {
                                    "__typename": "Constraint",
                                    "label": "(age 0-2)"
                                },
                                "id": "TORrVXmo8Pf1",
                                "offerItemId": "OI84pAdHN4jj",
                                "type": "infant",
                                "tieredPricing": false,
                                "price": {
                                    "__typename": "AttractionsPrice",
                                    "chargeAmount": 0,
                                    "currency": "EUR",
                                    "publicAmount": 0
                                },
                                "convertedPrice": {
                                    "__typename": "AttractionsPrice",
                                    "chargeAmount": 0,
                                    "currency": "USD",
                                    "publicAmount": 0
                                },
                                "ticketsAvailable": 10000,
                                "maxPerReservation": 10,
                                "minPerReservation": 1,
                                "label": "Infant"
                            }
                        ],
                        "label": "Bilingual tour",
                        "reservationRestrictions": {
                            "__typename": "ReservationRestrictions",
                            "adultRequiredForReservation": true,
                            "minOfferItemsPerReservation": 0
                        },
                        "typicalDuration": {
                            "__typename": "Value",
                            "label": "Duration: 1 hour 30 minutes",
                            "value": "PT1H30M"
                        }
                    }
                ]
            }
        ]
    }
]

2025-08-25 11:40:20,846 - evaluation_logger_Cross-69 - INFO - Function Calls: 
[
    {
        "name": "Get_Availability",
        "arguments": {
            "slug": "prk4trpjocby-skip-the-line-sagrada-familia-tour",
            "date": "2024-11-21"
        }
    }
]

2025-08-25 11:40:20,846 - evaluation_logger_Cross-69 - INFO - Golden Function Call: 
[
    {
        "name": "Get_Availability",
        "arguments": {
            "date": "2024-11-21",
            "slug": "prk4trpjocby-skip-the-line-sagrada-familia-tour"
        }
    }
]

2025-08-25 11:40:20,846 - evaluation_logger_Cross-69 - INFO - Start compare_single_call: 
{'name': 'Get_Availability', 'arguments': {'date': '2024-11-21', 'slug': 'prk4trpjocby-skip-the-line-sagrada-familia-tour'}}
{'name': 'Get_Availability', 'arguments': {'date': '2024-11-21', 'slug': 'prk4trpjocby-skip-the-line-sagrada-familia-tour'}}
2025-08-25 11:40:20,846 - evaluation_logger_Cross-69 - INFO - Rule-based compare success.
2025-08-25 11:40:20,846 - evaluation_logger_Cross-69 - INFO - Success matched: [{'name': 'Get_Availability', 'arguments': {'date': '2024-11-21', 'slug': 'prk4trpjocby-skip-the-line-sagrada-familia-tour'}}]
2025-08-25 11:40:20,846 - evaluation_logger_Cross-69 - INFO - Observations:
[
    {
        "status": true,
        "message": "Success",
        "data": [
            {
                "__typename": "AttractionTimeSlot",
                "fullDay": false,
                "start": "2024-11-21T09:00:00+01:00",
                "timeSlotId": "TSvf3B7Fn3E8",
                "timeSlotOffers": [
                    {
                        "__typename": "AttractionTimeSlotOffer",
                        "benefits": {
                            "__typename": "Benefits"
                        },
                        "id": "OFDanbP1zove",
                        "items": [
                            {
                                "__typename": "AttractionTimeSlotOfferItem",
                                "cancellationPolicy": {
                                    "__typename": "AttractionsCancellationPolicy",
                                    "comparedTo": "start",
                                    "hasFreeCancellation": true,
                                    "isStillRefundable": true,
                                    "percentage": 100,
                                    "period": "P1D"
                                },
                                "constraint": {
                                    "__typename": "Constraint",
                                    "label": "(age 12+)"
                                },
                                "id": "TO1Xyz63c94W",
                                "offerItemId": "OIExVDvGXEvw",
                                "type": "adult",
                                "tieredPricing": false,
                                "price": {
                                    "__typename": "AttractionsPrice",
                                    "chargeAmount": 99,
                                    "currency": "EUR",
                                    "publicAmount": 99
                                },
                                "convertedPrice": {
                                    "__typename": "AttractionsPrice",
                                    "chargeAmount": 107.23,
                                    "currency": "USD",
                                    "publicAmount": 107.23
                                },
                                "ticketsAvailable": 10000,
                                "maxPerReservation": 10,
                                "minPerReservation": 1,
                                "label": "Adult"
                            },
                            {
                                "__typename": "AttractionTimeSlotOfferItem",
                                "cancellationPolicy": {
                                    "__typename": "AttractionsCancellationPolicy",
                                    "comparedTo": "start",
                                    "hasFreeCancellation": true,
                                    "isStillRefundable": true,
                                    "percentage": 100,
                                    "period": "P1D"
                                },
                                "constraint": {
                                    "__typename": "Constraint",
                                    "label": "(age 3-11)"
                                },
                                "id": "TOzjoTML8rim",
                                "offerItemId": "OIBKC4azbE8G",
                                "type": "children",
                                "tieredPricing": false,
                                "price": {
                                    "__typename": "AttractionsPrice",
                                    "chargeAmount": 89.1,
                                    "currency": "EUR",
                                    "publicAmount": 89.1
                                },
                                "convertedPrice": {
                                    "__typename": "AttractionsPrice",
                                    "chargeAmount": 96.51,
                                    "currency": "USD",
                                    "publicAmount": 96.51
                                },
                                "ticketsAvailable": 10000,
                                "maxPerReservation": 10,
                                "minPerReservation": 1,
                                "label": "Child"
                            },
                            {
                                "__typename": "AttractionTimeSlotOfferItem",
                                "cancellationPolicy": {
                                    "__typename": "AttractionsCancellationPolicy",
                                    "comparedTo": "start",
                                    "hasFreeCancellation": true,
                                    "isStillRefundable": true,
                                    "percentage": 100,
                                    "period": "P1D"
                                },
                                "constraint": {
                                    "__typename": "Constraint",
                                    "label": "(age 0-2)"
                                },
                                "id": "TOP3Ulr0NO5r",
                                "offerItemId": "OIShABCwGw49",
                                "type": "infant",
                                "tieredPricing": false,
                                "price": {
                                    "__typename": "AttractionsPrice",
                                    "chargeAmount": 0,
                                    "currency": "EUR",
                                    "publicAmount": 0
                                },
                                "convertedPrice": {
                                    "__typename": "AttractionsPrice",
                                    "chargeAmount": 0,
                                    "currency": "USD",
                                    "publicAmount": 0
                                },
                                "ticketsAvailable": 10000,
                                "maxPerReservation": 10,
                                "minPerReservation": 1,
                                "label": "Infant"
                            }
                        ],
                        "label": "Tour in English",
                        "reservationRestrictions": {
                            "__typename": "ReservationRestrictions",
                            "adultRequiredForReservation": true,
                            "minOfferItemsPerReservation": 0
                        },
                        "typicalDuration": {
                            "__typename": "Value",
                            "label": "Duration: 1 hour 30 minutes",
                            "value": "PT1H30M"
                        }
                    }
                ]
            },
            {
                "__typename": "AttractionTimeSlot",
                "fullDay": false,
                "start": "2024-11-21T09:30:00+01:00",
                "timeSlotId": "TSHtkIXWt9l7",
                "timeSlotOffers": [
                    {
                        "__typename": "AttractionTimeSlotOffer",
                        "benefits": {
                            "__typename": "Benefits"
                        },
                        "id": "OFcDs4fVSWrf",
                        "items": [
                            {
                                "__typename": "AttractionTimeSlotOfferItem",
                                "cancellationPolicy": {
                                    "__typename": "AttractionsCancellationPolicy",
                                    "comparedTo": "start",
                                    "hasFreeCancellation": true,
                                    "isStillRefundable": true,
                                    "percentage": 100,
                                    "period": "P1D"
                                },
                                "constraint": {
                                    "__typename": "Constraint",
                                    "label": "(age 12+)"
                                },
                                "id": "TOq5TYZMtqHQ",
                                "offerItemId": "OIaD8uGoUbyz",
                                "type": "adult",
                                "tieredPricing": false,
                                "price": {
                                    "__typename": "AttractionsPrice",
                                    "chargeAmount": 99,
                                    "currency": "EUR",
                                    "publicAmount": 99
                                },
                                "convertedPrice": {
                                    "__typename": "AttractionsPrice",
                                    "chargeAmount": 107.23,
                                    "currency": "USD",
                                    "publicAmount": 107.23
                                },
                                "ticketsAvailable": 10000,
                                "maxPerReservation": 8,
                                "minPerReservation": 1,
                                "label": "Adult"
                            },
                            {
                                "__typename": "AttractionTimeSlotOfferItem",
                                "cancellationPolicy": {
                                    "__typename": "AttractionsCancellationPolicy",
                                    "comparedTo": "start",
                                    "hasFreeCancellation": true,
                                    "isStillRefundable": true,
                                    "percentage": 100,
                                    "period": "P1D"
                                },
                                "constraint": {
                                    "__typename": "Constraint",
                                    "label": "(age 3-11)"
                                },
                                "id": "TOFPPGd6sB3e",
                                "offerItemId": "OIsMW3UoVQEk",
                                "type": "children",
                                "tieredPricing": false,
                                "price": {
                                    "__typename": "AttractionsPrice",
                                    "chargeAmount": 89.1,
                                    "currency": "EUR",
                                    "publicAmount": 89.1
                                },
                                "convertedPrice": {
                                    "__typename": "AttractionsPrice",
                                    "chargeAmount": 96.51,
                                    "currency": "USD",
                                    "publicAmount": 96.51
                                },
                                "ticketsAvailable": 10000,
                                "maxPerReservation": 8,
                                "minPerReservation": 1,
                                "label": "Child"
                            },
                            {
                                "__typename": "AttractionTimeSlotOfferItem",
                                "cancellationPolicy": {
                                    "__typename": "AttractionsCancellationPolicy",
                                    "comparedTo": "start",
                                    "hasFreeCancellation": true,
                                    "isStillRefundable": true,
                                    "percentage": 100,
                                    "period": "P1D"
                                },
                                "constraint": {
                                    "__typename": "Constraint",
                                    "label": "(age 0-2)"
                                },
                                "id": "TOHAUezEzaOr",
                                "offerItemId": "OI84pAdHN4jj",
                                "type": "infant",
                                "tieredPricing": false,
                                "price": {
                                    "__typename": "AttractionsPrice",
                                    "chargeAmount": 0,
                                    "currency": "EUR",
                                    "publicAmount": 0
                                },
                                "convertedPrice": {
                                    "__typename": "AttractionsPrice",
                                    "chargeAmount": 0,
                                    "currency": "USD",
                                    "publicAmount": 0
                                },
                                "ticketsAvailable": 10000,
                                "maxPerReservation": 8,
                                "minPerReservation": 1,
                                "label": "Infant"
                            }
                        ],
                        "label": "Bilingual tour",
                        "reservationRestrictions": {
                            "__typename": "ReservationRestrictions",
                            "adultRequiredForReservation": true,
                            "minOfferItemsPerReservation": 0
                        },
                        "typicalDuration": {
                            "__typename": "Value",
                            "label": "Duration: 1 hour 30 minutes",
                            "value": "PT1H30M"
                        }
                    },
                    {
                        "__typename": "AttractionTimeSlotOffer",
                        "benefits": {
                            "__typename": "Benefits"
                        },
                        "id": "OFDanbP1zove",
                        "items": [
                            {
                                "__typename": "AttractionTimeSlotOfferItem",
                                "cancellationPolicy": {
                                    "__typename": "AttractionsCancellationPolicy",
                                    "comparedTo": "start",
                                    "hasFreeCancellation": true,
                                    "isStillRefundable": true,
                                    "percentage": 100,
                                    "period": "P1D"
                                },
                                "constraint": {
                                    "__typename": "Constraint",
                                    "label": "(age 12+)"
                                },
                                "id": "TOAEVuKCl7Ud",
                                "offerItemId": "OIExVDvGXEvw",
                                "type": "adult",
                                "tieredPricing": false,
                                "price": {
                                    "__typename": "AttractionsPrice",
                                    "chargeAmount": 99,
                                    "currency": "EUR",
                                    "publicAmount": 99
                                },
                                "convertedPrice": {
                                    "__typename": "AttractionsPrice",
                                    "chargeAmount": 107.23,
                                    "currency": "USD",
                                    "publicAmount": 107.23
                                },
                                "ticketsAvailable": 10000,
                                "maxPerReservation": 9,
                                "minPerReservation": 1,
                                "label": "Adult"
                            },
                            {
                                "__typename": "AttractionTimeSlotOfferItem",
                                "cancellationPolicy": {
                                    "__typename": "AttractionsCancellationPolicy",
                                    "comparedTo": "start",
                                    "hasFreeCancellation": true,
                                    "isStillRefundable": true,
                                    "percentage": 100,
                                    "period": "P1D"
                                },
                                "constraint": {
                                    "__typename": "Constraint",
                                    "label": "(age 3-11)"
                                },
                                "id": "TOc2vxBPWrr7",
                                "offerItemId": "OIBKC4azbE8G",
                                "type": "children",
                                "tieredPricing": false,
                                "price": {
                                    "__typename": "AttractionsPrice",
                                    "chargeAmount": 89.1,
                                    "currency": "EUR",
                                    "publicAmount": 89.1
                                },
                                "convertedPrice": {
                                    "__typename": "AttractionsPrice",
                                    "chargeAmount": 96.51,
                                    "currency": "USD",
                                    "publicAmount": 96.51
                                },
                                "ticketsAvailable": 10000,
                                "maxPerReservation": 9,
                                "minPerReservation": 1,
                                "label": "Child"
                            },
                            {
                                "__typename": "AttractionTimeSlotOfferItem",
                                "cancellationPolicy": {
                                    "__typename": "AttractionsCancellationPolicy",
                                    "comparedTo": "start",
                                    "hasFreeCancellation": true,
                                    "isStillRefundable": true,
                                    "percentage": 100,
                                    "period": "P1D"
                                },
                                "constraint": {
                                    "__typename": "Constraint",
                                    "label": "(age 0-2)"
                                },
                                "id": "TO81ZPxfjnaX",
                                "offerItemId": "OIShABCwGw49",
                                "type": "infant",
                                "tieredPricing": false,
                                "price": {
                                    "__typename": "AttractionsPrice",
                                    "chargeAmount": 0,
                                    "currency": "EUR",
                                    "publicAmount": 0
                                },
                                "convertedPrice": {
                                    "__typename": "AttractionsPrice",
                                    "chargeAmount": 0,
                                    "currency": "USD",
                                    "publicAmount": 0
                                },
                                "ticketsAvailable": 10000,
                                "maxPerReservation": 9,
                                "minPerReservation": 1,
                                "label": "Infant"
                            }
                        ],
                        "label": "Tour in English",
                        "reservationRestrictions": {
                            "__typename": "ReservationRestrictions",
                            "adultRequiredForReservation": true,
                            "minOfferItemsPerReservation": 0
                        },
                        "typicalDuration": {
                            "__typename": "Value",
                            "label": "Duration: 1 hour 30 minutes",
                            "value": "PT1H30M"
                        }
                    }
                ]
            },
            {
                "__typename": "AttractionTimeSlot",
                "fullDay": false,
                "start": "2024-11-21T15:30:00+01:00",
                "timeSlotId": "TSgENuKJcD5T",
                "timeSlotOffers": [
                    {
                        "__typename": "AttractionTimeSlotOffer",
                        "benefits": {
                            "__typename": "Benefits"
                        },
                        "id": "OFDanbP1zove",
                        "items": [
                            {
                                "__typename": "AttractionTimeSlotOfferItem",
                                "cancellationPolicy": {
                                    "__typename": "AttractionsCancellationPolicy",
                                    "comparedTo": "start",
                                    "hasFreeCancellation": true,
                                    "isStillRefundable": true,
                                    "percentage": 100,
                                    "period": "P1D"
                                },
                                "constraint": {
                                    "__typename": "Constraint",
                                    "label": "(age 12+)"
                                },
                                "id": "TOPMbf6Sodhj",
                                "offerItemId": "OIExVDvGXEvw",
                                "type": "adult",
                                "tieredPricing": false,
                                "price": {
                                    "__typename": "AttractionsPrice",
                                    "chargeAmount": 99,
                                    "currency": "EUR",
                                    "publicAmount": 99
                                },
                                "convertedPrice": {
                                    "__typename": "AttractionsPrice",
                                    "chargeAmount": 107.23,
                                    "currency": "USD",
                                    "publicAmount": 107.23
                                },
                                "ticketsAvailable": 10000,
                                "maxPerReservation": 10,
                                "minPerReservation": 1,
                                "label": "Adult"
                            },
                            {
                                "__typename": "AttractionTimeSlotOfferItem",
                                "cancellationPolicy": {
                                    "__typename": "AttractionsCancellationPolicy",
                                    "comparedTo": "start",
                                    "hasFreeCancellation": true,
                                    "isStillRefundable": true,
                                    "percentage": 100,
                                    "period": "P1D"
                                },
                                "constraint": {
                                    "__typename": "Constraint",
                                    "label": "(age 3-11)"
                                },
                                "id": "TOyBQOsRvVia",
                                "offerItemId": "OIBKC4azbE8G",
                                "type": "children",
                                "tieredPricing": false,
                                "price": {
                                    "__typename": "AttractionsPrice",
                                    "chargeAmount": 89.1,
                                    "currency": "EUR",
                                    "publicAmount": 89.1
                                },
                                "convertedPrice": {
                                    "__typename": "AttractionsPrice",
                                    "chargeAmount": 96.51,
                                    "currency": "USD",
                                    "publicAmount": 96.51
                                },
                                "ticketsAvailable": 10000,
                                "maxPerReservation": 10,
                                "minPerReservation": 1,
                                "label": "Child"
                            },
                            {
                                "__typename": "AttractionTimeSlotOfferItem",
                                "cancellationPolicy": {
                                    "__typename": "AttractionsCancellationPolicy",
                                    "comparedTo": "start",
                                    "hasFreeCancellation": true,
                                    "isStillRefundable": true,
                                    "percentage": 100,
                                    "period": "P1D"
                                },
                                "constraint": {
                                    "__typename": "Constraint",
                                    "label": "(age 0-2)"
                                },
                                "id": "TOkE1oEmjXKq",
                                "offerItemId": "OIShABCwGw49",
                                "type": "infant",
                                "tieredPricing": false,
                                "price": {
                                    "__typename": "AttractionsPrice",
                                    "chargeAmount": 0,
                                    "currency": "EUR",
                                    "publicAmount": 0
                                },
                                "convertedPrice": {
                                    "__typename": "AttractionsPrice",
                                    "chargeAmount": 0,
                                    "currency": "USD",
                                    "publicAmount": 0
                                },
                                "ticketsAvailable": 10000,
                                "maxPerReservation": 10,
                                "minPerReservation": 1,
                                "label": "Infant"
                            }
                        ],
                        "label": "Tour in English",
                        "reservationRestrictions": {
                            "__typename": "ReservationRestrictions",
                            "adultRequiredForReservation": true,
                            "minOfferItemsPerReservation": 0
                        },
                        "typicalDuration": {
                            "__typename": "Value",
                            "label": "Duration: 1 hour 30 minutes",
                            "value": "PT1H30M"
                        }
                    },
                    {
                        "__typename": "AttractionTimeSlotOffer",
                        "benefits": {
                            "__typename": "Benefits"
                        },
                        "id": "OFcDs4fVSWrf",
                        "items": [
                            {
                                "__typename": "AttractionTimeSlotOfferItem",
                                "cancellationPolicy": {
                                    "__typename": "AttractionsCancellationPolicy",
                                    "comparedTo": "start",
                                    "hasFreeCancellation": true,
                                    "isStillRefundable": true,
                                    "percentage": 100,
                                    "period": "P1D"
                                },
                                "constraint": {
                                    "__typename": "Constraint",
                                    "label": "(age 12+)"
                                },
                                "id": "TOLomfpdXZdu",
                                "offerItemId": "OIaD8uGoUbyz",
                                "type": "adult",
                                "tieredPricing": false,
                                "price": {
                                    "__typename": "AttractionsPrice",
                                    "chargeAmount": 99,
                                    "currency": "EUR",
                                    "publicAmount": 99
                                },
                                "convertedPrice": {
                                    "__typename": "AttractionsPrice",
                                    "chargeAmount": 107.23,
                                    "currency": "USD",
                                    "publicAmount": 107.23
                                },
                                "ticketsAvailable": 10000,
                                "maxPerReservation": 10,
                                "minPerReservation": 1,
                                "label": "Adult"
                            },
                            {
                                "__typename": "AttractionTimeSlotOfferItem",
                                "cancellationPolicy": {
                                    "__typename": "AttractionsCancellationPolicy",
                                    "comparedTo": "start",
                                    "hasFreeCancellation": true,
                                    "isStillRefundable": true,
                                    "percentage": 100,
                                    "period": "P1D"
                                },
                                "constraint": {
                                    "__typename": "Constraint",
                                    "label": "(age 3-11)"
                                },
                                "id": "TOTei6mb9tAM",
                                "offerItemId": "OIsMW3UoVQEk",
                                "type": "children",
                                "tieredPricing": false,
                                "price": {
                                    "__typename": "AttractionsPrice",
                                    "chargeAmount": 89.1,
                                    "currency": "EUR",
                                    "publicAmount": 89.1
                                },
                                "convertedPrice": {
                                    "__typename": "AttractionsPrice",
                                    "chargeAmount": 96.51,
                                    "currency": "USD",
                                    "publicAmount": 96.51
                                },
                                "ticketsAvailable": 10000,
                                "maxPerReservation": 10,
                                "minPerReservation": 1,
                                "label": "Child"
                            },
                            {
                                "__typename": "AttractionTimeSlotOfferItem",
                                "cancellationPolicy": {
                                    "__typename": "AttractionsCancellationPolicy",
                                    "comparedTo": "start",
                                    "hasFreeCancellation": true,
                                    "isStillRefundable": true,
                                    "percentage": 100,
                                    "period": "P1D"
                                },
                                "constraint": {
                                    "__typename": "Constraint",
                                    "label": "(age 0-2)"
                                },
                                "id": "TOBSAT8leZbM",
                                "offerItemId": "OI84pAdHN4jj",
                                "type": "infant",
                                "tieredPricing": false,
                                "price": {
                                    "__typename": "AttractionsPrice",
                                    "chargeAmount": 0,
                                    "currency": "EUR",
                                    "publicAmount": 0
                                },
                                "convertedPrice": {
                                    "__typename": "AttractionsPrice",
                                    "chargeAmount": 0,
                                    "currency": "USD",
                                    "publicAmount": 0
                                },
                                "ticketsAvailable": 10000,
                                "maxPerReservation": 10,
                                "minPerReservation": 1,
                                "label": "Infant"
                            }
                        ],
                        "label": "Bilingual tour",
                        "reservationRestrictions": {
                            "__typename": "ReservationRestrictions",
                            "adultRequiredForReservation": true,
                            "minOfferItemsPerReservation": 0
                        },
                        "typicalDuration": {
                            "__typename": "Value",
                            "label": "Duration: 1 hour 30 minutes",
                            "value": "PT1H30M"
                        }
                    }
                ]
            }
        ]
    }
]

2025-08-25 11:43:25,842 - evaluation_logger_Cross-69 - INFO - Final Response: <｜begin▁of▁sentence｜># 1. 概述

本文，我们来分享 MyBatis 的日志模块，对应 `logging` 包。如下图所示：[![`logging` 包](http://static.iocoder.cn/images/MyBatis/2020_01_31/01.png)](http://static.iocoder.cn/images/MyBatis/2020_01_31/01.png)`logging` 包

在 [《精尽 MyBatis 源码解析 —— 项目结构一览》](http://svip.iocoder.cn/MyBatis/intro) 中，简单介绍了这个模块如下：

> 无论在开发测试环境中，还是在线上生产环境中，日志在整个系统中的地位都是非常重要的。良好的日志功能可以帮助开发人员和测试人员快速定位 Bug 代码，也可以帮助运维人员快速定位性能瓶颈等问题。目前的 Java 世界中存在很多优秀的日志框架，例如 Log4j、 Log4j2、Slf4j 等。
>
> MyBatis 作为一个设计优良的框架，除了提供详细的日志输出信息，还要能够集成多种日志框架，其日志模块的一个主要功能就是**集成第三方日志框架**。

本文涉及的类如下图所示：![类图](http://static.iocoder.cn/images/MyBatis/2020_01_31/02.png)

- 从图的**上面**部分，我们可以看到，MyBatis 直接提供了多种日志框架的实现，然后由对应的日志适配器进行集成。
- 从图的**下面**部分，我们可以看到，MyBatis 自身又对多种日志框架进行适配。

下面，让我们开始干源码吧。

# 2. LogFactory

`org.apache.ibatis.logging.LogFactory` ，Log 工厂类。

## 2.1 构造方法

```java
// LogFactory.java

/**
 * Marker to be used by logging implementations that support markers
 */
public static final String MARKER = "MYBATIS";

/**
 * 使用的 Log 的构造方法
 */
private static Constructor<? extends Log> logConstructor;

static {
    // <1> 尝试依次初始化 logConstructor 对象，使用哪个日志框架
    tryImplementation(LogFactory::useSlf4jLogging);
    tryImplementation(LogFactory::useCommonsLogging);
    tryImplementation(LogFactory::useLog4J2Logging);
    tryImplementation(LogFactory::useLog4JLogging);
    tryImplementation(LogFactory::useJdkLogging);
    tryImplementation(LogFactory::useNoLogging);
}
```

- `logConstructor` 静态属性，使用的 Log 的构造方法。在 `static` 静态代码块中，会尝试依次初始化 `logConstructor` 对象，使用哪个日志框架。也就是说，`logConstructor` 静态属性，最终会指向使用的日志框架的 Log 类的构造方法。
- `#tryImplementation(Runnable runnable)` 方法，尝试初始化 `logConstructor` 对象。若已经初始化成功，则不再处理。代码如下：

  ```java
  // LogFactory.java
  
  private static void tryImplementation(Runnable runnable) {
      if (logConstructor == null) {
          try {
              runnable.run();
          } catch (Throwable t) {
              // ignore
          }
      }
  }
  ```

- `#useSlf4jLogging()` 等方法，尝试使用相应的日志框架。代码如下：

  ```java
  // LogFactory.java
  
  public static synchronized void useSlf4jLogging() {
      setImplementation(org.apache.ibatis.logging.slf4j.Slf4jImpl.class);
  }
  
  public static synchronized void useCommonsLogging() {
      setImplementation(org.apache.ibatis.logging.commons.JakartaCommonsLoggingImpl.class);
  }
  
  public static synchronized void useLog4JLogging() {
      setImplementation(org.apache.ibatis.logging.log4j.Log4jImpl.class);
  }
  
  public static synchronized void useLog4J2Logging() {
      setImplementation(org.apache.ibatis.logging.log4j2.Log4j2Impl.class);
  }
  
  public static synchronized void useJdkLogging() {
      setImplementation(org.apache.ibatis.logging.jdk14.Jdk14LoggingImpl.class);
  }
  
  public static synchronized void useStdOutLogging() {
      setImplementation(org.apache.ibatis.logging.stdout.StdOutImpl.class);
  }
  
  public static synchronized void useNoLogging() {
      setImplementation(org.apache.ibatis.logging.nologging.NoLoggingImpl.class);
  }
  ```

  - 都是调用 `#setImplementation(Class<? extends Log> implClass)` 方法，设置 `logConstructor` 为指定类的构造方法。代码如下：

    ```java
    // LogFactory.java
    
    private static void setImplementation(Class<? extends Log> implClass) {
        try {
            // 获得参数为 String 的构造方法
            Constructor<? extends Log> candidate = implClass.getConstructor(String.class);
            // 创建 Log 对象
            Log log = candidate.newInstance(LogFactory.class.getName());
            if (log.isDebugEnabled()) {
                log.debug("Logging initialized using '" + implClass + "' adapter.");
            }
            // 设置 logConstructor
            logConstructor = candidate;
        } catch (Throwable t) {
            throw new LogException("Error setting Log implementation.  Cause: " + t, t);
        }
    }
    ```

    - 通过这样的方式，就能创建指定类的 Log 对象。

## 2.2 getLog

`#getLog(...)` 方法，获得 Log 对象。代码如下：

```java
// LogFactory.java

public static Log getLog(Class<?> aClass) {
    return getLog(aClass.getName());
}

public static Log getLog(String logger) {
    try {
        return logConstructor.newInstance(logger);
    } catch (Throwable t) {
        throw new LogException("Error creating logger for logger " + logger + ".  Cause: " + t, t);
    }
}
```

- 通过 `logConstructor` 反射生成 Log 对象。

## 2.3 小结

LogFactory 负责**自动扫描**日志实现，并且**实例化**对应的日志适配器。有没有感受到“**工厂方法**”设计模式的味道？

# 3. Log

`org.apache.ibatis.logging.Log` ，MyBatis Log 接口。代码如下：

```java
// Log.java

public interface Log {

    boolean isDebugEnabled();

    boolean isTraceEnabled();

    void error(String s, Throwable e);

    void error(String s);

    void debug(String s);

    void trace(String s);

    void warn(String s);

}
```

- 定义了日志的接口。

## 3.1 Log 的实现类

Log 的实现类，有多个，如下图所示：![Log 的实现类](http://static.iocoder.cn/images/MyBatis/2020_01_31/03.png)

- 每个实现类，代码都非常简单，都是调用其**集成**的日志框架的对应方法。以 Log4jImpl 举例子。代码如下：

  ```java
  // Log4jImpl.java
  
  public class Log4jImpl implements Log {
  
      private static final String FQCN = Log4jImpl.class.getName();
  
      // 真正的日志记录器
      private final Logger log;
  
      public Log4jImpl(String clazz) {
          log = Logger.getLogger(clazz);
      }
  
      @Override
      public boolean isDebugEnabled() {
          return log.isDebugEnabled();
      }
  
      @Override
      public boolean isTraceEnabled() {
          return log.isTraceEnabled();
      }
  
      @Override
      public void error(String s, Throwable e) {
          log.log(FQCN, Level.ERROR, s, e);
      }
  
      @Override
      public void error(String s) {
          log.log(FQCN, Level.ERROR, s, null);
      }
  
      @Override
      public void debug(String s) {
          log.log(FQCN, Level.DEBUG, s, null);
      }
  
      @Override
      public void trace(String s) {
          log.log(FQCN, Level.TRACE, s, null);
      }
  
      @Override
      public void warn(String s) {
          log.log(FQCN, Level.WARN, s, null);
      }
  
  }
  ```

  - 在构造方法中，获得**真正的**日志记录器 `log` 。而后，每个方法，都是调用 `log` 的对应的方法。

- 其它实现类，就不详细解析，胖友自己瞅瞅。

# 4. JDBC 日志

在 `logging` 包的下方，还有 `jdbc` 包，将 JDBC 的操作，记录成日志。所以，它**不是**一个日志框架，而是将 JDBC 的操作，记录成日志。而记录日志的方式，就是通过上述的 Log 接口。

## 4.1 BaseJdbcLogger

`org.apache.ibatis.logging.jdbc.BaseJdbcLogger` ，是所有 JDBC Logger 的基类。

### 4.1.1 构造方法

```java
// BaseJdbcLogger.java

/**
 * 常用的 Set 的方法的集合
 */
protected static final Set<String> SET_METHODS = new HashSet<>();
/**
 * 执行 SQL 的方法的集合
 */
protected static final Set<String> EXECUTE_METHODS = new HashSet<>();

/**
 * 记录 PreparedStatement 的参数
 */
private final Map<Object, Object> columnMap = new HashMap<>();

/**
 * 记录的参数
 */
private final List<Object> columnNames = new ArrayList<>();
private final List<Object> columnValues = new ArrayList<>();

/**
 * Log 对象
 */
protected final Log statementLog;

/**
 * 查询的阈值
 */
protected final int queryStack;

static {
    SET_METHODS.add("setString");
    SET_METHODS.add("setNull");
    SET_METHODS.add("setInt");
    SET_METHODS.add("setByte");
    SET_METHODS.add("setShort");
    SET_METHODS.add("setLong");
    SET_METHODS.add("setDouble");
    SET_METHODS.add("setFloat");
    SET_METHODS.add("setTimestamp");
    SET_METHODS.add("setDate");
    SET_METHODS.add("setTime");
    SET_METHODS.add("setArray");
    SET_METHODS.add("setBigDecimal");
    SET_METHODS.add("setAsciiStream");
    SET_METHODS.add("setBinaryStream");
    SET_METHODS.add("setBlob");
    SET_METHODS.add("setBoolean");
    SET_METHODS.add("setBytes");
    SET_METHODS.add("setCharacterStream");
    SET_METHODS.add("setClob");
    SET_METHODS.add("setObject");
    SET_METHODS.add("setRef");
    SET_METHODS.add("setURL");
}

static {
    EXECUTE_METHODS.add("execute");
    EXECUTE_METHODS.add("executeUpdate");
    EXECUTE_METHODS.add("executeQuery");
    EXECUTE_METHODS.add("addBatch");
}
```

- 每个变量，看其上的注释。

### 4.1.2 核心方法

```java
// BaseJdbcLogger.java

protected void setColumn(Object key, Object value) {
    columnMap.put(key, value);
    columnNames.add(key);
    columnValues.add(value);
}

protected Object getColumn(Object key) {
    return columnMap.get(key);
}
```

- 设置和获得参数。

## 4.2 ConnectionLogger

`org.apache.ibatis.logging.jdbc.ConnectionLogger` ，继承 BaseJdbcLogger 类，Connection 的日志实现。

### 4.2.1 构造方法

```java
// ConnectionLogger.java

/**
 * 真正的 Connection 对象
 */
private final Connection connection;

private ConnectionLogger(Connection conn, Log statementLog, int queryStack) {
    super(statementLog, queryStack);
    this.connection = conn;
}
```

### 4.2.2 newInstance

```java
// ConnectionLogger.java

public static Connection newInstance(Connection conn, Log statementLog, int queryStack) {
    // 创建 ConnectionLogger 对象，并创建动态代理
    InvocationHandler handler = new ConnectionLogger(conn, statementLog, queryStack);
    ClassLoader cl = Connection.class.getClassLoader();
    return (Connection) Proxy.newProxyInstance(cl, new Class[]{Connection.class}, handler);
}
```

- 通过动态代理，对 Connection 所有的方法，进行日志的打印。

### 4.2.3 invoke

```java
// ConnectionLogger.java

@Override
public Object invoke(Object proxy, Method method, Object[] params)
        throws Throwable {
    try {
        // 如果调用的是 Object 的方法，则直接调用，不进行代理
        if (Object.class.equals(method.getDeclaringClass())) {
            return method.invoke(this, params);
        }
        // 如果调用的是 prepareStatement 方法，则打印日志，并创建 PreparedStatementLogger 代理对象
        if ("prepareStatement".equals(method.getName())) {
            if (isDebugEnabled()) {
                debug(" Preparing: " + removeBreakingWhitespace((String) params[0]), true);
            }
            PreparedStatement stmt = (PreparedStatement) method.invoke(connection, params);
            stmt = PreparedStatementLogger.newInstance(stmt, statementLog, queryStack);
            return stmt;
        // 如果调用的是 prepareCall 方法，则打印日志，并创建 PreparedStatementLogger 代理对象
        } else if ("prepareCall".equals(method.getName())) {
            if (isDebugEnabled()) {
                debug(" Preparing: " + removeBreakingWhitespace((String) params[0]), true);
            }
            PreparedStatement stmt = (PreparedStatement) method.invoke(connection, params);
            stmt = PreparedStatementLogger.newInstance(stmt, statementLog, queryStack);
            return stmt;
        // 如果调用的是 createStatement 方法，则创建 StatementLogger 代理对象
        } else if ("createStatement".equals(method.getName())) {
            Statement stmt = (Statement) method.invoke(connection, params);
            stmt = StatementLogger.newInstance(stmt, statementLog, queryStack);
            return stmt;
        } else {
            // 其它方法，则直接调用
            return method.invoke(connection, params);
        }
    } catch (Throwable t) {
        throw ExceptionUtil.unwrapThrowable(t);
    }
}
```

- 根据不同的方法，进行不同的日志打印，或者创建代理对象。

## 4.3 PreparedStatementLogger

`org.apache.ibatis.logging.jdbc.PreparedStatementLogger` ，继承 BaseJdbcLogger 类，PreparedStatement 的日志实现。

### 4.3.1 构造方法

```java
// PreparedStatementLogger.java

/**
 * 真正的 PreparedStatement 对象
 */
private final PreparedStatement statement;

private PreparedStatementLogger(PreparedStatement stmt, Log statementLog, int queryStack) {
    super(statementLog, queryStack);
    this.statement = stmt;
}
```

### 4.3.2 newInstance

```java
// PreparedStatementLogger.java

public static PreparedStatement newInstance(PreparedStatement stmt, Log statementLog, int queryStack) {
    // 创建 PreparedStatementLogger 对象，并创建动态代理
    InvocationHandler handler = new PreparedStatementLogger(stmt, statementLog, queryStack);
    ClassLoader cl = PreparedStatement.class.getClassLoader();
    return (PreparedStatement) Proxy.newProxyInstance(cl, new Class[]{PreparedStatement.class}, handler);
}
```

- 通过动态代理，对 PreparedStatement 所有的方法，进行日志的打印。

### 4.3.3 invoke

```java
// PreparedStatementLogger.java

@Override
public Object invoke(Object proxy, Method method, Object[] params) throws Throwable {
    try {
        // 如果调用的是 Object 的方法，则直接调用，不进行代理
        if (Object.class.equals(method.getDeclaringClass())) {
            return method.invoke(this, params);
        }
        // 如果调用的是 execute 系列方法，则打印日志
        if (EXECUTE_METHODS.contains(method.getName())) {
            if (isDebugEnabled()) {
                debug("Parameters: " + getParameterValueString(), true);
            }
            // 清除 columnMap、columnNames、columnValues
            clearColumnInfo();
            // 执行方法
            if ("executeQuery".equals(method.getName())) {
                ResultSet rs = (ResultSet) method.invoke(statement, params);
                return rs == null ? null : ResultSetLogger.newInstance(rs, statementLog, queryStack);
            } else {
                return method.invoke(statement, params);
            }
        // 如果调用的是 set 系列方法，则设置参数
        } else if (SET_METHODS.contains(method.getName())) {
            if ("setNull".equals(method.getName())) {
                setColumn(params[0], null);
            } else {
                setColumn(params[0], params[1]);
            }
            return method.invoke(statement, params);
        // 如果调用的是 get 系列方法，则直接调用
        } else if ("getResultSet".equals(method.getName())) {
            ResultSet rs = (ResultSet) method.invoke(statement, params);
            return rs == null ? null : ResultSetLogger.newInstance(rs, statementLog, queryStack);
        } else if ("getUpdateCount".equals(method.getName())) {
            int updateCount = (Integer) method.invoke(statement, params);
            if (updateCount != -1) {
                debug("   Updates: " + updateCount, false);
            }
            return updateCount;
        } else {
            return method.invoke(statement, params);
        }
    } catch (Throwable t) {
        throw ExceptionUtil.unwrapThrowable(t);
    }
}
```

- 根据不同的方法，进行不同的日志打印，或者创建代理对象。

## 4.4 StatementLogger

`org.apache.ibatis.logging.jdbc.StatementLogger` ，继承 BaseJdbcLogger 类，Statement 的日志实现。

### 4.4.1 构造方法

```java
// StatementLogger.java

/**
 * 真正的 Statement 对象
 */
private final Statement statement;

private StatementLogger(Statement stmt, Log statementLog, int queryStack) {
    super(statementLog, queryStack);
    this.statement = stmt;
}
```

### 4.4.2 newInstance

```java
// StatementLogger.java

public static Statement newInstance(Statement stmt, Log statementLog, int queryStack) {
    // 创建 StatementLogger 对象，并创建动态代理
    InvocationHandler handler = new StatementLogger(stmt, statementLog, queryStack);
    ClassLoader cl = Statement.class.getClassLoader();
    return (Statement) Proxy.newProxyInstance(cl, new Class[]{Statement.class}, handler);
}
```

- 通过动态

2025-08-25 11:43:34,292 - evaluation_logger_Cross-69 - INFO - Complete Result: {'score': 0, 'reason': "The response does not address any of the requested information in the user's query."}
2025-08-25 11:43:40,904 - evaluation_logger_Cross-69 - INFO - Correct Result: {'score': 0, 'reason': 'All information in the response is incorrect.'}
2025-08-25 11:43:40,904 - evaluation_logger_Cross-69 - INFO - Message: Success.
2025-08-25 11:43:40,904 - evaluation_logger_Cross-69 - INFO - Success turn num = 3
2025-08-25 11:43:40,904 - evaluation_logger_Cross-69 - INFO - ----------------------------------------------------------------------------------------------------
