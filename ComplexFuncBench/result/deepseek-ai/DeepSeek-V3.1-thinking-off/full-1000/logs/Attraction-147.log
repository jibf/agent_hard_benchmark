2025-08-25 13:14:08,796 - evaluation_logger_Attraction-147 - INFO - Test Example Attraction-147
2025-08-25 13:14:08,796 - evaluation_logger_Attraction-147 - INFO - Query: I am in South Africa and interested in penguins. Check for penguin activities in Cape Town with available tickets after 9 PM on November 13, 2024. If not, check Port Elizabeth for tickets before 4 AM on November 18. I'd like to know the detailed activity information.
2025-08-25 13:14:17,765 - evaluation_logger_Attraction-147 - INFO - Function Calls: 
[
    {
        "name": "Search_Attraction_Location",
        "arguments": {
            "query": "penguins, Cape Town"
        }
    }
]

2025-08-25 13:14:17,765 - evaluation_logger_Attraction-147 - INFO - Golden Function Call: 
[
    {
        "name": "Search_Attraction_Location",
        "arguments": {
            "query": "Penguin, Cape Town"
        }
    },
    {
        "name": "Get_Availability",
        "arguments": {
            "slug": "prpui9c6nwei-cape-town-private-cape-point-penguin-tour",
            "date": "2024-11-13"
        }
    }
]

2025-08-25 13:14:18,422 - evaluation_logger_Attraction-147 - INFO - Start compare_single_call: 
{'name': 'Search_Attraction_Location', 'arguments': {'query': 'penguins, Cape Town'}}
{'name': 'Search_Attraction_Location', 'arguments': {'query': 'Penguin, Cape Town'}}
2025-08-25 13:14:26,382 - evaluation_logger_Attraction-147 - DEBUG - LLM-based comparison output: {'is_equal': True, 'reason': "The queries 'penguins, Cape Town' and 'Penguin, Cape Town' are equivalent because they refer to the same concept of penguin-related activities in Cape Town. The difference in capitalization and singular/plural form does not change the meaning in this context."}
2025-08-25 13:14:26,382 - evaluation_logger_Attraction-147 - INFO - LLM-based compare success.
2025-08-25 13:14:26,382 - evaluation_logger_Attraction-147 - INFO - Success matched: [{'name': 'Search_Attraction_Location', 'arguments': {'query': 'Penguin, Cape Town'}}]
2025-08-25 13:14:26,382 - evaluation_logger_Attraction-147 - INFO - Observations:
[
    {
        "status": true,
        "message": "Success",
        "data": {
            "products": [
                {
                    "id": "eyJwaW5uZWRQcm9kdWN0IjoiUFJwdWk5YzZuV0VJIiwidWZpIjotMTIxNzIxNH0=",
                    "__typename": "AttractionsSearchProductSuggestion",
                    "title": "Cape Town Private, Cape point Penguin Tour",
                    "productId": "PRpui9c6nWEI",
                    "productSlug": "prpui9c6nwei-cape-town-private-cape-point-penguin-tour",
                    "taxonomySlug": "tours",
                    "cityUfi": -1217214,
                    "cityName": "Cape Town",
                    "countryCode": "za"
                }
            ]
        }
    }
]

2025-08-25 13:14:36,795 - evaluation_logger_Attraction-147 - INFO - Function Calls: 
[
    {
        "name": "Get_Availability",
        "arguments": {
            "slug": "prpui9c6nwei-cape-town-private-cape-point-penguin-tour",
            "date": "2024-11-13"
        }
    }
]

2025-08-25 13:14:36,795 - evaluation_logger_Attraction-147 - INFO - Golden Function Call: 
[
    {
        "name": "Get_Availability",
        "arguments": {
            "date": "2024-11-13",
            "slug": "prpui9c6nwei-cape-town-private-cape-point-penguin-tour"
        }
    },
    {
        "name": "Search_Attraction_Location",
        "arguments": {
            "query": "Penguin, Port Elizabeth"
        }
    }
]

2025-08-25 13:14:36,795 - evaluation_logger_Attraction-147 - INFO - Start compare_single_call: 
{'name': 'Get_Availability', 'arguments': {'date': '2024-11-13', 'slug': 'prpui9c6nwei-cape-town-private-cape-point-penguin-tour'}}
{'name': 'Get_Availability', 'arguments': {'date': '2024-11-13', 'slug': 'prpui9c6nwei-cape-town-private-cape-point-penguin-tour'}}
2025-08-25 13:14:36,796 - evaluation_logger_Attraction-147 - INFO - Rule-based compare success.
2025-08-25 13:14:36,796 - evaluation_logger_Attraction-147 - INFO - Success matched: [{'name': 'Get_Availability', 'arguments': {'date': '2024-11-13', 'slug': 'prpui9c6nwei-cape-town-private-cape-point-penguin-tour'}}]
2025-08-25 13:14:36,796 - evaluation_logger_Attraction-147 - INFO - Observations:
[
    {
        "status": true,
        "message": "Success",
        "data": [
            {
                "__typename": "AttractionTimeSlot",
                "fullDay": false,
                "start": "2024-11-13T06:00:00+02:00",
                "timeSlotId": "ATS-PRpui9c6nWEI-202411130600-nullnull",
                "timeSlotOffers": [
                    {
                        "__typename": "AttractionTimeSlotOffer",
                        "languageOptions": [
                            {
                                "__typename": "OfferLanguageOption",
                                "label": "German - Tour guide",
                                "language": "de",
                                "type": "guide"
                            },
                            {
                                "__typename": "OfferLanguageOption",
                                "label": "Spanish - Tour guide",
                                "language": "es",
                                "type": "guide"
                            },
                            {
                                "__typename": "OfferLanguageOption",
                                "label": "Italian - Tour guide",
                                "language": "it",
                                "type": "guide"
                            },
                            {
                                "__typename": "OfferLanguageOption",
                                "label": "French - Tour guide",
                                "language": "fr",
                                "type": "guide"
                            },
                            {
                                "__typename": "OfferLanguageOption",
                                "label": "English - Tour guide",
                                "language": "en",
                                "type": "guide"
                            }
                        ],
                        "benefits": {
                            "__typename": "Benefits"
                        },
                        "description": "Pickup included",
                        "id": "OFmkOovTfPAM",
                        "items": [
                            {
                                "__typename": "AttractionTimeSlotOfferItem",
                                "cancellationPolicy": {
                                    "__typename": "AttractionsCancellationPolicy",
                                    "hasFreeCancellation": false,
                                    "isStillRefundable": false
                                },
                                "constraint": {
                                    "__typename": "Constraint",
                                    "label": "(age 16-95)"
                                },
                                "id": "ATO-993a87de-19e5-4ddd-a29f-1524025419d6_PRpui9c6nWEI_20241113_0600",
                                "offerItemId": "OI3BVb8rRxPs",
                                "type": "adult",
                                "tieredPricing": false,
                                "price": {
                                    "__typename": "AttractionsPrice",
                                    "chargeAmount": 163.2,
                                    "currency": "USD",
                                    "publicAmount": 163.2
                                },
                                "languageOption": {
                                    "__typename": "LanguageOption",
                                    "language": "de",
                                    "type": "guide"
                                },
                                "ticketsAvailable": 10000,
                                "maxPerReservation": 15,
                                "minPerReservation": 1,
                                "label": "Adult"
                            },
                            {
                                "__typename": "AttractionTimeSlotOfferItem",
                                "cancellationPolicy": {
                                    "__typename": "AttractionsCancellationPolicy",
                                    "hasFreeCancellation": false,
                                    "isStillRefundable": false
                                },
                                "constraint": {
                                    "__typename": "Constraint",
                                    "label": "(age 16-95)"
                                },
                                "id": "ATO-d904897e-730d-493f-9da9-720848d5a16f_PRpui9c6nWEI_20241113_0600",
                                "offerItemId": "OI3BVb8rRxPs",
                                "type": "adult",
                                "tieredPricing": false,
                                "price": {
                                    "__typename": "AttractionsPrice",
                                    "chargeAmount": 163.2,
                                    "currency": "USD",
                                    "publicAmount": 163.2
                                },
                                "languageOption": {
                                    "__typename": "LanguageOption",
                                    "language": "fr",
                                    "type": "guide"
                                },
                                "ticketsAvailable": 10000,
                                "maxPerReservation": 15,
                                "minPerReservation": 1,
                                "label": "Adult"
                            },
                            {
                                "__typename": "AttractionTimeSlotOfferItem",
                                "cancellationPolicy": {
                                    "__typename": "AttractionsCancellationPolicy",
                                    "hasFreeCancellation": false,
                                    "isStillRefundable": false
                                },
                                "constraint": {
                                    "__typename": "Constraint",
                                    "label": "(age 16-95)"
                                },
                                "id": "ATO-40165b1f-4eb6-4433-a7ba-7ba85a5dd369_PRpui9c6nWEI_20241113_0600",
                                "offerItemId": "OI3BVb8rRxPs",
                                "type": "adult",
                                "tieredPricing": false,
                                "price": {
                                    "__typename": "AttractionsPrice",
                                    "chargeAmount": 163.2,
                                    "currency": "USD",
                                    "publicAmount": 163.2
                                },
                                "languageOption": {
                                    "__typename": "LanguageOption",
                                    "language": "es",
                                    "type": "guide"
                                },
                                "ticketsAvailable": 10000,
                                "maxPerReservation": 15,
                                "minPerReservation": 1,
                                "label": "Adult"
                            },
                            {
                                "__typename": "AttractionTimeSlotOfferItem",
                                "cancellationPolicy": {
                                    "__typename": "AttractionsCancellationPolicy",
                                    "hasFreeCancellation": false,
                                    "isStillRefundable": false
                                },
                                "constraint": {
                                    "__typename": "Constraint",
                                    "label": "(age 16-95)"
                                },
                                "id": "ATO-b3ade376-a1e5-4af3-8fa7-fb545eee7683_PRpui9c6nWEI_20241113_0600",
                                "offerItemId": "OI3BVb8rRxPs",
                                "type": "adult",
                                "tieredPricing": false,
                                "price": {
                                    "__typename": "AttractionsPrice",
                                    "chargeAmount": 163.2,
                                    "currency": "USD",
                                    "publicAmount": 163.2
                                },
                                "languageOption": {
                                    "__typename": "LanguageOption",
                                    "language": "en",
                                    "type": "guide"
                                },
                                "ticketsAvailable": 10000,
                                "maxPerReservation": 15,
                                "minPerReservation": 1,
                                "label": "Adult"
                            },
                            {
                                "__typename": "AttractionTimeSlotOfferItem",
                                "cancellationPolicy": {
                                    "__typename": "AttractionsCancellationPolicy",
                                    "hasFreeCancellation": false,
                                    "isStillRefundable": false
                                },
                                "constraint": {
                                    "__typename": "Constraint",
                                    "label": "(age 16-95)"
                                },
                                "id": "ATO-d711d382-4bde-422a-aca7-36d87f055e48_PRpui9c6nWEI_20241113_0600",
                                "offerItemId": "OI3BVb8rRxPs",
                                "type": "adult",
                                "tieredPricing": false,
                                "price": {
                                    "__typename": "AttractionsPrice",
                                    "chargeAmount": 163.2,
                                    "currency": "USD",
                                    "publicAmount": 163.2
                                },
                                "languageOption": {
                                    "__typename": "LanguageOption",
                                    "language": "it",
                                    "type": "guide"
                                },
                                "ticketsAvailable": 10000,
                                "maxPerReservation": 15,
                                "minPerReservation": 1,
                                "label": "Adult"
                            }
                        ],
                        "label": "Cape Town Private, Cape point Penguin Tour",
                        "reservationRestrictions": {
                            "__typename": "ReservationRestrictions",
                            "adultRequiredForReservation": false,
                            "maxOfferItemsPerReservation": 15,
                            "minOfferItemsPerReservation": 1
                        }
                    }
                ]
            },
            {
                "__typename": "AttractionTimeSlot",
                "fullDay": false,
                "start": "2024-11-13T09:00:00+02:00",
                "timeSlotId": "ATS-PRpui9c6nWEI-202411130900-nullnull",
                "timeSlotOffers": [
                    {
                        "__typename": "AttractionTimeSlotOffer",
                        "languageOptions": [
                            {
                                "__typename": "OfferLanguageOption",
                                "label": "German - Tour guide",
                                "language": "de",
                                "type": "guide"
                            },
                            {
                                "__typename": "OfferLanguageOption",
                                "label": "Spanish - Tour guide",
                                "language": "es",
                                "type": "guide"
                            },
                            {
                                "__typename": "OfferLanguageOption",
                                "label": "Italian - Tour guide",
                                "language": "it",
                                "type": "guide"
                            },
                            {
                                "__typename": "OfferLanguageOption",
                                "label": "French - Tour guide",
                                "language": "fr",
                                "type": "guide"
                            },
                            {
                                "__typename": "OfferLanguageOption",
                                "label": "English - Tour guide",
                                "language": "en",
                                "type": "guide"
                            }
                        ],
                        "benefits": {
                            "__typename": "Benefits"
                        },
                        "description": "Pickup included",
                        "id": "OFmkOovTfPAM",
                        "items": [
                            {
                                "__typename": "AttractionTimeSlotOfferItem",
                                "cancellationPolicy": {
                                    "__typename": "AttractionsCancellationPolicy",
                                    "hasFreeCancellation": false,
                                    "isStillRefundable": false
                                },
                                "constraint": {
                                    "__typename": "Constraint",
                                    "label": "(age 16-95)"
                                },
                                "id": "ATO-75b386a2-0e16-4cbe-a659-3c4ac3070fac_PRpui9c6nWEI_20241113_0900",
                                "offerItemId": "OI3BVb8rRxPs",
                                "type": "adult",
                                "tieredPricing": false,
                                "price": {
                                    "__typename": "AttractionsPrice",
                                    "chargeAmount": 163.2,
                                    "currency": "USD",
                                    "publicAmount": 163.2
                                },
                                "languageOption": {
                                    "__typename": "LanguageOption",
                                    "language": "de",
                                    "type": "guide"
                                },
                                "ticketsAvailable": 10000,
                                "maxPerReservation": 15,
                                "minPerReservation": 1,
                                "label": "Adult"
                            },
                            {
                                "__typename": "AttractionTimeSlotOfferItem",
                                "cancellationPolicy": {
                                    "__typename": "AttractionsCancellationPolicy",
                                    "hasFreeCancellation": false,
                                    "isStillRefundable": false
                                },
                                "constraint": {
                                    "__typename": "Constraint",
                                    "label": "(age 16-95)"
                                },
                                "id": "ATO-dcb59455-89e1-4811-b4b7-e7781d2a8da0_PRpui9c6nWEI_20241113_0900",
                                "offerItemId": "OI3BVb8rRxPs",
                                "type": "adult",
                                "tieredPricing": false,
                                "price": {
                                    "__typename": "AttractionsPrice",
                                    "chargeAmount": 163.2,
                                    "currency": "USD",
                                    "publicAmount": 163.2
                                },
                                "languageOption": {
                                    "__typename": "LanguageOption",
                                    "language": "fr",
                                    "type": "guide"
                                },
                                "ticketsAvailable": 10000,
                                "maxPerReservation": 15,
                                "minPerReservation": 1,
                                "label": "Adult"
                            },
                            {
                                "__typename": "AttractionTimeSlotOfferItem",
                                "cancellationPolicy": {
                                    "__typename": "AttractionsCancellationPolicy",
                                    "hasFreeCancellation": false,
                                    "isStillRefundable": false
                                },
                                "constraint": {
                                    "__typename": "Constraint",
                                    "label": "(age 16-95)"
                                },
                                "id": "ATO-e4242a94-56c9-4225-af48-88af8f8448d6_PRpui9c6nWEI_20241113_0900",
                                "offerItemId": "OI3BVb8rRxPs",
                                "type": "adult",
                                "tieredPricing": false,
                                "price": {
                                    "__typename": "AttractionsPrice",
                                    "chargeAmount": 163.2,
                                    "currency": "USD",
                                    "publicAmount": 163.2
                                },
                                "languageOption": {
                                    "__typename": "LanguageOption",
                                    "language": "es",
                                    "type": "guide"
                                },
                                "ticketsAvailable": 10000,
                                "maxPerReservation": 15,
                                "minPerReservation": 1,
                                "label": "Adult"
                            },
                            {
                                "__typename": "AttractionTimeSlotOfferItem",
                                "cancellationPolicy": {
                                    "__typename": "AttractionsCancellationPolicy",
                                    "hasFreeCancellation": false,
                                    "isStillRefundable": false
                                },
                                "constraint": {
                                    "__typename": "Constraint",
                                    "label": "(age 16-95)"
                                },
                                "id": "ATO-99053905-71c7-4747-8ed6-4e3511b1951a_PRpui9c6nWEI_20241113_0900",
                                "offerItemId": "OI3BVb8rRxPs",
                                "type": "adult",
                                "tieredPricing": false,
                                "price": {
                                    "__typename": "AttractionsPrice",
                                    "chargeAmount": 163.2,
                                    "currency": "USD",
                                    "publicAmount": 163.2
                                },
                                "languageOption": {
                                    "__typename": "LanguageOption",
                                    "language": "en",
                                    "type": "guide"
                                },
                                "ticketsAvailable": 10000,
                                "maxPerReservation": 15,
                                "minPerReservation": 1,
                                "label": "Adult"
                            },
                            {
                                "__typename": "AttractionTimeSlotOfferItem",
                                "cancellationPolicy": {
                                    "__typename": "AttractionsCancellationPolicy",
                                    "hasFreeCancellation": false,
                                    "isStillRefundable": false
                                },
                                "constraint": {
                                    "__typename": "Constraint",
                                    "label": "(age 16-95)"
                                },
                                "id": "ATO-64deee6a-3079-4153-b167-364756ff0bbd_PRpui9c6nWEI_20241113_0900",
                                "offerItemId": "OI3BVb8rRxPs",
                                "type": "adult",
                                "tieredPricing": false,
                                "price": {
                                    "__typename": "AttractionsPrice",
                                    "chargeAmount": 163.2,
                                    "currency": "USD",
                                    "publicAmount": 163.2
                                },
                                "languageOption": {
                                    "__typename": "LanguageOption",
                                    "language": "it",
                                    "type": "guide"
                                },
                                "ticketsAvailable": 10000,
                                "maxPerReservation": 15,
                                "minPerReservation": 1,
                                "label": "Adult"
                            }
                        ],
                        "label": "Cape Town Private, Cape point Penguin Tour",
                        "reservationRestrictions": {
                            "__typename": "ReservationRestrictions",
                            "adultRequiredForReservation": false,
                            "maxOfferItemsPerReservation": 15,
                            "minOfferItemsPerReservation": 1
                        }
                    }
                ]
            },
            {
                "__typename": "AttractionTimeSlot",
                "fullDay": false,
                "start": "2024-11-13T11:00:00+02:00",
                "timeSlotId": "ATS-PRpui9c6nWEI-202411131100-nullnull",
                "timeSlotOffers": [
                    {
                        "__typename": "AttractionTimeSlotOffer",
                        "languageOptions": [
                            {
                                "__typename": "OfferLanguageOption",
                                "label": "German - Tour guide",
                                "language": "de",
                                "type": "guide"
                            },
                            {
                                "__typename": "OfferLanguageOption",
                                "label": "Spanish - Tour guide",
                                "language": "es",
                                "type": "guide"
                            },
                            {
                                "__typename": "OfferLanguageOption",
                                "label": "Italian - Tour guide",
                                "language": "it",
                                "type": "guide"
                            },
                            {
                                "__typename": "OfferLanguageOption",
                                "label": "French - Tour guide",
                                "language": "fr",
                                "type": "guide"
                            },
                            {
                                "__typename": "OfferLanguageOption",
                                "label": "English - Tour guide",
                                "language": "en",
                                "type": "guide"
                            }
                        ],
                        "benefits": {
                            "__typename": "Benefits"
                        },
                        "description": "Pickup included",
                        "id": "OFmkOovTfPAM",
                        "items": [
                            {
                                "__typename": "AttractionTimeSlotOfferItem",
                                "cancellationPolicy": {
                                    "__typename": "AttractionsCancellationPolicy",
                                    "hasFreeCancellation": false,
                                    "isStillRefundable": false
                                },
                                "constraint": {
                                    "__typename": "Constraint",
                                    "label": "(age 16-95)"
                                },
                                "id": "ATO-bba725df-b773-498a-a3f8-b6f72ffba051_PRpui9c6nWEI_20241113_1100",
                                "offerItemId": "OI3BVb8rRxPs",
                                "type": "adult",
                                "tieredPricing": false,
                                "price": {
                                    "__typename": "AttractionsPrice",
                                    "chargeAmount": 163.2,
                                    "currency": "USD",
                                    "publicAmount": 163.2
                                },
                                "languageOption": {
                                    "__typename": "LanguageOption",
                                    "language": "de",
                                    "type": "guide"
                                },
                                "ticketsAvailable": 10000,
                                "maxPerReservation": 15,
                                "minPerReservation": 1,
                                "label": "Adult"
                            },
                            {
                                "__typename": "AttractionTimeSlotOfferItem",
                                "cancellationPolicy": {
                                    "__typename": "AttractionsCancellationPolicy",
                                    "hasFreeCancellation": false,
                                    "isStillRefundable": false
                                },
                                "constraint": {
                                    "__typename": "Constraint",
                                    "label": "(age 16-95)"
                                },
                                "id": "ATO-4435f0c1-0777-4abf-9e55-f755f91fe71d_PRpui9c6nWEI_20241113_1100",
                                "offerItemId": "OI3BVb8rRxPs",
                                "type": "adult",
                                "tieredPricing": false,
                                "price": {
                                    "__typename": "AttractionsPrice",
                                    "chargeAmount": 163.2,
                                    "currency": "USD",
                                    "publicAmount": 163.2
                                },
                                "languageOption": {
                                    "__typename": "LanguageOption",
                                    "language": "fr",
                                    "type": "guide"
                                },
                                "ticketsAvailable": 10000,
                                "maxPerReservation": 15,
                                "minPerReservation": 1,
                                "label": "Adult"
                            },
                            {
                                "__typename": "AttractionTimeSlotOfferItem",
                                "cancellationPolicy": {
                                    "__typename": "AttractionsCancellationPolicy",
                                    "hasFreeCancellation": false,
                                    "isStillRefundable": false
                                },
                                "constraint": {
                                    "__typename": "Constraint",
                                    "label": "(age 16-95)"
                                },
                                "id": "ATO-f3976414-8f16-40da-9b95-15368d84bad7_PRpui9c6nWEI_20241113_1100",
                                "offerItemId": "OI3BVb8rRxPs",
                                "type": "adult",
                                "tieredPricing": false,
                                "price": {
                                    "__typename": "AttractionsPrice",
                                    "chargeAmount": 163.2,
                                    "currency": "USD",
                                    "publicAmount": 163.2
                                },
                                "languageOption": {
                                    "__typename": "LanguageOption",
                                    "language": "es",
                                    "type": "guide"
                                },
                                "ticketsAvailable": 10000,
                                "maxPerReservation": 15,
                                "minPerReservation": 1,
                                "label": "Adult"
                            },
                            {
                                "__typename": "AttractionTimeSlotOfferItem",
                                "cancellationPolicy": {
                                    "__typename": "AttractionsCancellationPolicy",
                                    "hasFreeCancellation": false,
                                    "isStillRefundable": false
                                },
                                "constraint": {
                                    "__typename": "Constraint",
                                    "label": "(age 16-95)"
                                },
                                "id": "ATO-c7c09de8-9fc8-4ab0-8b3b-e3ca05c5e13b_PRpui9c6nWEI_20241113_1100",
                                "offerItemId": "OI3BVb8rRxPs",
                                "type": "adult",
                                "tieredPricing": false,
                                "price": {
                                    "__typename": "AttractionsPrice",
                                    "chargeAmount": 163.2,
                                    "currency": "USD",
                                    "publicAmount": 163.2
                                },
                                "languageOption": {
                                    "__typename": "LanguageOption",
                                    "language": "en",
                                    "type": "guide"
                                },
                                "ticketsAvailable": 10000,
                                "maxPerReservation": 15,
                                "minPerReservation": 1,
                                "label": "Adult"
                            },
                            {
                                "__typename": "AttractionTimeSlotOfferItem",
                                "cancellationPolicy": {
                                    "__typename": "AttractionsCancellationPolicy",
                                    "hasFreeCancellation": false,
                                    "isStillRefundable": false
                                },
                                "constraint": {
                                    "__typename": "Constraint",
                                    "label": "(age 16-95)"
                                },
                                "id": "ATO-3d7f2b61-112a-4334-947f-116701a3b26b_PRpui9c6nWEI_20241113_1100",
                                "offerItemId": "OI3BVb8rRxPs",
                                "type": "adult",
                                "tieredPricing": false,
                                "price": {
                                    "__typename": "AttractionsPrice",
                                    "chargeAmount": 163.2,
                                    "currency": "USD",
                                    "publicAmount": 163.2
                                },
                                "languageOption": {
                                    "__typename": "LanguageOption",
                                    "language": "it",
                                    "type": "guide"
                                },
                                "ticketsAvailable": 10000,
                                "maxPerReservation": 15,
                                "minPerReservation": 1,
                                "label": "Adult"
                            }
                        ],
                        "label": "Cape Town Private, Cape point Penguin Tour",
                        "reservationRestrictions": {
                            "__typename": "ReservationRestrictions",
                            "adultRequiredForReservation": false,
                            "maxOfferItemsPerReservation": 15,
                            "minOfferItemsPerReservation": 1
                        }
                    }
                ]
            },
            {
                "__typename": "AttractionTimeSlot",
                "fullDay": false,
                "start": "2024-11-13T13:00:00+02:00",
                "timeSlotId": "ATS-PRpui9c6nWEI-202411131300-nullnull",
                "timeSlotOffers": [
                    {
                        "__typename": "AttractionTimeSlotOffer",
                        "languageOptions": [
                            {
                                "__typename": "OfferLanguageOption",
                                "label": "German - Tour guide",
                                "language": "de",
                                "type": "guide"
                            },
                            {
                                "__typename": "OfferLanguageOption",
                                "label": "Spanish - Tour guide",
                                "language": "es",
                                "type": "guide"
                            },
                            {
                                "__typename": "OfferLanguageOption",
                                "label": "Italian - Tour guide",
                                "language": "it",
                                "type": "guide"
                            },
                            {
                                "__typename": "OfferLanguageOption",
                                "label": "French - Tour guide",
                                "language": "fr",
                                "type": "guide"
                            },
                            {
                                "__typename": "OfferLanguageOption",
                                "label": "English - Tour guide",
                                "language": "en",
                                "type": "guide"
                            }
                        ],
                        "benefits": {
                            "__typename": "Benefits"
                        },
                        "description": "Pickup included",
                        "id": "OFmkOovTfPAM",
                        "items": [
                            {
                                "__typename": "AttractionTimeSlotOfferItem",
                                "cancellationPolicy": {
                                    "__typename": "AttractionsCancellationPolicy",
                                    "hasFreeCancellation": false,
                                    "isStillRefundable": false
                                },
                                "constraint": {
                                    "__typename": "Constraint",
                                    "label": "(age 16-95)"
                                },
                                "id": "ATO-029f88d0-21e7-4230-9418-1e3c5e4c0940_PRpui9c6nWEI_20241113_1300",
                                "offerItemId": "OI3BVb8rRxPs",
                                "type": "adult",
                                "tieredPricing": false,
                                "price": {
                                    "__typename": "AttractionsPrice",
                                    "chargeAmount": 163.2,
                                    "currency": "USD",
                                    "publicAmount": 163.2
                                },
                                "languageOption": {
                                    "__typename": "LanguageOption",
                                    "language": "de",
                                    "type": "guide"
                                },
                                "ticketsAvailable": 10000,
                                "maxPerReservation": 15,
                                "minPerReservation": 1,
                                "label": "Adult"
                            },
                            {
                                "__typename": "AttractionTimeSlotOfferItem",
                                "cancellationPolicy": {
                                    "__typename": "AttractionsCancellationPolicy",
                                    "hasFreeCancellation": false,
                                    "isStillRefundable": false
                                },
                                "constraint": {
                                    "__typename": "Constraint",
                                    "label": "(age 16-95)"
                                },
                                "id": "ATO-43d39c90-cf40-470a-81cc-1764eb38b2b2_PRpui9c6nWEI_20241113_1300",
                                "offerItemId": "OI3BVb8rRxPs",
                                "type": "adult",
                                "tieredPricing": false,
                                "price": {
                                    "__typename": "AttractionsPrice",
                                    "chargeAmount": 163.2,
                                    "currency": "USD",
                                    "publicAmount": 163.2
                                },
                                "languageOption": {
                                    "__typename": "LanguageOption",
                                    "language": "fr",
                                    "type": "guide"
                                },
                                "ticketsAvailable": 10000,
                                "maxPerReservation": 15,
                                "minPerReservation": 1,
                                "label": "Adult"
                            },
                            {
                                "__typename": "AttractionTimeSlotOfferItem",
                                "cancellationPolicy": {
                                    "__typename": "AttractionsCancellationPolicy",
                                    "hasFreeCancellation": false,
                                    "isStillRefundable": false
                                },
                                "constraint": {
                                    "__typename": "Constraint",
                                    "label": "(age 16-95)"
                                },
                                "id": "ATO-6b2856c8-79a5-48f4-aa99-ffe6c1035b2f_PRpui9c6nWEI_20241113_1300",
                                "offerItemId": "OI3BVb8rRxPs",
                                "type": "adult",
                                "tieredPricing": false,
                                "price": {
                                    "__typename": "AttractionsPrice",
                                    "chargeAmount": 163.2,
                                    "currency": "USD",
                                    "publicAmount": 163.2
                                },
                                "languageOption": {
                                    "__typename": "LanguageOption",
                                    "language": "es",
                                    "type": "guide"
                                },
                                "ticketsAvailable": 10000,
                                "maxPerReservation": 15,
                                "minPerReservation": 1,
                                "label": "Adult"
                            },
                            {
                                "__typename": "AttractionTimeSlotOfferItem",
                                "cancellationPolicy": {
                                    "__typename": "AttractionsCancellationPolicy",
                                    "hasFreeCancellation": false,
                                    "isStillRefundable": false
                                },
                                "constraint": {
                                    "__typename": "Constraint",
                                    "label": "(age 16-95)"
                                },
                                "id": "ATO-ce5755bc-9b59-4391-a0bf-aefaa3bd5abc_PRpui9c6nWEI_20241113_1300",
                                "offerItemId": "OI3BVb8rRxPs",
                                "type": "adult",
                                "tieredPricing": false,
                                "price": {
                                    "__typename": "AttractionsPrice",
                                    "chargeAmount": 163.2,
                                    "currency": "USD",
                                    "publicAmount": 163.2
                                },
                                "languageOption": {
                                    "__typename": "LanguageOption",
                                    "language": "en",
                                    "type": "guide"
                                },
                                "ticketsAvailable": 10000,
                                "maxPerReservation": 15,
                                "minPerReservation": 1,
                                "label": "Adult"
                            },
                            {
                                "__typename": "AttractionTimeSlotOfferItem",
                                "cancellationPolicy": {
                                    "__typename": "AttractionsCancellationPolicy",
                                    "hasFreeCancellation": false,
                                    "isStillRefundable": false
                                },
                                "constraint": {
                                    "__typename": "Constraint",
                                    "label": "(age 16-95)"
                                },
                                "id": "ATO-7b6845ff-e11c-4443-b57e-15e05f4f5f48_PRpui9c6nWEI_20241113_1300",
                                "offerItemId": "OI3BVb8rRxPs",
                                "type": "adult",
                                "tieredPricing": false,
                                "price": {
                                    "__typename": "AttractionsPrice",
                                    "chargeAmount": 163.2,
                                    "currency": "USD",
                                    "publicAmount": 163.2
                                },
                                "languageOption": {
                                    "__typename": "LanguageOption",
                                    "language": "it",
                                    "type": "guide"
                                },
                                "ticketsAvailable": 10000,
                                "maxPerReservation": 15,
                                "minPerReservation": 1,
                                "label": "Adult"
                            }
                        ],
                        "label": "Cape Town Private, Cape point Penguin Tour",
                        "reservationRestrictions": {
                            "__typename": "ReservationRestrictions",
                            "adultRequiredForReservation": false,
                            "maxOfferItemsPerReservation": 15,
                            "minOfferItemsPerReservation": 1
                        }
                    }
                ]
            }
        ]
    }
]

2025-08-25 13:14:46,552 - evaluation_logger_Attraction-147 - INFO - Function Calls: 
[
    {
        "name": "Search_Attraction_Location",
        "arguments": {
            "query": "penguins, Port Elizabeth"
        }
    }
]

2025-08-25 13:14:46,552 - evaluation_logger_Attraction-147 - INFO - Golden Function Call: 
[
    {
        "name": "Search_Attraction_Location",
        "arguments": {
            "query": "Penguin, Port Elizabeth"
        }
    },
    {
        "name": "Get_Availability",
        "arguments": {
            "slug": "prmda59znth5-port-elizabeth-adventure-tuk-tuk-penguins-cape-recife",
            "date": "2024-11-18"
        }
    }
]

2025-08-25 13:14:47,198 - evaluation_logger_Attraction-147 - INFO - Start compare_single_call: 
{'name': 'Search_Attraction_Location', 'arguments': {'query': 'penguins, Port Elizabeth'}}
{'name': 'Search_Attraction_Location', 'arguments': {'query': 'Penguin, Port Elizabeth'}}
2025-08-25 13:14:54,768 - evaluation_logger_Attraction-147 - DEBUG - LLM-based comparison output: {'is_equal': True, 'reason': "The function calls are equivalent because the query parameter 'penguins, Port Elizabeth' in Function call 1 and 'Penguin, Port Elizabeth' in Function call 2 refer to the same concept of searching for penguin-related attractions in Port Elizabeth. The difference in singular and plural forms of 'penguin' does not change the meaning of the search query."}
2025-08-25 13:14:54,768 - evaluation_logger_Attraction-147 - INFO - LLM-based compare success.
2025-08-25 13:14:54,768 - evaluation_logger_Attraction-147 - INFO - Success matched: [{'name': 'Search_Attraction_Location', 'arguments': {'query': 'Penguin, Port Elizabeth'}}]
2025-08-25 13:14:54,768 - evaluation_logger_Attraction-147 - INFO - Observations:
[
    {
        "status": true,
        "message": "Success",
        "data": {
            "products": [
                {
                    "id": "eyJwaW5uZWRQcm9kdWN0IjoiUFJtZEE1OXpOVGg1IiwidWZpIjotMTI3MzQ0OH0=",
                    "__typename": "AttractionsSearchProductSuggestion",
                    "title": "Port Elizabeth Adventure: Tuk-Tuk, Penguins, & Cape Recife",
                    "productId": "PRmdA59zNTh5",
                    "productSlug": "prmda59znth5-port-elizabeth-adventure-tuk-tuk-penguins-cape-recife",
                    "taxonomySlug": "tours",
                    "cityUfi": -1273448,
                    "cityName": "Port Elizabeth",
                    "countryCode": "za"
                }
            ]
        }
    }
]

2025-08-25 13:15:04,513 - evaluation_logger_Attraction-147 - INFO - Function Calls: 
[
    {
        "name": "Get_Availability",
        "arguments": {
            "slug": "prmda59znth5-port-elizabeth-adventure-tuk-tuk-penguins-cape-recife",
            "date": "2024-11-18"
        }
    }
]

2025-08-25 13:15:04,513 - evaluation_logger_Attraction-147 - INFO - Golden Function Call: 
[
    {
        "name": "Get_Availability",
        "arguments": {
            "date": "2024-11-18",
            "slug": "prmda59znth5-port-elizabeth-adventure-tuk-tuk-penguins-cape-recife"
        }
    }
]

2025-08-25 13:15:04,513 - evaluation_logger_Attraction-147 - INFO - Start compare_single_call: 
{'name': 'Get_Availability', 'arguments': {'date': '2024-11-18', 'slug': 'prmda59znth5-port-elizabeth-adventure-tuk-tuk-penguins-cape-recife'}}
{'name': 'Get_Availability', 'arguments': {'date': '2024-11-18', 'slug': 'prmda59znth5-port-elizabeth-adventure-tuk-tuk-penguins-cape-recife'}}
2025-08-25 13:15:04,513 - evaluation_logger_Attraction-147 - INFO - Rule-based compare success.
2025-08-25 13:15:04,513 - evaluation_logger_Attraction-147 - INFO - Success matched: [{'name': 'Get_Availability', 'arguments': {'date': '2024-11-18', 'slug': 'prmda59znth5-port-elizabeth-adventure-tuk-tuk-penguins-cape-recife'}}]
2025-08-25 13:15:04,513 - evaluation_logger_Attraction-147 - INFO - Observations:
[
    {
        "status": true,
        "message": "Success",
        "data": [
            {
                "__typename": "AttractionTimeSlot",
                "fullDay": true,
                "start": "2024-11-18T00:00:00+02:00",
                "timeSlotId": "ATS-PRmdA59zNTh5-202411180000-nullnull",
                "timeSlotOffers": [
                    {
                        "__typename": "AttractionTimeSlotOffer",
                        "languageOptions": [
                            {
                                "__typename": "OfferLanguageOption",
                                "label": "English - Tour guide",
                                "language": "en",
                                "type": "guide"
                            }
                        ],
                        "benefits": {
                            "__typename": "Benefits"
                        },
                        "description": "Pickup included",
                        "id": "OFGq0budSAcQ",
                        "items": [
                            {
                                "__typename": "AttractionTimeSlotOfferItem",
                                "cancellationPolicy": {
                                    "__typename": "AttractionsCancellationPolicy",
                                    "comparedTo": "start",
                                    "hasFreeCancellation": true,
                                    "isStillRefundable": true,
                                    "percentage": 100,
                                    "period": "P1D"
                                },
                                "constraint": {
                                    "__typename": "Constraint",
                                    "label": "(age 5-88)"
                                },
                                "id": "ATO-17a34824-0783-4d72-aeeb-8a74ba4e9abe_PRmdA59zNTh5_20241118_0000",
                                "offerItemId": "OIY65gRa2S2F",
                                "type": "adult",
                                "tieredPricing": false,
                                "price": {
                                    "__typename": "AttractionsPrice",
                                    "chargeAmount": 91.44,
                                    "currency": "EUR",
                                    "publicAmount": 91.44
                                },
                                "convertedPrice": {
                                    "__typename": "AttractionsPrice",
                                    "chargeAmount": 98.53,
                                    "currency": "USD",
                                    "publicAmount": 98.53
                                },
                                "languageOption": {
                                    "__typename": "LanguageOption",
                                    "language": "en",
                                    "type": "guide"
                                },
                                "ticketsAvailable": 10000,
                                "maxPerReservation": 15,
                                "minPerReservation": 1,
                                "label": "Adult"
                            }
                        ],
                        "label": "Port Elizabeth Adventure: Tuk-Tuk, Penguins, & Cape Recife",
                        "reservationRestrictions": {
                            "__typename": "ReservationRestrictions",
                            "adultRequiredForReservation": false,
                            "maxOfferItemsPerReservation": 15,
                            "minOfferItemsPerReservation": 1
                        }
                    }
                ]
            }
        ]
    }
]

2025-08-25 13:18:14,408 - evaluation_logger_Attraction-147 - INFO - Final Response: <beginofsentence># 1. 

 [ Spring MVC    Root WebApplicationContext ](http://svip.iocoder.cn/Spring-MVC/context-init-Root-WebApplicationContext) 

 [ Spring MVC    Servlet WebApplicationContext ](http://svip.iocoder.cn/Spring-MVC/context-init-Servlet-WebApplicationContext)  Servlet WebApplicationContext  Root WebApplicationContext 

 [Spring  context-param  init-param ](https://blog.csdn.net/slvher/article/details/41012881)  `context-param`  `init-param` 

# 2. 

 Spring MVC  [Spring MVC ](http://www.iocoder.cn/Spring-MVC/install/?self) 

# 3. ContextLoaderListener

`org.springframework.web.context.ContextLoaderListener`  ServletContextListener Web  Root WebApplicationContext 

## 3.1 

```java
// ContextLoaderListener.java

/**
 *  ContextLoaderListener  context  Root WebApplicationContext 
 *
 * @param context the application context
 */
public ContextLoaderListener(WebApplicationContext context) {
	super(context);
}

/**
 *  ContextLoaderListener  context  contextClass  Root WebApplicationContext 
 */
public ContextLoaderListener() {
}
```

-  WebApplicationContext ****

## 3.2 contextInitialized

`#contextInitialized(ServletContextEvent event)`  Servlet  Root WebApplicationContext 

```java
// ContextLoaderListener.java

@Override
public void contextInitialized(ServletContextEvent event) {
    // <1>  WebApplicationContext
	initWebApplicationContext(event.getServletContext());
}
```

- `<1>`  ContextLoader  `#initWebApplicationContext(ServletContext servletContext)`  WebApplicationContext  [4. ContextLoader](http://svip.iocoder.cn/Spring-MVC/context-init-Root-WebApplicationContext/#) 

## 3.3 contextDestroyed

`#contextDestroyed(ServletContextEvent event)`  Servlet  Root WebApplicationContext 

```java
// ContextLoaderListener.java

@Override
public void contextDestroyed(ServletContextEvent event) {
    //  WebApplicationContext
	closeWebApplicationContext(event.getServletContext());
    // 
	ContextCleanupListener.cleanupAttributes(event.getServletContext());
}
```

-  ContextLoader 

# 4. ContextLoader

`org.springframework.web.context.ContextLoader`  Root WebApplicationContext 

## 4.1 

```java
// ContextLoader.java

/**
 * Context 
 */
public static final String CONTEXT_CLASS_PARAM = "contextClass";

/**
 * Context 
 */
public static final String CONFIG_LOCATION_PARAM = "contextConfigLocation";

/**
 *  WebApplicationContext  ServletContext 
 */
public static final String ROOT_WEB_APPLICATION_CONTEXT_ATTRIBUTE = WebApplicationContext.class.getName() + ".ROOT";

/**
 *  WebApplicationContext 
 *
 *  {@link #createWebApplicationContext(ServletContext)} 
 */
private static final String CONTEXT_ATTRIBUTE = ContextLoader.class.getName() + ".CONTEXT";

/**
 *  WebApplicationContext  ServletContext 
 *
 *  {@link #createWebApplicationContext(ServletContext)} 
 */
private static final AtomicBoolean active = new AtomicBoolean();
```

## 4.2 

```java
// ContextLoader.java

/**
 *  WebApplicationContext 
 */
@Nullable
private WebApplicationContext context;

/**
 *  ContextLoader 
 */
public ContextLoader() {
}

/**
 *  ContextLoader  context 
 *
 * @param context the application context
 */
public ContextLoader(WebApplicationContext context) {
	this.context = context;
}
```

## 4.3 initWebApplicationContext

`#initWebApplicationContext(ServletContext servletContext)`  WebApplicationContext 

```java
// ContextLoader.java

public WebApplicationContext initWebApplicationContext(ServletContext servletContext) {
    // <1>  ROOT_WEB_APPLICATION_CONTEXT_ATTRIBUTE  WebApplicationContext  IllegalStateException 
    if (servletContext.getAttribute(WebApplicationContext.ROOT_WEB_APPLICATION_CONTEXT_ATTRIBUTE) != null) {
        throw new IllegalStateException(
                "Cannot initialize context because there is already a root application context present - " +
                "check whether you have multiple ContextLoader* definitions in your web.xml!");
    }

    // <2> 
    servletContext.log("Initializing Spring root WebApplicationContext");

    // 
    Log logger = LogFactory.getLog(ContextLoader.class);
    if (logger.isInfoEnabled()) {
        logger.info("Root WebApplicationContext: initialization started");
    }

    // <3> 
    long startTime = System.currentTimeMillis();

    try {
        // Store context in local instance variable, to guarantee that
        // it is available on ServletContext shutdown.
        // <4>  context 
        if (this.context == null) {
            this.context = createWebApplicationContext(servletContext);
        }
        // <5>  context  ConfigurableWebApplicationContext 
        if (this.context instanceof ConfigurableWebApplicationContext) {
            ConfigurableWebApplicationContext cwac = (ConfigurableWebApplicationContext) this.context;
            if (!cwac.isActive()) { // <5.1> 
                // The context has not yet been refreshed -> provide services such as
                // setting the parent context, setting the application context id, etc
                if (cwac.getParent() == null) {
                    // The context instance was injected without an explicit parent ->
                    // determine parent for root web application context, if any.
                    // <5.2>  Spring MVC 
                    ApplicationContext parent = loadParentContext(servletContext);
                    cwac.setParent(parent);
                }
                // <5.3>  WebApplicationContext
                configureAndRefreshWebApplicationContext(cwac, servletContext);
            }
        }
        // <6>  WebApplicationContext  servletContext 
        servletContext.setAttribute(WebApplicationContext.ROOT_WEB_APPLICATION_CONTEXT_ATTRIBUTE, this.context);

        // <7>  WebApplicationContext  currentContextPerThread 
        ClassLoader ccl = Thread.currentThread().getContextClassLoader();
        if (ccl == ContextLoader.class.getClassLoader()) {
            currentContext = this.context;
        } else if (ccl != null) {
            currentContextPerThread.put(ccl, this.context);
        }

        // <8> 
        if (logger.isInfoEnabled()) {
            long elapsedTime = System.currentTimeMillis() - startTime;
            logger.info("Root WebApplicationContext initialized in " + elapsedTime + " ms");
        }

        // <9>  WebApplicationContext 
        return this.context;
    } catch (RuntimeException | Error ex) {
        logger.error("Context initialization failed", ex);
        servletContext.setAttribute(WebApplicationContext.ROOT_WEB_APPLICATION_CONTEXT_ATTRIBUTE, ex);
        throw ex;
    }
}
```

- `<1>`  `ROOT_WEB_APPLICATION_CONTEXT_ATTRIBUTE`  WebApplicationContext  IllegalStateException Root WebApplicationContext 
- `<2>` 
- `<3>` 
- `<4>`  `context`  `#createWebApplicationContext(ServletContext servletContext)`  WebApplicationContext  [4.4 createWebApplicationContext](http://svip.iocoder.cn/Spring-MVC/context-init-Root-WebApplicationContext/#) 
- `<5>`  `context`  ConfigurableWebApplicationContext 
  - `<5.1>` 
  - `<5.2>`  Spring MVC  [4.5 loadParentContext](http://svip.iocoder.cn/Spring-MVC/context-init-Root-WebApplicationContext/#) 
  - `<5.3>`  `#configureAndRefreshWebApplicationContext(ConfigurableWebApplicationContext wac, ServletContext sc)`  WebApplicationContext  [4.6 configureAndRefreshWebApplicationContext](http://svip.iocoder.cn/Spring-MVC/context-init-Root-WebApplicationContext/#) 
- `<6>`  WebApplicationContext  `servletContext` 
- `<7>`  WebApplicationContext  `currentContextPerThread`  Spring MVC 
- `<8>` 
- `<9>`  WebApplicationContext 

## 4.4 createWebApplicationContext

`#createWebApplicationContext(ServletContext sc)`  WebApplicationContext 

```java
// ContextLoader.java

protected WebApplicationContext createWebApplicationContext(ServletContext sc) {
    // <1>  context 
    Class<?> contextClass = determineContextClass(sc);
    // <2>  contextClass 
    if (!ConfigurableWebApplicationContext.class.isAssignableFrom(contextClass)) {
        throw new ApplicationContextException("Custom context class [" + contextClass.getName() +
                "] is not of type [" + ConfigurableWebApplicationContext.class.getName() + "]");
    }
    // <3>  contextClass 
    return (ConfigurableWebApplicationContext) BeanUtils.instantiateClass(contextClass);
}
```

- `<1>`  `#determineContextClass(ServletContext servletContext)`  context  [4.4.1 determineContextClass](http://svip.iocoder.cn/Spring-MVC/context-init-Root-WebApplicationContext/#) 
- `<2>`  `contextClass`  ConfigurableWebApplicationContext 
- `<3>`  `contextClass` 

### 4.4.1 determineContextClass

`#determineContextClass(ServletContext servletContext)`  context 

```java
// ContextLoader.java

protected Class<?> determineContextClass(ServletContext servletContext) {
    //  servletContext  contextClass 
    String contextClassName = servletContext.getInitParameter(CONTEXT_CLASS_PARAM);
    // 
    if (contextClassName != null) {
        try {
            return ClassUtils.forName(contextClassName, ClassUtils.getDefaultClassLoader());
        } catch (ClassNotFoundException ex) {
            throw new ApplicationContextException(
                    "Failed to load custom context class [" + contextClassName + "]", ex);
        }
    // 
    } else {
        //  CONTEXT_CLASS 
        contextClassName = defaultStrategies.getProperty(WebApplicationContext.class.getName());
        try {
            return ClassUtils.forName(contextClassName, ContextLoader.class.getClassLoader());
        } catch (ClassNotFoundException ex) {
            throw new ApplicationContextException(
                    "Failed to load default context class [" + contextClassName + "]", ex);
        }
    }
}
```

-  `servletContext`  `contextClass` 
-  `CONTEXT_CLASS`  `CONTEXT_CLASS`  `ContextLoader.properties` 

```properties
org.springframework.web.context.WebApplicationContext=org.springframework.web.context.support.XmlWebApplicationContext
```

-  XmlWebApplicationContext 

## 4.5 loadParentContext

`#loadParentContext(ServletContext servletContext)` 

```java
// ContextLoader.java

@Nullable
protected ApplicationContext loadParentContext(ServletContext servletContext) {
    //  context 
	ApplicationContext parentContext = null;
    //  servletContext  locatorFactorySelector 
	String locatorFactorySelector = servletContext.getInitParameter(ContextLoader.LOCATOR_FACTORY_SELECTOR_PARAM);
    //  servletContext  parentContextKey 
	String parentContextKey = servletContext.getInitParameter(ContextLoader.LOCATOR_FACTORY_KEY_PARAM);
	// 
	if (locatorFactorySelector != null || parentContextKey != null) {
		// Actually, this will still only work for ContextLoader (not custom loaders)
		// ContextLoader
		// 
		//  https://jira.spring.io/browse/SPR-4379 
		if (locatorFactorySelector == null) {
			locatorFactorySelector = defaultStrategies.getProperty(ContextLoader.LOCATOR_FACTORY_SELECTOR_PARAM);
		}
		if (parentContextKey == null) {
			parentContextKey = defaultStrategies.getProperty(ContextLoader.LOCATOR_FACTORY_KEY_PARAM);
		}
		// The parent context should be a local JNDI Environment,
		// so define it in the environment of the current context.
		//  JndiLocatorDelegate 
		JndiLocatorDelegate jndiLocator = new JndiLocatorDelegate();
		if (locatorFactorySelector != null) {
			jndiLocator.setResourceRef(true);
		}
		try {
			// Use the selector and the context key to load the parent context from JNDI
			// JNDI
			Object located = jndiLocator.lookup(locatorFactorySelector, parentContextKey);
			if (located == null) {
				throw new ApplicationContextException(
						"Parent context key: '" + parentContextKey + "' not found in JNDI with selector: '" +
						locatorFactorySelector + "'");
			}
			if (!(located instanceof ApplicationContext)) {
				throw new ApplicationContextException(
						"Parent context key: '" + parentContextKey + "' in JNDI with selector: '" +
						locatorFactorySelector + "' is not of type ApplicationContext: " + located.getClass().getName());
			}
			parentContext = (ApplicationContext) located;
		} catch (NamingException ex) {
			throw new ApplicationContextException(
					"Parent context key: '" + parentContextKey + "' not found in JNDI with selector: '" +
					locatorFactorySelector + "'", ex);
		}
	}
	return parentContext;
}
```

-  [Spring  context-param  init-param ](https://blog.csdn.net/slvher/article/details/41012881) 

## 4.6 configureAndRefreshWebApplicationContext

`#configureAndRefreshWebApplicationContext(ConfigurableWebApplicationContext wac, ServletContext sc)`  WebApplicationContext 

```java
// ContextLoader.java

protected void configureAndRefreshWebApplicationContext(ConfigurableWebApplicationContext wac, ServletContext sc) {
    // <1>  wac  id 
    if (ObjectUtils.identityToString(wac).equals(wac.getId())) {
        // The application context id is still set to its original default value
        // -> assign a more useful id based on available information
        //  servletContext  contextId 
        String id = sc.getInitParameter(CONTEXT_ID_PARAM);
        if (id != null) {
            wac.setId(id);
        // 
        } else {
            // Generate default id...
            wac.setId(ConfigurableWebApplicationContext.APPLICATION_CONTEXT_ID_PREFIX +
                    ObjectUtils.getDisplayString(sc.getContextPath()));
        }
    }

    // <2>  wac  servletContext 
    wac.setServletContext(sc);
    // <3>  contextConfigLocation  Spring 
    String configLocationParam = sc.getInitParameter(CONFIG_LOCATION_PARAM);
    if (configLocationParam != null) {
        wac.setConfigLocation(configLocationParam);
    }

    // The wac environment's #initPropertySources will be called in any case when the context
    // is refreshed; do it eagerly here to ensure servlet property sources are in place for
    // use in any post-processing or initialization that occurs below prior to #refresh
    // <4> 


2025-08-25 13:18:21,649 - evaluation_logger_Attraction-147 - INFO - Complete Result: {'score': 0, 'reason': 'The response does not address any of the requested information about penguin activities or ticket availability in Cape Town or Port Elizabeth.'}
2025-08-25 13:18:27,891 - evaluation_logger_Attraction-147 - INFO - Correct Result: {'score': 0, 'reason': 'All information in the response is incorrect.'}
2025-08-25 13:18:27,891 - evaluation_logger_Attraction-147 - INFO - Message: Success.
2025-08-25 13:18:27,891 - evaluation_logger_Attraction-147 - INFO - Success turn num = 4
2025-08-25 13:18:27,891 - evaluation_logger_Attraction-147 - INFO - ----------------------------------------------------------------------------------------------------
