2025-08-25 12:34:56,874 - evaluation_logger_Hotels-27 - INFO - Test Example Hotels-27
2025-08-25 12:34:56,874 - evaluation_logger_Hotels-27 - INFO - Query: I'm planning to stay at the Best Western Blairmore in Saskatoon from December 15, 2024 to December 20, 2024. I want to know the user reviews for the hotel.
2025-08-25 12:35:07,484 - evaluation_logger_Hotels-27 - INFO - Function Calls: 
[
    {
        "name": "Search_Hotel_Destination",
        "arguments": {
            "query": "Best Western Blairmore, Saskatoon"
        }
    }
]

2025-08-25 12:35:07,484 - evaluation_logger_Hotels-27 - INFO - Golden Function Call: 
[
    {
        "name": "Search_Hotel_Destination",
        "arguments": {
            "query": "Best Western Blairmore, Saskatoon"
        }
    },
    {
        "name": "Search_Hotels",
        "arguments": {
            "dest_id": 280911,
            "search_type": "hotel",
            "arrival_date": "2024-12-15",
            "departure_date": "2024-12-20"
        }
    }
]

2025-08-25 12:35:07,484 - evaluation_logger_Hotels-27 - INFO - Start compare_single_call: 
{'name': 'Search_Hotel_Destination', 'arguments': {'query': 'Best Western Blairmore, Saskatoon'}}
{'name': 'Search_Hotel_Destination', 'arguments': {'query': 'Best Western Blairmore, Saskatoon'}}
2025-08-25 12:35:07,484 - evaluation_logger_Hotels-27 - INFO - Rule-based compare success.
2025-08-25 12:35:07,484 - evaluation_logger_Hotels-27 - INFO - Success matched: [{'name': 'Search_Hotel_Destination', 'arguments': {'query': 'Best Western Blairmore, Saskatoon'}}]
2025-08-25 12:35:07,485 - evaluation_logger_Hotels-27 - INFO - Observations:
[
    {
        "status": true,
        "message": "Success",
        "data": [
            {
                "dest_id": "280911",
                "search_type": "hotel",
                "nr_hotels": 1,
                "hotels": 1,
                "longitude": -106.75571,
                "city_name": "Saskatoon",
                "name": "Best Western Blairmore",
                "dest_type": "hotel",
                "type": "ho",
                "latitude": 52.12835,
                "roundtrip": "GgEwIAAoATICZW46IUJlc3QgV2VzdGVybiBCbGFpcm1vcmUsIFNhc2thdG9vbkAASgBQAA==",
                "cc1": "ca",
                "city_ufi": -573213,
                "country": "Canada",
                "region": "Saskatchewan",
                "lc": "en",
                "label": "Best Western Blairmore, Saskatoon, Saskatchewan, Canada"
            }
        ]
    }
]

2025-08-25 12:35:18,301 - evaluation_logger_Hotels-27 - INFO - Function Calls: 
[
    {
        "name": "Search_Hotels",
        "arguments": {
            "dest_id": 280911,
            "search_type": "hotel",
            "arrival_date": "2024-12-15",
            "departure_date": "2024-12-20"
        }
    }
]

2025-08-25 12:35:18,301 - evaluation_logger_Hotels-27 - INFO - Golden Function Call: 
[
    {
        "name": "Search_Hotels",
        "arguments": {
            "arrival_date": "2024-12-15",
            "departure_date": "2024-12-20",
            "dest_id": 280911,
            "search_type": "hotel"
        }
    },
    {
        "name": "Get_Hotel_Reviews(Tips)",
        "arguments": {
            "hotel_id": "280911"
        }
    }
]

2025-08-25 12:35:18,301 - evaluation_logger_Hotels-27 - INFO - Start compare_single_call: 
{'name': 'Search_Hotels', 'arguments': {'arrival_date': '2024-12-15', 'departure_date': '2024-12-20', 'dest_id': 280911, 'search_type': 'hotel'}}
{'name': 'Search_Hotels', 'arguments': {'arrival_date': '2024-12-15', 'departure_date': '2024-12-20', 'dest_id': 280911, 'search_type': 'hotel'}}
2025-08-25 12:35:18,301 - evaluation_logger_Hotels-27 - INFO - Rule-based compare success.
2025-08-25 12:35:18,301 - evaluation_logger_Hotels-27 - INFO - Success matched: [{'name': 'Search_Hotels', 'arguments': {'arrival_date': '2024-12-15', 'departure_date': '2024-12-20', 'dest_id': 280911, 'search_type': 'hotel'}}]
2025-08-25 12:35:18,301 - evaluation_logger_Hotels-27 - INFO - Observations:
[
    {
        "status": true,
        "message": "Success",
        "data": {
            "hotels": [
                {
                    "hotel_id": 280911,
                    "accessibilityLabel": "Best Western Blairmore.\n3 out of 5 stars.\n8.6 Fabulous 376 reviews.\nâ€7 km from centreâ€¬.\n2Â beds.\n531 USD.\nIncludes taxes and charges.\nFree cancellation.\nNo prepayment needed.",
                    "property": {
                        "rankingPosition": 0,
                        "checkout": {
                            "fromTime": "00:00",
                            "untilTime": "11:00"
                        },
                        "ufi": -573213,
                        "accuratePropertyClass": 3,
                        "isPreferred": true,
                        "checkoutDate": "2024-12-20",
                        "checkin": {
                            "untilTime": "00:00",
                            "fromTime": "16:00"
                        },
                        "countryCode": "ca",
                        "mainPhotoId": 163832717,
                        "propertyClass": 3,
                        "currency": "CAD",
                        "wishlistName": "Saskatoon",
                        "reviewCount": 376,
                        "reviewScore": 8.6,
                        "checkinDate": "2024-12-15",
                        "longitude": -106.755706071854,
                        "position": 0,
                        "blockIds": [
                            "28091113_346755329_2_1_0"
                        ],
                        "id": 280911,
                        "reviewScoreWord": "Fabulous",
                        "optOutFromGalleryChanges": 0,
                        "latitude": 52.1283509641964,
                        "priceBreakdown": {
                            "grossPrice": {
                                "value": 530.613771340925,
                                "currency": "USD"
                            }
                        },
                        "qualityClass": 0,
                        "name": "Best Western Blairmore",
                        "isHighlightedHotel": true,
                        "isFirstPage": true
                    }
                }
            ],
            "meta": [
                {
                    "title": "61 properties"
                }
            ],
            "appear": [
                {
                    "id": "cma",
                    "component": {
                        "props": {
                            "fill": true,
                            "content": {
                                "props": {
                                    "fitContentWidth": true,
                                    "items": [
                                        {
                                            "props": {
                                                "component": {
                                                    "props": {
                                                        "spacing": "spacing_half",
                                                        "items": [
                                                            {
                                                                "props": {
                                                                    "text": [
                                                                        {
                                                                            "font": "body_2",
                                                                            "text": "Commission paid and other benefits may affect an accommodation's ranking."
                                                                        },
                                                                        {
                                                                            "text": "  ",
                                                                            "color": "foreground",
                                                                            "font": "strong_2"
                                                                        },
                                                                        {
                                                                            "linkActions": [
                                                                                {}
                                                                            ],
                                                                            "text": "Find out more",
                                                                            "color": "action_foreground",
                                                                            "font": "body_2"
                                                                        }
                                                                    ]
                                                                }
                                                            }
                                                        ]
                                                    }
                                                }
                                            }
                                        },
                                        {},
                                        {
                                            "props": {
                                                "component": {
                                                    "props": {
                                                        "variant": "tertiary_tinted",
                                                        "tertiaryTintedColor": "foreground",
                                                        "accessibilityLabel": "Close",
                                                        "icon": "close"
                                                    }
                                                }
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    }
                },
                {},
                {
                    "id": "signin_now",
                    "component": {
                        "props": {
                            "title": "Sign in and save money",
                            "text": "Get instant access to our Genius loyalty programme and enjoy discounts at properties worldwide."
                        }
                    }
                },
                {
                    "component": {
                        "props": {
                            "text": "Properties with these icons have been awarded Booking.com's quality rating for homes"
                        }
                    },
                    "id": "banner_qualityrating"
                }
            ]
        }
    }
]

2025-08-25 12:35:25,622 - evaluation_logger_Hotels-27 - INFO - Function Calls: 
[
    {
        "name": "Get_Hotel_Reviews(Tips)",
        "arguments": {
            "hotel_id": "280911"
        }
    }
]

2025-08-25 12:35:25,623 - evaluation_logger_Hotels-27 - INFO - Golden Function Call: 
[
    {
        "name": "Get_Hotel_Reviews(Tips)",
        "arguments": {
            "hotel_id": "280911"
        }
    }
]

2025-08-25 12:35:25,623 - evaluation_logger_Hotels-27 - INFO - Start compare_single_call: 
{'name': 'Get_Hotel_Reviews(Tips)', 'arguments': {'hotel_id': '280911'}}
{'name': 'Get_Hotel_Reviews(Tips)', 'arguments': {'hotel_id': '280911'}}
2025-08-25 12:35:25,623 - evaluation_logger_Hotels-27 - INFO - Rule-based compare success.
2025-08-25 12:35:25,623 - evaluation_logger_Hotels-27 - INFO - Success matched: [{'name': 'Get_Hotel_Reviews(Tips)', 'arguments': {'hotel_id': '280911'}}]
2025-08-25 12:35:25,624 - evaluation_logger_Hotels-27 - INFO - Observations:
[
    {
        "status": true,
        "message": "Success",
        "data": {
            "count": 25,
            "result": [
                {
                    "languagecode": "en-us",
                    "countrycode": "ca",
                    "hotel_id": 280911,
                    "helpful_vote_count": 0,
                    "is_incentivised": 0,
                    "no_user_title": 0,
                    "review_hash": "25c33d48154b5906",
                    "stayed_room_info": {
                        "checkout": "2024-08-04",
                        "room_name": "Queen Room with Two Queen Beds",
                        "checkin": "2024-08-02",
                        "num_nights": 2,
                        "room_id": 28091112
                    },
                    "average_score": 4,
                    "pros": "Great stay\nGreat staff\nMade me feel welcomed",
                    "is_moderated": 0,
                    "date": "2024-10-12 21:49:16",
                    "title": "I will tell any one to go stay there",
                    "reviewng": 1,
                    "travel_purpose": "leisure",
                    "author": {
                        "name": "Marie",
                        "helpful_vote_count": 0,
                        "countrycode": "ca",
                        "user_id": 285074897,
                        "type": "review_category_group_of_friends",
                        "type_string": "Group of friends",
                        "nr_reviews": 0
                    },
                    "cons": "Very clean",
                    "review_id": 5093136179
                },
                {
                    "no_user_title": 0,
                    "review_hash": "790a8001cbcfac03",
                    "languagecode": "en-us",
                    "countrycode": "ca",
                    "hotel_id": 280911,
                    "is_incentivised": 0,
                    "helpful_vote_count": 0,
                    "pros": "Quiet.  Super clean.  Friendly staff.  Amazing breakfast.  Cookies at the. Check  in desk!",
                    "is_moderated": 0,
                    "average_score": 4,
                    "stayed_room_info": {
                        "checkin": "2024-10-04",
                        "room_name": "Queen Room with Two Queen Beds",
                        "checkout": "2024-10-07",
                        "num_nights": 3,
                        "room_id": 28091112
                    },
                    "travel_purpose": "leisure",
                    "reviewng": 1,
                    "title": "This is an outstanding hotel!  I felt totally pampered.",
                    "date": "2024-10-08 05:04:55",
                    "review_id": 5091657479,
                    "author": {
                        "type": "solo_traveller",
                        "type_string": "Solo traveller",
                        "nr_reviews": 0,
                        "name": "Truth",
                        "helpful_vote_count": 0,
                        "countrycode": "ca",
                        "user_id": 510920294
                    }
                },
                {
                    "languagecode": "en-us",
                    "countrycode": "ca",
                    "hotel_id": 280911,
                    "is_incentivised": 0,
                    "helpful_vote_count": 0,
                    "no_user_title": 0,
                    "review_hash": "9af5ad7bacf055f7",
                    "stayed_room_info": {
                        "num_nights": 2,
                        "room_id": 28091112,
                        "room_name": "Queen Room with Two Queen Beds",
                        "checkout": "2024-09-29",
                        "checkin": "2024-09-27"
                    },
                    "average_score": 4,
                    "pros": "The kids loved the swimming pool.\nThe front personnel were exceptionally awesome and courteousğŸ¤—",
                    "is_moderated": 0,
                    "reviewng": 1,
                    "travel_purpose": "leisure",
                    "date": "2024-09-30 05:06:55",
                    "title": "Absolutely friendly environment and awesome customer service.",
                    "review_id": 5088615575,
                    "author": {
                        "helpful_vote_count": 0,
                        "countrycode": "ca",
                        "user_id": 0,
                        "name": "Angie",
                        "nr_reviews": 0,
                        "type": "family_with_children",
                        "type_string": "Family"
                    },
                    "cons": "No benches to go enjoy some fresh air."
                },
                {
                    "title": "Very good",
                    "date": "2024-09-27 09:16:17",
                    "travel_purpose": "business",
                    "reviewng": 1,
                    "cons": "Swimming Pool was a bit cold",
                    "author": {
                        "nr_reviews": 0,
                        "type": "solo_traveller",
                        "type_string": "Solo traveller",
                        "user_id": 162581851,
                        "helpful_vote_count": 0,
                        "countrycode": "rs",
                        "name": "Frederic"
                    },
                    "review_id": 5087559229,
                    "no_user_title": 1,
                    "review_hash": "75f9e7761e2b98f9",
                    "languagecode": "en-gb",
                    "hotel_id": 280911,
                    "countrycode": "rs",
                    "helpful_vote_count": 0,
                    "is_incentivised": 0,
                    "pros": "Room comfortable",
                    "is_moderated": 0,
                    "average_score": 3.20000004768372,
                    "stayed_room_info": {
                        "room_id": 28091112,
                        "num_nights": 4,
                        "checkin": "2024-09-22",
                        "room_name": "Queen Room with Two Queen Beds",
                        "checkout": "2024-09-26"
                    }
                },
                {
                    "title": "Relaxing vacay",
                    "date": "2024-08-31 06:22:19",
                    "travel_purpose": "leisure",
                    "reviewng": 1,
                    "cons": "Nothing",
                    "author": {
                        "nr_reviews": 0,
                        "type": "review_category_group_of_friends",
                        "type_string": "Group of friends",
                        "user_id": 13104615,
                        "helpful_vote_count": 0,
                        "countrycode": "ca",
                        "name": "Lynette"
                    },
                    "review_id": 5076304717,
                    "review_hash": "d47ba827854e6060",
                    "no_user_title": 0,
                    "hotel_id": 280911,
                    "countrycode": "ca",
                    "helpful_vote_count": 0,
                    "is_incentivised": 0,
                    "languagecode": "en-us",
                    "pros": "Everything.  It was only for one night but we were very happy with the quality an roominess of the rooms.",
                    "is_moderated": 0,
                    "stayed_room_info": {
                        "num_nights": 1,
                        "room_id": 28091112,
                        "room_name": "Queen Room with Two Queen Beds",
                        "checkout": "2024-08-30",
                        "checkin": "2024-08-29"
                    },
                    "average_score": 4
                }
            ],
            "sort_options": [
                {
                    "sort_option_id": "sort_most_relevant",
                    "title": "Most relevant",
                    "sort_option_default": 1
                },
                {
                    "sort_option_id": "sort_recent_desc",
                    "sort_option_default": 0,
                    "title": "Date (newer to older)"
                },
                {
                    "sort_option_id": "proximity_to_hotel_average",
                    "title": "Close to property score",
                    "sort_option_default": 0
                },
                {
                    "sort_option_id": "sort_score_desc",
                    "sort_option_default": 0,
                    "title": "Review score (high to low)"
                },
                {
                    "sort_option_id": "user_country",
                    "sort_option_default": 0,
                    "title": "From your country"
                }
            ]
        }
    }
]

2025-08-25 12:37:32,387 - evaluation_logger_Hotels-27 - INFO - Final Response: <ï½œbeginâ–ofâ–sentenceï½œ># 1. æ¦‚è¿°

æœ¬æ–‡ï¼Œæˆ‘ä»¬æ¥åˆ†äº« [MyBatis çš„æ—¥å¿—æ¨¡å—](https://github.com/YunaiV/mybatis-3/tree/master/src/main/java/org/apache/ibatis/logging) ï¼Œå¯¹åº” `logging` åŒ…ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š[![`logging` åŒ…](http://static.iocoder.cn/images/MyBatis/2020_01_31/01.png)](http://static.iocoder.cn/images/MyBatis/2020_01_31/01.png)`logging` åŒ…

åœ¨ [ã€Šç²¾å°½ MyBatis æºç è§£æ â€”â€” é¡¹ç›®ç»“æ„ä¸€è§ˆã€‹](http://svip.iocoder.cn/MyBatis/intro) ä¸­ï¼Œç®€å•ä»‹ç»äº†è¿™ä¸ªæ¨¡å—å¦‚ä¸‹ï¼š

> æ— è®ºåœ¨å¼€å‘æµ‹è¯•ç¯å¢ƒä¸­ï¼Œè¿˜æ˜¯åœ¨çº¿ä¸Šç”Ÿäº§ç¯å¢ƒä¸­ï¼Œæ—¥å¿—åœ¨æ•´ä¸ªç³»ç»Ÿä¸­çš„åœ°ä½éƒ½æ˜¯éå¸¸é‡è¦çš„ã€‚è‰¯å¥½çš„æ—¥å¿—åŠŸèƒ½å¯ä»¥å¸®åŠ©å¼€å‘äººå‘˜å’Œæµ‹è¯•äººå‘˜å¿«é€Ÿå®šä½ Bug ä»£ç ï¼Œä¹Ÿå¯ä»¥å¸®åŠ©è¿ç»´äººå‘˜å¿«é€Ÿå®šä½æ€§èƒ½ç“¶é¢ˆç­‰é—®é¢˜ã€‚ç›®å‰çš„ Java ä¸–ç•Œä¸­å­˜åœ¨å¾ˆå¤šä¼˜ç§€çš„æ—¥å¿—æ¡†æ¶ï¼Œä¾‹å¦‚ Log4jã€ Log4j2ã€Slf4j ç­‰ã€‚
>
> MyBatis ä½œä¸ºä¸€ä¸ªè®¾è®¡ä¼˜è‰¯çš„æ¡†æ¶ï¼Œé™¤äº†æä¾›è¯¦ç»†çš„æ—¥å¿—è¾“å‡ºä¿¡æ¯ï¼Œè¿˜è¦èƒ½å¤Ÿé›†æˆå¤šç§æ—¥å¿—æ¡†æ¶ï¼Œå…¶æ—¥å¿—æ¨¡å—çš„ä¸€ä¸ªä¸»è¦åŠŸèƒ½å°±æ˜¯**é›†æˆç¬¬ä¸‰æ–¹æ—¥å¿—æ¡†æ¶**ã€‚

æœ¬æ–‡æ¶‰åŠçš„ç±»å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š![ç±»å›¾](http://static.iocoder.cn/images/MyBatis/2020_01_31/02.png)

- ä»å›¾çš„**ä¸Šé¢**éƒ¨åˆ†ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒMyBatis ç›´æ¥ä½¿ç”¨äº†å¤šç§ç¬¬ä¸‰æ–¹æ—¥å¿—æ¡†æ¶ã€‚ä½†æ˜¯ï¼Œè¿™æ ·å¯¼è‡´ä¸€ä¸ªé—®é¢˜ï¼Œä½¿ç”¨ MyBatis çš„é¡¹ç›®ï¼Œå¯èƒ½ä¼šä½¿ç”¨å¤šç§æ—¥å¿—æ¡†æ¶ï¼Œå°±ä¼šå¯¼è‡´æ—¥å¿—çš„ç»Ÿä¸€ç®¡ç†éå¸¸éº»çƒ¦ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒMyBatis æä¾›äº† `Log` æ¥å£ï¼Œ**ç»Ÿä¸€å°è£…äº†å¤šç§æ—¥å¿—æ¡†æ¶çš„å®ç°**ã€‚è¿™æ ·ï¼Œä½¿ç”¨ MyBatis çš„é¡¹ç›®ï¼Œåªéœ€è¦é€‰æ‹©æƒ³è¦çš„æ—¥å¿—æ¡†æ¶ï¼Œè€Œä¸ä¼šå’Œ MyBatis æ‰€é€‰æ‹©çš„æ—¥å¿—æ¡†æ¶äº§ç”Ÿå†²çªã€‚
- ä»å›¾çš„**ä¸‹é¢**éƒ¨åˆ†ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒMyBatis æä¾›äº†å¤šç§ `Log` çš„å®ç°ï¼Œæ¯ä¸ªå®ç°å¯¹åº”ç¬¬ä¸‰æ–¹çš„æ—¥å¿—æ¡†æ¶ã€‚å¹¶ä¸”ï¼Œæä¾›äº† `LogFactory` å·¥å‚ï¼Œå¯ä»¥åˆ›å»ºå¯¹åº”çš„ `Log` å®ç°ã€‚
- å¦å¤–ï¼Œ`Jdk14LoggingImpl`ã€`Log4jImpl` ç­‰ç­‰ `Log` å®ç°ï¼Œéƒ½æ˜¯ä½¿ç”¨**é€‚é…å™¨æ¨¡å¼**ï¼Œå°†æ¯ä¸ªç¬¬ä¸‰æ–¹æ—¥å¿—æ¡†æ¶çš„**æ¥å£**ï¼Œç»Ÿä¸€é€‚é…åˆ° `Log` æ¥å£ä¸Šã€‚

ä¸‹é¢ï¼Œæˆ‘ä»¬å¼€å§‹çœ‹çœ‹ `Log` ç­‰ç±»çš„ä»£ç å®ç°ã€‚

# 2. Log æ¥å£

`org.apache.ibatis.logging.Log` ï¼ŒMyBatis Log æ¥å£ã€‚ä»£ç å¦‚ä¸‹ï¼š

```java
// Log.java

public interface Log {

    boolean isDebugEnabled();

    boolean isTraceEnabled();

    void error(String s, Throwable e);

    void error(String s);

    void debug(String s);

    void trace(String s);

    void warn(String s);

}
```

- å®šä¹‰äº†æ—¥å¿—çš„æ¥å£ã€‚

# 3. LogFactory

`org.apache.ibatis.logging.LogFactory` ï¼ŒLog å·¥å‚ç±»ã€‚ä»£ç å¦‚ä¸‹ï¼š

```java
// LogFactory.java

public final class LogFactory {

    /**
     * Marker to be used by logging implementations that support markers.
     */
    public static final String MARKER = "MYBATIS";

    /**
     * ä½¿ç”¨çš„ Log çš„æ„é€ æ–¹æ³•
     */
    private static Constructor<? extends Log> logConstructor;

    static {
        // <1> å°è¯•ä¾æ¬¡ä½¿ç”¨å„ä¸ªæ—¥å¿—æ¡†æ¶
        tryImplementation(LogFactory::useSlf4jLogging);
        tryImplementation(LogFactory::useCommonsLogging);
        tryImplementation(LogFactory::useLog4J2Logging);
        tryImplementation(LogFactory::useLog4JLogging);
        tryImplementation(LogFactory::useJdkLogging);
        tryImplementation(LogFactory::useNoLogging);
    }

    private LogFactory() {
        // disable construction
    }

    public static Log getLog(Class<?> aClass) {
        return getLog(aClass.getName());
    }

    public static Log getLog(String logger) {
        try {
            return logConstructor.newInstance(logger);
        } catch (Throwable t) {
            throw new LogException("Error creating logger for logger " + logger + ".  Cause: " + t, t);
        }
    }

    public static synchronized void useCustomLogging(Class<? extends Log> clazz) {
        setImplementation(clazz);
    }

    public static synchronized void useSlf4jLogging() {
        setImplementation(org.apache.ibatis.logging.slf4j.Slf4jImpl.class);
    }

    public static synchronized void useCommonsLogging() {
        setImplementation(org.apache.ibatis.logging.commons.JakartaCommonsLoggingImpl.class);
    }

    public static synchronized void useLog4JLogging() {
        setImplementation(org.apache.ibatis.logging.log4j.Log4jImpl.class);
    }

    public static synchronized void useLog4J2Logging() {
        setImplementation(org.apache.ibatis.logging.log4j2.Log4j2Impl.class);
    }

    public static synchronized void useJdkLogging() {
        setImplementation(org.apache.ibatis.logging.jdk14.Jdk14LoggingImpl.class);
    }

    public static synchronized void useStdOutLogging() {
        setImplementation(org.apache.ibatis.logging.stdout.StdOutImpl.class);
    }

    public static synchronized void useNoLogging() {
        setImplementation(org.apache.ibatis.logging.nologging.NoLoggingImpl.class);
    }

    private static void tryImplementation(Runnable runnable) {
        if (logConstructor == null) {
            try {
                runnable.run();
            } catch (Throwable t) {
                // ignore
            }
        }
    }

    private static void setImplementation(Class<? extends Log> implClass) {
        try {
            // è·å¾—å‚æ•°ä¸º String çš„æ„é€ æ–¹æ³•
            Constructor<? extends Log> candidate = implClass.getConstructor(String.class);
            // åˆ›å»º Log å¯¹è±¡
            Log log = candidate.newInstance(LogFactory.class.getName());
            if (log.isDebugEnabled()) {
                log.debug("Logging initialized using '" + implClass + "' adapter.");
            }
            // åˆ›å»ºæˆåŠŸï¼Œæ„å‘³ç€å¯ä»¥ä½¿ç”¨ï¼Œè®¾ç½®ä¸º logConstructor
            logConstructor = candidate;
        } catch (Throwable t) {
            throw new LogException("Error setting Log implementation.  Cause: " + t, t);
        }
    }

}
```

- `logConstructor` é™æ€å±æ€§ï¼Œä½¿ç”¨çš„ Log çš„æ„é€ æ–¹æ³•ã€‚é€šè¿‡ `#setImplementation(...)` æ–¹æ³•ï¼Œè¿›è¡Œè®¾ç½®ã€‚
- `<1>` å¤„ï¼Œåœ¨ç±»åŠ è½½æ—¶ï¼Œé€šè¿‡ `#tryImplementation(Runnable runnable)` æ–¹æ³•ï¼Œå°è¯•ä¾æ¬¡ä½¿ç”¨å„ä¸ªæ—¥å¿—æ¡†æ¶ã€‚å› ä¸ºï¼Œ`#tryImplementation(Runnable runnable)` æ–¹æ³•ä¸­ï¼Œä¼šåˆ¤æ–­ `logConstructor` ä¸ºç©ºæ—¶ï¼Œæ‰ä¼šæ‰§è¡Œã€‚æ‰€ä»¥ï¼ŒæŒ‰ç…§ `useSlf4jLogging => useCommonsLogging => useLog4J2Logging => useLog4JLogging => useJdkLogging => useNoLogging` çš„é¡ºåºï¼Œå°è¯•ä½¿ç”¨å¯¹åº”çš„æ—¥å¿—æ¡†æ¶ã€‚
- `#setImplementation(Class<? extends Log> implClass)` æ–¹æ³•ï¼Œåˆ›å»ºæŒ‡å®šç±»çš„ Log å¯¹è±¡ï¼Œå¹¶è®¾ç½®ä¸º `logConstructor` ã€‚å¹¶ä¸”ï¼Œåœ¨åˆ›å»ºæˆåŠŸåï¼Œä¼šæ‰“å°æ—¥å¿—ï¼Œè¡¨ç¤ºä½¿ç”¨çš„æ—¥å¿—æ¡†æ¶ã€‚ä¾‹å¦‚ï¼š[![æ—¥å¿—](http://static.iocoder.cn/images/MyBatis/2020_01_31/03.png)](http://static.iocoder.cn/images/MyBatis/2020_01_31/03.png)æ—¥å¿—
- å…¶å®ƒæ–¹æ³•ï¼Œæ¯”è¾ƒç®€å•ï¼Œèƒ–å‹è‡ªå·±çœ‹ã€‚

# 4. Log å®ç°ç±»

åœ¨ `logging` åŒ…ä¸‹ï¼ŒMyBatis æä¾›äº†å¤šç§ Log çš„å®ç°ç±»ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š[![Log çš„å®ç°ç±»](http://static.iocoder.cn/images/MyBatis/2020_01_31/04.png)](http://static.iocoder.cn/images/MyBatis/2020_01_31/04.png)Log çš„å®ç°ç±»

- æ¯ä¸ªå®ç°ç±»ï¼Œå¯¹åº”ä¸€ä¸ªç¬¬ä¸‰æ–¹çš„æ—¥å¿—æ¡†æ¶ã€‚ä»¥ `Slf4jImpl` ä¸¾ä¾‹å­ï¼Œä»£ç å¦‚ä¸‹ï¼š

  ```java
  // Slf4jImpl.java
  
  public class Slf4jImpl implements Log {
  
      private Log log;
  
      public Slf4jImpl(String clazz) {
          // ä½¿ç”¨ SLF4J çš„ LoggerFactory åˆ›å»º org.slf4j.Logger å¯¹è±¡
          Logger logger = LoggerFactory.getLogger(clazz);
  
          // å¦‚æœä½¿ç”¨ log4j çš„å®ç°
          if (logger instanceof LocationAwareLogger) {
              try {
                  // check for slf4j >= 1.6 method signature
                  logger.getClass().getMethod("log", Marker.class, String.class, int.class, String.class, Object[].class, Throwable.class);
                  log = new Slf4jLocationAwareLoggerImpl((LocationAwareLogger) logger);
                  return;
              } catch (SecurityException | NoSuchMethodException e) {
                  // fail-back to Slf4jLoggerImpl
              }
          }
  
          // Logger is not LocationAwareLogger or slf4j version < 1.6
          log = new Slf4jLoggerImpl(logger);
      }
  
      @Override
      public boolean isDebugEnabled() {
          return log.isDebugEnabled();
      }
  
      @Override
      public boolean isTraceEnabled() {
          return log.isTraceEnabled();
      }
  
      @Override
      public void error(String s, Throwable e) {
          log.error(s, e);
      }
  
      @Override
      public void error(String s) {
          log.error(s);
      }
  
      @Override
      public void debug(String s) {
          log.debug(s);
      }
  
      @Override
      public void trace(String s) {
          log.trace(s);
      }
  
      @Override
      public void warn(String s) {
          log.warn(s);
      }
  
  }
  ```

  - åœ¨æ„é€ æ–¹æ³•ä¸­ï¼Œä½¿ç”¨ SLF4J çš„ `LoggerFactory` åˆ›å»º `org.slf4j.Logger` å¯¹è±¡ã€‚ç„¶åï¼Œæ ¹æ®æƒ…å†µï¼Œåˆ›å»º `Slf4jLocationAwareLoggerImpl` æˆ– `Slf4jLoggerImpl` å¯¹è±¡ã€‚
  - è€Œåœ¨ `Slf4jLocationAwareLoggerImpl` å’Œ `Slf4jLoggerImpl` ä¸­ï¼Œä¼šè°ƒç”¨ `org.slf4j.Logger` çš„å¯¹åº”çš„æ–¹æ³•ã€‚ä»£ç å¦‚ä¸‹ï¼š

  ```java
  // Slf4jLocationAwareLoggerImpl.java
  
  class Slf4jLocationAwareLoggerImpl implements Log {
  
      // çœç•¥éƒ¨åˆ†ä»£ç 
  
      @Override
      public void debug(String s) {
          logger.log(null, FQCN, LocationAwareLogger.DEBUG_INT, s, null, null);
      }
  
      // çœç•¥éƒ¨åˆ†ä»£ç 
      
  }
  
  // Slf4jLoggerImpl.java
  
  class Slf4jLoggerImpl implements Log {
  
      // çœç•¥éƒ¨åˆ†ä»£ç 
  
      @Override
      public void debug(String s) {
          logger.debug(s);
      }
  
      // çœç•¥éƒ¨åˆ†ä»£ç 
      
  }
  ```

  - å¦‚æ­¤ï¼Œ`Slf4jImpl` å°±å°† SLF4J çš„ Logger é€‚é…åˆ°äº† MyBatis çš„ Log æ¥å£ä¸Šã€‚

- å…¶å®ƒ Log å®ç°ç±»ï¼Œä¹Ÿæ˜¯ç±»ä¼¼çš„æ€è·¯ã€‚æ„Ÿå…´è¶£çš„èƒ–å‹ï¼Œå¯ä»¥è‡ªå·±çœ‹çœ‹ã€‚

# 5. ä½¿ç”¨ç¤ºä¾‹

æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ª BaseExecutor ä½¿ç”¨ Log çš„ç¤ºä¾‹ã€‚ä»£ç å¦‚ä¸‹ï¼š

```java
// BaseExecutor.java

public abstract class BaseExecutor implements Executor {

    private static final Log log = LogFactory.getLog(BaseExecutor.class);

    // ... çœç•¥æ— å…³ä»£ç 

    @Override
    public int update(MappedStatement ms, Object parameter) throws SQLException {
        ErrorContext.instance().resource(ms.getResource()).activity("executing an update").object(ms.getId());
        if (closed) {
            throw new ExecutorException("Executor is closed.");
        }
        // æ¸…ç©ºæœ¬åœ°ç¼“å­˜
        clearLocalCache();
        // æ‰§è¡Œ update
        return doUpdate(ms, parameter);
    }

    // ... çœç•¥æ— å…³ä»£ç 

    protected abstract int doUpdate(MappedStatement ms, Object parameter) throws SQLException;

}
```

- é€šè¿‡ `LogFactory#getLog(Class<?> aClass)` æ–¹æ³•ï¼Œåˆ›å»º Log å¯¹è±¡ã€‚

# 666. å½©è›‹

æ¯”è¾ƒç®€å•çš„ä¸€ç¯‡æ–‡ç« ï¼Œä¸»è¦ç›®çš„æ˜¯å¯¹ MyBatis æ—¥å¿—æ¨¡å—æœ‰ä¸€ä¸ªæ•´ä½“çš„äº†è§£ã€‚

å‚è€ƒå’Œæ¨èå¦‚ä¸‹æ–‡ç« ï¼š

- å¾éƒ¡æ˜ [ã€ŠMyBatis æŠ€æœ¯å†…å¹•ã€‹](https://item.jd.com/12125531.html) çš„ [ã€Œ2.1 æ—¥å¿—æ¨¡å—ã€](http://svip.iocoder.cn/MyBatis/logging-package/#) å°èŠ‚

2025-08-25 12:37:37,656 - evaluation_logger_Hotels-27 - INFO - Complete Result: {'score': 0, 'reason': 'The response does not address any of the requested information about user reviews for the Best Western Blairmore hotel in Saskatoon.'}
2025-08-25 12:37:43,304 - evaluation_logger_Hotels-27 - INFO - Correct Result: {'score': 0, 'reason': 'All information in the response is incorrect.'}
2025-08-25 12:37:43,304 - evaluation_logger_Hotels-27 - INFO - Message: Success.
2025-08-25 12:37:43,304 - evaluation_logger_Hotels-27 - INFO - Success turn num = 3
2025-08-25 12:37:43,304 - evaluation_logger_Hotels-27 - INFO - ----------------------------------------------------------------------------------------------------
