2025-08-25 13:08:55,580 - evaluation_logger_Attraction-107 - INFO - Test Example Attraction-107
2025-08-25 13:08:55,580 - evaluation_logger_Attraction-107 - INFO - Query: Could you find some tour routes in Cairo and provide detailed information about the sightseeing activities?
2025-08-25 13:09:03,592 - evaluation_logger_Attraction-107 - INFO - Function Calls: 
[
    {
        "name": "Search_Attraction_Location",
        "arguments": {
            "query": "Cairo"
        }
    }
]

2025-08-25 13:09:03,592 - evaluation_logger_Attraction-107 - INFO - Golden Function Call: 
[
    {
        "name": "Search_Attraction_Location",
        "arguments": {
            "query": "Cairo"
        }
    },
    {
        "name": "Search_Attractions",
        "arguments": {
            "id": "eyJ1ZmkiOi0yOTA2OTJ9"
        }
    }
]

2025-08-25 13:09:03,592 - evaluation_logger_Attraction-107 - INFO - Start compare_single_call: 
{'name': 'Search_Attraction_Location', 'arguments': {'query': 'Cairo'}}
{'name': 'Search_Attraction_Location', 'arguments': {'query': 'Cairo'}}
2025-08-25 13:09:03,592 - evaluation_logger_Attraction-107 - INFO - Rule-based compare success.
2025-08-25 13:09:03,592 - evaluation_logger_Attraction-107 - INFO - Success matched: [{'name': 'Search_Attraction_Location', 'arguments': {'query': 'Cairo'}}]
2025-08-25 13:09:03,593 - evaluation_logger_Attraction-107 - INFO - Observations:
[
    {
        "status": true,
        "message": "Success",
        "data": {
            "destinations": [
                {
                    "id": "eyJ1ZmkiOi0yOTA2OTJ9",
                    "__typename": "AttractionsSearchDestinationSuggestion",
                    "ufi": -290692,
                    "country": "Egypt",
                    "cityName": "Cairo",
                    "productCount": 8571,
                    "cc1": "eg"
                },
                {
                    "id": "eyJ1ZmkiOi0yOTAwMjl9",
                    "__typename": "AttractionsSearchDestinationSuggestion",
                    "ufi": -290029,
                    "country": "Egypt",
                    "cityName": "Hurghada",
                    "productCount": 3124,
                    "cc1": "eg"
                }
            ]
        }
    }
]

2025-08-25 13:09:14,569 - evaluation_logger_Attraction-107 - INFO - Function Calls: 
[
    {
        "name": "Search_Attractions",
        "arguments": {
            "id": "eyJ1ZmkiOi0yOTA2OTJ9",
            "sortBy": "trending"
        }
    }
]

2025-08-25 13:09:14,569 - evaluation_logger_Attraction-107 - INFO - Golden Function Call: 
[
    {
        "name": "Search_Attractions",
        "arguments": {
            "id": "eyJ1ZmkiOi0yOTA2OTJ9"
        }
    },
    {
        "name": "Get_Attraction_Details",
        "arguments": {
            "slug": "prlcwyz2hhh9-budget-sunset-desert-safari-trip-by-quad-bike-in-hurghada"
        }
    }
]

2025-08-25 13:09:15,243 - evaluation_logger_Attraction-107 - INFO - Start compare_single_call: 
{'name': 'Search_Attractions', 'arguments': {'id': 'eyJ1ZmkiOi0yOTA2OTJ9', 'sortBy': 'trending'}}
{'name': 'Search_Attractions', 'arguments': {'id': 'eyJ1ZmkiOi0yOTA2OTJ9'}}
2025-08-25 13:09:19,272 - evaluation_logger_Attraction-107 - INFO - Response-based compare success.
2025-08-25 13:09:19,272 - evaluation_logger_Attraction-107 - INFO - Success matched: [{'name': 'Search_Attractions', 'arguments': {'id': 'eyJ1ZmkiOi0yOTA2OTJ9'}}]
2025-08-25 13:09:19,272 - evaluation_logger_Attraction-107 - INFO - Observations:
[
    {
        "status": true,
        "message": "Success",
        "data": {
            "__typename": "AttractionsProductSearchResponse",
            "products": [
                {
                    "__typename": "AttractionsProduct",
                    "cancellationPolicy": {
                        "__typename": "AttractionsCancellationPolicy",
                        "hasFreeCancellation": true
                    },
                    "id": "PRlcWYZ2hHH9",
                    "name": "Cairo Nile Dinner Cruise with entertainment shows include pickup",
                    "slug": "prlcwyz2hhh9-budget-sunset-desert-safari-trip-by-quad-bike-in-hurghada",
                    "shortDescription": "Experience a magical evening on the Nile with our Night Dinner Cruise featuring an Open Buffet Di...",
                    "representativePrice": {
                        "__typename": "AttractionsPrice",
                        "chargeAmount": 11,
                        "currency": "USD",
                        "publicAmount": 11
                    },
                    "reviewsStats": {
                        "__typename": "AttractionsProductReviewStats",
                        "allReviewsCount": 0,
                        "percentage": "0",
                        "combinedNumericStats": {
                            "__typename": "AttractionsProductCombinedReviewStats",
                            "average": 4.3,
                            "total": 494
                        }
                    },
                    "ufiDetails": {
                        "__typename": "AttractionLocationResponse",
                        "bCityName": "Cairo",
                        "ufi": -290692
                    },
                    "offers": [
                        {
                            "__typename": "Offer",
                            "items": [
                                {
                                    "__typename": "OfferItem",
                                    "id": "OIL1uyqktHhq"
                                },
                                {
                                    "__typename": "OfferItem",
                                    "id": "OI5lyJ2kN8YH"
                                },
                                {
                                    "__typename": "OfferItem",
                                    "id": "OI465wgPrt23"
                                }
                            ]
                        }
                    ],
                    "supportedFeatures": {
                        "__typename": "AttractionsProductSupportedFeatures",
                        "nativeApp": true
                    },
                    "flags": [
                        {
                            "__typename": "AttractionsProductFlags",
                            "flag": "bestseller",
                            "value": true,
                            "rank": 1
                        }
                    ]
                }
            ],
            "filterStats": {
                "__typename": "FilterStats",
                "unfilteredProductCount": 8569,
                "filteredProductCount": 8569
            },
            "sorters": [
                {
                    "__typename": "AttractionsSorterOption",
                    "name": "Our top picks",
                    "value": "trending"
                },
                {
                    "__typename": "AttractionsSorterOption",
                    "name": "Most popular",
                    "value": "attr_book_score"
                },
                {
                    "__typename": "AttractionsSorterOption",
                    "name": "Lowest price",
                    "value": "lowest_price"
                }
            ],
            "defaultSorter": {
                "__typename": "AttractionsSorterOption",
                "name": "Our top picks",
                "value": "trending"
            },
            "filterOptions": {
                "__typename": "FilterOptions",
                "typeFilters": [
                    {
                        "__typename": "FilterOption",
                        "name": "Tours",
                        "tagname": "tours",
                        "productCount": 698
                    },
                    {
                        "__typename": "FilterOption",
                        "name": "Museums, arts & culture",
                        "tagname": "museums-arts-culture",
                        "productCount": 568
                    },
                    {
                        "__typename": "FilterOption",
                        "name": "Nature & outdoor",
                        "tagname": "nature-outdoor",
                        "productCount": 141
                    },
                    {
                        "__typename": "FilterOption",
                        "name": "Entertainment & tickets",
                        "tagname": "entertainment-tickets",
                        "productCount": 80
                    },
                    {
                        "__typename": "FilterOption",
                        "name": "Food & drinks",
                        "tagname": "food-drinks",
                        "productCount": 21
                    }
                ],
                "labelFilters": [
                    {
                        "__typename": "FilterOption",
                        "name": "Free cancellation",
                        "tagname": "free_cancellation",
                        "productCount": 8378
                    }
                ],
                "ufiFilters": [
                    {
                        "__typename": "FilterOption",
                        "name": "Cairo",
                        "tagname": "-290692",
                        "productCount": 7476
                    },
                    {
                        "__typename": "FilterOption",
                        "name": "Giza",
                        "tagname": "900061933",
                        "productCount": 1093
                    }
                ],
                "priceFilters": [
                    {
                        "__typename": "FilterOption",
                        "name": "US$0 - US$22",
                        "tagname": "b0",
                        "productCount": 444
                    },
                    {
                        "__typename": "FilterOption",
                        "name": "US$22 - US$44",
                        "tagname": "b1",
                        "productCount": 1212
                    },
                    {
                        "__typename": "FilterOption",
                        "name": "US$44 - US$83",
                        "tagname": "b2",
                        "productCount": 2237
                    },
                    {
                        "__typename": "FilterOption",
                        "name": "US$83 - US$138",
                        "tagname": "b3",
                        "productCount": 1735
                    },
                    {
                        "__typename": "FilterOption",
                        "name": "US$138+",
                        "tagname": "b4",
                        "productCount": 3038
                    }
                ]
            }
        }
    }
]

2025-08-25 13:09:29,996 - evaluation_logger_Attraction-107 - INFO - Function Calls: 
[
    {
        "name": "Get_Attraction_Details",
        "arguments": {
            "slug": "prlcwyz2hhh9-budget-sunset-desert-safari-trip-by-quad-bike-in-hurghada"
        }
    }
]

2025-08-25 13:09:29,996 - evaluation_logger_Attraction-107 - INFO - Golden Function Call: 
[
    {
        "name": "Get_Attraction_Details",
        "arguments": {
            "slug": "prlcwyz2hhh9-budget-sunset-desert-safari-trip-by-quad-bike-in-hurghada"
        }
    }
]

2025-08-25 13:09:29,996 - evaluation_logger_Attraction-107 - INFO - Start compare_single_call: 
{'name': 'Get_Attraction_Details', 'arguments': {'slug': 'prlcwyz2hhh9-budget-sunset-desert-safari-trip-by-quad-bike-in-hurghada'}}
{'name': 'Get_Attraction_Details', 'arguments': {'slug': 'prlcwyz2hhh9-budget-sunset-desert-safari-trip-by-quad-bike-in-hurghada'}}
2025-08-25 13:09:29,996 - evaluation_logger_Attraction-107 - INFO - Rule-based compare success.
2025-08-25 13:09:29,996 - evaluation_logger_Attraction-107 - INFO - Success matched: [{'name': 'Get_Attraction_Details', 'arguments': {'slug': 'prlcwyz2hhh9-budget-sunset-desert-safari-trip-by-quad-bike-in-hurghada'}}]
2025-08-25 13:09:29,997 - evaluation_logger_Attraction-107 - INFO - Observations:
[
    {
        "status": true,
        "message": "Success",
        "data": {
            "__typename": "AttractionsProduct",
            "additionalInfo": "Public transportation options are available nearby\n\nSpecialized infant seats are available\n\nSuitable for all physical fitness levels\n\nYou will find our tour guide/representative in the Lobby area holding a sign that shows our Company name\n\nNot wheelchair accessible\n\nPlease bring your ticket with you to the attraction.\n\nBe aware that operators may cancel for unforeseen reasons.\n\nYou need to be 18 years or older to book or be accompanied by an adult. ",
            "applicableTerms": [
                {
                    "__typename": "TermsConditions",
                    "policyProvider": "Booking.com"
                },
                {
                    "__typename": "TermsConditions",
                    "policyProvider": "Viator"
                }
            ],
            "cancellationPolicy": {
                "__typename": "AttractionsCancellationPolicy",
                "hasFreeCancellation": true
            },
            "description": "Experience a magical evening on the Nile with our Night Dinner Cruise featuring an Open Buffet Dinner with all taxes and services included. Sit back and enjoy the mesmerizing Belly Dancing and Tanura Shows on board. Let us take care of your transportation with convenient Pickup and drop off Transfers for a seamless experience.",
            "flags": [
                {
                    "__typename": "AttractionsProductFlags",
                    "flag": "bestseller",
                    "value": true,
                    "rank": 1
                }
            ],
            "id": "PRlcWYZ2hHH9",
            "isBookable": true,
            "labels": [
                {
                    "__typename": "AttractionsLabel",
                    "text": "Free cancellation",
                    "type": "free_cancellation"
                }
            ],
            "name": "Cairo Nile Dinner Cruise with entertainment shows include pickup",
            "notIncluded": [
                "Gratuities"
            ],
            "offers": [
                {
                    "__typename": "Offer",
                    "availabilityType": "date_time",
                    "id": "OF3hpSk4p02G"
                }
            ],
            "onSiteRequirements": {
                "__typename": "OnSiteRequirements"
            },
            "operatedBy": "EMO TOURS EGYPT",
            "representativePrice": {
                "__typename": "AttractionsPrice",
                "chargeAmount": 11,
                "currency": "USD",
                "publicAmount": 11
            },
            "reviews": {
                "__typename": "AttractionsGetReviewsResponse",
                "total": 494,
                "reviews": [
                    {
                        "__typename": "AttractionsReview",
                        "id": "RSzQwqRdGlop",
                        "epochMs": 1729629329000,
                        "language": "fr",
                        "numericRating": 5,
                        "user": {
                            "__typename": "AttractionsReviewUser",
                            "name": "Dahbi"
                        }
                    },
                    {
                        "__typename": "AttractionsReview",
                        "id": "RS8Zgz30yemW",
                        "epochMs": 1729626291000,
                        "numericRating": 2
                    },
                    {
                        "__typename": "AttractionsReview",
                        "id": "RSXZ5yJb8PWR",
                        "epochMs": 1729587361000,
                        "language": "en-gb",
                        "numericRating": 4,
                        "user": {
                            "__typename": "AttractionsReviewUser",
                            "name": "Mariam",
                            "cc1": "gb"
                        }
                    },
                    {
                        "__typename": "AttractionsReview",
                        "id": "RSjEbadLvDvD",
                        "epochMs": 1729580465000,
                        "language": "it",
                        "numericRating": 4,
                        "user": {
                            "__typename": "AttractionsReviewUser",
                            "name": "Alessandro",
                            "cc1": "it"
                        }
                    },
                    {
                        "__typename": "AttractionsReview",
                        "id": "RSB85ChHnMfX",
                        "epochMs": 1729571324000,
                        "language": "en-us",
                        "numericRating": 5,
                        "user": {
                            "__typename": "AttractionsReviewUser",
                            "name": "Kate",
                            "cc1": "eg"
                        }
                    }
                ]
            },
            "reviewsStats": {
                "__typename": "AttractionsProductReviewStats",
                "allReviewsCount": 0,
                "percentage": "0",
                "combinedNumericStats": {
                    "__typename": "AttractionsProductCombinedReviewStats",
                    "average": 4.3,
                    "total": 494
                }
            },
            "slug": "prlcwyz2hhh9-budget-sunset-desert-safari-trip-by-quad-bike-in-hurghada",
            "supportedFeatures": {
                "__typename": "AttractionsProductSupportedFeatures",
                "nativeApp": true,
                "nativeAppBookProcess": false,
                "liveAvailabilityCheckSupported": true
            },
            "ufiDetails": {
                "__typename": "AttractionLocationResponse",
                "ufi": -290692,
                "bCityName": "Cairo"
            },
            "whatsIncluded": [
                "Private transportation",
                "Buffet Dinner",
                "Bottle of water ( in the car )",
                "All Taxes & Services",
                "Tanura Show",
                "Belly Dancer show"
            ]
        }
    }
]

2025-08-25 13:12:36,878 - evaluation_logger_Attraction-107 - INFO - Final Response: <｜begin▁of▁sentence｜># 1. 概述

本文，我们来分享 [MyBatis 的日志模块](https://github.com/YunaiV/mybatis-3/tree/master/src/main/java/org/apache/ibatis/logging)，对应 `logging` 包。如下图所示：[![`logging` 包](http://static.iocoder.cn/images/MyBatis/2020_01_07/01.png)](http://static.iocoder.cn/images/MyBatis/2020_01_07/01.png)`logging` 包

在 [《精尽 MyBatis 源码分析 —— 项目结构一览》](http://svip.iocoder.cn/MyBatis/intro) 中，简单介绍了这个模块如下：

> 无论在开发测试环境中，还是在线上生产环境中，日志在整个系统中的地位都是非常重要的。良好的日志功能可以帮助开发人员和测试人员快速定位 Bug 代码，也可以帮助运维人员快速定位性能瓶颈等问题。目前的 Java 世界中存在很多优秀的日志框架，例如 Log4j、 Log4j2、Slf4j 等。
>
> MyBatis 作为一个设计优良的框架，除了提供详细的日志输出信息，还要能够集成多种日志框架，其日志模块的一个主要功能就是**集成第三方日志框架**。

本文涉及的类如下图所示：![类图](http://static.iocoder.cn/images/MyBatis/2020_01_07/02.png)

- 从图的**上面**部分，我们可以看到，MyBatis 直接使用了多种第三方日志框架。但是，实际上，MyBatis 的日志实现是进一步封装了这些第三方日志框架。即图的**下面**部分。
- 另外，`jdbc` 包，是 MyBatis 封装的对 JDBC 操作的日志模块。因为，我们在实际开发中，需要看到 MyBatis 操作数据库时的 SQL 语句、参数、结果等等。而 `jdbc` 包，就实现了这样的功能。当然，`jdbc` 包，是基于 `logging` 包实现的。

下面，让我们开始干源码吧。

# 2. Log 接口

`org.apache.ibatis.logging.Log` ，MyBatis Log 接口。代码如下：

```java
// Log.java

public interface Log {

    boolean isDebugEnabled();

    boolean isTraceEnabled();

    void error(String s, Throwable e);

    void error(String s);

    void debug(String s);

    void trace(String s);

    void warn(String s);

}
```

- 定义了日志的接口。但是，这个接口的实现类，需要进一步调用第三方日志框架。目前有 6 种实现类，我们来看下 [LogFactory](https://github.com/YunaiV/mybatis-3/blob/master/src/main/java/org/apache/ibatis/logging/LogFactory.java) ：

```java
// LogFactory.java

public final class LogFactory {

    /**
     * Marker to be used by logging implementations that support markers.
     */
    public static final String MARKER = "MYBATIS";

    /**
     * 使用的 Log 的构造方法
     */
    private static Constructor<? extends Log> logConstructor;

    static {
        // <1> 尝试依次初始化每个日志框架的对应的 Log 构造方法
        tryImplementation(LogFactory::useSlf4jLogging);
        tryImplementation(LogFactory::useCommonsLogging);
        tryImplementation(LogFactory::useLog4J2Logging);
        tryImplementation(LogFactory::useLog4JLogging);
        tryImplementation(LogFactory::useJdkLogging);
        tryImplementation(LogFactory::useNoLogging);
    }

    private LogFactory() {
        // disable construction
    }

    public static Log getLog(Class<?> aClass) {
        return getLog(aClass.getName());
    }

    public static Log getLog(String logger) {
        try {
            return logConstructor.newInstance(logger);
        } catch (Throwable t) {
            throw new LogException("Error creating logger for logger " + logger + ".  Cause: " + t, t);
        }
    }

    public static synchronized void useCustomLogging(Class<? extends Log> clazz) {
        setImplementation(clazz);
    }

    public static synchronized void useSlf4jLogging() {
        setImplementation(org.apache.ibatis.logging.slf4j.Slf4jImpl.class);
    }

    public static synchronized void useCommonsLogging() {
        setImplementation(org.apache.ibatis.logging.commons.JakartaCommonsLoggingImpl.class);
    }

    public static synchronized void useLog4JLogging() {
        setImplementation(org.apache.ibatis.logging.log4j.Log4jImpl.class);
    }

    public static synchronized void useLog4J2Logging() {
        setImplementation(org.apache.ibatis.logging.log4j2.Log4j2Impl.class);
    }

    public static synchronized void useJdkLogging() {
        setImplementation(org.apache.ibatis.logging.jdk14.Jdk14LoggingImpl.class);
    }

    public static synchronized void useNoLogging() {
        setImplementation(org.apache.ibatis.logging.nologging.NoLoggingImpl.class);
    }

    private static void tryImplementation(Runnable runnable) {
        if (logConstructor == null) {
            try {
                runnable.run();
            } catch (Throwable t) {
                // ignore
            }
        }
    }

    private static void setImplementation(Class<? extends Log> implClass) {
        try {
            // 获得参数为 String 的构造方法
            Constructor<? extends Log> candidate = implClass.getConstructor(String.class);
            // 创建 Log 对象
            Log log = candidate.newInstance(LogFactory.class.getName());
            if (log.isDebugEnabled()) {
                log.debug("Logging initialized using '" + implClass + "' adapter.");
            }
            // 创建成功，意味着可以使用，设置为 logConstructor
            logConstructor = candidate;
        } catch (Throwable t) {
            throw new LogException("Error setting Log implementation.  Cause: " + t, t);
        }
    }

}
```

- `<1>` 处，在静态代码块中，会尝试依次初始化每个日志框架的对应的 Log 构造方法。因为，可能有多个日志框架，那么只能使用一个。这里，按照 `useSlf4jLogging`、`useCommonsLogging`、`useLog4J2Logging`、`useLog4JLogging`、`useJdkLogging`、`useNoLogging` 的顺序，直到一个成功。
- `#setImplementation(...)` 方法，尝试设置使用的 `logConstructor` 字段，即使用的 Log 的构造方法。
- `#tryImplementation(...)` 方法，如果 `logConstructor` 为空，则调用方法，进行初始化。
- 其它方法，比较简单，胖友自己看。

# 3. 第三方日志框架集成

## 3.1 Slf4jImpl

`org.apache.ibatis.logging.slf4j.Slf4jImpl` ，实现 Log 接口，**SLF4J** 封装实现类。代码如下：

```java
// Slf4jImpl.java

public class Slf4jImpl implements Log {

    private Log log;

    public Slf4jImpl(String clazz) {
        // 使用 SLF4J 的 LoggerFactory 获得 Logger 对象
        Logger logger = LoggerFactory.getLogger(clazz);

        // 如果使用了 SLF4J 桥接器，则可能会找到多个 Logger 对象，所以需要判断
        if (logger instanceof LocationAwareLogger) {
            try {
                // check for slf4j >= 1.6 method signature
                logger.getClass().getMethod("log", Marker.class, String.class, int.class, String.class, Object[].class, Throwable.class);
                log = new Slf4jLocationAwareLoggerImpl((LocationAwareLogger) logger);
                return;
            } catch (SecurityException | NoSuchMethodException e) {
                // fail-back to Slf4jLoggerImpl
            }
        }

        // Logger is not LocationAwareLogger or slf4j version < 1.6
        log = new Slf4jLoggerImpl(logger);
    }

    @Override
    public boolean isDebugEnabled() {
        return log.isDebugEnabled();
    }

    @Override
    public boolean isTraceEnabled() {
        return log.isTraceEnabled();
    }

    @Override
    public void error(String s, Throwable e) {
        log.error(s, e);
    }

    @Override
    public void error(String s) {
        log.error(s);
    }

    @Override
    public void debug(String s) {
        log.debug(s);
    }

    @Override
    public void trace(String s) {
        log.trace(s);
    }

    @Override
    public void warn(String s) {
        log.warn(s);
    }

}
```

- 在构造方法中，我们可以看到，根据不同的情况，会创建不同的 Log 对象：
  - `org.apache.ibatis.logging.slf4j.Slf4jLocationAwareLoggerImpl` ，当使用 SLF4J 桥接器时。
  - `org.apache.ibatis.logging.slf4j.Slf4jLoggerImpl` ，普通情况。
- 但是，这两个实现类，都是实现 Log 接口，**委托**给真正的 SLF4J 的 Logger 。以 Slf4jLoggerImpl 为例，代码如下：

```java
// Slf4jLoggerImpl.java

public class Slf4jLoggerImpl implements Log {

    private Logger log;

    public Slf4jLoggerImpl(Logger logger) {
        log = logger;
    }

    @Override
    public boolean isDebugEnabled() {
        return log.isDebugEnabled();
    }

    @Override
    public boolean isTraceEnabled() {
        return log.isTraceEnabled();
    }

    @Override
    public void error(String s, Throwable e) {
        log.error(s, e);
    }

    @Override
    public void error(String s) {
        log.error(s);
    }

    @Override
    public void debug(String s) {
        log.debug(s);
    }

    @Override
    public void trace(String s) {
        log.trace(s);
    }

    @Override
    public void warn(String s) {
        log.warn(s);
    }

}
```

- 委托模式。

## 3.2 JakartaCommonsLoggingImpl

`org.apache.ibatis.logging.commons.JakartaCommonsLoggingImpl` ，实现 Log 接口，**Jakarta Commons Logging** 封装实现类。代码如下：

```java
// JakartaCommonsLoggingImpl.java

public class JakartaCommonsLoggingImpl implements Log {

    private Log log;

    public JakartaCommonsLoggingImpl(String clazz) {
        // 使用 Jakarta Commons Logging 的 LogFactory 获得 Log 对象
        log = LogFactory.getLog(clazz);
    }

    @Override
    public boolean isDebugEnabled() {
        return log.isDebugEnabled();
    }

    @Override
    public boolean isTraceEnabled() {
        return log.isTraceEnabled();
    }

    @Override
    public void error(String s, Throwable e) {
        log.error(s, e);
    }

    @Override
    public void error(String s) {
        log.error(s);
    }

    @Override
    public void debug(String s) {
        log.debug(s);
    }

    @Override
    public void trace(String s) {
        log.trace(s);
    }

    @Override
    public void warn(String s) {
        log.warn(s);
    }

}
```

- 委托模式。

## 3.3 Log4jImpl

`org.apache.ibatis.logging.log4j.Log4jImpl` ，实现 Log 接口，**Log4J** 封装实现类。代码如下：

```java
// Log4jImpl.java

public class Log4jImpl implements Log {

    private static final String FQCN = Log4jImpl.class.getName();

    private Logger log;

    public Log4jImpl(String clazz) {
        // 获得 Logger 对象
        log = Logger.getLogger(clazz);
    }

    @Override
    public boolean isDebugEnabled() {
        return log.isDebugEnabled();
    }

    @Override
    public boolean isTraceEnabled() {
        return log.isTraceEnabled();
    }

    @Override
    public void error(String s, Throwable e) {
        log.log(FQCN, Level.ERROR, s, e);
    }

    @Override
    public void error(String s) {
        log.log(FQCN, Level.ERROR, s, null);
    }

    @Override
    public void debug(String s) {
        log.log(FQCN, Level.DEBUG, s, null);
    }

    @Override
    public void trace(String s) {
        log.log(FQCN, Level.TRACE, s, null);
    }

    @Override
    public void warn(String s) {
        log.log(FQCN, Level.WARN, s, null);
    }

}
```

- 委托模式。

## 3.4 Log4j2Impl

`org.apache.ibatis.logging.log4j2.Log4j2Impl` ，实现 Log 接口，**Log4J2** 封装实现类。代码如下：

```java
// Log4j2Impl.java

public class Log4j2Impl implements Log {

    private static final String FQCN = Log4j2Impl.class.getName();

    private Logger log;

    public Log4j2Impl(String clazz) {
        // 获得 Logger 对象
        log = LogManager.getLogger(clazz);
    }

    @Override
    public boolean isDebugEnabled() {
        return log.isDebugEnabled();
    }

    @Override
    public boolean isTraceEnabled() {
        return log.isTraceEnabled();
    }

    @Override
    public void error(String s, Throwable e) {
        log.log(Level.ERROR, s, e);
    }

    @Override
    public void error(String s) {
        log.log(Level.ERROR, s);
    }

    @Override
    public void debug(String s) {
        log.log(Level.DEBUG, s);
    }

    @Override
    public void trace(String s) {
        log.log(Level.TRACE, s);
    }

    @Override
    public void warn(String s) {
        log.log(Level.WARN, s);
    }

}
```

- 委托模式。

## 3.5 Jdk14LoggingImpl

`org.apache.ibatis.logging.jdk14.Jdk14LoggingImpl` ，实现 Log 接口，**JDK Logging** 封装实现类。代码如下：

```java
// Jdk14LoggingImpl.java

public class Jdk14LoggingImpl implements Log {

    private Logger log;

    public Jdk14LoggingImpl(String clazz) {
        // 获得 Logger 对象
        log = Logger.getLogger(clazz);
    }

    @Override
    public boolean isDebugEnabled() {
        return log.isLoggable(Level.FINE);
    }

    @Override
    public boolean isTraceEnabled() {
        return log.isLoggable(Level.FINER);
    }

    @Override
    public void error(String s, Throwable e) {
        log.log(Level.SEVERE, s, e);
    }

    @Override
    public void error(String s) {
        log.log(Level.SEVERE, s);
    }

    @Override
    public void debug(String s) {
        log.log(Level.FINE, s);
    }

    @Override
    public void trace(String s) {
        log.log(Level.FINER, s);
    }

    @Override
    public void warn(String s) {
        log.log(Level.WARNING, s);
    }

}
```

- 委托模式。

## 3.6 NoLoggingImpl

`org.apache.ibatis.logging.nologging.NoLoggingImpl` ，实现 Log 接口，**空**封装实现类。代码如下：

```java
// NoLoggingImpl.java

public class NoLoggingImpl implements Log {

    public NoLoggingImpl(String clazz) {
        // Do Nothing
    }

    @Override
    public boolean isDebugEnabled() {
        return false;
    }

    @Override
    public boolean isTraceEnabled() {
        return false;
    }

    @Override
    public void error(String s, Throwable e) {
        // Do Nothing
    }

    @Override
    public void error(String s) {
        // Do Nothing
    }

    @Override
    public void debug(String s) {
        // Do Nothing
    }

    @Override
    public void trace(String s) {
        // Do Nothing
    }

    @Override
    public void warn(String s) {
        // Do Nothing
    }

}
```

- 每个方法，空实现。

# 4. jdbc 包

`jdbc` 包，是 MyBatis 封装的对 JDBC 操作的日志模块。核心类有 5 个，我们来一一瞅瞅。

## 4.1 BaseJdbcLogger

`org.apache.ibatis.logging.jdbc.BaseJdbcLogger` ，抽象类，为其它 JdbcLogger 抽象类。代码如下：

```java
// BaseJdbcLogger.java

public abstract class BaseJdbcLogger {

    /**
     * SET 方法集合
     */
    protected static final Set<String> SET_METHODS = new HashSet<>();
    /**
     * EXECUTE 方法集合
     */
    protected static final Set<String> EXECUTE_METHODS = new HashSet<>();

    static {
        // SET 方法集合
        SET_METHODS.add("setString");
        SET_METHODS.add("setInt");
        SET_METHODS.add("setByte");
        SET_METHODS.add("setShort");
        SET_METHODS.add("setLong");
        SET_METHODS.add("setDouble");
        SET_METHODS.add("setFloat");
        SET_METHODS.add("setTimestamp");
        SET_METHODS.add("setDate");
        SET_METHODS.add("setTime");
        SET_METHODS.add("setArray");
        SET_METHODS.add("setBigDecimal");
        SET_METHODS.add("setAsciiStream");
        SET_METHODS.add("setBinaryStream");
        SET_METHODS.add("setBlob");
        SET_METHODS.add("setBoolean");
        SET_METHODS.add("setBytes");
        SET_METHODS.add("setCharacterStream");
        SET_METHODS.add("setClob");
        SET_METHODS.add("setObject");
        SET_METHODS.add("setNull");

        // EXECUTE 方法集合
        EXECUTE_METHODS.add("execute");
        EXECUTE_METHODS.add("executeUpdate");
        EXECUTE_METHODS.add("executeQuery");
    }

    /**
     * Log 对象
     */
    protected Log statementLog;
    /**
     * 查询

2025-08-25 13:12:41,865 - evaluation_logger_Attraction-107 - INFO - Complete Result: {'score': 0, 'reason': 'The response does not address any of the requested information about tour routes or sightseeing activities in Cairo.'}
2025-08-25 13:12:48,053 - evaluation_logger_Attraction-107 - INFO - Correct Result: {'score': 0, 'reason': 'All information in the response is incorrect.'}
2025-08-25 13:12:48,053 - evaluation_logger_Attraction-107 - INFO - Message: Success.
2025-08-25 13:12:48,053 - evaluation_logger_Attraction-107 - INFO - Success turn num = 3
2025-08-25 13:12:48,053 - evaluation_logger_Attraction-107 - INFO - ----------------------------------------------------------------------------------------------------
