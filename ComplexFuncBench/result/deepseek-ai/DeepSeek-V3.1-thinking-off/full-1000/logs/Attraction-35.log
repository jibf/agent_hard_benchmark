2025-08-25 12:58:07,529 - evaluation_logger_Attraction-35 - INFO - Test Example Attraction-35
2025-08-25 12:58:07,529 - evaluation_logger_Attraction-35 - INFO - Query: Our company is planning a trip to Paris for the employees. What is the highest-rated attraction there?
2025-08-25 12:58:15,651 - evaluation_logger_Attraction-35 - INFO - Function Calls: 
[
    {
        "name": "Search_Attraction_Location",
        "arguments": {
            "query": "Paris"
        }
    }
]

2025-08-25 12:58:15,651 - evaluation_logger_Attraction-35 - INFO - Golden Function Call: 
[
    {
        "name": "Search_Attraction_Location",
        "arguments": {
            "query": "Paris"
        }
    },
    {
        "name": "Search_Attractions",
        "arguments": {
            "id": "eyJ1ZmkiOi0xNDU2OTI4fQ==",
            "sortBy": "attr_book_score"
        }
    }
]

2025-08-25 12:58:15,651 - evaluation_logger_Attraction-35 - INFO - Start compare_single_call: 
{'name': 'Search_Attraction_Location', 'arguments': {'query': 'Paris'}}
{'name': 'Search_Attraction_Location', 'arguments': {'query': 'Paris'}}
2025-08-25 12:58:15,651 - evaluation_logger_Attraction-35 - INFO - Rule-based compare success.
2025-08-25 12:58:15,651 - evaluation_logger_Attraction-35 - INFO - Success matched: [{'name': 'Search_Attraction_Location', 'arguments': {'query': 'Paris'}}]
2025-08-25 12:58:15,651 - evaluation_logger_Attraction-35 - INFO - Observations:
[
    {
        "status": true,
        "message": "Success",
        "data": {
            "products": [
                {
                    "id": "eyJwaW5uZWRQcm9kdWN0IjoiUFJYMUNnVGxJOFJWIiwidWZpIjotMTQ1NjkyOH0=",
                    "__typename": "AttractionsSearchProductSuggestion",
                    "title": "Menu Dinner Paris Night Cruise Bateaux Parisien",
                    "productId": "PRX1CgTlI8RV",
                    "productSlug": "prx1cgtli8rv-menu-dinner-paris-night-cruise-bateaux-parisien",
                    "taxonomySlug": "tours",
                    "cityUfi": -1456928,
                    "cityName": "Paris",
                    "countryCode": "fr"
                },
                {
                    "id": "eyJwaW5uZWRQcm9kdWN0IjoiUFJpWjkxWVhRODNyIiwidWZpIjotMTQ1NjkyOH0=",
                    "__typename": "AttractionsSearchProductSuggestion",
                    "title": "Paris Service Privilege Lunch Cruise - Bateaux Parisien",
                    "productId": "PRiZ91YXQ83r",
                    "productSlug": "priz91yxq83r-paris-service-privilege-lunch-cruise-bateaux-parisien",
                    "taxonomySlug": "tours",
                    "cityUfi": -1456928,
                    "cityName": "Paris",
                    "countryCode": "fr"
                },
                {
                    "id": "eyJwaW5uZWRQcm9kdWN0IjoiUFI0S0t3VkV6TkZxIiwidWZpIjotMTQ1NjkyOH0=",
                    "__typename": "AttractionsSearchProductSuggestion",
                    "title": "Paris Dinner Cruise - Bateaux Parisien Seine River",
                    "productId": "PR4KKwVEzNFq",
                    "productSlug": "pr4kkwveznfq-paris-dinner-cruise-bateaux-parisien-seine-river",
                    "taxonomySlug": "transfers-services",
                    "cityUfi": -1456928,
                    "cityName": "Paris",
                    "countryCode": "fr"
                },
                {
                    "id": "eyJwaW5uZWRQcm9kdWN0IjoiUFJmem5mRk95Skh0IiwidWZpIjotMTQ1NjkyOH0=",
                    "__typename": "AttractionsSearchProductSuggestion",
                    "title": "The Parisian Experience: Styling & Shopping Experience in Paris",
                    "productId": "PRfznfFOyJHt",
                    "productSlug": "prfznffoyjht-the-fashionista-experience-personal-shopping-and-styling-experience",
                    "taxonomySlug": "tours",
                    "cityUfi": -1456928,
                    "cityName": "Paris",
                    "countryCode": "fr"
                },
                {
                    "id": "eyJwaW5uZWRQcm9kdWN0IjoiUFJDazUycEQ2ZExFIiwidWZpIjotMTQ1NjkyOH0=",
                    "__typename": "AttractionsSearchProductSuggestion",
                    "title": "Solo in Paris: Chanel Style Photoshoot & Fun with a Parisian",
                    "productId": "PRCk52pD6dLE",
                    "productSlug": "prck52pd6dle-premium-paris-photoshoot-with-a-fashion-photographer",
                    "taxonomySlug": "tours",
                    "cityUfi": -1456928,
                    "cityName": "Paris",
                    "countryCode": "fr"
                }
            ],
            "destinations": [
                {
                    "id": "eyJ1ZmkiOi0xNDU2OTI4fQ==",
                    "__typename": "AttractionsSearchDestinationSuggestion",
                    "ufi": -1456928,
                    "country": "France",
                    "cityName": "Paris",
                    "productCount": 3202,
                    "cc1": "fr"
                }
            ]
        }
    }
]

2025-08-25 12:58:25,810 - evaluation_logger_Attraction-35 - INFO - Function Calls: 
[
    {
        "name": "Search_Attractions",
        "arguments": {
            "id": "eyJ1ZmkiOi0xNDU2OTI4fQ==",
            "sortBy": "attr_book_score"
        }
    }
]

2025-08-25 12:58:25,810 - evaluation_logger_Attraction-35 - INFO - Golden Function Call: 
[
    {
        "name": "Search_Attractions",
        "arguments": {
            "id": "eyJ1ZmkiOi0xNDU2OTI4fQ==",
            "sortBy": "attr_book_score"
        }
    }
]

2025-08-25 12:58:25,810 - evaluation_logger_Attraction-35 - INFO - Start compare_single_call: 
{'name': 'Search_Attractions', 'arguments': {'id': 'eyJ1ZmkiOi0xNDU2OTI4fQ==', 'sortBy': 'attr_book_score'}}
{'name': 'Search_Attractions', 'arguments': {'id': 'eyJ1ZmkiOi0xNDU2OTI4fQ==', 'sortBy': 'attr_book_score'}}
2025-08-25 12:58:25,810 - evaluation_logger_Attraction-35 - INFO - Rule-based compare success.
2025-08-25 12:58:25,810 - evaluation_logger_Attraction-35 - INFO - Success matched: [{'name': 'Search_Attractions', 'arguments': {'id': 'eyJ1ZmkiOi0xNDU2OTI4fQ==', 'sortBy': 'attr_book_score'}}]
2025-08-25 12:58:25,810 - evaluation_logger_Attraction-35 - INFO - Observations:
[
    {
        "status": true,
        "message": "Success",
        "data": {
            "__typename": "AttractionsProductSearchResponse",
            "products": [
                {
                    "__typename": "AttractionsProduct",
                    "cancellationPolicy": {
                        "__typename": "AttractionsCancellationPolicy",
                        "hasFreeCancellation": false
                    },
                    "id": "PRct8rEMbWLD",
                    "name": "Admission to the Mus√©e d'Orsay",
                    "slug": "prct8rembwld-admission-to-the-musee-dorsay",
                    "shortDescription": "A visit to a famous art museum housed in a former railway station",
                    "representativePrice": {
                        "__typename": "AttractionsPrice",
                        "chargeAmount": 19.12,
                        "currency": "USD",
                        "publicAmount": 19.12
                    },
                    "reviewsStats": {
                        "__typename": "AttractionsProductReviewStats",
                        "allReviewsCount": 2,
                        "percentage": "100%",
                        "combinedNumericStats": {
                            "__typename": "AttractionsProductCombinedReviewStats",
                            "average": 4.7,
                            "total": 1485
                        }
                    },
                    "ufiDetails": {
                        "__typename": "AttractionLocationResponse",
                        "bCityName": "Paris",
                        "ufi": -1456928
                    },
                    "offers": [
                        {
                            "__typename": "Offer",
                            "items": [
                                {
                                    "__typename": "OfferItem",
                                    "id": "OIHpz1cRc2iw"
                                }
                            ]
                        }
                    ],
                    "supportedFeatures": {
                        "__typename": "AttractionsProductSupportedFeatures",
                        "nativeApp": true
                    }
                },
                {
                    "__typename": "AttractionsProduct",
                    "cancellationPolicy": {
                        "__typename": "AttractionsCancellationPolicy",
                        "hasFreeCancellation": true
                    },
                    "id": "PRgFnm0q2pM7",
                    "name": "Montparnasse Tower Observation Deck",
                    "slug": "prgfnm0q2pm7-montparnasse-tower-observation-deck",
                    "shortDescription": "Admission to a sky-high observation deck with 360-degree views over Paris",
                    "representativePrice": {
                        "__typename": "AttractionsPrice",
                        "chargeAmount": 19.66,
                        "currency": "USD",
                        "publicAmount": 19.66
                    },
                    "reviewsStats": {
                        "__typename": "AttractionsProductReviewStats",
                        "allReviewsCount": 109,
                        "percentage": "91%",
                        "combinedNumericStats": {
                            "__typename": "AttractionsProductCombinedReviewStats",
                            "average": 4.6,
                            "total": 593
                        }
                    },
                    "ufiDetails": {
                        "__typename": "AttractionLocationResponse",
                        "bCityName": "Paris",
                        "ufi": -1456928
                    },
                    "offers": [
                        {
                            "__typename": "Offer",
                            "items": [
                                {
                                    "__typename": "OfferItem",
                                    "id": "OIQJxgYgy0hi"
                                },
                                {
                                    "__typename": "OfferItem",
                                    "id": "OIUDh3aCk8mo"
                                },
                                {
                                    "__typename": "OfferItem",
                                    "id": "OIihZeDOGnJX"
                                }
                            ]
                        }
                    ],
                    "supportedFeatures": {
                        "__typename": "AttractionsProductSupportedFeatures",
                        "nativeApp": true
                    }
                },
                {
                    "__typename": "AttractionsProduct",
                    "cancellationPolicy": {
                        "__typename": "AttractionsCancellationPolicy",
                        "hasFreeCancellation": false
                    },
                    "id": "PRza0ZCg7YzS",
                    "name": "Admission to the Arc de Triomphe's Rooftop",
                    "slug": "prza0zcg7yzs-admission-to-the-arc-de-triomphes-rooftop",
                    "shortDescription": "A ticket to visit one of the best viewing points in Paris",
                    "representativePrice": {
                        "__typename": "AttractionsPrice",
                        "chargeAmount": 17.48,
                        "currency": "USD",
                        "publicAmount": 17.48
                    },
                    "reviewsStats": {
                        "__typename": "AttractionsProductReviewStats",
                        "allReviewsCount": 416,
                        "percentage": "90%",
                        "combinedNumericStats": {
                            "__typename": "AttractionsProductCombinedReviewStats",
                            "average": 4.5,
                            "total": 763
                        }
                    },
                    "ufiDetails": {
                        "__typename": "AttractionLocationResponse",
                        "bCityName": "Paris",
                        "ufi": -1456928
                    },
                    "offers": [
                        {
                            "__typename": "Offer",
                            "items": [
                                {
                                    "__typename": "OfferItem",
                                    "id": "OIY1MIiF0M6C"
                                }
                            ]
                        },
                        {
                            "__typename": "Offer",
                            "items": [
                                {
                                    "__typename": "OfferItem",
                                    "id": "OIGj1nxmOTxr"
                                }
                            ]
                        }
                    ],
                    "supportedFeatures": {
                        "__typename": "AttractionsProductSupportedFeatures",
                        "nativeApp": true
                    },
                    "flags": [
                        {
                            "__typename": "AttractionsProductFlags",
                            "flag": "bestseller",
                            "value": true,
                            "rank": 8
                        },
                        {
                            "__typename": "AttractionsProductFlags",
                            "flag": "bestsellerForLandmarks",
                            "value": true,
                            "rank": 1
                        }
                    ]
                },
                {
                    "__typename": "AttractionsProduct",
                    "cancellationPolicy": {
                        "__typename": "AttractionsCancellationPolicy",
                        "hasFreeCancellation": true
                    },
                    "id": "PRjYfiTKUhFz",
                    "name": "Admission to Disneyland¬Æ Paris",
                    "slug": "prjyfitkuhfz-one-day-admission-to-disneylandr-paris",
                    "shortDescription": "A ticket to experience the best of one or two Disney¬Æ theme parks in Paris",
                    "representativePrice": {
                        "__typename": "AttractionsPrice",
                        "chargeAmount": 61.17,
                        "currency": "USD",
                        "publicAmount": 61.17
                    },
                    "reviewsStats": {
                        "__typename": "AttractionsProductReviewStats",
                        "allReviewsCount": 1884,
                        "percentage": "88%",
                        "combinedNumericStats": {
                            "__typename": "AttractionsProductCombinedReviewStats",
                            "average": 4.5,
                            "total": 3864
                        }
                    },
                    "ufiDetails": {
                        "__typename": "AttractionLocationResponse",
                        "bCityName": "Paris",
                        "ufi": -1456928
                    },
                    "offers": [
                        {
                            "__typename": "Offer",
                            "items": [
                                {
                                    "__typename": "OfferItem",
                                    "id": "OIwyusiWUhnN"
                                },
                                {
                                    "__typename": "OfferItem",
                                    "id": "OI3odKMlgKSK"
                                }
                            ]
                        },
                        {
                            "__typename": "Offer",
                            "items": [
                                {
                                    "__typename": "OfferItem",
                                    "id": "OImI20ad7f2W"
                                },
                                {
                                    "__typename": "OfferItem",
                                    "id": "OIvl9TTLMX3q"
                                }
                            ]
                        },
                        {
                            "__typename": "Offer",
                            "items": [
                                {
                                    "__typename": "OfferItem",
                                    "id": "OINApUHr2SHS"
                                },
                                {
                                    "__typename": "OfferItem",
                                    "id": "OIoDlt3mP2AU"
                                }
                            ]
                        },
                        {
                            "__typename": "Offer",
                            "items": [
                                {
                                    "__typename": "OfferItem",
                                    "id": "OIeAkgGLAZqi"
                                },
                                {
                                    "__typename": "OfferItem",
                                    "id": "OIbuudRJtwKn"
                                }
                            ]
                        },
                        {
                            "__typename": "Offer",
                            "items": [
                                {
                                    "__typename": "OfferItem",
                                    "id": "OIFkjsIuR7ER"
                                },
                                {
                                    "__typename": "OfferItem",
                                    "id": "OI24G4jFEdzF"
                                }
                            ]
                        }
                    ],
                    "supportedFeatures": {
                        "__typename": "AttractionsProductSupportedFeatures",
                        "nativeApp": true
                    },
                    "flags": [
                        {
                            "__typename": "AttractionsProductFlags",
                            "flag": "bestseller",
                            "value": true,
                            "rank": 2
                        },
                        {
                            "__typename": "AttractionsProductFlags",
                            "flag": "bestsellerInMonth",
                            "value": true,
                            "rank": 1
                        },
                        {
                            "__typename": "AttractionsProductFlags",
                            "flag": "bestsellerInWeek",
                            "value": true,
                            "rank": 1
                        },
                        {
                            "__typename": "AttractionsProductFlags",
                            "flag": "bestsellerOnWeekends",
                            "value": true,
                            "rank": 2
                        },
                        {
                            "__typename": "AttractionsProductFlags",
                            "flag": "bestsellerForAttractions",
                            "value": true,
                            "rank": 1
                        }
                    ]
                },
                {
                    "__typename": "AttractionsProduct",
                    "cancellationPolicy": {
                        "__typename": "AttractionsCancellationPolicy",
                        "hasFreeCancellation": true
                    },
                    "id": "PRN0YvDeIrz7",
                    "name": "Arc de Triomphe Admission",
                    "slug": "prn0yvdeirz7-arc-de-triomphe-skip-the-line-admission",
                    "shortDescription": "A ticket to visit the famous historical landmark and enjoy panoramic views",
                    "representativePrice": {
                        "__typename": "AttractionsPrice",
                        "chargeAmount": 17.48,
                        "currency": "USD",
                        "publicAmount": 17.48
                    },
                    "reviewsStats": {
                        "__typename": "AttractionsProductReviewStats",
                        "allReviewsCount": 45,
                        "percentage": "80%",
                        "combinedNumericStats": {
                            "__typename": "AttractionsProductCombinedReviewStats",
                            "average": 4.5,
                            "total": 617
                        }
                    },
                    "ufiDetails": {
                        "__typename": "AttractionLocationResponse",
                        "bCityName": "Paris",
                        "ufi": -1456928
                    },
                    "offers": [
                        {
                            "__typename": "Offer",
                            "items": [
                                {
                                    "__typename": "OfferItem",
                                    "id": "OIGf8D5DQSFk"
                                }
                            ]
                        }
                    ],
                    "supportedFeatures": {
                        "__typename": "AttractionsProductSupportedFeatures",
                        "nativeApp": true
                    },
                    "flags": [
                        {
                            "__typename": "AttractionsProductFlags",
                            "flag": "bestseller",
                            "value": true,
                            "rank": 5
                        }
                    ]
                }
            ],
            "filterStats": {
                "__typename": "FilterStats",
                "unfilteredProductCount": 3202,
                "filteredProductCount": 3202
            },
            "sorters": [
                {
                    "__typename": "AttractionsSorterOption",
                    "name": "Our top picks",
                    "value": "trending"
                },
                {
                    "__typename": "AttractionsSorterOption",
                    "name": "Most popular",
                    "value": "attr_book_score"
                },
                {
                    "__typename": "AttractionsSorterOption",
                    "name": "Lowest price",
                    "value": "lowest_price"
                }
            ],
            "defaultSorter": {
                "__typename": "AttractionsSorterOption",
                "name": "Our top picks",
                "value": "trending"
            },
            "filterOptions": {
                "__typename": "FilterOptions",
                "typeFilters": [
                    {
                        "__typename": "FilterOption",
                        "name": "Tours",
                        "tagname": "tours",
                        "productCount": 494
                    },
                    {
                        "__typename": "FilterOption",
                        "name": "Museums, arts & culture",
                        "tagname": "museums-arts-culture",
                        "productCount": 314
                    },
                    {
                        "__typename": "FilterOption",
                        "name": "Nature & outdoor",
                        "tagname": "nature-outdoor",
                        "productCount": 251
                    },
                    {
                        "__typename": "FilterOption",
                        "name": "Entertainment & tickets",
                        "tagname": "entertainment-tickets",
                        "productCount": 186
                    },
                    {
                        "__typename": "FilterOption",
                        "name": "Food & drinks",
                        "tagname": "food-drinks",
                        "productCount": 78
                    }
                ],
                "labelFilters": [
                    {
                        "__typename": "FilterOption",
                        "name": "Free cancellation",
                        "tagname": "free_cancellation",
                        "productCount": 2354
                    }
                ],
                "ufiFilters": [
                    {
                        "__typename": "FilterOption",
                        "name": "Paris",
                        "tagname": "-1456928",
                        "productCount": 3113
                    },
                    {
                        "__typename": "FilterOption",
                        "name": "Versailles",
                        "tagname": "-1475811",
                        "productCount": 57
                    },
                    {
                        "__typename": "FilterOption",
                        "name": "Marne-la-Vallee",
                        "tagname": "-1449817",
                        "productCount": 29
                    },
                    {
                        "__typename": "FilterOption",
                        "name": "Grisy Suisnes",
                        "tagname": "-1430775",
                        "productCount": 1
                    },
                    {
                        "__typename": "FilterOption",
                        "name": "Rungis",
                        "tagname": "-1463315",
                        "productCount": 1
                    }
                ],
                "priceFilters": [
                    {
                        "__typename": "FilterOption",
                        "name": "US$0 - US$22",
                        "tagname": "b0",
                        "productCount": 219
                    },
                    {
                        "__typename": "FilterOption",
                        "name": "US$22 - US$44",
                        "tagname": "b1",
                        "productCount": 267
                    },
                    {
                        "__typename": "FilterOption",
                        "name": "US$44 - US$83",
                        "tagname": "b2",
                        "productCount": 386
                    },
                    {
                        "__typename": "FilterOption",
                        "name": "US$83 - US$138",
                        "tagname": "b3",
                        "productCount": 460
                    },
                    {
                        "__typename": "FilterOption",
                        "name": "US$138+",
                        "tagname": "b4",
                        "productCount": 1980
                    }
                ]
            }
        }
    }
]

2025-08-25 13:00:34,924 - evaluation_logger_Attraction-35 - INFO - Final Response: <ÔΩúbegin‚ñÅof‚ñÅsentenceÔΩú># 1. Ê¶ÇËø∞

Êú¨ÊñáÔºåÊàë‰ª¨Êù•ÂàÜ‰∫´ [„ÄäÁ≤æÂ∞Ω Spring Boot Ê∫êÁ†ÅÂàÜÊûê ‚Äî‚Äî SpringApplication„Äã](http://svip.iocoder.cn/Spring-Boot/SpringApplication/) ÁöÑ**ÂàùÂßãÂåñ**ÁöÑÊ∫êÁ†ÅËß£Êûê„ÄÇ

Âú® SpringApplication ÂÆû‰æãÂàùÂßãÂåñÁöÑËøáÁ®ã‰∏≠Ôºå‰ºöËøõË°å**ÂàùÂßãÂåñÈò∂ÊÆµ**„ÄÇËÄåÂàùÂßãÂåñÈò∂ÊÆµÔºå‰∏ªË¶Å‰ºöÂÅöÂ¶Ç‰∏ãÂá†‰ª∂‰∫ãÊÉÖÔºö

1. ËÆæÁΩÆ `primarySources` Â±ûÊÄß
2. ËÆæÁΩÆ `webApplicationType` Â±ûÊÄß
3. ËÆæÁΩÆ `initializers` Â±ûÊÄß
4. ËÆæÁΩÆ `listeners` Â±ûÊÄß
5. ËÆæÁΩÆ `mainApplicationClass` Â±ûÊÄß

# 2. ÊûÑÈÄ†ÊñπÊ≥ï

SpringApplication Êèê‰æõ‰∫ÜÂ§ö‰∏™ÊûÑÈÄ†ÊñπÊ≥ïÔºåÁî®‰∫éÂàùÂßãÂåñ„ÄÇ‰ª£Á†ÅÂ¶Ç‰∏ãÔºö

```java
// SpringApplication.java

public SpringApplication(ResourceLoader resourceLoader, Class<?>... primarySources) {
    this.resourceLoader = resourceLoader;
    Assert.notNull(primarySources, "PrimarySources must not be null");
    this.primarySources = new LinkedHashSet<>(Arrays.asList(primarySources));
    // <1> Êé®Êñ≠ Web Â∫îÁî®Á±ªÂûã
    this.webApplicationType = WebApplicationType.deduceFromClasspath();
    // <2> ËÆæÁΩÆÂ∫îÁî®‰∏ä‰∏ãÊñáÂàùÂßãÂåñÂô®
    setInitializers((Collection) getSpringFactoriesInstances(ApplicationContextInitializer.class));
    // <3> ËÆæÁΩÆ‰∫ã‰ª∂ÁõëÂê¨Âô®
    setListeners((Collection) getSpringFactoriesInstances(ApplicationListener.class));
    // <4> Êé®Êñ≠Â∫îÁî®ÊñπÊ≥ï
    this.mainApplicationClass = deduceMainApplicationClass();
}

public SpringApplication(Class<?>... primarySources) {
    this(null, primarySources);
}
```

- ‰∏§‰∏™ÊûÑÈÄ†ÊñπÊ≥ïÔºåÂÆûÈôÖÊòØÂêå‰∏Ä‰∏™„ÄÇÂ∑ÆÂà´Âú®‰∫éÔºåÊòØÂê¶‰º†ÈÄí‰∫Ü `resourceLoader` ÂèÇÊï∞„ÄÇ
- `<1>` Â§ÑÔºåË∞ÉÁî® `WebApplicationType#deduceFromClasspath()` ÊñπÊ≥ïÔºåÊé®Êñ≠ Web Â∫îÁî®Á±ªÂûã„ÄÇËØ¶ÁªÜËß£ÊûêÔºåËßÅ [„Äå2.1 WebApplicationType„Äç](http://svip.iocoder.cn/Spring-Boot/SpringApplication/#) „ÄÇ
- `<2>` Â§ÑÔºåËÆæÁΩÆÂ∫îÁî®‰∏ä‰∏ãÊñáÂàùÂßãÂåñÂô®ÔºàApplicationContextInitializerÔºâ„ÄÇËØ¶ÁªÜËß£ÊûêÔºåËßÅ [„Äå2.2 ËÆæÁΩÆ Initializers„Äç](http://svip.iocoder.cn/Spring-Boot/SpringApplication/#) „ÄÇ
- `<3>` Â§ÑÔºåËÆæÁΩÆ‰∫ã‰ª∂ÁõëÂê¨Âô®ÔºàApplicationListenerÔºâ„ÄÇËØ¶ÁªÜËß£ÊûêÔºåËßÅ [„Äå2.3 ËÆæÁΩÆ Listeners„Äç](http://svip.iocoder.cn/Spring-Boot/SpringApplication/#) „ÄÇ
- `<4>` Â§ÑÔºåË∞ÉÁî® `#deduceMainApplicationClass()` ÊñπÊ≥ïÔºåÊé®Êñ≠Â∫îÁî®ÊñπÊ≥ï„ÄÇËØ¶ÁªÜËß£ÊûêÔºåËßÅ [„Äå2.4 Êé®Êñ≠Â∫îÁî®ÊñπÊ≥ï„Äç](http://svip.iocoder.cn/Spring-Boot/SpringApplication/#) „ÄÇ

## 2.1 WebApplicationType

`org.springframework.boot.WebApplicationType` ÔºåSpring Boot Â∫îÁî®Á±ªÂûãÊûö‰∏æ„ÄÇ‰ª£Á†ÅÂ¶Ç‰∏ãÔºö

```java
// WebApplicationType.java

public enum WebApplicationType {

    /**
     * Èùû Web È°πÁõÆ
     */
    NONE,
    /**
     * Servlet Web È°πÁõÆ
     */
    SERVLET,
    /**
     * Reactive Web È°πÁõÆ
     */
    REACTIVE;

    private static final String[] SERVLET_INDICATOR_CLASSES = { "javax.servlet.Servlet",
            "org.springframework.web.context.ConfigurableWebApplicationContext" };

    private static final String WEBMVC_INDICATOR_CLASS = "org.springframework.web.servlet.DispatcherServlet";

    private static final String WEBFLUX_INDICATOR_CLASS = "org.springframework.web.reactive.DispatcherHandler";

    private static final String JERSEY_INDICATOR_CLASS = "org.glassfish.jersey.servlet.ServletContainer";

    private static final String SERVLET_APPLICATION_CONTEXT_CLASS = "org.springframework.web.context.WebApplicationContext";

    private static final String REACTIVE_APPLICATION_CONTEXT_CLASS = "org.springframework.boot.web.reactive.context.ReactiveWebApplicationContext";

    /**
     * Ê†πÊçÆÁ±ªË∑ØÂæÑÔºåÊé®Êñ≠ Web Â∫îÁî®Á±ªÂûã
     *
     * @return Â∫îÁî®Á±ªÂûã
     */
    static WebApplicationType deduceFromClasspath() {
        // Â¶ÇÊûúÂ≠òÂú® org.springframework.web.reactive.DispatcherHandler Ôºå‰ΩÜÊòØ‰∏çÂ≠òÂú® org.springframework.web.servlet.DispatcherServlet Âíå org.glassfish.jersey.servlet.ServletContainer ÔºåÂàôÂÆö‰πâ‰∏∫ REACTIVE Á±ªÂûã
        if (ClassUtils.isPresent(WEBFLUX_INDICATOR_CLASS, null) && !ClassUtils.isPresent(WEBMVC_INDICATOR_CLASS, null)
                && !ClassUtils.isPresent(JERSEY_INDICATOR_CLASS, null)) {
            return WebApplicationType.REACTIVE;
        }
        // Â¶ÇÊûú‰∏çÂ≠òÂú® javax.servlet.Servlet Âíå org.springframework.web.context.ConfigurableWebApplicationContext ‰∏≠ÁöÑ‰ªª‰Ωï‰∏Ä‰∏™ÔºåÂàôÂÆö‰πâ‰∏∫ NONE Á±ªÂûã
        for (String className : SERVLET_INDICATOR_CLASSES) {
            if (!ClassUtils.isPresent(className, null)) {
                return WebApplicationType.NONE;
            }
        }
        // Âê¶ÂàôÔºåÂÆö‰πâ‰∏∫ SERVLET Á±ªÂûã
        return WebApplicationType.SERVLET;
    }

    // ... ÁúÅÁï•ÂÖ∂ÂÆÉÊñπÊ≥ï
}
```

- Ê†πÊçÆÁ±ªË∑ØÂæÑ‰∏äÊòØÂê¶Â≠òÂú®ÁâπÂÆöÁöÑÁ±ªÔºåËøõË°åÂà§Êñ≠„ÄÇÈÄªËæëÊØîËæÉÁÆÄÂçïÔºåÁúã‰∏ãÊ≥®ÈáäÂô¢„ÄÇ

## 2.2 ËÆæÁΩÆ Initializers

`#setInitializers(Collection<? extends ApplicationContextInitializer<?>> initializers)` ÊñπÊ≥ïÔºåËÆæÁΩÆÂ∫îÁî®‰∏ä‰∏ãÊñáÂàùÂßãÂåñÂô®ÔºàApplicationContextInitializerÔºâ„ÄÇ‰ª£Á†ÅÂ¶Ç‰∏ãÔºö

```java
// SpringApplication.java

/**
 * Â∫îÁî®‰∏ä‰∏ãÊñáÂàùÂßãÂåñÂô®ÈõÜÂêà
 */
private List<ApplicationContextInitializer<?>> initializers;

public void setInitializers(Collection<? extends ApplicationContextInitializer<?>> initializers) {
	this.initializers = new ArrayList<>(initializers);
}
```

- ÈÇ£‰πàÔºåËøô‰∫õ ApplicationContextInitializer ‰ªéÂì™ÈáåÊù•Âë¢ÔºüÁ≠îÊ°àÂú® `#getSpringFactoriesInstances(Class<T> type)` ÊñπÊ≥ï‰∏≠„ÄÇ‰ª£Á†ÅÂ¶Ç‰∏ãÔºö

  ```java
  // SpringApplication.java
  
  private <T> Collection<T> getSpringFactoriesInstances(Class<T> type) {
  	return getSpringFactoriesInstances(type, new Class<?>[] {});
  }
  
  private <T> Collection<T> getSpringFactoriesInstances(Class<T> type, Class<?>[] parameterTypes, Object... args) {
  	ClassLoader classLoader = getClassLoader();
  	// Use names and ensure unique to protect against duplicates
  	// <1> Âä†ËΩΩÊåáÂÆöÁ±ªÂûãÂØπÂ∫îÁöÑÔºåÂú® `META-INF/spring.factories` ÈáåÁöÑÁ±ªÂêçÁöÑÊï∞ÁªÑ
  	Set<String> names = new LinkedHashSet<>(SpringFactoriesLoader.loadFactoryNames(type, classLoader));
  	// <2> ÂàõÂª∫ÂØπË±°
  	List<T> instances = createSpringFactoriesInstances(type, parameterTypes, classLoader, args, names);
  	// <3> ÊéíÂ∫è
  	AnnotationAwareOrderComparator.sort(instances);
  	return instances;
  }
  ```

  - `<1>` Â§ÑÔºåË∞ÉÁî® `SpringFactoriesLoader#loadFactoryNames(Class<?> factoryClass, ClassLoader classLoader)` ÊñπÊ≥ïÔºåÂä†ËΩΩÊåáÂÆöÁ±ªÂûãÂØπÂ∫îÁöÑÔºåÂú® `META-INF/spring.factories` ÈáåÁöÑÁ±ªÂêçÁöÑÊï∞ÁªÑ„ÄÇ

    - Âú® `spring-boot` È°πÁõÆ‰∏≠ÁöÑ `META-INF/spring.factories` Êñá‰ª∂‰∏≠ÔºåÈªòËÆ§Êúâ ApplicationContextInitializer ÁöÑÂ¶Ç‰∏ãÈÖçÁΩÆÔºö

      ```properties
      # Initializers
      org.springframework.context.ApplicationContextInitializer=\
      org.springframework.boot.context.ConfigurationWarningsApplicationContextInitializer,\
      org.springframework.boot.context.ContextIdApplicationContextInitializer,\
      org.springframework.boot.context.config.DelegatingApplicationContextInitializer,\
      org.springframework.boot.web.context.ServerPortInfoApplicationContextInitializer
      ```

    - Âú® `spring-boot-autoconfigure` È°πÁõÆ‰∏≠ÁöÑ `META-INF/spring.factories` Êñá‰ª∂‰∏≠ÔºåÈªòËÆ§Êúâ ApplicationContextInitializer ÁöÑÂ¶Ç‰∏ãÈÖçÁΩÆÔºö

      ```properties
      # Initializers
      org.springframework.context.ApplicationContextInitializer=\
      org.springframework.boot.autoconfigure.SharedMetadataReaderFactoryContextInitializer,\
      org.springframework.boot.autoconfigure.logging.ConditionEvaluationReportLoggingListener
      ```

    - ÂΩìÁÑ∂ÔºåÂ¶ÇÊûúÈ°πÁõÆ‰∏≠ÊúâËá™ÂÆö‰πâÁöÑÈÖçÁΩÆÔºå‰πü‰ºöË¢´ËØªÂèñÂà∞„ÄÇ

  - `<2>` Â§ÑÔºåË∞ÉÁî® `#createSpringFactoriesInstances(Class<T> type, Class<?>[] parameterTypes, ClassLoader classLoader, Object[] args, Set<String> names)` ÊñπÊ≥ïÔºåÂàõÂª∫ÂØπË±°„ÄÇ‰ª£Á†ÅÂ¶Ç‰∏ãÔºö

    ```java
    // SpringApplication.java
    
    private <T> List<T> createSpringFactoriesInstances(Class<T> type, Class<?>[] parameterTypes,
    		ClassLoader classLoader, Object[] args, Set<String> names) {
    	List<T> instances = new ArrayList<>(names.size());
    	for (String name : names) {
    		try {
    			Class<?> instanceClass = ClassUtils.forName(name, classLoader);
    			Assert.isAssignable(type, instanceClass);
    			Constructor<?> constructor = instanceClass.getDeclaredConstructor(parameterTypes);
    			T instance = (T) BeanUtils.instantiateClass(constructor, args);
    			instances.add(instance);
    		} catch (Throwable ex) {
    			throw new IllegalArgumentException("Cannot instantiate " + type + " : " + name, ex);
    		}
    	}
    	return instances;
    }
    ```

    - ÈÄöËøáÂèçÂ∞ÑÔºåÂàõÂª∫ÂØπË±°„ÄÇ

  - `<3>` Â§ÑÔºåË∞ÉÁî® `AnnotationAwareOrderComparator#sort(List<?> list)` ÊñπÊ≥ïÔºåÊéíÂ∫èÂØπË±°„ÄÇ

    - ÂÖ≥‰∫é Order ÊéíÂ∫èÔºåÂèØ‰ª•ÁúãÁúã [„Ää„ÄêÊ≠ªÁ£ï Spring„Äë‚Äî‚Äî IoC ‰πãÊ∑±ÂÖ•ÂàÜÊûê ÔªøBeanFactoryPostProcessor„Äã](http://svip.iocoder.cn/Spring/IoC-BeanFactoryPostProcessor/) ÁöÑ [„Äå3.2 Order„Äç](http://svip.iocoder.cn/Spring-Boot/SpringApplication/#) Â∞èËäÇ„ÄÇ

## 2.3 ËÆæÁΩÆ Listeners

`#setListeners(Collection<? extends ApplicationListener<?>> listeners)` ÊñπÊ≥ïÔºåËÆæÁΩÆ‰∫ã‰ª∂ÁõëÂê¨Âô®ÔºàApplicationListenerÔºâ„ÄÇ‰ª£Á†ÅÂ¶Ç‰∏ãÔºö

```java
// SpringApplication.java

/**
 * ‰∫ã‰ª∂ÁõëÂê¨Âô®ÈõÜÂêà
 */
private List<ApplicationListener<?>> listeners;

public void setListeners(Collection<? extends ApplicationListener<?>> listeners) {
	this.listeners = new ArrayList<>(listeners);
}
```

- ÈÇ£‰πàÔºåËøô‰∫õ ApplicationListener ‰ªéÂì™ÈáåÊù•Âë¢ÔºüÁ≠îÊ°à‰πüÊòØ `#getSpringFactoriesInstances(Class<T> type)` ÊñπÊ≥ï‰∏≠„ÄÇ

  - Âú® `spring-boot` È°πÁõÆ‰∏≠ÁöÑ `META-INF/spring.factories` Êñá‰ª∂‰∏≠ÔºåÈªòËÆ§Êúâ ApplicationListener ÁöÑÂ¶Ç‰∏ãÈÖçÁΩÆÔºö

    ```properties
    # Application Listeners
    org.springframework.context.ApplicationListener=\
    org.springframework.boot.ClearCachesApplicationListener,\
    org.springframework.boot.builder.ParentContextCloserApplicationListener,\
    org.springframework.boot.context.FileEncodingApplicationListener,\
    org.springframework.boot.context.config.AnsiOutputApplicationListener,\
    org.springframework.boot.context.config.ConfigFileApplicationListener,\
    org.springframework.boot.context.config.DelegatingApplicationListener,\
    org.springframework.boot.context.logging.ClasspathLoggingApplicationListener,\
    org.springframework.boot.context.logging.LoggingApplicationListener,\
    org.springframework.boot.liquibase.LiquibaseServiceApplicationListener
    ```

  - ÂΩìÁÑ∂ÔºåÂ¶ÇÊûúÈ°πÁõÆ‰∏≠ÊúâËá™ÂÆö‰πâÁöÑÈÖçÁΩÆÔºå‰πü‰ºöË¢´ËØªÂèñÂà∞„ÄÇ

## 2.4 Êé®Êñ≠Â∫îÁî®ÊñπÊ≥ï

`#deduceMainApplicationClass()` ÊñπÊ≥ïÔºåÊé®Êñ≠Â∫îÁî®ÊñπÊ≥ï„ÄÇ‰ª£Á†ÅÂ¶Ç‰∏ãÔºö

```java
// SpringApplication.java

private Class<?> deduceMainApplicationClass() {
	try {
		// Ëé∑ÂæóÂΩìÂâç StackTraceElement Êï∞ÁªÑ
		StackTraceElement[] stackTrace = new RuntimeException().getStackTrace();
		// ÈÅçÂéÜÔºåÊü•Êâæ main ÊñπÊ≥ï
		for (StackTraceElement stackTraceElement : stackTrace) {
			if ("main".equals(stackTraceElement.getMethodName())) {
				return Class.forName(stackTraceElement.getClassName());
			}
		}
	} catch (ClassNotFoundException ex) {
		// Swallow and continue
	}
	return null;
}
```

- ÈÄöËøáÂºÇÂ∏∏ÁöÑÊñπÂºèÔºåËé∑ÂèñÂΩìÂâç StackTraceElement Êï∞ÁªÑÔºåÁÑ∂ÂêéÈÅçÂéÜÔºåÊü•Êâæ `main` ÊñπÊ≥ïÔºå‰ªéËÄåËé∑ÂæóÂØπÂ∫îÁöÑÁ±ª„ÄÇ

# 3. Â∞èÁªì

Ëá≥Ê≠§ÔºåSpringApplication ÁöÑÂàùÂßãÂåñÂÆåÊàê„ÄÇÂêéÁª≠ÔºåÊàë‰ª¨ÂºÄÂßãÁúãÁúã `#run(String... args)` ÊñπÊ≥ïÁöÑÊâßË°åÊµÅÁ®ã„ÄÇ

2025-08-25 13:00:39,906 - evaluation_logger_Attraction-35 - INFO - Complete Result: {'score': 0, 'reason': 'no requested information is addressed'}
2025-08-25 13:00:46,167 - evaluation_logger_Attraction-35 - INFO - Correct Result: {'score': 0, 'reason': 'All information in the response is incorrect.'}
2025-08-25 13:00:46,167 - evaluation_logger_Attraction-35 - INFO - Message: Success.
2025-08-25 13:00:46,167 - evaluation_logger_Attraction-35 - INFO - Success turn num = 2
2025-08-25 13:00:46,167 - evaluation_logger_Attraction-35 - INFO - ----------------------------------------------------------------------------------------------------
