2025-08-25 12:45:02,408 - evaluation_logger_Hotels-101 - INFO - Test Example Hotels-101
2025-08-25 12:45:02,408 - evaluation_logger_Hotels-101 - INFO - Query: My friends are planning to visit London from December 1st to December 6th, 2024. Find a hotel near the British Museum that is a beachfront hotel. Then find other nearby cities around hotel where they can continue their travel plans.
2025-08-25 12:45:11,713 - evaluation_logger_Hotels-101 - INFO - Function Calls: 
[
    {
        "name": "Search_Hotel_Destination",
        "arguments": {
            "query": "British Museum"
        }
    }
]

2025-08-25 12:45:11,713 - evaluation_logger_Hotels-101 - INFO - Golden Function Call: 
[
    {
        "name": "Search_Hotel_Destination",
        "arguments": {
            "query": "British Museum"
        }
    },
    {
        "name": "Get_Filter",
        "arguments": {
            "search_type": "landmark",
            "dest_id": "12605",
            "departure_date": "2024-12-06",
            "arrival_date": "2024-12-01"
        }
    }
]

2025-08-25 12:45:11,713 - evaluation_logger_Hotels-101 - INFO - Start compare_single_call: 
{'name': 'Search_Hotel_Destination', 'arguments': {'query': 'British Museum'}}
{'name': 'Search_Hotel_Destination', 'arguments': {'query': 'British Museum'}}
2025-08-25 12:45:11,713 - evaluation_logger_Hotels-101 - INFO - Rule-based compare success.
2025-08-25 12:45:11,713 - evaluation_logger_Hotels-101 - INFO - Success matched: [{'name': 'Search_Hotel_Destination', 'arguments': {'query': 'British Museum'}}]
2025-08-25 12:45:11,713 - evaluation_logger_Hotels-101 - INFO - Observations:
[
    {
        "status": true,
        "message": "Success",
        "data": [
            {
                "dest_id": "12605",
                "search_type": "landmark",
                "type": "la",
                "longitude": -0.126944,
                "label": "British Museum, London, Greater London, United Kingdom",
                "country": "United Kingdom",
                "city_ufi": -2601889,
                "roundtrip": "GgEwIAAoATICZW46DkJyaXRpc2ggTXVzZXVtQABKAFAA",
                "lc": "en",
                "hotels": 143,
                "dest_type": "landmark",
                "landmark_type": 5,
                "name": "British Museum",
                "nr_hotels": 143,
                "cc1": "gb",
                "latitude": 51.519444,
                "region": "Greater London",
                "city_name": "London"
            }
        ]
    }
]

2025-08-25 12:45:22,315 - evaluation_logger_Hotels-101 - INFO - Function Calls: 
[
    {
        "name": "Get_Filter",
        "arguments": {
            "search_type": "landmark",
            "dest_id": "12605",
            "departure_date": "2024-12-06",
            "arrival_date": "2024-12-01"
        }
    }
]

2025-08-25 12:45:22,315 - evaluation_logger_Hotels-101 - INFO - Golden Function Call: 
[
    {
        "name": "Get_Filter",
        "arguments": {
            "arrival_date": "2024-12-01",
            "departure_date": "2024-12-06",
            "dest_id": "12605",
            "search_type": "landmark"
        }
    },
    {
        "name": "Search_Hotels",
        "arguments": {
            "search_type": "landmark",
            "dest_id": 12605,
            "departure_date": "2024-12-06",
            "arrival_date": "2024-12-01",
            "categories_filter": "beach_access::1"
        }
    }
]

2025-08-25 12:45:22,316 - evaluation_logger_Hotels-101 - INFO - Start compare_single_call: 
{'name': 'Get_Filter', 'arguments': {'arrival_date': '2024-12-01', 'departure_date': '2024-12-06', 'dest_id': '12605', 'search_type': 'landmark'}}
{'name': 'Get_Filter', 'arguments': {'arrival_date': '2024-12-01', 'departure_date': '2024-12-06', 'dest_id': '12605', 'search_type': 'landmark'}}
2025-08-25 12:45:22,316 - evaluation_logger_Hotels-101 - INFO - Rule-based compare success.
2025-08-25 12:45:22,316 - evaluation_logger_Hotels-101 - INFO - Success matched: [{'name': 'Get_Filter', 'arguments': {'arrival_date': '2024-12-01', 'departure_date': '2024-12-06', 'dest_id': '12605', 'search_type': 'landmark'}}]
2025-08-25 12:45:22,317 - evaluation_logger_Hotels-101 - INFO - Observations:
[
    {
        "status": true,
        "message": "Success",
        "timestamp": 1729521689421,
        "data": {
            "pagination": {
                "nbResultsTotal": 7066
            },
            "availabilityInfo": {
                "totalAvailableNotAutoextended": 2410
            },
            "filters": [
                {
                    "title": "Your previous filters",
                    "field": "previous",
                    "filterStyle": "CHECKBOX",
                    "options": [
                        {
                            "title": "Hotels",
                            "genericId": "property_type::204",
                            "countNotAutoextended": 658
                        },
                        {
                            "title": "3 stars",
                            "genericId": "class::3",
                            "countNotAutoextended": 421
                        },
                        {
                            "title": "Breakfast included",
                            "genericId": "mealplan::breakfast_included",
                            "countNotAutoextended": 402
                        },
                        {
                            "title": "5 stars",
                            "genericId": "class::5",
                            "countNotAutoextended": 195
                        },
                        {
                            "title": "Free cancellation",
                            "genericId": "free_cancellation::1",
                            "countNotAutoextended": 1994
                        },
                        {
                            "title": "Free WiFi",
                            "genericId": "facility::107",
                            "countNotAutoextended": 2260
                        },
                        {
                            "title": "Very good: 8+",
                            "genericId": "reviewscorebuckets::80",
                            "countNotAutoextended": 1094
                        },
                        {
                            "title": "Pets allowed",
                            "genericId": "facility::4",
                            "countNotAutoextended": 332
                        },
                        {
                            "title": "Family rooms",
                            "genericId": "facility::28",
                            "countNotAutoextended": 961
                        }
                    ]
                },
                {
                    "title": "Your budget (for 5 nights)",
                    "field": "price",
                    "filterStyle": "SLIDER",
                    "options": [],
                    "min": "0",
                    "max": "3000",
                    "minPriceStep": "100",
                    "minSelected": "0",
                    "histogram": [
                        0,
                        8,
                        5,
                        12,
                        32,
                        62,
                        69,
                        86,
                        80,
                        86,
                        83,
                        87,
                        95,
                        85,
                        100,
                        98,
                        80,
                        91,
                        80,
                        74,
                        73,
                        67,
                        60,
                        45,
                        48,
                        48,
                        44,
                        35,
                        36,
                        34,
                        27,
                        26,
                        26,
                        23,
                        21,
                        22,
                        21,
                        18,
                        14,
                        14,
                        14,
                        17,
                        12,
                        7,
                        8,
                        7,
                        8,
                        10,
                        8,
                        7
                    ],
                    "currency": "GBP"
                },
                {
                    "title": "Popular filters",
                    "field": "popular",
                    "filterStyle": "CHECKBOX",
                    "options": [
                        {
                            "title": "Free WiFi",
                            "genericId": "facility::107",
                            "countNotAutoextended": 2260
                        },
                        {
                            "title": "Hotels",
                            "genericId": "property_type::204",
                            "countNotAutoextended": 658
                        },
                        {
                            "title": "Free cancellation",
                            "genericId": "free_cancellation::1",
                            "countNotAutoextended": 1994
                        },
                        {
                            "title": "Breakfast included",
                            "genericId": "mealplan::breakfast_included",
                            "countNotAutoextended": 402
                        },
                        {
                            "title": "Very good: 8+",
                            "genericId": "reviewscorebuckets::80",
                            "countNotAutoextended": 1094
                        },
                        {
                            "title": "Good: 7+",
                            "genericId": "reviewscorebuckets::70",
                            "countNotAutoextended": 1623
                        },
                        {
                            "title": "Homestays",
                            "genericId": "property_type::222",
                            "countNotAutoextended": 65
                        },
                        {
                            "title": "Double bed",
                            "genericId": "twin_double_bed::3",
                            "countNotAutoextended": 2302
                        }
                    ]
                },
                {
                    "title": "Review score",
                    "field": "review_score",
                    "filterStyle": "CHECKBOX",
                    "options": [
                        {
                            "title": "Passable: 5+",
                            "genericId": "reviewscorebuckets::50",
                            "countNotAutoextended": 1978
                        },
                        {
                            "title": "Pleasant: 6+",
                            "genericId": "reviewscorebuckets::60",
                            "countNotAutoextended": 1855
                        },
                        {
                            "title": "Good: 7+",
                            "genericId": "reviewscorebuckets::70",
                            "countNotAutoextended": 1623
                        },
                        {
                            "title": "Very good: 8+",
                            "genericId": "reviewscorebuckets::80",
                            "countNotAutoextended": 1094
                        },
                        {
                            "title": "Superb: 9+",
                            "genericId": "reviewscorebuckets::90",
                            "countNotAutoextended": 446
                        }
                    ]
                },
                {
                    "title": "Beach access",
                    "field": "ht_beach",
                    "filterStyle": "CHECKBOX",
                    "options": [
                        {
                            "title": "Beachfront",
                            "genericId": "beach_access::1",
                            "countNotAutoextended": 0
                        }
                    ]
                },
                {
                    "title": "Property type",
                    "field": "ht_id",
                    "filterStyle": "CHECKBOX",
                    "options": [
                        {
                            "title": "Apartments",
                            "genericId": "property_type::201",
                            "countNotAutoextended": 1569
                        },
                        {
                            "title": "Hotels",
                            "genericId": "property_type::204",
                            "countNotAutoextended": 658
                        },
                        {
                            "title": "Holiday homes",
                            "genericId": "property_type::220",
                            "countNotAutoextended": 57
                        },
                        {
                            "title": "Homestays",
                            "genericId": "property_type::222",
                            "countNotAutoextended": 65
                        },
                        {
                            "title": "Guest houses",
                            "genericId": "property_type::216",
                            "countNotAutoextended": 79
                        },
                        {
                            "title": "Bed and breakfasts",
                            "genericId": "property_type::208",
                            "countNotAutoextended": 15
                        },
                        {
                            "title": "Hostels",
                            "genericId": "property_type::203",
                            "countNotAutoextended": 38
                        },
                        {
                            "title": "Villas",
                            "genericId": "property_type::213",
                            "countNotAutoextended": 11
                        },
                        {
                            "title": "Cabins",
                            "genericId": "property_type_ml::9999",
                            "countNotAutoextended": 1
                        },
                        {
                            "title": "Boats",
                            "genericId": "property_type::215",
                            "countNotAutoextended": 4
                        },
                        {
                            "title": "Chalets",
                            "genericId": "property_type::228",
                            "countNotAutoextended": 0
                        },
                        {
                            "title": "Campsites",
                            "genericId": "property_type::214",
                            "countNotAutoextended": 0
                        },
                        {
                            "title": "Capsule hotels",
                            "genericId": "property_type::225",
                            "countNotAutoextended": 1
                        },
                        {
                            "title": "Motels",
                            "genericId": "property_type::205",
                            "countNotAutoextended": 0
                        },
                        {
                            "title": "Luxury tents",
                            "genericId": "property_type::224",
                            "countNotAutoextended": 0
                        },
                        {
                            "title": "Country houses",
                            "genericId": "property_type::223",
                            "countNotAutoextended": 0
                        },
                        {
                            "title": "Student accommodation",
                            "genericId": "property_type::235",
                            "countNotAutoextended": 1
                        }
                    ]
                },
                {
                    "title": "Chain",
                    "field": "chaincode",
                    "filterStyle": "CHECKBOX",
                    "options": [
                        {
                            "title": "Autograph Collection",
                            "genericId": "chaincode::2542",
                            "countNotAutoextended": 5
                        },
                        {
                            "title": "Best Western",
                            "genericId": "chaincode::1029",
                            "countNotAutoextended": 4
                        },
                        {
                            "title": "City Relay",
                            "genericId": "chaincode::12495",
                            "countNotAutoextended": 14
                        },
                        {
                            "title": "Curio Collection by Hilton",
                            "genericId": "chaincode::4381",
                            "countNotAutoextended": 5
                        },
                        {
                            "title": "Doubletree by Hilton",
                            "genericId": "chaincode::1984",
                            "countNotAutoextended": 7
                        },
                        {
                            "title": "GuestReady",
                            "genericId": "chaincode::12642",
                            "countNotAutoextended": 10
                        },
                        {
                            "title": "Hampton Inn",
                            "genericId": "chaincode::1851",
                            "countNotAutoextended": 3
                        },
                        {
                            "title": "Hilton Hotels & Resorts",
                            "genericId": "chaincode::1078",
                            "countNotAutoextended": 9
                        },
                        {
                            "title": "Holiday Inn Express",
                            "genericId": "chaincode::2301",
                            "countNotAutoextended": 2
                        },
                        {
                            "title": "Holiday Inn Hotels & Resorts",
                            "genericId": "chaincode::1072",
                            "countNotAutoextended": 4
                        },
                        {
                            "title": "ibis",
                            "genericId": "chaincode::1053",
                            "countNotAutoextended": 2
                        },
                        {
                            "title": "Leonardo Hotels",
                            "genericId": "chaincode::1844",
                            "countNotAutoextended": 5
                        },
                        {
                            "title": "Marriott Hotels & Resorts",
                            "genericId": "chaincode::1080",
                            "countNotAutoextended": 6
                        },
                        {
                            "title": "Mercure",
                            "genericId": "chaincode::1051",
                            "countNotAutoextended": 4
                        },
                        {
                            "title": "Montcalm Collection",
                            "genericId": "chaincode::1705",
                            "countNotAutoextended": 10
                        },
                        {
                            "title": "Novotel",
                            "genericId": "chaincode::1050",
                            "countNotAutoextended": 5
                        },
                        {
                            "title": "OYO Rooms",
                            "genericId": "chaincode::6015",
                            "countNotAutoextended": 6
                        },
                        {
                            "title": "Park Plaza Hotels & Resorts",
                            "genericId": "chaincode::1040",
                            "countNotAutoextended": 6
                        },
                        {
                            "title": "Pass the Keys",
                            "genericId": "chaincode::14869",
                            "countNotAutoextended": 9
                        },
                        {
                            "title": "Point A Hotels",
                            "genericId": "chaincode::9857",
                            "countNotAutoextended": 5
                        },
                        {
                            "title": "Radisson Blu",
                            "genericId": "chaincode::8648",
                            "countNotAutoextended": 8
                        },
                        {
                            "title": "Sonder",
                            "genericId": "chaincode::14572",
                            "countNotAutoextended": 9
                        },
                        {
                            "title": "Young & Co.’s Brewery",
                            "genericId": "chaincode::14659",
                            "countNotAutoextended": 0
                        },
                        {
                            "title": "Your.Rentals",
                            "genericId": "chaincode::10257",
                            "countNotAutoextended": 0
                        },
                        {
                            "title": "Z Hotels",
                            "genericId": "chaincode::8718",
                            "countNotAutoextended": 11
                        }
                    ]
                },
                {
                    "title": "Facilities",
                    "field": "hotelfacility",
                    "filterStyle": "CHECKBOX",
                    "options": [
                        {
                            "title": "Free WiFi",
                            "genericId": "facility::107",
                            "countNotAutoextended": 2260
                        },
                        {
                            "title": "Non-smoking rooms",
                            "genericId": "facility::16",
                            "countNotAutoextended": 1514
                        },
                        {
                            "title": "Parking",
                            "genericId": "facility::2",
                            "countNotAutoextended": 525
                        },
                        {
                            "title": "Family rooms",
                            "genericId": "facility::28",
                            "countNotAutoextended": 961
                        },
                        {
                            "title": "Free parking",
                            "genericId": "facility::46",
                            "countNotAutoextended": 66
                        },
                        {
                            "title": "24-hour front desk",
                            "genericId": "facility::8",
                            "countNotAutoextended": 662
                        },
                        {
                            "title": "Pets allowed",
                            "genericId": "facility::4",
                            "countNotAutoextended": 332
                        },
                        {
                            "title": "Restaurant",
                            "genericId": "facility::3",
                            "countNotAutoextended": 369
                        },
                        {
                            "title": "Room service",
                            "genericId": "facility::5",
                            "countNotAutoextended": 312
                        },
                        {
                            "title": "Wheelchair accessible",
                            "genericId": "facility::185",
                            "countNotAutoextended": 234
                        },
                        {
                            "title": "Fitness centre",
                            "genericId": "facility::11",
                            "countNotAutoextended": 268
                        },
                        {
                            "title": "Airport shuttle",
                            "genericId": "facility::17",
                            "countNotAutoextended": 114
                        },
                        {
                            "title": "Electric vehicle charging station",
                            "genericId": "facility::182",
                            "countNotAutoextended": 84
                        },
                        {
                            "title": "Adult only",
                            "genericId": "facility::149",
                            "countNotAutoextended": 65
                        },
                        {
                            "title": "BBQ facilities",
                            "genericId": "facility::72",
                            "countNotAutoextended": 40
                        },
                        {
                            "title": "Swimming Pool",
                            "genericId": "facility::433",
                            "countNotAutoextended": 65
                        },
                        {
                            "title": "Spa and wellness centre",
                            "genericId": "facility::54",
                            "countNotAutoextended": 67
                        },
                        {
                            "title": "Airport shuttle (free)",
                            "genericId": "facility::139",
                            "countNotAutoextended": 1
                        }
                    ]
                },
                {
                    "title": "Distance from landmark",
                    "field": "distance",
                    "filterStyle": "CHECKBOX",
                    "options": [
                        {
                            "title": "Less than 1 km",
                            "genericId": "distance::1000",
                            "countNotAutoextended": 229
                        },
                        {
                            "title": "Less than 3 km",
                            "genericId": "distance::3000",
                            "countNotAutoextended": 1096
                        },
                        {
                            "title": "Less than 5 km",
                            "genericId": "distance::5000",
                            "countNotAutoextended": 2410
                        }
                    ]
                },
                {
                    "title": "Landmarks",
                    "field": "popular_nearby_landmarks",
                    "filterStyle": "CHECKBOX",
                    "options": [
                        {
                            "title": "Barking",
                            "genericId": "popular_nearby_landmarks::10808",
                            "countNotAutoextended": 0
                        },
                        {
                            "title": "Barking Station",
                            "genericId": "popular_nearby_landmarks::210628",
                            "countNotAutoextended": 0
                        },
                        {
                            "title": "Brunel University",
                            "genericId": "popular_nearby_landmarks::205807",
                            "countNotAutoextended": 0
                        },
                        {
                            "title": "Chessington World of Adventures",
                            "genericId": "popular_nearby_landmarks::11961",
                            "countNotAutoextended": 0
                        },
                        {
                            "title": "Cockfosters",
                            "genericId": "popular_nearby_landmarks::10839",
                            "countNotAutoextended": 0
                        },
                        {
                            "title": "Croydon University Hospital",
                            "genericId": "popular_nearby_landmarks::900065852",
                            "countNotAutoextended": 0
                        },
                        {
                            "title": "Eastcote",
                            "genericId": "popular_nearby_landmarks::10847",
                            "countNotAutoextended": 0
                        },
                        {
                            "title": "Edgware",
                            "genericId": "popular_nearby_landmarks::10851",
                            "countNotAutoextended": 0
                        },
                        {
                            "title": "Hampton Court Palace",
                            "genericId": "popular_nearby_landmarks::15723",
                            "countNotAutoextended": 0
                        },
                        {
                            "title": "Harrow School",
                            "genericId": "popular_nearby_landmarks::900065913",
                            "countNotAutoextended": 0
                        },
                        {
                            "title": "Hatton Cross",
                            "genericId": "popular_nearby_landmarks::10879",
                            "countNotAutoextended": 0
                        },
                        {
                            "title": "Heathrow Terminal 4",
                            "genericId": "popular_nearby_landmarks::10881",
                            "countNotAutoextended": 0
                        },
                        {
                            "title": "Hounslow Central",
                            "genericId": "popular_nearby_landmarks::10892",
                            "countNotAutoextended": 0
                        },
                        {
                            "title": "Kew Gardens",
                            "genericId": "popular_nearby_landmarks::11044",
                            "countNotAutoextended": 0
                        },
                        {
                            "title": "London Eye",
                            "genericId": "popular_nearby_landmarks::1722",
                            "countNotAutoextended": 62
                        },
                        {
                            "title": "London Zoo",
                            "genericId": "popular_nearby_landmarks::1728",
                            "countNotAutoextended": 51
                        },
                        {
                            "title": "Mount Vernon Hospital",
                            "genericId": "popular_nearby_landmarks::900065807",
                            "countNotAutoextended": 0
                        },
                        {
                            "title": "Northwood",
                            "genericId": "popular_nearby_landmarks::10937",
                            "countNotAutoextended": 0
                        },
                        {
                            "title": "Perivale",
                            "genericId": "popular_nearby_landmarks::10949",
                            "countNotAutoextended": 0
                        },
                        {
                            "title": "Redbridge",
                            "genericId": "popular_nearby_landmarks::10960",
                            "countNotAutoextended": 0
                        },
                        {
                            "title": "Richmond Station",
                            "genericId": "popular_nearby_landmarks::212044",
                            "countNotAutoextended": 0
                        },
                        {
                            "title": "Ruislip",
                            "genericId": "popular_nearby_landmarks::10965",
                            "countNotAutoextended": 0
                        },
                        {
                            "title": "South Harrow",
                            "genericId": "popular_nearby_landmarks::10977",
                            "countNotAutoextended": 0
                        },
                        {
                            "title": "South Mimms Services M25",
                            "genericId": "popular_nearby_landmarks::264319",
                            "countNotAutoextended": 0
                        },
                        {
                            "title": "The Grove",
                            "genericId": "popular_nearby_landmarks::8407",
                            "countNotAutoextended": 0
                        },
                        {
                            "title": "The Orchard Theatre",
                            "genericId": "popular_nearby_landmarks::900116664",
                            "countNotAutoextended": 0
                        },
                        {
                            "title": "The Stoop",
                            "genericId": "popular_nearby_landmarks::15919",
                            "countNotAutoextended": 0
                        },
                        {
                            "title": "Tower of London",
                            "genericId": "popular_nearby_landmarks::846",
                            "countNotAutoextended": 88
                        },
                        {
                            "title": "Twickenham Stadium",
                            "genericId": "popular_nearby_landmarks::12535",
                            "countNotAutoextended": 0
                        },
                        {
                            "title": "Watford General Hospital",
                            "genericId": "popular_nearby_landmarks::900065358",
                            "countNotAutoextended": 0
                        },
                        {
                            "title": "Watford Junction",
                            "genericId": "popular_nearby_landmarks::22043",
                            "countNotAutoextended": 0
                        },
                        {
                            "title": "Watford Stadium",
                            "genericId": "popular_nearby_landmarks::22045",
                            "countNotAutoextended": 0
                        }
                    ]
                },
                {
                    "title": "Property rating",
                    "field": "class",
                    "filterStyle": "CHECKBOX",
                    "options": [
                        {
                            "title": "Unrated",
                            "genericId": "class::0",
                            "countNotAutoextended": 550
                        },
                        {
                            "title": "1 star",
                            "genericId": "class::1",
                            "countNotAutoextended": 0
                        },
                        {
                            "title": "2 stars",
                            "genericId": "class::2",
                            "countNotAutoextended": 90
                        },
                        {
                            "title": "3 stars",
                            "genericId": "class::3",
                            "countNotAutoextended": 421
                        },
                        {
                            "title": "4 stars",
                            "genericId": "class::4",
                            "countNotAutoextended": 1154
                        },
                        {
                            "title": "5 stars",
                            "genericId": "class::5",
                            "countNotAutoextended": 195
                        }
                    ]
                },
                {
                    "title": "Bed preference",
                    "field": "tdb",
                    "filterStyle": "CHECKBOX",
                    "options": [
                        {
                            "title": "2 single beds",
                            "genericId": "twin_double_bed::2",
                            "countNotAutoextended": 424
                        },
                        {
                            "title": "Double bed",
                            "genericId": "twin_double_bed::3",
                            "countNotAutoextended": 2302
                        }
                    ]
                },
                {
                    "title": "Room facilities",
                    "field": "roomfacility",
                    "filterStyle": "CHECKBOX",
                    "options": [
                        {
                            "title": "Coffee machine",
                            "genericId": "room_facility::120",
                            "countNotAutoextended": 795
                        },
                        {
                            "title": "Electric kettle",
                            "genericId": "room_facility::86",
                            "countNotAutoextended": 1610
                        },
                        {
                            "title": "View",
                            "genericId": "room_facility::81",
                            "countNotAutoextended": 811
                        },
                        {
                            "title": "Washing machine",
                            "genericId": "room_facility::34",
                            "countNotAutoextended": 1451
                        },
                        {
                            "title": "Flat-screen TV",
                            "genericId": "room_facility::75",
                            "countNotAutoextended": 1803
                        },
                        {
                            "title": "Balcony",
                            "genericId": "room_facility::17",
                            "countNotAutoextended": 410
                        },
                        {
                            "title": "Bath",
                            "genericId": "room_facility::5",
                            "countNotAutoextended": 946
                        },
                        {
                            "title": "Desk",
                            "genericId": "room_facility::23",
                            "countNotAutoextended": 1201
                        },
                        {
                            "title": "Air conditioning",
                            "genericId": "room_facility::11",
                            "countNotAutoextended": 819
                        },
                        {
                            "title": "Kitchenette",
                            "genericId": "room_facility::16",
                            "countNotAutoextended": 571
                        },
                        {
                            "title": "Private bathroom",
                            "genericId": "room_facility::38",
                            "countNotAutoextended": 1685
                        }
                    ]
                },
                {
                    "title": "Free cancellation ",
                    "field": "fc",
                    "filterStyle": "CHECKBOX",
                    "options": [
                        {
                            "title": "Free cancellation",
                            "genericId": "free_cancellation::1",
                            "countNotAutoextended": 1994
                        }
                    ]
                },
                {
                    "title": "Online payment",
                    "field": "pmt",
                    "filterStyle": "CHECKBOX",
                    "options": [
                        {
                            "title": "Accepts online payments",
                            "genericId": "pmt::101",
                            "countNotAutoextended": 2152
                        }
                    ]
                },
                {
                    "title": "Number of bedrooms",
                    "field": "entire_place_bedroom_count",
                    "filterStyle": "CHECKBOX",
                    "options": [
                        {
                            "title": "1+ bedrooms",
                            "genericId": "entire_place_bedroom_count::1",
                            "countNotAutoextended": 1654
                        },
                        {
                            "title": "2+ bedrooms",
                            "genericId": "entire_place_bedroom_count::2",
                            "countNotAutoextended": 871
                        },
                        {
                            "title": "3+ bedrooms",
                            "genericId": "entire_place_bedroom_count::3",
                            "countNotAutoextended": 288
                        },
                        {
                            "title": "4+ bedrooms",
                            "genericId": "entire_place_bedroom_count::4",
                            "countNotAutoextended": 64
                        }
                    ]
                },
                {
                    "title": "Meals",
                    "field": "mealplan",
                    "filterStyle": "CHECKBOX",
                    "options": [
                        {
                            "title": "Breakfast included",
                            "genericId": "mealplan::breakfast_included",
                            "countNotAutoextended": 402
                        },
                        {
                            "title": "Breakfast & lunch included",
                            "genericId": "mealplan::breakfast_and_lunch",
                            "countNotAutoextended": 0
                        },
                        {
                            "title": "Breakfast & dinner included",
                            "genericId": "mealplan::breakfast_and_dinner",
                            "countNotAutoextended": 19
                        },
                        {
                            "title": "Self catering",
                            "genericId": "mealplan::999",
                            "countNotAutoextended": 1671
                        }
                    ]
                }
            ]
        }
    }
]

2025-08-25 12:45:32,001 - evaluation_logger_Hotels-101 - INFO - Function Calls: 
[
    {
        "name": "Search_Hotels",
        "arguments": {
            "search_type": "landmark",
            "dest_id": 12605,
            "arrival_date": "2024-12-01",
            "departure_date": "2024-12-06",
            "categories_filter": "beach_access::1"
        }
    }
]

2025-08-25 12:45:32,001 - evaluation_logger_Hotels-101 - INFO - Golden Function Call: 
[
    {
        "name": "Search_Hotels",
        "arguments": {
            "arrival_date": "2024-12-01",
            "categories_filter": "beach_access::1",
            "departure_date": "2024-12-06",
            "dest_id": 12605,
            "search_type": "landmark"
        }
    },
    {
        "name": "Get_Nearby_Cities",
        "arguments": {
            "latitude": "51.50501717392",
            "longitude": "-0.054550923589"
        }
    }
]

2025-08-25 12:45:32,001 - evaluation_logger_Hotels-101 - INFO - Start compare_single_call: 
{'name': 'Search_Hotels', 'arguments': {'arrival_date': '2024-12-01', 'categories_filter': 'beach_access::1', 'departure_date': '2024-12-06', 'dest_id': 12605, 'search_type': 'landmark'}}
{'name': 'Search_Hotels', 'arguments': {'arrival_date': '2024-12-01', 'categories_filter': 'beach_access::1', 'departure_date': '2024-12-06', 'dest_id': 12605, 'search_type': 'landmark'}}
2025-08-25 12:45:32,001 - evaluation_logger_Hotels-101 - INFO - Rule-based compare success.
2025-08-25 12:45:32,001 - evaluation_logger_Hotels-101 - INFO - Success matched: [{'name': 'Search_Hotels', 'arguments': {'arrival_date': '2024-12-01', 'categories_filter': 'beach_access::1', 'departure_date': '2024-12-06', 'dest_id': 12605, 'search_type': 'landmark'}}]
2025-08-25 12:45:32,002 - evaluation_logger_Hotels-101 - INFO - Observations:
[
    {
        "status": true,
        "message": "Success",
        "data": {
            "hotels": [
                {
                    "hotel_id": 11367085,
                    "accessibilityLabel": "Perfect in the centre with view.\n3 out of 5 for property rating.\n7.5 Good 32 reviews.\n‎Tower Hamlets, London‬ • ‎5 km from British Museum‬.\n Entire apartment – 73 m² : 3 beds • 2 bedrooms • 1 living room • 1 bathroom.\nOriginal price 1491 USD. Current price 1342 USD..\nIncludes taxes and charges.",
                    "property": {
                        "ufi": -2601889,
                        "longitude": -0.054550923589,
                        "accuratePropertyClass": 0,
                        "reviewScore": 7.5,
                        "currency": "GBP",
                        "qualityClass": 3,
                        "wishlistName": "London",
                        "checkout": {
                            "untilTime": "11:00",
                            "fromTime": "00:00"
                        },
                        "blockIds": [
                            "1136708501_386286560_1_0_0"
                        ],
                        "propertyClass": 0,
                        "rankingPosition": 0,
                        "id": 11367085,
                        "priceBreakdown": {
                            "grossPrice": {
                                "currency": "USD",
                                "value": 1341.88606511212
                            },
                            "benefitBadges": [
                                {
                                    "identifier": "Mobile Rate",
                                    "variant": "constructive",
                                    "explanation": "Mobile-only price",
                                    "text": "Mobile-only price"
                                }
                            ],
                            "strikethroughPrice": {
                                "currency": "USD",
                                "value": 1490.98451679125
                            }
                        },
                        "latitude": 51.50501717392,
                        "isFirstPage": true,
                        "checkin": {
                            "untilTime": "00:00",
                            "fromTime": "15:00"
                        },
                        "name": "Perfect in the centre with view",
                        "reviewScoreWord": "Good",
                        "position": 0,
                        "isExtended": true,
                        "checkoutDate": "2024-12-06",
                        "countryCode": "gb",
                        "checkinDate": "2024-12-01",
                        "mainPhotoId": 520664022,
                        "reviewCount": 32,
                        "optOutFromGalleryChanges": 0
                    }
                }
            ],
            "meta": [
                {
                    "title": "3 properties around British Museum"
                }
            ],
            "appear": [
                {
                    "component": {
                        "props": {
                            "content": {
                                "props": {
                                    "fitContentWidth": true,
                                    "items": [
                                        {
                                            "props": {
                                                "component": {
                                                    "props": {
                                                        "spacing": "spacing_half",
                                                        "items": [
                                                            {
                                                                "props": {
                                                                    "text": [
                                                                        {
                                                                            "font": "body_2",
                                                                            "text": "Commission paid and other benefits may affect an accommodation's ranking."
                                                                        },
                                                                        {
                                                                            "font": "strong_2",
                                                                            "text": "  ",
                                                                            "color": "foreground"
                                                                        },
                                                                        {
                                                                            "color": "action_foreground",
                                                                            "linkActions": [
                                                                                {}
                                                                            ],
                                                                            "text": "Find out more",
                                                                            "font": "body_2"
                                                                        }
                                                                    ]
                                                                }
                                                            }
                                                        ]
                                                    }
                                                }
                                            }
                                        },
                                        {},
                                        {
                                            "props": {
                                                "component": {
                                                    "props": {
                                                        "tertiaryTintedColor": "foreground",
                                                        "icon": "close",
                                                        "accessibilityLabel": "Close",
                                                        "variant": "tertiary_tinted"
                                                    }
                                                }
                                            }
                                        }
                                    ]
                                }
                            },
                            "fill": true
                        }
                    },
                    "id": "cma"
                },
                {
                    "component": {
                        "props": {
                            "text": "Properties with these icons have been awarded Booking.com's quality rating for homes"
                        }
                    },
                    "id": "banner_qualityrating"
                },
                {},
                {
                    "id": "take-control-of-your-search-banner",
                    "component": {
                        "props": {
                            "content": {
                                "props": {
                                    "fitContentWidth": true,
                                    "items": [
                                        {
                                            "props": {
                                                "component": {
                                                    "props": {
                                                        "items": [
                                                            {
                                                                "props": {
                                                                    "font": "strong_1",
                                                                    "text": "Take control of your search"
                                                                }
                                                            },
                                                            {
                                                                "props": {
                                                                    "text": "Maximise availability by removing a filter:"
                                                                }
                                                            },
                                                            {
                                                                "props": {
                                                                    "component": {
                                                                        "props": {
                                                                            "state": "dismissible",
                                                                            "text": "Beachfront",
                                                                            "deselectActions": [
                                                                                {}
                                                                            ]
                                                                        }
                                                                    }
                                                                }
                                                            },
                                                            {
                                                                "props": {
                                                                    "component": {
                                                                        "props": {
                                                                            "variant": "tertiary",
                                                                            "text": "Clear filters",
                                                                            "negativeInsetAdjustment": {
                                                                                "top": true,
                                                                                "start": true,
                                                                                "bottom": true,
                                                                                "end": true
                                                                            },
                                                                            "iconPosition": "end",
                                                                            "icon": "arrow_nav_right"
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                        ],
                                                        "spacing": "spacing_half"
                                                    }
                                                }
                                            }
                                        },
                                        {},
                                        {
                                            "props": {
                                                "component": {
                                                    "props": {
                                                        "icon": "close",
                                                        "accessibilityLabel": "Close this section",
                                                        "variant": "tertiary_tinted",
                                                        "tertiaryTintedColor": "foreground"
                                                    }
                                                }
                                            }
                                        }
                                    ]
                                }
                            },
                            "fill": true
                        }
                    }
                }
            ]
        }
    }
]

2025-08-25 12:45:40,573 - evaluation_logger_Hotels-101 - INFO - Function Calls: 
[
    {
        "name": "Get_Nearby_Cities",
        "arguments": {
            "latitude": "51.50501717392",
            "longitude": "-0.054550923589"
        }
    }
]

2025-08-25 12:45:40,573 - evaluation_logger_Hotels-101 - INFO - Golden Function Call: 
[
    {
        "name": "Get_Nearby_Cities",
        "arguments": {
            "latitude": "51.50501717392",
            "longitude": "-0.054550923589"
        }
    }
]

2025-08-25 12:45:40,573 - evaluation_logger_Hotels-101 - INFO - Start compare_single_call: 
{'name': 'Get_Nearby_Cities', 'arguments': {'latitude': '51.50501717392', 'longitude': '-0.054550923589'}}
{'name': 'Get_Nearby_Cities', 'arguments': {'latitude': '51.50501717392', 'longitude': '-0.054550923589'}}
2025-08-25 12:45:40,573 - evaluation_logger_Hotels-101 - INFO - Rule-based compare success.
2025-08-25 12:45:40,573 - evaluation_logger_Hotels-101 - INFO - Success matched: [{'name': 'Get_Nearby_Cities', 'arguments': {'latitude': '51.50501717392', 'longitude': '-0.054550923589'}}]
2025-08-25 12:45:40,573 - evaluation_logger_Hotels-101 - INFO - Observations:
[
    {
        "status": true,
        "message": "Success",
        "data": [
            {
                "country": "United Kingdom",
                "dest_id": -2607732,
                "cc1": "gb",
                "dest_type": "city",
                "latitude": 51.5332984924316,
                "longitude": -0.0833332985639572,
                "name": "Shoreditch",
                "nr_hotels": 1
            }
        ]
    }
]

2025-08-25 12:48:52,326 - evaluation_logger_Hotels-101 - INFO - Final Response: <｜begin▁of▁sentence｜># 1. 概述

## 1.1 什么是Spring

Spring是一个开源框架，它由[Rod Johnson](https://baike.baidu.com/item/Rod Johnson)创建。它是为了解决企业应用开发的复杂性而创建的。

Spring使用基本的JavaBean来完成以前只可能由EJB完成的事情。

然而，Spring的用途不仅限于服务器端的开发。从简单性、可测试性和松耦合的角度而言，任何Java应用都可以从Spring中受益。

**目的：**解决企业应用开发的复杂性

**功能：**使用基本的JavaBean代替EJB，并提供了更多的企业应用功能

**范围：**任何Java应用

简单来说，Spring是一个轻量级的控制反转(IoC)和面向切面(AOP)的容器框架。

## 1.2 Spring框架的特点

- **轻量**：从大小与开销两方面而言Spring都是轻量的。完整的Spring框架可以在一个大小只有1MB多的JAR文件里发布。并且Spring所需的处理开销也是微不足道的。此外，Spring是非侵入式的：典型地，Spring应用中的对象不依赖于Spring的特定类。
- **控制反转**：Spring通过一种称作控制反转（IoC）的技术促进了松耦合。当应用了IoC，一个对象依赖的其它对象会通过被动的方式传递进来，而不是这个对象自己创建或者查找依赖对象。你可以认为IoC与JNDI相反——不是对象从容器中查找依赖，而是容器在对象初始化时不等对象请求就主动将依赖传递给它。
- **面向切面**：Spring提供了面向切面编程的丰富支持，允许通过分离应用的业务逻辑与系统级服务（例如审计（auditing）和事务（transaction）管理）进行内聚性的开发。应用对象只实现它们应该做的——完成业务逻辑——仅此而已。它们并不负责（甚至是意识）其它的系统级关注点，例如日志或事务支持。
- **容器**：Spring包含并管理应用对象的配置和生命周期，在这个意义上它是一种容器，你可以配置你的每个bean如何被创建——基于一个可配置原型（prototype），你的bean可以创建一个单独的实例或者每次需要时都生成一个新的实例——以及它们是如何相互关联的。然而，Spring不应该被混同于传统的重量级的EJB容器，它们经常是庞大与笨重的，难以使用。
- **框架**：Spring可以将简单的组件配置、组合成为复杂的应用。在Spring中，应用对象被声明式地组合，典型地是在一个XML文件里。Spring也提供了很多基础功能（事务管理、持久化框架集成等等），将应用逻辑的开发留给了你。

所有Spring的这些特征使你能够编写更干净、更可管理、并且更易于测试的代码。它们也为Spring中的各种模块提供了基础支持。

# 2. 快速入门

## 2.1 导入jar包

- commons-logging-1.2.jar
- spring-beans-5.2.3.RELEASE.jar
- spring-context-5.2.3.RELEASE.jar
- spring-core-5.2.3.RELEASE.jar
- spring-expression-5.2.3.RELEASE.jar

## 2.2 核心配置文件

在src目录下创建applicationContext.xml

```xml
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">

    <!-- 将User对象交给spring容器管理 -->
    <!-- Bean元素:使用该元素描述需要spring容器管理的对象
            class属性:被管理对象的完整类名.
            name属性:给被管理的对象起个名字.获得对象时根据该名称获得对象.  
                    可以重复.可以使用特殊字符.
            id属性: 与name属性一模一样. 
                    名称不可重复.不能使用特殊字符.
            结论: 尽量使用name属性.
      -->
    <bean name="user" class="com.itheima.bean.User" ></bean>

</beans>
```

## 2.3 测试

```java
//1.创建容器对象
ApplicationContext ac = new ClassPathXmlApplicationContext("applicationContext.xml");
//2.向容器"要"user对象
User u = (User) ac.getBean("user");
//3.打印user对象
System.out.println(u);
```

# 3. Spring的工厂类

## 3.1 工厂类的结构图

![image-20200529111950575](图片.assets/image-20200529111950575.png)

- **ApplicationContext**: 加载配置文件的时候就会创建对象
- **BeanFactory**: 加载配置文件的时候不会创建对象，在获取对象的时候才会创建对象

## 3.2 ApplicationContext

- ClassPathXmlApplicationContext：加载类路径下的配置文件
- FileSystemXmlApplicationContext：加载文件系统下的配置文件

# 4. Spring配置

## 4.1 Bean元素配置

```xml
<!-- 将User对象交给spring容器管理 -->
<!-- Bean元素:使用该元素描述需要spring容器管理的对象
        class属性:被管理对象的完整类名.
        name属性:给被管理的对象起个名字.获得对象时根据该名称获得对象.  
                可以重复.可以使用特殊字符.
        id属性: 与name属性一模一样. 
                名称不可重复.不能使用特殊字符.
        结论: 尽量使用name属性.
  -->
<bean name="user" class="com.itheima.bean.User" ></bean>
```

## 4.2 Bean元素进阶

### 4.2.1 scope属性

- **singleton**: 默认值，单例对象，被标识为单例的对象在spring容器中只会存在一个实例
- **prototype**: 多例原型，被标识为多例的对象，每次再获得才会创建，每次创建都是新的对象，整合struts2时,ActionBean必须配置为多例的.
- **request**: web环境下.对象与request生命周期一致.
- **session**: web环境下,对象与session生命周期一致.

### 4.2.2 生命周期属性

- **init-method**:配置一个方法作为生命周期初始化方法.spring会在对象创建之后立即调用.
- **destroy-method**:配置一个方法作为生命周期的销毁方法.spring容器在关闭并销毁所有容器中的对象之前调用.

```xml
<bean name="user" class="com.itheima.bean.User" init-method="init" destroy-method="destroy" ></bean>
```

## 4.3 模块化配置

```xml
<import resource="applicationContext2.xml"/>
```

# 5. Spring属性注入

## 5.1 构造方法方式注入

- 在类中提供构造方法

```java
public class Car {
    private String name;
    private double price;

    public Car(String name, double price) {
        this.name = name;
        this.price = price;
    }

    @Override
    public String toString() {
        return "Car{" +
                "name='" + name + '\'' +
                ", price=" + price +
                '}';
    }
}
```

- 配置

```xml
<!-- 构造方法方式 -->
<bean name="car" class="com.itheima.bean.Car" >
    <constructor-arg name="name" value="宝马" ></constructor-arg>
    <constructor-arg name="price" value="800000" ></constructor-arg>
</bean>
```

## 5.2 set方法方式注入

- 在类中提供set方法

```java
public class Car2 {
    private String name;
    private double price;

    public void setName(String name) {
        this.name = name;
    }

    public void setPrice(double price) {
        this.price = price;
    }

    @Override
    public String toString() {
        return "Car2{" +
                "name='" + name + '\'' +
                ", price=" + price +
                '}';
    }
}
```

- 配置

```xml
<!-- set方法方式 -->
<bean name="car2" class="com.itheima.bean.Car2" >
    <property name="name" value="奔驰" ></property>
    <property name="price" value="1000000" ></property>
</bean>
```

## 5.3 注入对象类型属性

- 创建User类，并在User类中引入Car属性

```java
public class User {
    private String name;
    private Car car;

    public void setName(String name) {
        this.name = name;
    }

    public void setCar(Car car) {
        this.car = car;
    }

    @Override
    public String toString() {
        return "User{" +
                "name='" + name + '\'' +
                ", car=" + car +
                '}';
    }
}
```

- 配置

```xml
<bean name="user" class="com.itheima.bean.User" >
    <property name="name" value="tom" ></property>
    <property name="car" ref="car" ></property>
</bean>
```

## 5.4 p名称空间注入

- 通过引入p名称空间完成属性的注入：

  - 写法：
    - 普通属性 p:属性名=”值”
    - 对象属性 p:属性名-ref=”值”

- p名称空间的引入

  ```xml
  xmlns:p="http://www.springframework.org/schema/p"
  ```

- 配置

```xml
<!-- p名称空间方式 -->
<bean name="user2" class="com.itheima.bean.User" p:name="jack" p:car-ref="car" ></bean>
```

## 5.5 spel方式注入

- spel：spring Expression Language，spring的表达式语言

```xml
<!-- spel方式 -->
<bean name="user3" class="com.itheima.bean.User" >
    <property name="name" value="#{user.name}" ></property>
    <property name="car" ref="car" ></property>
</bean>
```

## 5.6 复杂类型注入

- 数组

```xml
<property name="arr">
    <array>
        <value>tom</value>
        <value>jerry</value>
    </array>
</property>
```

- List

```xml
<property name="list">
    <list>
        <value>tom</value>
        <value>jerry</value>
    </list>
</property>
```

- Map

```xml
<property name="map">
    <map>
        <entry key="url" value="jdbc:mysql:///crm" ></entry>
        <entry key="user" value="root" ></entry>
        <entry key="password" value="1234" ></entry>
    </map>
</property>
```

- Properties

```xml
<property name="prop">
    <props>
        <prop key="driverClass">com.jdbc.mysql.Driver</prop>
        <prop key="userName">root</prop>
        <prop key="password">1234</prop>
    </props>
</property>
```

# 6. Spring注解开发

## 6.1 导入jar包

- 在导入4+1的基础上再导入spring-aop的jar包

## 6.2 开启注解扫描

- 在applicationContext.xml中配置：

```xml
<!-- 开启注解扫描 
        base-package: 配置扫描的包路径
-->
<context:component-scan base-package="com.itheima" ></context:component-scan>
```

## 6.3 在类上添加注解

```java
@Component("user")  // 相当于<bean name="user" class="com.itheima.bean.User" >
public class User {
    public void run(){
        System.out.println("running...");
    }
}
```

## 6.4 注解方式设置属性值

- 注解方式：使用注解方式，可以没有set方法

```java
@Component("user")
public class User {
    @Value("tom")  // 相当于<property name="name" value="tom" >
    private String name;

    public void run(){
        System.out.println(name + " is running...");
    }
}
```

- 如果属性有set方法，需要将属性注入的注解加到set方法上

```java
@Component("user")
public class User {
    private String name;

    @Value("tom")
    public void setName(String name) {
        this.name = name;
    }

    public void run(){
        System.out.println(name + " is running...");
    }
}
```

## 6.5 其他注解

- **@Component**：组件注解，用于修饰一个类，将这个类交给Spring管理

  这个注解有三个衍生的注解，功能类似，也用来修饰类。

  - **@Controller**：修饰web层类
  - **@Service**：修饰service层类
  - **@Repository**：修饰dao层类

- **@Scope**：用来设置对象的作用范围，相当于`<bean>`标签的scope属性

- **@PostConstruct**：用来修饰方法，标注在方法上，该方法就是初始化后调用的方法，相当于`<bean>`标签的init-method属性

- **@PreDestroy**：用来修饰方法，标注在方法上，该方法就是销毁前调用的方法，相当于`<bean>`标签的destroy-method属性

## 6.6 注解方式注入对象类型属性

- 在需要注入的对象属性上添加**@Autowired**，就可以自动装配对象类型的属性

```java
@Service("userService")
public class UserServiceImpl implements UserService {
    @Autowired  // 自动装配，相当于<property name="userDao" ref="userDao" >
    private UserDao userDao;

    @Override
    public void save() {
        userDao.save();
    }
}
```

- **@Autowired**是按照类型进行自动装配的，如果接口有多个实现类，那么会报错。可以使用**@Qualifier**指定名称

```java
@Service("userService")
public class UserServiceImpl implements UserService {
    @Autowired
    @Qualifier("userDao2")  // 指定名称
    private UserDao userDao;

    @Override
    public void save() {
        userDao.save();
    }
}
```

- **@Resource**注解也可以完成对象属性的注入

```java
@Service("userService")
public class UserServiceImpl implements UserService {
    @Resource(name="userDao2")  // 相当于@Autowired + @Qualifier
    private UserDao userDao;

    @Override
    public void save() {
        userDao.save();
    }
}
```

## 6.7 配置文件和注解混合使用

- 实际开发中，一般将自定义的对象使用注解的方式，将一些第三方的对象使用配置文件的方式

# 7. AOP

## 7.1 概述

AOP：Aspect Oriented Programming，面向切面编程，是OOP的延伸和扩展，是用来解决OOP开发过程中遇到的一些问题。

AOP采取横向抽取机制，取代了传统纵向继承体系重复性代码（性能监视、事务管理、安全检查、缓存）

Spring AOP使用纯Java实现，不需要专门的编译过程和类加载器，在运行期通过代理方式向目标类织入增强代码

## 7.2 AOP相关术语

- **Joinpoint(连接点)**：所谓连接点是指那些被拦截到的点。在spring中,这些点指的是方法,因为spring只支持方法类型的连接点。
- **Pointcut(切入点)**：所谓切入点是指我们要对哪些Joinpoint进行拦截的定义。
- **Advice(通知/增强)**：所谓通知是指拦截到Joinpoint之后所要做的事情就是通知。通知分为前置通知,后置通知,异常通知,最终通知,环绕通知(切面要完成的功能)
- **Introduction(引介)**：引介是一种特殊的通知在不修改类代码的前提下, Introduction可以在运行期为类动态地添加一些方法或Field。
- **Target(目标对象)**：代理的目标对象
- **Weaving(织入)**：是指把增强应用到目标对象来创建新的代理对象的过程。spring采用动态代理织入，而AspectJ采用编译期织入和类装载期织入
- **Proxy（代理）**：一个类被AOP织入增强后，就产生一个结果代理类
- **Aspect(切面)**：是切入点和通知（引介）的结合

## 7.3 手动方式 - JDK动态代理

- JDK动态代理：对实现了接口的类生成代理

- 创建接口

```java
public interface UserService {
    public void save();
    public void delete();
    public void update();
    public void find();
}
```

- 创建接口的实现类

```java
public class UserServiceImpl implements UserService {
    @Override
    public void save() {
        System.out.println("保存用户...");
    }

    @Override
    public void delete() {
        System.out.println("删除用户...");
    }

    @Override
    public void update() {
        System.out.println("修改用户...");
    }

    @Override
    public void find() {
        System.out.println("查询用户...");
    }
}
```

- 创建代理类

```java
public class JdkProxy implements InvocationHandler {
    private UserService userService;

    public JdkProxy(UserService userService) {
        this.userService = userService;
    }

    public UserService createProxy(){
        UserService proxy = (UserService) Proxy.newProxyInstance(userService.getClass().getClassLoader(),
                userService.getClass().getInterfaces(), this);
        return proxy;
    }

    @Override
    public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {
        if("save".equals(method.getName())){
            System.out.println("权限校验...");
            return method.invoke(userService, args);
        }
        return method.invoke(userService, args);
    }
}
```

- 测试

```java
@Test
public void test1(){
    // 创建目标对象
    UserService userService = new UserServiceImpl();
    // 创建代理对象
    UserService proxy = new JdkProxy(userService).createProxy();
    proxy.save();
    proxy.delete();
    proxy.update();
    proxy.find();
}
```

## 7.4 手动方式 - CGLIB动态代理

- 对没有实现接口的类生成代理，应用的是底层的字节码增强技术，生成当前类的子类对象

- 导入cglib的jar包：cglib-full-2.0.2.jar

- 创建类

```java
public class ProductService {
    public void save() {
        System.out.println("保存商品...");
    }

    public void delete() {
        System.out.println("删除商品...");
    }

    public void update() {
        System.out.println("修改商品...");
    }



2025-08-25 12:48:57,829 - evaluation_logger_Hotels-101 - INFO - Complete Result: {'score': 0, 'reason': "The response does not address any part of the user's query about finding a beachfront hotel near the British Museum or nearby cities for travel plans."}
2025-08-25 12:49:04,311 - evaluation_logger_Hotels-101 - INFO - Correct Result: {'score': 0, 'reason': 'All information in the response is incorrect.'}
2025-08-25 12:49:04,311 - evaluation_logger_Hotels-101 - INFO - Message: Success.
2025-08-25 12:49:04,311 - evaluation_logger_Hotels-101 - INFO - Success turn num = 4
2025-08-25 12:49:04,311 - evaluation_logger_Hotels-101 - INFO - ----------------------------------------------------------------------------------------------------
