2025-08-25 13:28:29,884 - evaluation_logger_Flights-41 - INFO - Test Example Flights-41
2025-08-25 13:28:29,884 - evaluation_logger_Flights-41 - INFO - Query: I'm looking for the cheapest economy class air ticket. Right now, I'm planning to set off from San Francisco on December 1st, 2024, travel through Amsterdam on December 2nd and then fly to Prague. Finally, I'll return to San Francisco on December 15th, 2024. Check the details of the flights. I want to know things like the baggage limit. Thanks for your help.
2025-08-25 13:28:40,894 - evaluation_logger_Flights-41 - INFO - Function Calls: 
[
    {
        "name": "Search_Flight_Location",
        "arguments": {
            "query": "San Francisco"
        }
    },
    {
        "name": "Search_Flight_Location",
        "arguments": {
            "query": "Amsterdam"
        }
    },
    {
        "name": "Search_Flight_Location",
        "arguments": {
            "query": "Prague"
        }
    }
]

2025-08-25 13:28:40,895 - evaluation_logger_Flights-41 - INFO - Golden Function Call: 
[
    {
        "name": "Search_Flight_Location",
        "arguments": {
            "query": "San Francisco"
        }
    },
    {
        "name": "Search_Flight_Location",
        "arguments": {
            "query": "Amsterdam"
        }
    },
    {
        "name": "Search_Flight_Location",
        "arguments": {
            "query": "Prague"
        }
    },
    {
        "name": "Search_Flights_Multi_Stops",
        "arguments": {
            "cabinClass": "ECONOMY",
            "sort": "CHEAPEST",
            "legs": [
                {
                    "fromId": "SFO.AIRPORT",
                    "toId": "AMS.AIRPORT",
                    "date": "2024-12-01"
                },
                {
                    "fromId": "AMS.AIRPORT",
                    "toId": "PRG.AIRPORT",
                    "date": "2024-12-02"
                },
                {
                    "fromId": "PRG.AIRPORT",
                    "toId": "SFO.AIRPORT",
                    "date": "2024-12-15"
                }
            ]
        }
    }
]

2025-08-25 13:28:40,895 - evaluation_logger_Flights-41 - INFO - Start compare_single_call: 
{'name': 'Search_Flight_Location', 'arguments': {'query': 'San Francisco'}}
{'name': 'Search_Flight_Location', 'arguments': {'query': 'San Francisco'}}
2025-08-25 13:28:40,895 - evaluation_logger_Flights-41 - INFO - Rule-based compare success.
2025-08-25 13:28:40,895 - evaluation_logger_Flights-41 - INFO - Start compare_single_call: 
{'name': 'Search_Flight_Location', 'arguments': {'query': 'Amsterdam'}}
{'name': 'Search_Flight_Location', 'arguments': {'query': 'Amsterdam'}}
2025-08-25 13:28:40,895 - evaluation_logger_Flights-41 - INFO - Rule-based compare success.
2025-08-25 13:28:40,895 - evaluation_logger_Flights-41 - INFO - Start compare_single_call: 
{'name': 'Search_Flight_Location', 'arguments': {'query': 'Prague'}}
{'name': 'Search_Flight_Location', 'arguments': {'query': 'Prague'}}
2025-08-25 13:28:40,895 - evaluation_logger_Flights-41 - INFO - Rule-based compare success.
2025-08-25 13:28:40,895 - evaluation_logger_Flights-41 - INFO - Success matched: [{'name': 'Search_Flight_Location', 'arguments': {'query': 'San Francisco'}}, {'name': 'Search_Flight_Location', 'arguments': {'query': 'Amsterdam'}}, {'name': 'Search_Flight_Location', 'arguments': {'query': 'Prague'}}]
2025-08-25 13:28:40,895 - evaluation_logger_Flights-41 - INFO - Observations:
[
    {
        "status": true,
        "message": "Success",
        "data": [
            {
                "id": "SFO.AIRPORT",
                "type": "AIRPORT",
                "name": "San Francisco International Airport",
                "code": "SFO",
                "city": "SFO",
                "cityName": "San Francisco",
                "regionName": "California",
                "country": "US",
                "countryName": "United States",
                "countryNameShort": "US",
                "distanceToCity": {
                    "value": 19.16395121441966,
                    "unit": "km"
                },
                "parent": "SFO"
            }
        ]
    },
    {
        "status": true,
        "message": "Success",
        "data": [
            {
                "id": "AMS.AIRPORT",
                "type": "AIRPORT",
                "name": "Schiphol Airport",
                "code": "AMS",
                "city": "AMS",
                "cityName": "Amsterdam",
                "regionName": "Noord-Holland",
                "country": "NL",
                "countryName": "Netherlands",
                "countryNameShort": "Netherlands",
                "distanceToCity": {
                    "value": 11.396990072691436,
                    "unit": "km"
                },
                "parent": "AMS"
            }
        ]
    },
    {
        "status": true,
        "message": "Success",
        "data": [
            {
                "id": "PRG.AIRPORT",
                "type": "AIRPORT",
                "name": "Vaclav Havel Airport Prague",
                "code": "PRG",
                "city": "PRG",
                "cityName": "Prague",
                "country": "CZ",
                "countryName": "Czech Republic",
                "countryNameShort": "Czech Republic",
                "distanceToCity": {
                    "value": 11.202693777767475,
                    "unit": "km"
                },
                "parent": "PRG"
            }
        ]
    }
]

2025-08-25 13:28:53,500 - evaluation_logger_Flights-41 - INFO - Function Calls: 
[
    {
        "name": "Search_Flights_Multi_Stops",
        "arguments": {
            "cabinClass": "ECONOMY",
            "sort": "CHEAPEST",
            "legs": [
                {
                    "fromId": "SFO.AIRPORT",
                    "toId": "AMS.AIRPORT",
                    "date": "2024-12-01"
                },
                {
                    "fromId": "AMS.AIRPORT",
                    "toId": "PRG.AIRPORT",
                    "date": "2024-12-02"
                },
                {
                    "fromId": "PRG.AIRPORT",
                    "toId": "SFO.AIRPORT",
                    "date": "2024-12-15"
                }
            ]
        }
    }
]

2025-08-25 13:28:53,501 - evaluation_logger_Flights-41 - INFO - Golden Function Call: 
[
    {
        "name": "Search_Flights_Multi_Stops",
        "arguments": {
            "cabinClass": "ECONOMY",
            "legs": [
                {
                    "fromId": "SFO.AIRPORT",
                    "toId": "AMS.AIRPORT",
                    "date": "2024-12-01"
                },
                {
                    "fromId": "AMS.AIRPORT",
                    "toId": "PRG.AIRPORT",
                    "date": "2024-12-02"
                },
                {
                    "fromId": "PRG.AIRPORT",
                    "toId": "SFO.AIRPORT",
                    "date": "2024-12-15"
                }
            ],
            "sort": "CHEAPEST"
        }
    },
    {
        "name": "Get_Flight_Details",
        "arguments": {
            "token": "d6a1f_H4sIAAAAAAAA_z2Q3W6jMBCFnya9WozNb6lkVSiQtI0hmxJScWURxyGkbL3CXiXl6XcCUWXL851jjz2ekzF_9ZNtH7u2ORlt_dOoUUY1tZFIqD_2sYdlr9Rn-9XYddvbxWIdZwUmSTr_BfD7fYmdGwPAFvGBbWJbMMRT9SyvxtK9oA_tXqKaWlEUTagFJXfqaYC8dOU5OFyPllCGesgnaciqbJfdzZ4u82VQ4VEdaDa_XFnyqrOzvrAk1qAv6yEO86128kSTrCzd7aLLN-fPYf1NirK9XPPy0WFJSrZDpT_S7uXGZVJptnsrIFez7eKNzfEAd5kN2YBOdZFmMzcZH5UCikbIC6OpdFXr-yeUMDScKlMHQwuWx241SUOjAJPp2JUS1330H7TspDCt-lrJb7piAQ4saKgUjmft-IoR1w8t6OposMnAFrT2xwiw_6N3M2d-7PeXzgOYuTHMhmM0DuATMEEOcoBrnjvo3UUxRssU9J5HtwzBow2EA5d1EEggyW-ZR-7B2nJyv-nMXz8gDJwoN8LyPxVFdz46AgAA"
        }
    }
]

2025-08-25 13:28:53,501 - evaluation_logger_Flights-41 - INFO - Start compare_single_call: 
{'name': 'Search_Flights_Multi_Stops', 'arguments': {'cabinClass': 'ECONOMY', 'legs': [{'fromId': 'SFO.AIRPORT', 'toId': 'AMS.AIRPORT', 'date': '2024-12-01'}, {'fromId': 'AMS.AIRPORT', 'toId': 'PRG.AIRPORT', 'date': '2024-12-02'}, {'fromId': 'PRG.AIRPORT', 'toId': 'SFO.AIRPORT', 'date': '2024-12-15'}], 'sort': 'CHEAPEST'}}
{'name': 'Search_Flights_Multi_Stops', 'arguments': {'cabinClass': 'ECONOMY', 'legs': [{'fromId': 'SFO.AIRPORT', 'toId': 'AMS.AIRPORT', 'date': '2024-12-01'}, {'fromId': 'AMS.AIRPORT', 'toId': 'PRG.AIRPORT', 'date': '2024-12-02'}, {'fromId': 'PRG.AIRPORT', 'toId': 'SFO.AIRPORT', 'date': '2024-12-15'}], 'sort': 'CHEAPEST'}}
2025-08-25 13:28:53,501 - evaluation_logger_Flights-41 - INFO - Rule-based compare success.
2025-08-25 13:28:53,501 - evaluation_logger_Flights-41 - INFO - Success matched: [{'name': 'Search_Flights_Multi_Stops', 'arguments': {'cabinClass': 'ECONOMY', 'legs': [{'fromId': 'SFO.AIRPORT', 'toId': 'AMS.AIRPORT', 'date': '2024-12-01'}, {'fromId': 'AMS.AIRPORT', 'toId': 'PRG.AIRPORT', 'date': '2024-12-02'}, {'fromId': 'PRG.AIRPORT', 'toId': 'SFO.AIRPORT', 'date': '2024-12-15'}], 'sort': 'CHEAPEST'}}]
2025-08-25 13:28:53,502 - evaluation_logger_Flights-41 - INFO - Observations:
[
    {
        "status": true,
        "message": "Success",
        "data": {
            "flightOffers": [
                {
                    "token": "d6a1f_H4sIAAAAAAAA_z2Q3W6jMBCFnya9WozNb6lkVSiQtI0hmxJScWURxyGkbL3CXiXl6XcCUWXL851jjz2ekzF_9ZNtH7u2ORlt_dOoUUY1tZFIqD_2sYdlr9Rn-9XYddvbxWIdZwUmSTr_BfD7fYmdGwPAFvGBbWJbMMRT9SyvxtK9oA_tXqKaWlEUTagFJXfqaYC8dOU5OFyPllCGesgnaciqbJfdzZ4u82VQ4VEdaDa_XFnyqrOzvrAk1qAv6yEO86128kSTrCzd7aLLN-fPYf1NirK9XPPy0WFJSrZDpT_S7uXGZVJptnsrIFez7eKNzfEAd5kN2YBOdZFmMzcZH5UCikbIC6OpdFXr-yeUMDScKlMHQwuWx241SUOjAJPp2JUS1330H7TspDCt-lrJb7piAQ4saKgUjmft-IoR1w8t6OposMnAFrT2xwiw_6N3M2d-7PeXzgOYuTHMhmM0DuATMEEOcoBrnjvo3UUxRssU9J5HtwzBow2EA5d1EEggyW-ZR-7B2nJyv-nMXz8gDJwoN8LyPxVFdz46AgAA",
                    "segments": [
                        {
                            "departureAirport": {
                                "type": "AIRPORT",
                                "code": "SFO",
                                "name": "San Francisco International Airport",
                                "city": "SFO",
                                "cityName": "San Francisco",
                                "country": "US",
                                "countryName": "United States"
                            },
                            "arrivalAirport": {
                                "type": "AIRPORT",
                                "code": "AMS",
                                "name": "Schiphol Airport",
                                "city": "AMS",
                                "cityName": "Amsterdam",
                                "country": "NL",
                                "countryName": "Netherlands"
                            },
                            "departureTime": "2024-12-01T13:50:00",
                            "arrivalTime": "2024-12-02T09:05:00",
                            "legs": [
                                {
                                    "departureTime": "2024-12-01T13:50:00",
                                    "arrivalTime": "2024-12-02T09:05:00",
                                    "departureAirport": {
                                        "type": "AIRPORT",
                                        "code": "SFO",
                                        "name": "San Francisco International Airport",
                                        "city": "SFO",
                                        "cityName": "San Francisco",
                                        "country": "US",
                                        "countryName": "United States"
                                    },
                                    "arrivalAirport": {
                                        "type": "AIRPORT",
                                        "code": "AMS",
                                        "name": "Schiphol Airport",
                                        "city": "AMS",
                                        "cityName": "Amsterdam",
                                        "country": "NL",
                                        "countryName": "Netherlands"
                                    },
                                    "cabinClass": "ECONOMY",
                                    "flightInfo": {
                                        "flightNumber": 606,
                                        "planeType": "781",
                                        "carrierInfo": {
                                            "operatingCarrier": "KL",
                                            "marketingCarrier": "KL"
                                        }
                                    },
                                    "carriers": [
                                        "KL",
                                        "KL"
                                    ],
                                    "carriersData": [
                                        {
                                            "name": "KLM",
                                            "code": "KL"
                                        },
                                        {
                                            "name": "KLM",
                                            "code": "KL"
                                        }
                                    ],
                                    "totalTime": 36900,
                                    "amenities": [
                                        {
                                            "category": "AIRCRAFT",
                                            "model": "781"
                                        },
                                        {
                                            "category": "ENTERTAINMENT",
                                            "cost": "free"
                                        },
                                        {
                                            "category": "FOOD",
                                            "cost": "free",
                                            "type": "meal"
                                        },
                                        {
                                            "category": "POWER",
                                            "cost": "free",
                                            "type": [
                                                "usb_port"
                                            ]
                                        },
                                        {
                                            "category": "WIFI",
                                            "cost": "paid"
                                        }
                                    ],
                                    "departureTerminal": "I"
                                }
                            ],
                            "totalTime": 36900,
                            "isAtolProtected": false,
                            "showWarningDestinationAirport": false,
                            "showWarningOriginAirport": false
                        },
                        {
                            "departureAirport": {
                                "type": "AIRPORT",
                                "code": "AMS",
                                "name": "Schiphol Airport",
                                "city": "AMS",
                                "cityName": "Amsterdam",
                                "country": "NL",
                                "countryName": "Netherlands"
                            },
                            "arrivalAirport": {
                                "type": "AIRPORT",
                                "code": "PRG",
                                "name": "Vaclav Havel Airport Prague",
                                "city": "PRG",
                                "cityName": "Prague",
                                "country": "CZ",
                                "countryName": "Czech Republic"
                            },
                            "departureTime": "2024-12-02T16:15:00",
                            "arrivalTime": "2024-12-02T17:40:00",
                            "legs": [
                                {
                                    "departureTime": "2024-12-02T16:15:00",
                                    "arrivalTime": "2024-12-02T17:40:00",
                                    "departureAirport": {
                                        "type": "AIRPORT",
                                        "code": "AMS",
                                        "name": "Schiphol Airport",
                                        "city": "AMS",
                                        "cityName": "Amsterdam",
                                        "country": "NL",
                                        "countryName": "Netherlands"
                                    },
                                    "arrivalAirport": {
                                        "type": "AIRPORT",
                                        "code": "PRG",
                                        "name": "Vaclav Havel Airport Prague",
                                        "city": "PRG",
                                        "cityName": "Prague",
                                        "country": "CZ",
                                        "countryName": "Czech Republic"
                                    },
                                    "cabinClass": "ECONOMY",
                                    "flightInfo": {
                                        "flightNumber": 1357,
                                        "planeType": "295",
                                        "carrierInfo": {
                                            "operatingCarrier": "KL",
                                            "marketingCarrier": "KL",
                                            "operatingCarrierDisclosureText": "Klm Cityhopper"
                                        }
                                    },
                                    "carriers": [
                                        "KL",
                                        "KL"
                                    ],
                                    "carriersData": [
                                        {
                                            "name": "KLM",
                                            "code": "KL"
                                        },
                                        {
                                            "name": "KLM",
                                            "code": "KL"
                                        }
                                    ],
                                    "totalTime": 5100,
                                    "amenities": [
                                        {
                                            "category": "AIRCRAFT",
                                            "model": "295"
                                        },
                                        {
                                            "category": "FOOD",
                                            "cost": "free",
                                            "type": "snack"
                                        },
                                        {
                                            "category": "POWER",
                                            "cost": "free",
                                            "type": [
                                                "usb_port"
                                            ]
                                        },
                                        {
                                            "category": "WIFI",
                                            "cost": "paid"
                                        }
                                    ],
                                    "arrivalTerminal": "2"
                                }
                            ],
                            "totalTime": 5100,
                            "isAtolProtected": false,
                            "showWarningDestinationAirport": false,
                            "showWarningOriginAirport": false
                        },
                        {
                            "departureAirport": {
                                "type": "AIRPORT",
                                "code": "PRG",
                                "name": "Vaclav Havel Airport Prague",
                                "city": "PRG",
                                "cityName": "Prague",
                                "country": "CZ",
                                "countryName": "Czech Republic"
                            },
                            "arrivalAirport": {
                                "type": "AIRPORT",
                                "code": "SFO",
                                "name": "San Francisco International Airport",
                                "city": "SFO",
                                "cityName": "San Francisco",
                                "country": "US",
                                "countryName": "United States"
                            },
                            "departureTime": "2024-12-15T06:00:00",
                            "arrivalTime": "2024-12-15T11:50:00",
                            "legs": [
                                {
                                    "departureTime": "2024-12-15T06:00:00",
                                    "arrivalTime": "2024-12-15T07:35:00",
                                    "departureAirport": {
                                        "type": "AIRPORT",
                                        "code": "PRG",
                                        "name": "Vaclav Havel Airport Prague",
                                        "city": "PRG",
                                        "cityName": "Prague",
                                        "country": "CZ",
                                        "countryName": "Czech Republic"
                                    },
                                    "arrivalAirport": {
                                        "type": "AIRPORT",
                                        "code": "AMS",
                                        "name": "Schiphol Airport",
                                        "city": "AMS",
                                        "cityName": "Amsterdam",
                                        "country": "NL",
                                        "countryName": "Netherlands"
                                    },
                                    "cabinClass": "ECONOMY",
                                    "flightInfo": {
                                        "flightNumber": 1350,
                                        "planeType": "73H",
                                        "carrierInfo": {
                                            "operatingCarrier": "KL",
                                            "marketingCarrier": "KL"
                                        }
                                    },
                                    "carriers": [
                                        "KL",
                                        "KL"
                                    ],
                                    "carriersData": [
                                        {
                                            "name": "KLM",
                                            "code": "KL"
                                        },
                                        {
                                            "name": "KLM",
                                            "code": "KL"
                                        }
                                    ],
                                    "totalTime": 5700,
                                    "amenities": [
                                        {
                                            "category": "AIRCRAFT",
                                            "model": "737"
                                        },
                                        {
                                            "category": "FOOD",
                                            "cost": "free",
                                            "type": "light_meal"
                                        },
                                        {
                                            "category": "POWER",
                                            "cost": "free",
                                            "type": [
                                                "usb_port"
                                            ]
                                        },
                                        {
                                            "category": "WIFI",
                                            "cost": "paid"
                                        }
                                    ],
                                    "departureTerminal": "2"
                                },
                                {
                                    "departureTime": "2024-12-15T09:50:00",
                                    "arrivalTime": "2024-12-15T11:50:00",
                                    "departureAirport": {
                                        "type": "AIRPORT",
                                        "code": "AMS",
                                        "name": "Schiphol Airport",
                                        "city": "AMS",
                                        "cityName": "Amsterdam",
                                        "country": "NL",
                                        "countryName": "Netherlands"
                                    },
                                    "arrivalAirport": {
                                        "type": "AIRPORT",
                                        "code": "SFO",
                                        "name": "San Francisco International Airport",
                                        "city": "SFO",
                                        "cityName": "San Francisco",
                                        "country": "US",
                                        "countryName": "United States"
                                    },
                                    "cabinClass": "ECONOMY",
                                    "flightInfo": {
                                        "flightNumber": 605,
                                        "planeType": "781",
                                        "carrierInfo": {
                                            "operatingCarrier": "KL",
                                            "marketingCarrier": "KL"
                                        }
                                    },
                                    "carriers": [
                                        "KL",
                                        "KL"
                                    ],
                                    "carriersData": [
                                        {
                                            "name": "KLM",
                                            "code": "KL"
                                        },
                                        {
                                            "name": "KLM",
                                            "code": "KL"
                                        }
                                    ],
                                    "totalTime": 39600,
                                    "amenities": [
                                        {
                                            "category": "AIRCRAFT",
                                            "model": "781"
                                        },
                                        {
                                            "category": "ENTERTAINMENT",
                                            "cost": "free"
                                        },
                                        {
                                            "category": "FOOD",
                                            "cost": "free",
                                            "type": "meal"
                                        },
                                        {
                                            "category": "POWER",
                                            "cost": "free",
                                            "type": [
                                                "usb_port"
                                            ]
                                        },
                                        {
                                            "category": "WIFI",
                                            "cost": "paid"
                                        }
                                    ],
                                    "arrivalTerminal": "I"
                                }
                            ],
                            "totalTime": 53400,
                            "isAtolProtected": false,
                            "showWarningDestinationAirport": false,
                            "showWarningOriginAirport": false
                        }
                    ]
                },
                {
                    "token": "d6a1f_H4sIAAAAAAAA_z2Qb2-qMBTGP417dSktf8eS5oYIus2C8yIuvGqwVsS59cbWyPj0O4JZ2vT8nqc97ek5GPNfP9n2_tQ2B6Oti0aNMqqpjURCfdr7MyxbpT7ar8au27NdzJZxVmCSpNM_AG__5ti5MQBsER_YJrYFQzxVf2VnLH0W9KHdSlRTK4qiEbWg5E5nGiAvXXgODpeDJZShHvJJGrIq22Rvo3mm83weVHhQO5pNrx1LXnR21FeWxBr0ddnHYb7WTp5okpWlu56d8tXxo19-k6Jsr11ePjosScm6r_R7enq-cZlUmm1eC8jVbD17ZVPcw11mRVagU12k2cRNhkelgKIR8sJoLF3V-v4JJQwNx8rUztCC5bFbjdLQKMBkPNZR4rqP_oOWJylMq74W8psuWIADCxoqheNZG75gxPUjC7o6GGw0sAWt_TUC7P_qzcSZ7i-dd3EAJm4Ms-EYDQP4AEyQgxzgmucOKjGKMZqnoLc8umUIHq0g7Lisg0ACSX7L3HMP1paT-01H_vIOoedEuRGWP5-NHFM6AgAA",
                    "segments": [
                        {
                            "departureAirport": {
                                "type": "AIRPORT",
                                "code": "SFO",
                                "name": "San Francisco International Airport",
                                "city": "SFO",
                                "cityName": "San Francisco",
                                "country": "US",
                                "countryName": "United States"
                            },
                            "arrivalAirport": {
                                "type": "AIRPORT",
                                "code": "AMS",
                                "name": "Schiphol Airport",
                                "city": "AMS",
                                "cityName": "Amsterdam",
                                "country": "NL",
                                "countryName": "Netherlands"
                            },
                            "departureTime": "2024-12-01T13:50:00",
                            "arrivalTime": "2024-12-02T09:05:00",
                            "legs": [
                                {
                                    "departureTime": "2024-12-01T13:50:00",
                                    "arrivalTime": "2024-12-02T09:05:00",
                                    "departureAirport": {
                                        "type": "AIRPORT",
                                        "code": "SFO",
                                        "name": "San Francisco International Airport",
                                        "city": "SFO",
                                        "cityName": "San Francisco",
                                        "country": "US",
                                        "countryName": "United States"
                                    },
                                    "arrivalAirport": {
                                        "type": "AIRPORT",
                                        "code": "AMS",
                                        "name": "Schiphol Airport",
                                        "city": "AMS",
                                        "cityName": "Amsterdam",
                                        "country": "NL",
                                        "countryName": "Netherlands"
                                    },
                                    "cabinClass": "ECONOMY",
                                    "flightInfo": {
                                        "flightNumber": 606,
                                        "planeType": "781",
                                        "carrierInfo": {
                                            "operatingCarrier": "KL",
                                            "marketingCarrier": "KL"
                                        }
                                    },
                                    "carriers": [
                                        "KL",
                                        "KL"
                                    ],
                                    "carriersData": [
                                        {
                                            "name": "KLM",
                                            "code": "KL"
                                        },
                                        {
                                            "name": "KLM",
                                            "code": "KL"
                                        }
                                    ],
                                    "totalTime": 36900,
                                    "amenities": [
                                        {
                                            "category": "AIRCRAFT",
                                            "model": "781"
                                        },
                                        {
                                            "category": "ENTERTAINMENT",
                                            "cost": "free"
                                        },
                                        {
                                            "category": "FOOD",
                                            "cost": "free",
                                            "type": "meal"
                                        },
                                        {
                                            "category": "POWER",
                                            "cost": "free",
                                            "type": [
                                                "usb_port"
                                            ]
                                        },
                                        {
                                            "category": "WIFI",
                                            "cost": "paid"
                                        }
                                    ],
                                    "departureTerminal": "I"
                                }
                            ],
                            "totalTime": 36900,
                            "isAtolProtected": false,
                            "showWarningDestinationAirport": false,
                            "showWarningOriginAirport": false
                        },
                        {
                            "departureAirport": {
                                "type": "AIRPORT",
                                "code": "AMS",
                                "name": "Schiphol Airport",
                                "city": "AMS",
                                "cityName": "Amsterdam",
                                "country": "NL",
                                "countryName": "Netherlands"
                            },
                            "arrivalAirport": {
                                "type": "AIRPORT",
                                "code": "PRG",
                                "name": "Vaclav Havel Airport Prague",
                                "city": "PRG",
                                "cityName": "Prague",
                                "country": "CZ",
                                "countryName": "Czech Republic"
                            },
                            "departureTime": "2024-12-02T18:00:00",
                            "arrivalTime": "2024-12-02T19:25:00",
                            "legs": [
                                {
                                    "departureTime": "2024-12-02T18:00:00",
                                    "arrivalTime": "2024-12-02T19:25:00",
                                    "departureAirport": {
                                        "type": "AIRPORT",
                                        "code": "AMS",
                                        "name": "Schiphol Airport",
                                        "city": "AMS",
                                        "cityName": "Amsterdam",
                                        "country": "NL",
                                        "countryName": "Netherlands"
                                    },
                                    "arrivalAirport": {
                                        "type": "AIRPORT",
                                        "code": "PRG",
                                        "name": "Vaclav Havel Airport Prague",
                                        "city": "PRG",
                                        "cityName": "Prague",
                                        "country": "CZ",
                                        "countryName": "Czech Republic"
                                    },
                                    "cabinClass": "ECONOMY",
                                    "flightInfo": {
                                        "flightNumber": 1359,
                                        "planeType": "295",
                                        "carrierInfo": {
                                            "operatingCarrier": "KL",
                                            "marketingCarrier": "KL",
                                            "operatingCarrierDisclosureText": "Klm Cityhopper"
                                        }
                                    },
                                    "carriers": [
                                        "KL",
                                        "KL"
                                    ],
                                    "carriersData": [
                                        {
                                            "name": "KLM",
                                            "code": "KL"
                                        },
                                        {
                                            "name": "KLM",
                                            "code": "KL"
                                        }
                                    ],
                                    "totalTime": 5100,
                                    "amenities": [
                                        {
                                            "category": "AIRCRAFT",
                                            "model": "295"
                                        },
                                        {
                                            "category": "FOOD",
                                            "cost": "free",
                                            "type": "snack"
                                        },
                                        {
                                            "category": "POWER",
                                            "cost": "free",
                                            "type": [
                                                "usb_port"
                                            ]
                                        },
                                        {
                                            "category": "WIFI",
                                            "cost": "paid"
                                        }
                                    ],
                                    "arrivalTerminal": "2"
                                }
                            ],
                            "totalTime": 5100,
                            "isAtolProtected": false,
                            "showWarningDestinationAirport": false,
                            "showWarningOriginAirport": false
                        },
                        {
                            "departureAirport": {
                                "type": "AIRPORT",
                                "code": "PRG",
                                "name": "Vaclav Havel Airport Prague",
                                "city": "PRG",
                                "cityName": "Prague",
                                "country": "CZ",
                                "countryName": "Czech Republic"
                            },
                            "arrivalAirport": {
                                "type": "AIRPORT",
                                "code": "SFO",
                                "name": "San Francisco International Airport",
                                "city": "SFO",
                                "cityName": "San Francisco",
                                "country": "US",
                                "countryName": "United States"
                            },
                            "departureTime": "2024-12-15T06:00:00",
                            "arrivalTime": "2024-12-15T11:50:00",
                            "legs": [
                                {
                                    "departureTime": "2024-12-15T06:00:00",
                                    "arrivalTime": "2024-12-15T07:35:00",
                                    "departureAirport": {
                                        "type": "AIRPORT",
                                        "code": "PRG",
                                        "name": "Vaclav Havel Airport Prague",
                                        "city": "PRG",
                                        "cityName": "Prague",
                                        "country": "CZ",
                                        "countryName": "Czech Republic"
                                    },
                                    "arrivalAirport": {
                                        "type": "AIRPORT",
                                        "code": "AMS",
                                        "name": "Schiphol Airport",
                                        "city": "AMS",
                                        "cityName": "Amsterdam",
                                        "country": "NL",
                                        "countryName": "Netherlands"
                                    },
                                    "cabinClass": "ECONOMY",
                                    "flightInfo": {
                                        "flightNumber": 1350,
                                        "planeType": "73H",
                                        "carrierInfo": {
                                            "operatingCarrier": "KL",
                                            "marketingCarrier": "KL"
                                        }
                                    },
                                    "carriers": [
                                        "KL",
                                        "KL"
                                    ],
                                    "carriersData": [
                                        {
                                            "name": "KLM",
                                            "code": "KL"
                                        },
                                        {
                                            "name": "KLM",
                                            "code": "KL"
                                        }
                                    ],
                                    "totalTime": 5700,
                                    "amenities": [
                                        {
                                            "category": "AIRCRAFT",
                                            "model": "737"
                                        },
                                        {
                                            "category": "FOOD",
                                            "cost": "free",
                                            "type": "light_meal"
                                        },
                                        {
                                            "category": "POWER",
                                            "cost": "free",
                                            "type": [
                                                "usb_port"
                                            ]
                                        },
                                        {
                                            "category": "WIFI",
                                            "cost": "paid"
                                        }
                                    ],
                                    "departureTerminal": "2"
                                },
                                {
                                    "departureTime": "2024-12-15T09:50:00",
                                    "arrivalTime": "2024-12-15T11:50:00",
                                    "departureAirport": {
                                        "type": "AIRPORT",
                                        "code": "AMS",
                                        "name": "Schiphol Airport",
                                        "city": "AMS",
                                        "cityName": "Amsterdam",
                                        "country": "NL",
                                        "countryName": "Netherlands"
                                    },
                                    "arrivalAirport": {
                                        "type": "AIRPORT",
                                        "code": "SFO",
                                        "name": "San Francisco International Airport",
                                        "city": "SFO",
                                        "cityName": "San Francisco",
                                        "country": "US",
                                        "countryName": "United States"
                                    },
                                    "cabinClass": "ECONOMY",
                                    "flightInfo": {
                                        "flightNumber": 605,
                                        "planeType": "781",
                                        "carrierInfo": {
                                            "operatingCarrier": "KL",
                                            "marketingCarrier": "KL"
                                        }
                                    },
                                    "carriers": [
                                        "KL",
                                        "KL"
                                    ],
                                    "carriersData": [
                                        {
                                            "name": "KLM",
                                            "code": "KL"
                                        },
                                        {
                                            "name": "KLM",
                                            "code": "KL"
                                        }
                                    ],
                                    "totalTime": 39600,
                                    "amenities": [
                                        {
                                            "category": "AIRCRAFT",
                                            "model": "781"
                                        },
                                        {
                                            "category": "ENTERTAINMENT",
                                            "cost": "free"
                                        },
                                        {
                                            "category": "FOOD",
                                            "cost": "free",
                                            "type": "meal"
                                        },
                                        {
                                            "category": "POWER",
                                            "cost": "free",
                                            "type": [
                                                "usb_port"
                                            ]
                                        },
                                        {
                                            "category": "WIFI",
                                            "cost": "paid"
                                        }
                                    ],
                                    "arrivalTerminal": "I"
                                }
                            ],
                            "totalTime": 53400,
                            "isAtolProtected": false,
                            "showWarningDestinationAirport": false,
                            "showWarningOriginAirport": false
                        }
                    ]
                },
                {
                    "token": "d6a1f_H4sIAAAAAAAA_z2Qb4-iMBDGP4376igtf2WT5kIEvV0LHoe44VWDtSKut73QXnT59DuC2bTp_J6nnXY6J2P-6WfbPl669mS09V-jVhnVNkYiof7axx6WvVLv3UdrN11vl8tNnJWYJOniB8DvPyvs3BkAtogPbBPbgiGe65_yZizdC_rU7SVqqBVF0YRaUPKgngbIS9eeg8PNaAllqId8koasznZZMZk9XeWroMajOtBscb2x5EVnZ31lSaxBXzdDHOZb7eSJJllVudvlJS_O78Pmk5RVd73l1dxhSUq2Q63f0suvO1dJrdnutYRczbbLV7bAA9xlClKATnWZZjM3GR-VAopGyAujqXTV6McnlDA0nCpTB0NLlsduPUlDowCT6diNEted-09aXqQwnfpYy0-6ZgEOLGioFI5n7fiaETcgFnR1NNho-NiC1n4bAfa_9W7mLI6dnJ9DgJkbw2w5RuMAPgET5CAHuOG5g-oCxRitUtB7Ht0zBI8KCAcumyCQQJLfM4_cg7Xj5HHTmb-8QRg4UW6E5ReLXZjWOgIAAA..",
                    "segments": [
                        {
                            "departureAirport": {
                                "type": "AIRPORT",
                                "code": "SFO",
                                "name": "San Francisco International Airport",
                                "city": "SFO",
                                "cityName": "San Francisco",
                                "country": "US",
                                "countryName": "United States"
                            },
                            "arrivalAirport": {
                                "type": "AIRPORT",
                                "code": "AMS",
                                "name": "Schiphol Airport",
                                "city": "AMS",
                                "cityName": "Amsterdam",
                                "country": "NL",
                                "countryName": "Netherlands"
                            },
                            "departureTime": "2024-12-01T13:50:00",
                            "arrivalTime": "2024-12-02T09:05:00",
                            "legs": [
                                {
                                    "departureTime": "2024-12-01T13:50:00",
                                    "arrivalTime": "2024-12-02T09:05:00",
                                    "departureAirport": {
                                        "type": "AIRPORT",
                                        "code": "SFO",
                                        "name": "San Francisco International Airport",
                                        "city": "SFO",
                                        "cityName": "San Francisco",
                                        "country": "US",
                                        "countryName": "United States"
                                    },
                                    "arrivalAirport": {
                                        "type": "AIRPORT",
                                        "code": "AMS",
                                        "name": "Schiphol Airport",
                                        "city": "AMS",
                                        "cityName": "Amsterdam",
                                        "country": "NL",
                                        "countryName": "Netherlands"
                                    },
                                    "cabinClass": "ECONOMY",
                                    "flightInfo": {
                                        "flightNumber": 606,
                                        "planeType": "781",
                                        "carrierInfo": {
                                            "operatingCarrier": "KL",
                                            "marketingCarrier": "KL"
                                        }
                                    },
                                    "carriers": [
                                        "KL",
                                        "KL"
                                    ],
                                    "carriersData": [
                                        {
                                            "name": "KLM",
                                            "code": "KL"
                                        },
                                        {
                                            "name": "KLM",
                                            "code": "KL"
                                        }
                                    ],
                                    "totalTime": 36900,
                                    "amenities": [
                                        {
                                            "category": "AIRCRAFT",
                                            "model": "781"
                                        },
                                        {
                                            "category": "ENTERTAINMENT",
                                            "cost": "free"
                                        },
                                        {
                                            "category": "FOOD",
                                            "cost": "free",
                                            "type": "meal"
                                        },
                                        {
                                            "category": "POWER",
                                            "cost": "free",
                                            "type": [
                                                "usb_port"
                                            ]
                                        },
                                        {
                                            "category": "WIFI",
                                            "cost": "paid"
                                        }
                                    ],
                                    "departureTerminal": "I"
                                }
                            ],
                            "totalTime": 36900,
                            "isAtolProtected": false,
                            "showWarningDestinationAirport": false,
                            "showWarningOriginAirport": false
                        },
                        {
                            "departureAirport": {
                                "type": "AIRPORT",
                                "code": "AMS",
                                "name": "Schiphol Airport",
                                "city": "AMS",
                                "cityName": "Amsterdam",
                                "country": "NL",
                                "countryName": "Netherlands"
                            },
                            "arrivalAirport": {
                                "type": "AIRPORT",
                                "code": "PRG",
                                "name": "Vaclav Havel Airport Prague",
                                "city": "PRG",
                                "cityName": "Prague",
                                "country": "CZ",
                                "countryName": "Czech Republic"
                            },
                            "departureTime": "2024-12-02T20:50:00",
                            "arrivalTime": "2024-12-02T22:15:00",
                            "legs": [
                                {
                                    "departureTime": "2024-12-02T20:50:00",
                                    "arrivalTime": "2024-12-02T22:15:00",
                                    "departureAirport": {
                                        "type": "AIRPORT",
                                        "code": "AMS",
                                        "name": "Schiphol Airport",
                                        "city": "AMS",
                                        "cityName": "Amsterdam",
                                        "country": "NL",
                                        "countryName": "Netherlands"
                                    },
                                    "arrivalAirport": {
                                        "type": "AIRPORT",
                                        "code": "PRG",
                                        "name": "Vaclav Havel Airport Prague",
                                        "city": "PRG",
                                        "cityName": "Prague",
                                        "country": "CZ",
                                        "countryName": "Czech Republic"
                                    },
                                    "cabinClass": "ECONOMY",
                                    "flightInfo": {
                                        "flightNumber": 1361,
                                        "planeType": "73H",
                                        "carrierInfo": {
                                            "operatingCarrier": "KL",
                                            "marketingCarrier": "KL"
                                        }
                                    },
                                    "carriers": [
                                        "KL",
                                        "KL"
                                    ],
                                    "carriersData": [
                                        {
                                            "name": "KLM",
                                            "code": "KL"
                                        },
                                        {
                                            "name": "KLM",
                                            "code": "KL"
                                        }
                                    ],
                                    "totalTime": 5100,
                                    "amenities": [
                                        {
                                            "category": "AIRCRAFT",
                                            "model": "737"
                                        },
                                        {
                                            "category": "FOOD",
                                            "cost": "free",
                                            "type": "snack"
                                        },
                                        {
                                            "category": "POWER",
                                            "cost": "free",
                                            "type": [
                                                "usb_port"
                                            ]
                                        },
                                        {
                                            "category": "WIFI",
                                            "cost": "paid"
                                        }
                                    ],
                                    "arrivalTerminal": "2"
                                }
                            ],
                            "totalTime": 5100,
                            "isAtolProtected": false,
                            "showWarningDestinationAirport": false,
                            "showWarningOriginAirport": false
                        },
                        {
                            "departureAirport": {
                                "type": "AIRPORT",
                                "code": "PRG",
                                "name": "Vaclav Havel Airport Prague",
                                "city": "PRG",
                                "cityName": "Prague",
                                "country": "CZ",
                                "countryName": "Czech Republic"
                            },
                            "arrivalAirport": {
                                "type": "AIRPORT",
                                "code": "SFO",
                                "name": "San Francisco International Airport",
                                "city": "SFO",
                                "cityName": "San Francisco",
                                "country": "US",
                                "countryName": "United States"
                            },
                            "departureTime": "2024-12-15T06:00:00",
                            "arrivalTime": "2024-12-15T11:50:00",
                            "legs": [
                                {
                                    "departureTime": "2024-12-15T06:00:00",
                                    "arrivalTime": "2024-12-15T07:35:00",
                                    "departureAirport": {
                                        "type": "AIRPORT",
                                        "code": "PRG",
                                        "name": "Vaclav Havel Airport Prague",
                                        "city": "PRG",
                                        "cityName": "Prague",
                                        "country": "CZ",
                                        "countryName": "Czech Republic"
                                    },
                                    "arrivalAirport": {
                                        "type": "AIRPORT",
                                        "code": "AMS",
                                        "name": "Schiphol Airport",
                                        "city": "AMS",
                                        "cityName": "Amsterdam",
                                        "country": "NL",
                                        "countryName": "Netherlands"
                                    },
                                    "cabinClass": "ECONOMY",
                                    "flightInfo": {
                                        "flightNumber": 1350,
                                        "planeType": "73H",
                                        "carrierInfo": {
                                            "operatingCarrier": "KL",
                                            "marketingCarrier": "KL"
                                        }
                                    },
                                    "carriers": [
                                        "KL",
                                        "KL"
                                    ],
                                    "carriersData": [
                                        {
                                            "name": "KLM",
                                            "code": "KL"
                                        },
                                        {
                                            "name": "KLM",
                                            "code": "KL"
                                        }
                                    ],
                                    "totalTime": 5700,
                                    "amenities": [
                                        {
                                            "category": "AIRCRAFT",
                                            "model": "737"
                                        },
                                        {
                                            "category": "FOOD",
                                            "cost": "free",
                                            "type": "light_meal"
                                        },
                                        {
                                            "category": "POWER",
                                            "cost": "free",
                                            "type": [
                                                "usb_port"
                                            ]
                                        },
                                        {
                                            "category": "WIFI",
                                            "cost": "paid"
                                        }
                                    ],
                                    "departureTerminal": "2"
                                },
                                {
                                    "departureTime": "2024-12-15T09:50:00",
                                    "arrivalTime": "2024-12-15T11:50:00",
                                    "departureAirport": {
                                        "type": "AIRPORT",
                                        "code": "AMS",
                                        "name": "Schiphol Airport",
                                        "city": "AMS",
                                        "cityName": "Amsterdam",
                                        "country": "NL",
                                        "countryName": "Netherlands"
                                    },
                                    "arrivalAirport": {
                                        "type": "AIRPORT",
                                        "code": "SFO",
                                        "name": "San Francisco International Airport",
                                        "city": "SFO",
                                        "cityName": "San Francisco",
                                        "country": "US",
                                        "countryName": "United States"
                                    },
                                    "cabinClass": "ECONOMY",
                                    "flightInfo": {
                                        "flightNumber": 605,
                                        "planeType": "781",
                                        "carrierInfo": {
                                            "operatingCarrier": "KL",
                                            "marketingCarrier": "KL"
                                        }
                                    },
                                    "carriers": [
                                        "KL",
                                        "KL"
                                    ],
                                    "carriersData": [
                                        {
                                            "name": "KLM",
                                            "code": "KL"
                                        },
                                        {
                                            "name": "KLM",
                                            "code": "KL"
                                        }
                                    ],
                                    "totalTime": 39600,
                                    "amenities": [
                                        {
                                            "category": "AIRCRAFT",
                                            "model": "781"
                                        },
                                        {
                                            "category": "ENTERTAINMENT",
                                            "cost": "free"
                                        },
                                        {
                                            "category": "FOOD",
                                            "cost": "free",
                                            "type": "meal"
                                        },
                                        {
                                            "category": "POWER",
                                            "cost": "free",
                                            "type": [
                                                "usb_port"
                                            ]
                                        },
                                        {
                                            "category": "WIFI",
                                            "cost": "paid"
                                        }
                                    ],
                                    "arrivalTerminal": "I"
                                }
                            ],
                            "totalTime": 53400,
                            "isAtolProtected": false,
                            "showWarningDestinationAirport": false,
                            "showWarningOriginAirport": false
                        }
                    ]
                },
                {
                    "token": "d6a1f_H4sIAAAAAAAA_z2QbY-iMBSFf43zaSmU8iKTNBMi6MxYcFdEh08N1qo47DChnaD8-r2C2dym9zmnObfJPWv9rZ5N81hXp7NWxo9Cp0Y3p1JLJJq_5rGFa980n9XXySyr1szmqzDJLBzFs18Av9cLy74zADxhF9jEpgElnosXedWGagV9qvYSldQIgmBEJej0QS31kBMvHdvyV4MlGk0d5OLYZ0WyLezRbOkizXbublAHmsy6K4veVHJRHYtCBbpb9aGfbJSdRgoneU428zr9c6kXqxvO8qq7pvnUZlGMN32hdnH9euc8KhTbvmeQVWwzf2czq4dZel3HoGOV9Z8TEg2fSiEoRsjxAzzoplSUjCQ09a0RD5pmLA1JMUpNA8_CY-BKMSFT90nJWgpdNV9LeaNL5lmeAQuVwnaMLV8yTFzfgK0OBhsMzzJgtf8Nz3IN7D0SE3t2VB0pbwATEsI5cQsNBXwGxshGNnDJUxutCfp4RYsY9J4H94TgwRragcvS8ySQ5PfkkTtwVxw_Jl342w5az_H3oW7JP11i1ec6AgAA",
                    "segments": [
                        {
                            "departureAirport": {
                                "type": "AIRPORT",
                                "code": "SFO",
                                "name": "San Francisco International Airport",
                                "city": "SFO",
                                "cityName": "San Francisco",
                                "country": "US",
                                "countryName": "United States"
                            },
                            "arrivalAirport": {
                                "type": "AIRPORT",
                                "code": "AMS",
                                "name": "Schiphol Airport",
                                "city": "AMS",
                                "cityName": "Amsterdam",
                                "country": "NL",
                                "countryName": "Netherlands"
                            },
                            "departureTime": "2024-12-01T13:50:00",
                            "arrivalTime": "2024-12-02T09:05:00",
                            "legs": [
                                {
                                    "departureTime": "2024-12-01T13:50:00",
                                    "arrivalTime": "2024-12-02T09:05:00",
                                    "departureAirport": {
                                        "type": "AIRPORT",
                                        "code": "SFO",
                                        "name": "San Francisco International Airport",
                                        "city": "SFO",
                                        "cityName": "San Francisco",
                                        "country": "US",
                                        "countryName": "United States"
                                    },
                                    "arrivalAirport": {
                                        "type": "AIRPORT",
                                        "code": "AMS",
                                        "name": "Schiphol Airport",
                                        "city": "AMS",
                                        "cityName": "Amsterdam",
                                        "country": "NL",
                                        "countryName": "Netherlands"
                                    },
                                    "cabinClass": "ECONOMY",
                                    "flightInfo": {
                                        "flightNumber": 606,
                                        "planeType": "781",
                                        "carrierInfo": {
                                            "operatingCarrier": "KL",
                                            "marketingCarrier": "KL"
                                        }
                                    },
                                    "carriers": [
                                        "KL",
                                        "KL"
                                    ],
                                    "carriersData": [
                                        {
                                            "name": "KLM",
                                            "code": "KL"
                                        },
                                        {
                                            "name": "KLM",
                                            "code": "KL"
                                        }
                                    ],
                                    "totalTime": 36900,
                                    "amenities": [
                                        {
                                            "category": "AIRCRAFT",
                                            "model": "781"
                                        },
                                        {
                                            "category": "ENTERTAINMENT",
                                            "cost": "free"
                                        },
                                        {
                                            "category": "FOOD",
                                            "cost": "free",
                                            "type": "meal"
                                        },
                                        {
                                            "category": "POWER",
                                            "cost": "free",
                                            "type": [
                                                "usb_port"
                                            ]
                                        },
                                        {
                                            "category": "WIFI",
                                            "cost": "paid"
                                        }
                                    ],
                                    "departureTerminal": "I"
                                }
                            ],
                            "totalTime": 36900,
                            "isAtolProtected": false,
                            "showWarningDestinationAirport": false,
                            "showWarningOriginAirport": false
                        },
                        {
                            "departureAirport": {
                                "type": "AIRPORT",
                                "code": "AMS",
                                "name": "Schiphol Airport",
                                "city": "AMS",
                                "cityName": "Amsterdam",
                                "country": "NL",
                                "countryName": "Netherlands"
                            },
                            "arrivalAirport": {
                                "type": "AIRPORT",
                                "code": "PRG",
                                "name": "Vaclav Havel Airport Prague",
                                "city": "PRG",
                                "cityName": "Prague",
                                "country": "CZ",
                                "countryName": "Czech Republic"
                            },
                            "departureTime": "2024-12-02T16:15:00",
                            "arrivalTime": "2024-12-02T17:40:00",
                            "legs": [
                                {
                                    "departureTime": "2024-12-02T16:15:00",
                                    "arrivalTime": "2024-12-02T17:40:00",
                                    "departureAirport": {
                                        "type": "AIRPORT",
                                        "code": "AMS",
                                        "name": "Schiphol Airport",
                                        "city": "AMS",
                                        "cityName": "Amsterdam",
                                        "country": "NL",
                                        "countryName": "Netherlands"
                                    },
                                    "arrivalAirport": {
                                        "type": "AIRPORT",
                                        "code": "PRG",
                                        "name": "Vaclav Havel Airport Prague",
                                        "city": "PRG",
                                        "cityName": "Prague",
                                        "country": "CZ",
                                        "countryName": "Czech Republic"
                                    },
                                    "cabinClass": "ECONOMY",
                                    "flightInfo": {
                                        "flightNumber": 1357,
                                        "planeType": "295",
                                        "carrierInfo": {
                                            "operatingCarrier": "KL",
                                            "marketingCarrier": "KL",
                                            "operatingCarrierDisclosureText": "KLM Cityhopper"
                                        }
                                    },
                                    "carriers": [
                                        "KL",
                                        "KL"
                                    ],
                                    "carriersData": [
                                        {
                                            "name": "KLM",
                                            "code": "KL"
                                        },
                                        {
                                            "name": "KLM",
                                            "code": "KL"
                                        }
                                    ],
                                    "totalTime": 5100,
                                    "amenities": [
                                        {
                                            "category": "AIRCRAFT",
                                            "model": "295"
                                        },
                                        {
                                            "category": "FOOD",
                                            "cost": "free",
                                            "type": "snack"
                                        },
                                        {
                                            "category": "POWER",
                                            "cost": "free",
                                            "type": [
                                                "usb_port"
                                            ]
                                        },
                                        {
                                            "category": "WIFI",
                                            "cost": "paid"
                                        }
                                    ],
                                    "arrivalTerminal": "2"
                                }
                            ],
                            "totalTime": 5100,
                            "isAtolProtected": false,
                            "showWarningDestinationAirport": false,
                            "showWarningOriginAirport": false
                        },
                        {
                            "departureAirport": {
                                "type": "AIRPORT",
                                "code": "PRG",
                                "name": "Vaclav Havel Airport Prague",
                                "city": "PRG",
                                "cityName": "Prague",
                                "country": "CZ",
                                "countryName": "Czech Republic"
                            },
                            "arrivalAirport": {
                                "type": "AIRPORT",
                                "code": "SFO",
                                "name": "San Francisco International Airport",
                                "city": "SFO",
                                "cityName": "San Francisco",
                                "country": "US",
                                "countryName": "United States"
                            },
                            "departureTime": "2024-12-15T20:05:00",
                            "arrivalTime": "2024-12-16T11:50:00",
                            "legs": [
                                {
                                    "departureTime": "2024-12-15T20:05:00",
                                    "arrivalTime": "2024-12-15T21:50:00",
                                    "departureAirport": {
                                        "type": "AIRPORT",
                                        "code": "PRG",
                                        "name": "Vaclav Havel Airport Prague",
                                        "city": "PRG",
                                        "cityName": "Prague",
                                        "country": "CZ",
                                        "countryName": "Czech Republic"
                                    },
                                    "arrivalAirport": {
                                        "type": "AIRPORT",
                                        "code": "AMS",
                                        "name": "Schiphol Airport",
                                        "city": "AMS",
                                        "cityName": "Amsterdam",
                                        "country": "NL",
                                        "countryName": "Netherlands"
                                    },
                                    "cabinClass": "ECONOMY",
                                    "flightInfo": {
                                        "flightNumber": 1360,
                                        "planeType": "E90",
                                        "carrierInfo": {
                                            "operatingCarrier": "KL",
                                            "marketingCarrier": "KL",
                                            "operatingCarrierDisclosureText": "KLM Cityhopper"
                                        }
                                    },
                                    "carriers": [
                                        "KL",
                                        "KL"
                                    ],
                                    "carriersData": [
                                        {
                                            "name": "KLM",
                                            "code": "KL"
                                        },
                                        {
                                            "name": "KLM",
                                            "code": "KL"
                                        }
                                    ],
                                    "totalTime": 6300,
                                    "amenities": [
                                        {
                                            "category": "AIRCRAFT",
                                            "model": "E190"
                                        },
                                        {
                                            "category": "FOOD",
                                            "cost": "free",
                                            "type": "light_meal"
                                        },
                                        {
                                            "category": "POWER",
                                            "cost": "free",
                                            "type": [
                                                "usb_port"
                                            ]
                                        }
                                    ],
                                    "departureTerminal": "2"
                                },
                                {
                                    "departureTime": "2024-12-16T09:50:00",
                                    "arrivalTime": "2024-12-16T11:50:00",
                                    "departureAirport": {
                                        "type": "AIRPORT",
                                        "code": "AMS",
                                        "name": "Schiphol Airport",
                                        "city": "AMS",
                                        "cityName": "Amsterdam",
                                        "country": "NL",
                                        "countryName": "Netherlands"
                                    },
                                    "arrivalAirport": {
                                        "type": "AIRPORT",
                                        "code": "SFO",
                                        "name": "San Francisco International Airport",
                                        "city": "SFO",
                                        "cityName": "San Francisco",
                                        "country": "US",
                                        "countryName": "United States"
                                    },
                                    "cabinClass": "ECONOMY",
                                    "flightInfo": {
                                        "flightNumber": 605,
                                        "planeType": "772",
                                        "carrierInfo": {
                                            "operatingCarrier": "KL",
                                            "marketingCarrier": "KL"
                                        }
                                    },
                                    "carriers": [
                                        "KL",
                                        "KL"
                                    ],
                                    "carriersData": [
                                        {
                                            "name": "KLM",
                                            "code": "KL"
                                        },
                                        {
                                            "name": "KLM",
                                            "code": "KL"
                                        }
                                    ],
                                    "totalTime": 39600,
                                    "amenities": [
                                        {
                                            "category": "AIRCRAFT",
                                            "model": "777"
                                        },
                                        {
                                            "category": "ENTERTAINMENT",
                                            "cost": "free"
                                        },
                                        {
                                            "category": "FOOD",
                                            "cost": "free",
                                            "type": "meal"
                                        },
                                        {
                                            "category": "POWER",
                                            "cost": "free",
                                            "type": [
                                                "usb_port"
                                            ]
                                        },
                                        {
                                            "category": "WIFI",
                                            "cost": "paid"
                                        }
                                    ],
                                    "arrivalTerminal": "I"
                                }
                            ],
                            "totalTime": 89100,
                            "isAtolProtected": false,
                            "showWarningDestinationAirport": false,
                            "showWarningOriginAirport": false
                        }
                    ]
                },
                {
                    "token": "d6a1f_H4sIAAAAAAAA_z2Q3W6jMBCFnya9WozNb6hkrVAgaRtDdkNIliuLOA4hZUuFXZHy9DuBaDWW5zvHOmNpLlp_qmfTPDd1ddHK-FKoanVblVoi0f41zx1cx7Z9rz8qs6w7M1tuwiTDJIoXPwB-bVfYujMAPBEX2CSmASWei5_ypg3VCfpUHyUqqREEwYRK0PmDOuohJ147FvY3oyVaTR3kkthnRbIvvMns6CrNDu5hVCeaLPobi15VclU9i0IFut8MoZ_slJVGiiR5bu-WTfr72qw23yTL6_6W5nOLRTHZDYU6xM3LnfOoUGz_lkFWsd3yjS3wALP0tolBxyob3md2NH4qhaAEIccPyKjbUlF7IqGpjyc8aZqxNLSLSWoaeJhMgRsltj13n5RspNB1-7GW33TNPOwZsFApLMfY8zUjthsYsNXRYKPhYQNW-9_wsGsQ75GYWYtzfzlee4CZHcKpOEZjAV-ACbKQBVzy1EI5Rn9e0CoGfeTBPSF4sIV24rL0PAkk-T155g7cNSePSVf-eoA2cPJ5ajr7Hx3wrSI6AgAA",
                    "segments": [
                        {
                            "departureAirport": {
                                "type": "AIRPORT",
                                "code": "SFO",
                                "name": "San Francisco International Airport",
                                "city": "SFO",
                                "cityName": "San Francisco",
                                "country": "US",
                                "countryName": "United States"
                            },
                            "arrivalAirport": {
                                "type": "AIRPORT",
                                "code": "AMS",
                                "name": "Schiphol Airport",
                                "city": "AMS",
                                "cityName": "Amsterdam",
                                "country": "NL",
                                "countryName": "Netherlands"
                            },
                            "departureTime": "2024-12-01T13:50:00",
                            "arrivalTime": "2024-12-02T09:05:00",
                            "legs": [
                                {
                                    "departureTime": "2024-12-01T13:50:00",
                                    "arrivalTime": "2024-12-02T09:05:00",
                                    "departureAirport": {
                                        "type": "AIRPORT",
                                        "code": "SFO",
                                        "name": "San Francisco International Airport",
                                        "city": "SFO",
                                        "cityName": "San Francisco",
                                        "country": "US",
                                        "countryName": "United States"
                                    },
                                    "arrivalAirport": {
                                        "type": "AIRPORT",
                                        "code": "AMS",
                                        "name": "Schiphol Airport",
                                        "city": "AMS",
                                        "cityName": "Amsterdam",
                                        "country": "NL",
                                        "countryName": "Netherlands"
                                    },
                                    "cabinClass": "ECONOMY",
                                    "flightInfo": {
                                        "flightNumber": 606,
                                        "planeType": "781",
                                        "carrierInfo": {
                                            "operatingCarrier": "KL",
                                            "marketingCarrier": "KL"
                                        }
                                    },
                                    "carriers": [
                                        "KL",
                                        "KL"
                                    ],
                                    "carriersData": [
                                        {
                                            "name": "KLM",
                                            "code": "KL"
                                        },
                                        {
                                            "name": "KLM",
                                            "code": "KL"
                                        }
                                    ],
                                    "totalTime": 36900,
                                    "amenities": [
                                        {
                                            "category": "AIRCRAFT",
                                            "model": "781"
                                        },
                                        {
                                            "category": "ENTERTAINMENT",
                                            "cost": "free"
                                        },
                                        {
                                            "category": "FOOD",
                                            "cost": "free",
                                            "type": "meal"
                                        },
                                        {
                                            "category": "POWER",
                                            "cost": "free",
                                            "type": [
                                                "usb_port"
                                            ]
                                        },
                                        {
                                            "category": "WIFI",
                                            "cost": "paid"
                                        }
                                    ],
                                    "departureTerminal": "I"
                                }
                            ],
                            "totalTime": 36900,
                            "isAtolProtected": false,
                            "showWarningDestinationAirport": false,
                            "showWarningOriginAirport": false
                        },
                        {
                            "departureAirport": {
                                "type": "AIRPORT",
                                "code": "AMS",
                                "name": "Schiphol Airport",
                                "city": "AMS",
                                "cityName": "Amsterdam",
                                "country": "NL",
                                "countryName": "Netherlands"
                            },
                            "arrivalAirport": {
                                "type": "AIRPORT",
                                "code": "PRG",
                                "name": "Vaclav Havel Airport Prague",
                                "city": "PRG",
                                "cityName": "Prague",
                                "country": "CZ",
                                "countryName": "Czech Republic"
                            },
                            "departureTime": "2024-12-02T18:00:00",
                            "arrivalTime": "2024-12-02T19:25:00",
                            "legs": [
                                {
                                    "departureTime": "2024-12-02T18:00:00",
                                    "arrivalTime": "2024-12-02T19:25:00",
                                    "departureAirport": {
                                        "type": "AIRPORT",
                                        "code": "AMS",
                                        "name": "Schiphol Airport",
                                        "city": "AMS",
                                        "cityName": "Amsterdam",
                                        "country": "NL",
                                        "countryName": "Netherlands"
                                    },
                                    "arrivalAirport": {
                                        "type": "AIRPORT",
                                        "code": "PRG",
                                        "name": "Vaclav Havel Airport Prague",
                                        "city": "PRG",
                                        "cityName": "Prague",
                                        "country": "CZ",
                                        "countryName": "Czech Republic"
                                    },
                                    "cabinClass": "ECONOMY",
                                    "flightInfo": {
                                        "flightNumber": 1359,
                                        "planeType": "295",
                                        "carrierInfo": {
                                            "operatingCarrier": "KL",
                                            "marketingCarrier": "KL",
                                            "operatingCarrierDisclosureText": "KLM Cityhopper"
                                        }
                                    },
                                    "carriers": [
                                        "KL",
                                        "KL"
                                    ],
                                    "carriersData": [
                                        {
                                            "name": "KLM",
                                            "code": "KL"
                                        },
                                        {
                                            "name": "KLM",
                                            "code": "KL"
                                        }
                                    ],
                                    "totalTime": 5100,
                                    "amenities": [
                                        {
                                            "category": "AIRCRAFT",
                                            "model": "295"
                                        },
                                        {
                                            "category": "FOOD",
                                            "cost": "free",
                                            "type": "snack"
                                        },
                                        {
                                            "category": "POWER",
                                            "cost": "free",
                                            "type": [
                                                "usb_port"
                                            ]
                                        },
                                        {
                                            "category": "WIFI",
                                            "cost": "paid"
                                        }
                                    ],
                                    "arrivalTerminal": "2"
                                }
                            ],
                            "totalTime": 5100,
                            "isAtolProtected": false,
                            "showWarningDestinationAirport": false,
                            "showWarningOriginAirport": false
                        },
                        {
                            "departureAirport": {
                                "type": "AIRPORT",
                                "code": "PRG",
                                "name": "Vaclav Havel Airport Prague",
                                "city": "PRG",
                                "cityName": "Prague",
                                "country": "CZ",
                                "countryName": "Czech Republic"
                            },
                            "arrivalAirport": {
                                "type": "AIRPORT",
                                "code": "SFO",
                                "name": "San Francisco International Airport",
                                "city": "SFO",
                                "cityName": "San Francisco",
                                "country": "US",
                                "countryName": "United States"
                            },
                            "departureTime": "2024-12-15T20:05:00",
                            "arrivalTime": "2024-12-16T11:50:00",
                            "legs": [
                                {
                                    "departureTime": "2024-12-15T20:05:00",
                                    "arrivalTime": "2024-12-15T21:50:00",
                                    "departureAirport": {
                                        "type": "AIRPORT",
                                        "code": "PRG",
                                        "name": "Vaclav Havel Airport Prague",
                                        "city": "PRG",
                                        "cityName": "Prague",
                                        "country": "CZ",
                                        "countryName": "Czech Republic"
                                    },
                                    "arrivalAirport": {
                                        "type": "AIRPORT",
                                        "code": "AMS",
                                        "name": "Schiphol Airport",
                                        "city": "AMS",
                                        "cityName": "Amsterdam",
                                        "country": "NL",
                                        "countryName": "Netherlands"
                                    },
                                    "cabinClass": "ECONOMY",
                                    "flightInfo": {
                                        "flightNumber": 1360,
                                        "planeType": "E90",
                                        "carrierInfo": {
                                            "operatingCarrier": "KL",
                                            "marketingCarrier": "KL",
                                            "operatingCarrierDisclosureText": "KLM Cityhopper"
                                        }
                                    },
                                    "carriers": [
                                        "KL",
                                        "KL"
                                    ],
                                    "carriersData": [
                                        {
                                            "name": "KLM",
                                            "code": "KL"
                                        },
                                        {
                                            "name": "KLM",
                                            "code": "KL"
                                        }
                                    ],
                                    "totalTime": 6300,
                                    "amenities": [
                                        {
                                            "category": "AIRCRAFT",
                                            "model": "E190"
                                        },
                                        {
                                            "category": "FOOD",
                                            "cost": "free",
                                            "type": "light_meal"
                                        },
                                        {
                                            "category": "POWER",
                                            "cost": "free",
                                            "type": [
                                                "usb_port"
                                            ]
                                        }
                                    ],
                                    "departureTerminal": "2"
                                },
                                {
                                    "departureTime": "2024-12-16T09:50:00",
                                    "arrivalTime": "2024-12-16T11:50:00",
                                    "departureAirport": {
                                        "type": "AIRPORT",
                                        "code": "AMS",
                                        "name": "Schiphol Airport",
                                        "city": "AMS",
                                        "cityName": "Amsterdam",
                                        "country": "NL",
                                        "countryName": "Netherlands"
                                    },
                                    "arrivalAirport": {
                                        "type": "AIRPORT",
                                        "code": "SFO",
                                        "name": "San Francisco International Airport",
                                        "city": "SFO",
                                        "cityName": "San Francisco",
                                        "country": "US",
                                        "countryName": "United States"
                                    },
                                    "cabinClass": "ECONOMY",
                                    "flightInfo": {
                                        "flightNumber": 605,
                                        "planeType": "772",
                                        "carrierInfo": {
                                            "operatingCarrier": "KL",
                                            "marketingCarrier": "KL"
                                        }
                                    },
                                    "carriers": [
                                        "KL",
                                        "KL"
                                    ],
                                    "carriersData": [
                                        {
                                            "name": "KLM",
                                            "code": "KL"
                                        },
                                        {
                                            "name": "KLM",
                                            "code": "KL"
                                        }
                                    ],
                                    "totalTime": 39600,
                                    "amenities": [
                                        {
                                            "category": "AIRCRAFT",
                                            "model": "777"
                                        },
                                        {
                                            "category": "ENTERTAINMENT",
                                            "cost": "free"
                                        },
                                        {
                                            "category": "FOOD",
                                            "cost": "free",
                                            "type": "meal"
                                        },
                                        {
                                            "category": "POWER",
                                            "cost": "free",
                                            "type": [
                                                "usb_port"
                                            ]
                                        },
                                        {
                                            "category": "WIFI",
                                            "cost": "paid"
                                        }
                                    ],
                                    "arrivalTerminal": "I"
                                }
                            ],
                            "totalTime": 89100,
                            "isAtolProtected": false,
                            "showWarningDestinationAirport": false,
                            "showWarningOriginAirport": false
                        }
                    ]
                }
            ],
            "flightDeals": [
                {
                    "key": "CHEAPEST",
                    "offerToken": "d6a1f_H4sIAAAAAAAA_z2Q3W6jMBCFnya9WozNb6lkVSiQtI0hmxJScWURxyGkbL3CXiXl6XcCUWXL851jjz2ekzF_9ZNtH7u2ORlt_dOoUUY1tZFIqD_2sYdlr9Rn-9XYddvbxWIdZwUmSTr_BfD7fYmdGwPAFvGBbWJbMMRT9SyvxtK9oA_tXqKaWlEUTagFJXfqaYC8dOU5OFyPllCGesgnaciqbJfdzZ4u82VQ4VEdaDa_XFnyqrOzvrAk1qAv6yEO86128kSTrCzd7aLLN-fPYf1NirK9XPPy0WFJSrZDpT_S7uXGZVJptnsrIFez7eKNzfEAd5kN2YBOdZFmMzcZH5UCikbIC6OpdFXr-yeUMDScKlMHQwuWx241SUOjAJPp2JUS1330H7TspDCt-lrJb7piAQ4saKgUjmft-IoR1w8t6OposMnAFrT2xwiw_6N3M2d-7PeXzgOYuTHMhmM0DuATMEEOcoBrnjvo3UUxRssU9J5HtwzBow2EA5d1EEggyW-ZR-7B2nJyv-nMXz8gDJwoN8LyPxVFdz46AgAA",
                    "price": {
                        "currencyCode": "USD",
                        "units": 960,
                        "nanos": 110000000
                    },
                    "travellerPrices": [
                        {
                            "travellerPriceBreakdown": {
                                "total": {
                                    "currencyCode": "USD",
                                    "units": 960,
                                    "nanos": 110000000
                                },
                                "baseFare": {
                                    "currencyCode": "USD",
                                    "units": 400,
                                    "nanos": 0
                                },
                                "fee": {
                                    "currencyCode": "USD",
                                    "units": 0,
                                    "nanos": 0
                                },
                                "tax": {
                                    "currencyCode": "USD",
                                    "units": 560,
                                    "nanos": 110000000
                                },
                                "totalRounded": {
                                    "currencyCode": "USD",
                                    "nanos": 0,
                                    "units": 961
                                },
                                "discount": {
                                    "currencyCode": "USD",
                                    "units": 0,
                                    "nanos": 0
                                },
                                "totalWithoutDiscount": {
                                    "currencyCode": "USD",
                                    "units": 960,
                                    "nanos": 110000000
                                },
                                "totalWithoutDiscountRounded": {
                                    "currencyCode": "USD",
                                    "nanos": 0,
                                    "units": 961
                                }
                            },
                            "travellerReference": "1",
                            "travellerType": "ADULT"
                        }
                    ]
                },
                {
                    "key": "FASTEST",
                    "offerToken": "d6a1f_H4sIAAAAAAAA_z2Q3W6jMBCFnya9WozNb6lkVSiQtI0hmxJScWURxyGkbL3CXiXl6XcCUWXL851jjz2ekzF_9ZNtH7u2ORlt_dOoUUY1tZFIqD_2sYdlr9Rn-9XYddvbxWIdZwUmSTr_BfD7fYmdGwPAFvGBbWJbMMRT9SyvxtK9oA_tXqKaWlEUTagFJXfqaYC8dOU5OFyPllCGesgnaciqbJfdzZ4u82VQ4VEdaDa_XFnyqrOzvrAk1qAv6yEO86128kSTrCzd7aLLN-fPYf1NirK9XPPy0WFJSrZDpT_S7uXGZVJptnsrIFez7eKNzfEAd5kN2YBOdZFmMzcZH5UCikbIC6OpdFXr-yeUMDScKlMHQwuWx241SUOjAJPp2JUS1330H7TspDCt-lrJb7piAQ4saKgUjmft-IoR1w8t6OposMnAFrT2xwiw_6N3M2d-7PeXzgOYuTHMhmM0DuATMEEOcoBrnjvo3UUxRssU9J5HtwzBow2EA5d1EEggyW-ZR-7B2nJyv-nMXz8gDJwoN8LyPxVFdz46AgAA",
                    "price": {
                        "currencyCode": "USD",
                        "units": 960,
                        "nanos": 110000000
                    },
                    "travellerPrices": [
                        {
                            "travellerPriceBreakdown": {
                                "total": {
                                    "currencyCode": "USD",
                                    "units": 960,
                                    "nanos": 110000000
                                },
                                "baseFare": {
                                    "currencyCode": "USD",
                                    "units": 400,
                                    "nanos": 0
                                },
                                "fee": {
                                    "currencyCode": "USD",
                                    "units": 0,
                                    "nanos": 0
                                },
                                "tax": {
                                    "currencyCode": "USD",
                                    "units": 560,
                                    "nanos": 110000000
                                },
                                "totalRounded": {
                                    "currencyCode": "USD",
                                    "nanos": 0,
                                    "units": 961
                                },
                                "discount": {
                                    "currencyCode": "USD",
                                    "units": 0,
                                    "nanos": 0
                                },
                                "totalWithoutDiscount": {
                                    "currencyCode": "USD",
                                    "units": 960,
                                    "nanos": 110000000
                                },
                                "totalWithoutDiscountRounded": {
                                    "currencyCode": "USD",
                                    "nanos": 0,
                                    "units": 961
                                }
                            },
                            "travellerReference": "1",
                            "travellerType": "ADULT"
                        }
                    ]
                },
                {
                    "key": "BEST",
                    "offerToken": "d6a1f_H4sIAAAAAAAA_z2Q3W6jMBCFnya9WozNb6lkVSiQtI0hmxJScWURxyGkbL3CXiXl6XcCUWXL851jjz2ekzF_9ZNtH7u2ORlt_dOoUUY1tZFIqD_2sYdlr9Rn-9XYddvbxWIdZwUmSTr_BfD7fYmdGwPAFvGBbWJbMMRT9SyvxtK9oA_tXqKaWlEUTagFJXfqaYC8dOU5OFyPllCGesgnaciqbJfdzZ4u82VQ4VEdaDa_XFnyqrOzvrAk1qAv6yEO86128kSTrCzd7aLLN-fPYf1NirK9XPPy0WFJSrZDpT_S7uXGZVJptnsrIFez7eKNzfEAd5kN2YBOdZFmMzcZH5UCikbIC6OpdFXr-yeUMDScKlMHQwuWx241SUOjAJPp2JUS1330H7TspDCt-lrJb7piAQ4saKgUjmft-IoR1w8t6OposMnAFrT2xwiw_6N3M2d-7PeXzgOYuTHMhmM0DuATMEEOcoBrnjvo3UUxRssU9J5HtwzBow2EA5d1EEggyW-ZR-7B2nJyv-nMXz8gDJwoN8LyPxVFdz46AgAA",
                    "price": {
                        "currencyCode": "USD",
                        "units": 960,
                        "nanos": 110000000
                    },
                    "travellerPrices": [
                        {
                            "travellerPriceBreakdown": {
                                "total": {
                                    "currencyCode": "USD",
                                    "units": 960,
                                    "nanos": 110000000
                                },
                                "baseFare": {
                                    "currencyCode": "USD",
                                    "units": 400,
                                    "nanos": 0
                                },
                                "fee": {
                                    "currencyCode": "USD",
                                    "units": 0,
                                    "nanos": 0
                                },
                                "tax": {
                                    "currencyCode": "USD",
                                    "units": 560,
                                    "nanos": 110000000
                                },
                                "totalRounded": {
                                    "currencyCode": "USD",
                                    "nanos": 0,
                                    "units": 961
                                },
                                "discount": {
                                    "currencyCode": "USD",
                                    "units": 0,
                                    "nanos": 0
                                },
                                "totalWithoutDiscount": {
                                    "currencyCode": "USD",
                                    "units": 960,
                                    "nanos": 110000000
                                },
                                "totalWithoutDiscountRounded": {
                                    "currencyCode": "USD",
                                    "nanos": 0,
                                    "units": 961
                                }
                            },
                            "travellerReference": "1",
                            "travellerType": "ADULT"
                        }
                    ]
                }
            ],
            "atolProtectedStatus": "NONE",
            "searchId": "D3186256DB1D78632FE92A4D1CDBB1BC",
            "displayOptions": {
                "brandedFaresShownByDefault": false,
                "directFlightsOnlyFilterIgnored": false,
                "hideFlexiblePricesBanner": false
            },
            "isOffersCabinClassExtended": false,
            "searchCriteria": {
                "cabinClass": "ECONOMY"
            }
        }
    }
]

2025-08-25 13:29:21,590 - evaluation_logger_Flights-41 - INFO - Function Calls: 
[
    {
        "name": "Get_Flight_Details",
        "arguments": {
            "token": "d6a1f_H4sIAAAAAAAA_z2Q3W6jMBCFnya9WozNb6lkVSiQtI0hmxJScWURxyGkbL3CXiXl6XcCUWXL851jjz2ekzF_9ZNtH7u2ORlt_dOoUUY1tZFIqD_2sYdlr9Rn-9XYddvbxWIdZwUmSTr_BfD7fYmdGwPAFvGBbWJbMMRT9SyvxtK9oA_tXqKaWlEUTagFJXfqaYC8dOU5OFyPllCGesgnaciqbJfdzZ4u82VQ4VEdaDa_XFnyqrOzvrAk1qAv6yEO86128kSTrCzd7aLLN-fPYf1NirK9XPPy0WFJSrZDpT_S7uXGZVJptnsrIFez7eKNzfEAd5kN2YBOdZFmMzcZH5UCikbIC6OpdFXr-yeUMDScKlMHQwuWx241SUOjAJPp2JUS1330H7TspDCt-lrJb7piAQ4saKgUjmft-IoR1w8t6OposMnAFrT2xwiw_6N3M2d-7PeXzgOYuTHMhmM0DuATMEEOcoBrnjvo3UUxRssU9J5HtwzBow2EA5d1EEggyW-ZR-7B2nJyv-nMXz8gDJwoN8LyPxVFdz46AgAA"
        }
    }
]

2025-08-25 13:29:21,591 - evaluation_logger_Flights-41 - INFO - Golden Function Call: 
[
    {
        "name": "Get_Flight_Details",
        "arguments": {
            "token": "d6a1f_H4sIAAAAAAAA_z2Q3W6jMBCFnya9WozNb6lkVSiQtI0hmxJScWURxyGkbL3CXiXl6XcCUWXL851jjz2ekzF_9ZNtH7u2ORlt_dOoUUY1tZFIqD_2sYdlr9Rn-9XYddvbxWIdZwUmSTr_BfD7fYmdGwPAFvGBbWJbMMRT9SyvxtK9oA_tXqKaWlEUTagFJXfqaYC8dOU5OFyPllCGesgnaciqbJfdzZ4u82VQ4VEdaDa_XFnyqrOzvrAk1qAv6yEO86128kSTrCzd7aLLN-fPYf1NirK9XPPy0WFJSrZDpT_S7uXGZVJptnsrIFez7eKNzfEAd5kN2YBOdZFmMzcZH5UCikbIC6OpdFXr-yeUMDScKlMHQwuWx241SUOjAJPp2JUS1330H7TspDCt-lrJb7piAQ4saKgUjmft-IoR1w8t6OposMnAFrT2xwiw_6N3M2d-7PeXzgOYuTHMhmM0DuATMEEOcoBrnjvo3UUxRssU9J5HtwzBow2EA5d1EEggyW-ZR-7B2nJyv-nMXz8gDJwoN8LyPxVFdz46AgAA"
        }
    }
]

2025-08-25 13:29:21,591 - evaluation_logger_Flights-41 - INFO - Start compare_single_call: 
{'name': 'Get_Flight_Details', 'arguments': {'token': 'd6a1f_H4sIAAAAAAAA_z2Q3W6jMBCFnya9WozNb6lkVSiQtI0hmxJScWURxyGkbL3CXiXl6XcCUWXL851jjz2ekzF_9ZNtH7u2ORlt_dOoUUY1tZFIqD_2sYdlr9Rn-9XYddvbxWIdZwUmSTr_BfD7fYmdGwPAFvGBbWJbMMRT9SyvxtK9oA_tXqKaWlEUTagFJXfqaYC8dOU5OFyPllCGesgnaciqbJfdzZ4u82VQ4VEdaDa_XFnyqrOzvrAk1qAv6yEO86128kSTrCzd7aLLN-fPYf1NirK9XPPy0WFJSrZDpT_S7uXGZVJptnsrIFez7eKNzfEAd5kN2YBOdZFmMzcZH5UCikbIC6OpdFXr-yeUMDScKlMHQwuWx241SUOjAJPp2JUS1330H7TspDCt-lrJb7piAQ4saKgUjmft-IoR1w8t6OposMnAFrT2xwiw_6N3M2d-7PeXzgOYuTHMhmM0DuATMEEOcoBrnjvo3UUxRssU9J5HtwzBow2EA5d1EEggyW-ZR-7B2nJyv-nMXz8gDJwoN8LyPxVFdz46AgAA'}}
{'name': 'Get_Flight_Details', 'arguments': {'token': 'd6a1f_H4sIAAAAAAAA_z2Q3W6jMBCFnya9WozNb6lkVSiQtI0hmxJScWURxyGkbL3CXiXl6XcCUWXL851jjz2ekzF_9ZNtH7u2ORlt_dOoUUY1tZFIqD_2sYdlr9Rn-9XYddvbxWIdZwUmSTr_BfD7fYmdGwPAFvGBbWJbMMRT9SyvxtK9oA_tXqKaWlEUTagFJXfqaYC8dOU5OFyPllCGesgnaciqbJfdzZ4u82VQ4VEdaDa_XFnyqrOzvrAk1qAv6yEO86128kSTrCzd7aLLN-fPYf1NirK9XPPy0WFJSrZDpT_S7uXGZVJptnsrIFez7eKNzfEAd5kN2YBOdZFmMzcZH5UCikbIC6OpdFXr-yeUMDScKlMHQwuWx241SUOjAJPp2JUS1330H7TspDCt-lrJb7piAQ4saKgUjmft-IoR1w8t6OposMnAFrT2xwiw_6N3M2d-7PeXzgOYuTHMhmM0DuATMEEOcoBrnjvo3UUxRssU9J5HtwzBow2EA5d1EEggyW-ZR-7B2nJyv-nMXz8gDJwoN8LyPxVFdz46AgAA'}}
2025-08-25 13:29:21,591 - evaluation_logger_Flights-41 - INFO - Rule-based compare success.
2025-08-25 13:29:21,591 - evaluation_logger_Flights-41 - INFO - Success matched: [{'name': 'Get_Flight_Details', 'arguments': {'token': 'd6a1f_H4sIAAAAAAAA_z2Q3W6jMBCFnya9WozNb6lkVSiQtI0hmxJScWURxyGkbL3CXiXl6XcCUWXL851jjz2ekzF_9ZNtH7u2ORlt_dOoUUY1tZFIqD_2sYdlr9Rn-9XYddvbxWIdZwUmSTr_BfD7fYmdGwPAFvGBbWJbMMRT9SyvxtK9oA_tXqKaWlEUTagFJXfqaYC8dOU5OFyPllCGesgnaciqbJfdzZ4u82VQ4VEdaDa_XFnyqrOzvrAk1qAv6yEO86128kSTrCzd7aLLN-fPYf1NirK9XPPy0WFJSrZDpT_S7uXGZVJptnsrIFez7eKNzfEAd5kN2YBOdZFmMzcZH5UCikbIC6OpdFXr-yeUMDScKlMHQwuWx241SUOjAJPp2JUS1330H7TspDCt-lrJb7piAQ4saKgUjmft-IoR1w8t6OposMnAFrT2xwiw_6N3M2d-7PeXzgOYuTHMhmM0DuATMEEOcoBrnjvo3UUxRssU9J5HtwzBow2EA5d1EEggyW-ZR-7B2nJyv-nMXz8gDJwoN8LyPxVFdz46AgAA'}}]
2025-08-25 13:29:21,592 - evaluation_logger_Flights-41 - INFO - Observations:
[
    {
        "status": true,
        "message": "Success",
        "data": {
            "token": "d6a1f_H4sIAAAAAAAA_z2Q3W6jMBCFnya9WozNb6lkVSiQtI0hmxJScWURxyGkbL3CXiXl6XcCUWXL851jjz2ekzF_9ZNtH7u2ORlt_dOoUUY1tZFIqD_2sYdlr9Rn-9XYddvbxWIdZwUmSTr_BfD7fYmdGwPAFvGBbWJbMMRT9SyvxtK9oA_tXqKaWlEUTagFJXfqaYC8dOU5OFyPllCGesgnaciqbJfdzZ4u82VQ4VEdaDa_XFnyqrOzvrAk1qAv6yEO86128kSTrCzd7aLLN-fPYf1NirK9XPPy0WFJSrZDpT_S7uXGZVJptnsrIFez7eKNzfEAd5kN2YBOdZFmMzcZH5UCikbIC6OpdFXr-yeUMDScKlMHQwuWx241SUOjAJPp2JUS1330H7TspDCt-lrJb7piAQ4saKgUjmft-IoR1w8t6OposMnAFrT2xwiw_6N3M2d-7PeXzgOYuTHMhmM0DuATMEEOcoBrnjvo3UUxRssU9J5HtwzBow2EA5d1EEggyW-ZR-7B2nJyv-nMXz8gDJwoN8LyPxVFdz46AgAA",
            "segments": [
                {
                    "departureAirport": {
                        "type": "AIRPORT",
                        "code": "SFO",
                        "name": "San Francisco International Airport",
                        "city": "SFO",
                        "cityName": "San Francisco",
                        "country": "US",
                        "countryName": "United States"
                    },
                    "arrivalAirport": {
                        "type": "AIRPORT",
                        "code": "AMS",
                        "name": "Schiphol Airport",
                        "city": "AMS",
                        "cityName": "Amsterdam",
                        "country": "NL",
                        "countryName": "Netherlands"
                    },
                    "departureTime": "2024-12-01T13:50:00",
                    "arrivalTime": "2024-12-02T09:05:00",
                    "legs": [
                        {
                            "departureTime": "2024-12-01T13:50:00",
                            "arrivalTime": "2024-12-02T09:05:00",
                            "departureAirport": {
                                "type": "AIRPORT",
                                "code": "SFO",
                                "name": "San Francisco International Airport",
                                "city": "SFO",
                                "cityName": "San Francisco",
                                "country": "US",
                                "countryName": "United States"
                            },
                            "arrivalAirport": {
                                "type": "AIRPORT",
                                "code": "AMS",
                                "name": "Schiphol Airport",
                                "city": "AMS",
                                "cityName": "Amsterdam",
                                "country": "NL",
                                "countryName": "Netherlands"
                            },
                            "cabinClass": "ECONOMY",
                            "flightInfo": {
                                "flightNumber": 606,
                                "planeType": "781",
                                "carrierInfo": {
                                    "operatingCarrier": "KL",
                                    "marketingCarrier": "KL"
                                }
                            },
                            "carriers": [
                                "KL",
                                "KL"
                            ],
                            "carriersData": [
                                {
                                    "name": "KLM",
                                    "code": "KL"
                                },
                                {
                                    "name": "KLM",
                                    "code": "KL"
                                }
                            ],
                            "totalTime": 36900,
                            "amenities": [
                                {
                                    "category": "AIRCRAFT",
                                    "model": "781"
                                },
                                {
                                    "category": "ENTERTAINMENT",
                                    "cost": "free"
                                },
                                {
                                    "category": "FOOD",
                                    "cost": "free",
                                    "type": "meal"
                                },
                                {
                                    "category": "POWER",
                                    "cost": "free",
                                    "type": [
                                        "usb_port"
                                    ]
                                },
                                {
                                    "category": "WIFI",
                                    "cost": "paid"
                                }
                            ],
                            "departureTerminal": "I"
                        }
                    ],
                    "totalTime": 36900,
                    "travellerCabinLuggage": [
                        {
                            "travellerReference": "1",
                            "luggageAllowance": {
                                "luggageType": "HAND",
                                "maxPiece": 1,
                                "maxWeightPerPiece": 26.5,
                                "massUnit": "LB",
                                "sizeRestrictions": {
                                    "maxLength": 21.7,
                                    "maxWidth": 13.8,
                                    "maxHeight": 9.8,
                                    "sizeUnit": "INCH"
                                }
                            },
                            "personalItem": true
                        }
                    ],
                    "isAtolProtected": false,
                    "showWarningDestinationAirport": false,
                    "showWarningOriginAirport": false
                },
                {
                    "departureAirport": {
                        "type": "AIRPORT",
                        "code": "AMS",
                        "name": "Schiphol Airport",
                        "city": "AMS",
                        "cityName": "Amsterdam",
                        "country": "NL",
                        "countryName": "Netherlands"
                    },
                    "arrivalAirport": {
                        "type": "AIRPORT",
                        "code": "PRG",
                        "name": "Vaclav Havel Airport Prague",
                        "city": "PRG",
                        "cityName": "Prague",
                        "country": "CZ",
                        "countryName": "Czech Republic"
                    },
                    "departureTime": "2024-12-02T16:15:00",
                    "arrivalTime": "2024-12-02T17:40:00",
                    "legs": [
                        {
                            "departureTime": "2024-12-02T16:15:00",
                            "arrivalTime": "2024-12-02T17:40:00",
                            "departureAirport": {
                                "type": "AIRPORT",
                                "code": "AMS",
                                "name": "Schiphol Airport",
                                "city": "AMS",
                                "cityName": "Amsterdam",
                                "country": "NL",
                                "countryName": "Netherlands"
                            },
                            "arrivalAirport": {
                                "type": "AIRPORT",
                                "code": "PRG",
                                "name": "Vaclav Havel Airport Prague",
                                "city": "PRG",
                                "cityName": "Prague",
                                "country": "CZ",
                                "countryName": "Czech Republic"
                            },
                            "cabinClass": "ECONOMY",
                            "flightInfo": {
                                "flightNumber": 1357,
                                "planeType": "295",
                                "carrierInfo": {
                                    "operatingCarrier": "KL",
                                    "marketingCarrier": "KL",
                                    "operatingCarrierDisclosureText": "Klm Cityhopper"
                                }
                            },
                            "carriers": [
                                "KL",
                                "KL"
                            ],
                            "carriersData": [
                                {
                                    "name": "KLM",
                                    "code": "KL"
                                },
                                {
                                    "name": "KLM",
                                    "code": "KL"
                                }
                            ],
                            "totalTime": 5100,
                            "amenities": [
                                {
                                    "category": "AIRCRAFT",
                                    "model": "295"
                                },
                                {
                                    "category": "FOOD",
                                    "cost": "free",
                                    "type": "snack"
                                },
                                {
                                    "category": "POWER",
                                    "cost": "free",
                                    "type": [
                                        "usb_port"
                                    ]
                                },
                                {
                                    "category": "WIFI",
                                    "cost": "paid"
                                }
                            ],
                            "arrivalTerminal": "2"
                        }
                    ],
                    "totalTime": 5100,
                    "travellerCabinLuggage": [
                        {
                            "travellerReference": "1",
                            "luggageAllowance": {
                                "luggageType": "HAND",
                                "maxPiece": 1,
                                "maxWeightPerPiece": 26.5,
                                "massUnit": "LB",
                                "sizeRestrictions": {
                                    "maxLength": 21.7,
                                    "maxWidth": 13.8,
                                    "maxHeight": 9.8,
                                    "sizeUnit": "INCH"
                                }
                            },
                            "personalItem": true
                        }
                    ],
                    "isAtolProtected": false,
                    "showWarningDestinationAirport": false,
                    "showWarningOriginAirport": false
                },
                {
                    "departureAirport": {
                        "type": "AIRPORT",
                        "code": "PRG",
                        "name": "Vaclav Havel Airport Prague",
                        "city": "PRG",
                        "cityName": "Prague",
                        "country": "CZ",
                        "countryName": "Czech Republic"
                    },
                    "arrivalAirport": {
                        "type": "AIRPORT",
                        "code": "SFO",
                        "name": "San Francisco International Airport",
                        "city": "SFO",
                        "cityName": "San Francisco",
                        "country": "US",
                        "countryName": "United States"
                    },
                    "departureTime": "2024-12-15T06:00:00",
                    "arrivalTime": "2024-12-15T11:50:00",
                    "legs": [
                        {
                            "departureTime": "2024-12-15T06:00:00",
                            "arrivalTime": "2024-12-15T07:35:00",
                            "departureAirport": {
                                "type": "AIRPORT",
                                "code": "PRG",
                                "name": "Vaclav Havel Airport Prague",
                                "city": "PRG",
                                "cityName": "Prague",
                                "country": "CZ",
                                "countryName": "Czech Republic"
                            },
                            "arrivalAirport": {
                                "type": "AIRPORT",
                                "code": "AMS",
                                "name": "Schiphol Airport",
                                "city": "AMS",
                                "cityName": "Amsterdam",
                                "country": "NL",
                                "countryName": "Netherlands"
                            },
                            "cabinClass": "ECONOMY",
                            "flightInfo": {
                                "flightNumber": 1350,
                                "planeType": "73H",
                                "carrierInfo": {
                                    "operatingCarrier": "KL",
                                    "marketingCarrier": "KL"
                                }
                            },
                            "carriers": [
                                "KL",
                                "KL"
                            ],
                            "carriersData": [
                                {
                                    "name": "KLM",
                                    "code": "KL"
                                },
                                {
                                    "name": "KLM",
                                    "code": "KL"
                                }
                            ],
                            "totalTime": 5700,
                            "amenities": [
                                {
                                    "category": "AIRCRAFT",
                                    "model": "737"
                                },
                                {
                                    "category": "FOOD",
                                    "cost": "free",
                                    "type": "light_meal"
                                },
                                {
                                    "category": "POWER",
                                    "cost": "free",
                                    "type": [
                                        "usb_port"
                                    ]
                                },
                                {
                                    "category": "WIFI",
                                    "cost": "paid"
                                }
                            ],
                            "departureTerminal": "2"
                        },
                        {
                            "departureTime": "2024-12-15T09:50:00",
                            "arrivalTime": "2024-12-15T11:50:00",
                            "departureAirport": {
                                "type": "AIRPORT",
                                "code": "AMS",
                                "name": "Schiphol Airport",
                                "city": "AMS",
                                "cityName": "Amsterdam",
                                "country": "NL",
                                "countryName": "Netherlands"
                            },
                            "arrivalAirport": {
                                "type": "AIRPORT",
                                "code": "SFO",
                                "name": "San Francisco International Airport",
                                "city": "SFO",
                                "cityName": "San Francisco",
                                "country": "US",
                                "countryName": "United States"
                            },
                            "cabinClass": "ECONOMY",
                            "flightInfo": {
                                "flightNumber": 605,
                                "planeType": "781",
                                "carrierInfo": {
                                    "operatingCarrier": "KL",
                                    "marketingCarrier": "KL"
                                }
                            },
                            "carriers": [
                                "KL",
                                "KL"
                            ],
                            "carriersData": [
                                {
                                    "name": "KLM",
                                    "code": "KL"
                                },
                                {
                                    "name": "KLM",
                                    "code": "KL"
                                }
                            ],
                            "totalTime": 39600,
                            "amenities": [
                                {
                                    "category": "AIRCRAFT",
                                    "model": "781"
                                },
                                {
                                    "category": "ENTERTAINMENT",
                                    "cost": "free"
                                },
                                {
                                    "category": "FOOD",
                                    "cost": "free",
                                    "type": "meal"
                                },
                                {
                                    "category": "POWER",
                                    "cost": "free",
                                    "type": [
                                        "usb_port"
                                    ]
                                },
                                {
                                    "category": "WIFI",
                                    "cost": "paid"
                                }
                            ],
                            "arrivalTerminal": "I"
                        }
                    ],
                    "totalTime": 53400,
                    "travellerCabinLuggage": [
                        {
                            "travellerReference": "1",
                            "luggageAllowance": {
                                "luggageType": "HAND",
                                "maxPiece": 1,
                                "maxWeightPerPiece": 26.5,
                                "massUnit": "LB",
                                "sizeRestrictions": {
                                    "maxLength": 21.7,
                                    "maxWidth": 13.8,
                                    "maxHeight": 9.8,
                                    "sizeUnit": "INCH"
                                }
                            },
                            "personalItem": true
                        }
                    ],
                    "isAtolProtected": false,
                    "showWarningDestinationAirport": false,
                    "showWarningOriginAirport": false
                }
            ],
            "priceBreakdown": {
                "total": {
                    "currencyCode": "USD",
                    "units": 960,
                    "nanos": 110000000
                },
                "baseFare": {
                    "currencyCode": "USD",
                    "units": 400,
                    "nanos": 0
                },
                "fee": {
                    "currencyCode": "USD",
                    "units": 0,
                    "nanos": 0
                },
                "tax": {
                    "currencyCode": "USD",
                    "units": 560,
                    "nanos": 110000000
                },
                "totalRounded": {
                    "currencyCode": "USD",
                    "nanos": 0,
                    "units": 961
                },
                "discount": {
                    "currencyCode": "USD",
                    "units": 0,
                    "nanos": 0
                },
                "totalWithoutDiscount": {
                    "currencyCode": "USD",
                    "units": 960,
                    "nanos": 110000000
                },
                "totalWithoutDiscountRounded": {
                    "currencyCode": "USD",
                    "nanos": 0,
                    "units": 961
                },
                "carrierTaxBreakdown": [
                    {
                        "carrier": {
                            "name": "KLM",
                            "code": "KL"
                        },
                        "avgPerAdult": {
                            "currencyCode": "USD",
                            "units": 560,
                            "nanos": 110000000
                        }
                    }
                ]
            },
            "travellerPrices": [
                {
                    "travellerPriceBreakdown": {
                        "total": {
                            "currencyCode": "USD",
                            "units": 960,
                            "nanos": 110000000
                        },
                        "baseFare": {
                            "currencyCode": "USD",
                            "units": 400,
                            "nanos": 0
                        },
                        "fee": {
                            "currencyCode": "USD",
                            "units": 0,
                            "nanos": 0
                        },
                        "tax": {
                            "currencyCode": "USD",
                            "units": 560,
                            "nanos": 110000000
                        },
                        "totalRounded": {
                            "currencyCode": "USD",
                            "nanos": 0,
                            "units": 961
                        },
                        "discount": {
                            "currencyCode": "USD",
                            "units": 0,
                            "nanos": 0
                        },
                        "totalWithoutDiscount": {
                            "currencyCode": "USD",
                            "units": 960,
                            "nanos": 110000000
                        },
                        "totalWithoutDiscountRounded": {
                            "currencyCode": "USD",
                            "nanos": 0,
                            "units": 961
                        }
                    },
                    "travellerReference": "1",
                    "travellerType": "ADULT"
                }
            ],
            "priceDisplayRequirements": [
                "BAGGAGE_PRICE_BREAKDOWN",
                "SEAT_MAP_PRICE_BREAKDOWN",
                "AIR_PRICE_BREAKDOWN"
            ],
            "pointOfSale": "us",
            "tripType": "MULTISTOP",
            "offerReference": "d6a1f_1786651613",
            "travellerDataRequirements": [
                "DATE_OF_BIRTH"
            ],
            "bookerDataRequirement": [
                "EMAIL",
                "PHONE"
            ],
            "travellers": [
                {
                    "travellerReference": "1",
                    "type": "ADULT"
                }
            ],
            "posMismatch": {
                "detectedPointOfSale": "us",
                "isPOSMismatch": false,
                "offerSalesCountry": "us"
            },
            "includedProductsBySegment": [
                [
                    {
                        "travellerReference": "1",
                        "travellerProducts": [
                            {
                                "type": "cabinBaggage",
                                "product": {
                                    "luggageType": "HAND",
                                    "maxPiece": 1,
                                    "maxWeightPerPiece": 26.5,
                                    "massUnit": "LB",
                                    "sizeRestrictions": {
                                        "maxLength": 21.7,
                                        "maxWidth": 13.8,
                                        "maxHeight": 9.8,
                                        "sizeUnit": "INCH"
                                    }
                                }
                            },
                            {
                                "type": "personalItem"
                            }
                        ]
                    }
                ],
                [
                    {
                        "travellerReference": "1",
                        "travellerProducts": [
                            {
                                "type": "cabinBaggage",
                                "product": {
                                    "luggageType": "HAND",
                                    "maxPiece": 1,
                                    "maxWeightPerPiece": 26.5,
                                    "massUnit": "LB",
                                    "sizeRestrictions": {
                                        "maxLength": 21.7,
                                        "maxWidth": 13.8,
                                        "maxHeight": 9.8,
                                        "sizeUnit": "INCH"
                                    }
                                }
                            },
                            {
                                "type": "personalItem"
                            }
                        ]
                    }
                ],
                [
                    {
                        "travellerReference": "1",
                        "travellerProducts": [
                            {
                                "type": "cabinBaggage",
                                "product": {
                                    "luggageType": "HAND",
                                    "maxPiece": 1,
                                    "maxWeightPerPiece": 26.5,
                                    "massUnit": "LB",
                                    "sizeRestrictions": {
                                        "maxLength": 21.7,
                                        "maxWidth": 13.8,
                                        "maxHeight": 9.8,
                                        "sizeUnit": "INCH"
                                    }
                                }
                            },
                            {
                                "type": "personalItem"
                            }
                        ]
                    }
                ]
            ],
            "includedProducts": {
                "areAllSegmentsIdentical": true,
                "segments": [
                    [
                        {
                            "luggageType": "PERSONAL_ITEM",
                            "maxPiece": 1,
                            "piecePerPax": 1
                        },
                        {
                            "luggageType": "HAND",
                            "maxPiece": 1,
                            "maxWeightPerPiece": 26.5,
                            "massUnit": "LB",
                            "sizeRestrictions": {
                                "maxLength": 21.7,
                                "maxWidth": 13.8,
                                "maxHeight": 9.8,
                                "sizeUnit": "INCH"
                            },
                            "piecePerPax": 1
                        }
                    ]
                ]
            },
            "extraProducts": [
                {
                    "type": "flexibleTicket",
                    "priceBreakdown": {
                        "total": {
                            "currencyCode": "USD",
                            "units": 134,
                            "nanos": 420000000
                        },
                        "baseFare": {
                            "currencyCode": "USD",
                            "units": 134,
                            "nanos": 420000000
                        },
                        "fee": {
                            "currencyCode": "USD",
                            "units": 0,
                            "nanos": 0
                        },
                        "tax": {
                            "currencyCode": "USD",
                            "units": 0,
                            "nanos": 0
                        },
                        "discount": {
                            "currencyCode": "USD",
                            "units": 0,
                            "nanos": 0
                        },
                        "totalWithoutDiscount": {
                            "currencyCode": "USD",
                            "units": 134,
                            "nanos": 420000000
                        }
                    }
                },
                {
                    "type": "mealPreference",
                    "priceBreakdown": {
                        "total": {
                            "currencyCode": "USD",
                            "units": 0,
                            "nanos": 0
                        },
                        "baseFare": {
                            "currencyCode": "USD",
                            "units": 0,
                            "nanos": 0
                        },
                        "fee": {
                            "currencyCode": "USD",
                            "units": 0,
                            "nanos": 0
                        },
                        "tax": {
                            "currencyCode": "USD",
                            "units": 0,
                            "nanos": 0
                        },
                        "discount": {
                            "currencyCode": "USD",
                            "units": 0,
                            "nanos": 0
                        },
                        "totalWithoutDiscount": {
                            "currencyCode": "USD",
                            "units": 0,
                            "nanos": 0
                        }
                    }
                },
                {
                    "type": "mobileTravelPlan",
                    "priceBreakdown": {
                        "total": {
                            "currencyCode": "USD",
                            "units": 0,
                            "nanos": 0
                        },
                        "baseFare": {
                            "currencyCode": "USD",
                            "units": 0,
                            "nanos": 0
                        },
                        "fee": {
                            "currencyCode": "USD",
                            "units": 0,
                            "nanos": 0
                        },
                        "tax": {
                            "currencyCode": "USD",
                            "units": 0,
                            "nanos": 0
                        },
                        "discount": {
                            "currencyCode": "USD",
                            "units": 0,
                            "nanos": 0
                        },
                        "totalWithoutDiscount": {
                            "currencyCode": "USD",
                            "units": 0,
                            "nanos": 0
                        }
                    }
                }
            ],
            "offerExtras": {
                "flexibleTicket": {
                    "airProductReference": "n/a",
                    "travellers": [
                        "1"
                    ],
                    "recommendation": {
                        "recommended": false,
                        "confidence": "UNKNOWN_LEVEL"
                    },
                    "priceBreakdown": {
                        "total": {
                            "currencyCode": "USD",
                            "units": 134,
                            "nanos": 420000000
                        },
                        "baseFare": {
                            "currencyCode": "USD",
                            "units": 134,
                            "nanos": 420000000
                        },
                        "fee": {
                            "currencyCode": "USD",
                            "units": 0,
                            "nanos": 0
                        },
                        "tax": {
                            "currencyCode": "USD",
                            "units": 0,
                            "nanos": 0
                        },
                        "totalRounded": {
                            "currencyCode": "USD",
                            "nanos": 0,
                            "units": 135
                        },
                        "discount": {
                            "currencyCode": "USD",
                            "units": 0,
                            "nanos": 0
                        },
                        "totalWithoutDiscount": {
                            "currencyCode": "USD",
                            "units": 134,
                            "nanos": 420000000
                        },
                        "totalWithoutDiscountRounded": {
                            "currencyCode": "USD",
                            "nanos": 0,
                            "units": 135
                        }
                    },
                    "supplierInfo": {
                        "name": "Gotogate, Inc."
                    }
                },
                "mobileTravelPlan": {
                    "priceBreakdown": {
                        "total": {
                            "currencyCode": "USD",
                            "units": 0,
                            "nanos": 0
                        },
                        "baseFare": {
                            "currencyCode": "USD",
                            "units": 0,
                            "nanos": 0
                        },
                        "fee": {
                            "currencyCode": "USD",
                            "units": 0,
                            "nanos": 0
                        },
                        "tax": {
                            "currencyCode": "USD",
                            "units": 0,
                            "nanos": 0
                        },
                        "discount": {
                            "currencyCode": "USD",
                            "units": 0,
                            "nanos": 0
                        },
                        "totalWithoutDiscount": {
                            "currencyCode": "USD",
                            "units": 0,
                            "nanos": 0
                        }
                    }
                }
            },
            "ancillaries": {
                "flexibleTicket": {
                    "airProductReference": "n/a",
                    "travellers": [
                        "1"
                    ],
                    "priceBreakdown": {
                        "total": {
                            "currencyCode": "USD",
                            "units": 134,
                            "nanos": 420000000
                        },
                        "baseFare": {
                            "currencyCode": "USD",
                            "units": 134,
                            "nanos": 420000000
                        },
                        "fee": {
                            "currencyCode": "USD",
                            "units": 0,
                            "nanos": 0
                        },
                        "tax": {
                            "currencyCode": "USD",
                            "units": 0,
                            "nanos": 0
                        },
                        "discount": {
                            "currencyCode": "USD",
                            "units": 0,
                            "nanos": 0
                        },
                        "totalWithoutDiscount": {
                            "currencyCode": "USD",
                            "units": 134,
                            "nanos": 420000000
                        }
                    },
                    "preSelected": false,
                    "recommendation": {
                        "recommended": false,
                        "confidence": "UNKNOWN_LEVEL"
                    },
                    "supplierInfo": {
                        "name": "Gotogate, Inc."
                    }
                },
                "mealPreference": {
                    "airProductReference": "n/a",
                    "travellers": [
                        "1"
                    ],
                    "choices": [
                        {
                            "mealType": "VEGETARIAN",
                            "priceBreakdown": {
                                "total": {
                                    "currencyCode": "USD",
                                    "units": 0,
                                    "nanos": 0
                                },
                                "baseFare": {
                                    "currencyCode": "USD",
                                    "units": 0,
                                    "nanos": 0
                                },
                                "fee": {
                                    "currencyCode": "USD",
                                    "units": 0,
                                    "nanos": 0
                                },
                                "tax": {
                                    "currencyCode": "USD",
                                    "units": 0,
                                    "nanos": 0
                                },
                                "discount": {
                                    "currencyCode": "USD",
                                    "units": 0,
                                    "nanos": 0
                                },
                                "totalWithoutDiscount": {
                                    "currencyCode": "USD",
                                    "units": 0,
                                    "nanos": 0
                                }
                            }
                        },
                        {
                            "mealType": "VEGAN",
                            "priceBreakdown": {
                                "total": {
                                    "currencyCode": "USD",
                                    "units": 0,
                                    "nanos": 0
                                },
                                "baseFare": {
                                    "currencyCode": "USD",
                                    "units": 0,
                                    "nanos": 0
                                },
                                "fee": {
                                    "currencyCode": "USD",
                                    "units": 0,
                                    "nanos": 0
                                },
                                "tax": {
                                    "currencyCode": "USD",
                                    "units": 0,
                                    "nanos": 0
                                },
                                "discount": {
                                    "currencyCode": "USD",
                                    "units": 0,
                                    "nanos": 0
                                },
                                "totalWithoutDiscount": {
                                    "currencyCode": "USD",
                                    "units": 0,
                                    "nanos": 0
                                }
                            }
                        },
                        {
                            "mealType": "LACTOSE_FREE",
                            "priceBreakdown": {
                                "total": {
                                    "currencyCode": "USD",
                                    "units": 0,
                                    "nanos": 0
                                },
                                "baseFare": {
                                    "currencyCode": "USD",
                                    "units": 0,
                                    "nanos": 0
                                },
                                "fee": {
                                    "currencyCode": "USD",
                                    "units": 0,
                                    "nanos": 0
                                },
                                "tax": {
                                    "currencyCode": "USD",
                                    "units": 0,
                                    "nanos": 0
                                },
                                "discount": {
                                    "currencyCode": "USD",
                                    "units": 0,
                                    "nanos": 0
                                },
                                "totalWithoutDiscount": {
                                    "currencyCode": "USD",
                                    "units": 0,
                                    "nanos": 0
                                }
                            }
                        },
                        {
                            "mealType": "GLUTEN_FREE",
                            "priceBreakdown": {
                                "total": {
                                    "currencyCode": "USD",
                                    "units": 0,
                                    "nanos": 0
                                },
                                "baseFare": {
                                    "currencyCode": "USD",
                                    "units": 0,
                                    "nanos": 0
                                },
                                "fee": {
                                    "currencyCode": "USD",
                                    "units": 0,
                                    "nanos": 0
                                },
                                "tax": {
                                    "currencyCode": "USD",
                                    "units": 0,
                                    "nanos": 0
                                },
                                "discount": {
                                    "currencyCode": "USD",
                                    "units": 0,
                                    "nanos": 0
                                },
                                "totalWithoutDiscount": {
                                    "currencyCode": "USD",
                                    "units": 0,
                                    "nanos": 0
                                }
                            }
                        },
                        {
                            "mealType": "KOSHER",
                            "priceBreakdown": {
                                "total": {
                                    "currencyCode": "USD",
                                    "units": 0,
                                    "nanos": 0
                                },
                                "baseFare": {
                                    "currencyCode": "USD",
                                    "units": 0,
                                    "nanos": 0
                                },
                                "fee": {
                                    "currencyCode": "USD",
                                    "units": 0,
                                    "nanos": 0
                                },
                                "tax": {
                                    "currencyCode": "USD",
                                    "units": 0,
                                    "nanos": 0
                                },
                                "discount": {
                                    "currencyCode": "USD",
                                    "units": 0,
                                    "nanos": 0
                                },
                                "totalWithoutDiscount": {
                                    "currencyCode": "USD",
                                    "units": 0,
                                    "nanos": 0
                                }
                            }
                        }
                    ]
                },
                "mobileTravelPlan": {
                    "priceBreakdown": {
                        "total": {
                            "currencyCode": "USD",
                            "units": 0,
                            "nanos": 0
                        },
                        "baseFare": {
                            "currencyCode": "USD",
                            "units": 0,
                            "nanos": 0
                        },
                        "fee": {
                            "currencyCode": "USD",
                            "units": 0,
                            "nanos": 0
                        },
                        "tax": {
                            "currencyCode": "USD",
                            "units": 0,
                            "nanos": 0
                        },
                        "discount": {
                            "currencyCode": "USD",
                            "units": 0,
                            "nanos": 0
                        },
                        "totalWithoutDiscount": {
                            "currencyCode": "USD",
                            "units": 0,
                            "nanos": 0
                        }
                    }
                },
                "travelInsurance": {
                    "options": {
                        "type": "COMPREHENSIVE_INSURANCE_COVER_GENIUS",
                        "travellers": [
                            "1"
                        ],
                        "priceBreakdown": {
                            "total": {
                                "currencyCode": "USD",
                                "units": 69,
                                "nanos": 250000000
                            },
                            "baseFare": {
                                "currencyCode": "USD",
                                "units": 69,
                                "nanos": 250000000
                            },
                            "fee": {
                                "currencyCode": "USD",
                                "units": 0,
                                "nanos": 0
                            },
                            "tax": {
                                "currencyCode": "USD",
                                "units": 0,
                                "nanos": 0
                            },
                            "discount": {
                                "currencyCode": "USD",
                                "units": 0,
                                "nanos": 0
                            },
                            "totalWithoutDiscount": {
                                "currencyCode": "USD",
                                "units": 69,
                                "nanos": 250000000
                            }
                        },
                        "disclaimer": "Plan is issued by Cover Genius Insurance Services, LLC, includes insurance by US Fire and non-ins. services by On Call International. By clicking the button to select this coverage, I agree that I have read and agree to the Plan Terms."
                    },
                    "content": {
                        "header": "Travel protection",
                        "subheader": "Protect yourself from the unexpected. XCover's Travel Protection covers flight costs and more.",
                        "optInTitle": "Travel protection",
                        "optOutTitle": "No insurance",
                        "exclusions": [
                            "Terms and exclusions apply. Claims and losses due to pre-existing medical conditions are not covered."
                        ],
                        "coveredStatusLabel": "Insured",
                        "notCoveredStatusLabel": "Not insured",
                        "benefitsTitle": "What’s covered by your travel insurance",
                        "closeA11y": "Close and go back to the travel insurance overview section.",
                        "benefits": [
                            "Trip cancellation - Unforeseen covered circumstances that force you to cancel your trip",
                            "Trip interruption - Unexpected events that require you to return home during your trip\n",
                            "Travel delay - Expenses, like hotels and food, if you’re delayed during your trip",
                            "Baggage loss or theft - Coverage may be available for lost, stolen or damaged personal items",
                            "Baggage delay - Purchases you make, like toiletries and clothes, if your baggage is lost",
                            "Medical and dental, emergency assistance and transportation while you’re abroad (international flight bookings only)"
                        ],
                        "finePrint": [
                            "This plan is issued by Cover Genius Insurance Services, LLC, and includes insurance by US Fire and non-insurance services by On Call International. By selecting this coverage, I agree that I have read and agree to the <a href='https://www.xcover.com/en-us/pds/EYR9J-PPG4L-INS' id='insurance_terms_link' target='_blank' rel='noopener noreferrer' >Plan Terms & Disclosures</a>. Coverage is not available for travellers residing in Hawaii, Kansas, New York, or Wyoming."
                        ]
                    },
                    "forceForAllTravellers": true,
                    "isPerTraveller": true,
                    "version": 0,
                    "recommendation": {
                        "recommended": false,
                        "confidence": "UNKNOWN_LEVEL"
                    }
                }
            },
            "carbonEmissions": {
                "footprintForOffer": {
                    "quantity": 1262.52,
                    "unit": "KG",
                    "status": "LOWER",
                    "average": 1680.9299999999998,
                    "percentageDifference": 24
                }
            },
            "displayOptions": {
                "skipExtrasPage": false
            }
        }
    }
]

2025-08-25 13:32:45,760 - evaluation_logger_Flights-41 - INFO - Final Response: <｜begin▁of▁sentence｜># 1. 概述

## 1.1. 背景

在当今的互联网时代，数据已经成为企业最宝贵的资产之一。然而，数据的价值不仅仅在于其存在，更在于如何有效地利用这些数据来驱动业务决策、优化用户体验和提升运营效率。随着大数据技术的发展，企业能够收集和处理的数据量呈指数级增长，这为数据驱动的决策提供了前所未有的机会。

然而，传统的数据处理和分析方法往往无法满足现代企业对实时性、准确性和可扩展性的要求。批处理系统虽然能够处理大规模数据，但延迟较高，无法支持实时决策；而实时流处理系统虽然能够提供低延迟的数据处理，但在复杂事件处理、状态管理和精确一次语义等方面存在挑战。

正是在这样的背景下，Flink作为一个开源的流处理框架，凭借其强大的状态管理、精确一次语义处理能力和灵活的窗口机制，成为了构建实时数据平台的首选技术。Flink不仅能够处理无界数据流，还能够高效地处理有界数据集，实现了批流一体的处理模式。

## 1.2. 目标

本白皮书旨在深入探讨基于Flink构建企业级实时数据平台的最佳实践和技术方案。我们将从平台架构设计、核心组件实现、运维监控、应用场景等多个维度进行全面分析，为企业构建自己的实时数据平台提供实用的指导。

具体而言，本白皮书的目标包括：

1. 阐述实时数据平台的核心价值和技术选型依据
2. 提供基于Flink的实时数据平台架构设计方案
3. 详细介绍关键组件的实现细节和优化策略
4. 分享平台运维和监控的最佳实践
5. 展示典型的应用场景和成功案例
6. 探讨未来发展趋势和技术演进方向

## 1.3. 读者对象

本白皮书主要面向以下读者：

- **技术决策者**：CTO、技术总监、架构师等，需要了解实时数据平台的技术架构和商业价值
- **数据工程师**：负责数据平台的设计、开发和维护的技术人员
- **数据分析师**：使用数据平台进行数据分析和挖掘的专业人员
- **运维工程师**：负责数据平台的部署、监控和运维的技术人员
- **对实时数据处理感兴趣的技术爱好者**

我们假设读者具备基本的大数据处理知识和分布式系统概念，对Flink有一定的了解，但不要求是Flink专家。通过阅读本白皮书，读者将能够全面了解基于Flink构建实时数据平台的技术方案和实践经验。

# 2. 实时数据平台概述

## 2.1. 什么是实时数据平台

实时数据平台是一个集数据采集、处理、存储和分析于一体的综合性系统，旨在为企业提供低延迟、高吞吐的数据处理能力。与传统的批处理系统不同，实时数据平台能够对数据进行即时处理和分析，使企业能够快速响应业务变化，做出实时决策。

实时数据平台的核心特征包括：

- **低延迟处理**：能够在毫秒到秒级内完成数据处理
- **高吞吐量**：支持大规模数据流的实时处理
- **精确一次语义**：确保数据处理的准确性和一致性
- **可扩展性**：能够根据业务需求弹性扩展处理能力
- **容错性**：在节点故障时能够保证数据不丢失和处理不中断

## 2.2. 实时 vs 批处理

为了更好地理解实时数据平台的价值，我们需要对比实时处理与批处理的区别：

| 特性 | 批处理 | 实时处理 |
|------|--------|----------|
| 数据处理方式 | 周期性处理大量数据 | 持续处理数据流 |
| 延迟 | 分钟到小时级 | 毫秒到秒级 |
| 数据范围 | 有界数据集 | 无界数据流 |
| 典型应用 | 报表生成、历史分析 | 实时监控、实时推荐 |
| 技术代表 | Hadoop MapReduce、Spark | Flink、Storm、Spark Streaming |

虽然批处理和实时处理各有优势，但现代数据平台往往需要同时支持两种处理模式，这就是所谓的"批流一体"架构。Flink在这方面表现出色，能够用同一套代码和架构处理有界和无界数据。

## 2.3. 实时数据平台的价值

构建实时数据平台能够为企业带来多方面的价值：

### 2.3.1. 业务价值

- **实时决策支持**：使企业能够基于最新数据做出快速决策
- **用户体验提升**：通过实时个性化推荐、实时搜索等功能提升用户满意度
- **运营效率优化**：实时监控业务指标，快速发现问题并采取措施
- **风险控制**：实时检测异常行为，防范欺诈和安全风险

### 2.3.2. 技术价值

- **架构统一**：批流一体架构减少技术栈复杂度
- **资源优化**：实时处理可以减少中间存储，降低存储成本
- **开发效率**：统一的API和开发模式提高开发效率
- **运维简化**：统一的监控和管理平台简化运维工作

### 2.3.3. 数据价值

- **数据时效性**：确保数据的实时性和新鲜度
- **数据一致性**：通过精确一次语义保证数据处理的一致性
- **数据完整性**：支持复杂事件处理和状态管理，提供完整的数据视图
- **数据可追溯**：完善的数据血缘和元数据管理

## 2.4. 实时数据平台的挑战

构建实时数据平台也面临一些挑战：

### 2.4.1. 技术挑战

- **状态管理**：如何高效管理分布式状态
- **精确一次语义**：如何保证数据处理的准确性和一致性
- **资源管理**：如何动态分配和管理计算资源
- **数据一致性**：如何保证端到端的数据一致性

### 2.4.2. 运维挑战

- **监控告警**：如何实时监控平台状态并及时发现问题
- **故障恢复**：如何快速从故障中恢复
- **性能优化**：如何持续优化平台性能
- **版本升级**：如何平滑升级平台版本

### 2.4.3. 业务挑战

- **需求变化**：如何快速响应业务需求的变化
- **数据质量**：如何保证实时数据的质量
- **成本控制**：如何在性能和成本之间找到平衡
- **团队技能**：如何培养具备实时数据处理技能的团队

在后续章节中，我们将详细探讨如何基于Flink构建实时数据平台，并解决这些挑战。

# 3. Flink技术优势

## 3.1. Flink架构概述

Apache Flink是一个开源的分布式流处理框架，其核心设计理念是将批处理作为流处理的特例。Flink的架构设计使其能够处理无界数据流和有界数据集，实现了真正的批流一体。

### 3.1.1. 核心架构组件

Flink的核心架构包括以下组件：

- **JobManager**：负责作业调度和资源管理，协调分布式执行
- **TaskManager**：负责具体任务的执行，每个TaskManager包含一定数量的任务槽（slot）
- **Client**：提交作业到JobManager的客户端
- **ResourceManager**：负责资源分配和管理
- **Dispatcher**：提供REST接口，用于作业提交和查询

### 3.1.2. 编程模型

Flink提供了多层次的API抽象：

- **ProcessFunction**：最底层的API，提供对时间和状态的细粒度控制
- **DataStream API**：用于流处理的核心API
- **DataSet API**：用于批处理的API（逐渐被Table API/SQL取代）
- **Table API & SQL**：关系型API，支持SQL查询和表操作

## 3.2. 状态管理

状态管理是流处理的核心挑战之一，Flink在这方面提供了强大的支持。

### 3.2.1. 状态类型

Flink支持多种状态类型：

- **Keyed State**：与特定key关联的状态，只能在keyed stream上使用
- **Operator State**：与算子实例关联的状态，每个算子实例维护自己的状态
- **Broadcast State**：用于将状态广播到所有并行实例

### 3.2.2. 状态后端

Flink提供了多种状态后端实现：

- **MemoryStateBackend**：将状态存储在内存中，适用于测试和开发
- **FsStateBackend**：将状态存储在文件系统中，定期做checkpoint
- **RocksDBStateBackend**：使用RocksDB存储状态，支持大状态和增量checkpoint

### 3.2.3. 状态恢复

Flink通过checkpoint机制实现状态恢复：

- **定期checkpoint**：定期将状态持久化到外部存储
- **精确一次语义**：通过barrier对齐机制保证精确一次语义
- **保存点（Savepoint）**：手动触发的checkpoint，用于版本升级和作业迁移

## 3.3. 时间语义

时间处理是流处理的核心，Flink提供了丰富的时间语义支持。

### 3.3.1. 时间类型

Flink支持三种时间概念：

- **Event Time**：事件发生的时间，通常嵌入在数据记录中
- **Processing Time**：数据被处理的时间，由处理机器决定
- **Ingestion Time**：数据进入Flink系统的时间

### 3.3.2. 水位线（Watermark）

水位线是处理乱序事件的关键机制：

- **乱序处理**：通过水位线容忍一定程度的乱序
- **延迟数据处理**：支持处理延迟到达的数据
- **自定义水位线**：支持自定义水位线生成策略

### 3.3.3. 窗口机制

Flink提供了灵活的窗口机制：

- **滚动窗口**：固定大小、不重叠的窗口
- **滑动窗口**：固定大小、可能重叠的窗口
- **会话窗口**：基于活动间隔的动态窗口
- **全局窗口**：将所有数据分配到单个窗口

## 3.4. 精确一次语义

精确一次语义（Exactly-Once Semantics）是流处理系统的重要特性，Flink在这方面提供了完整的支持。

### 3.4.1. Checkpoint机制

Flink通过分布式快照算法实现精确一次语义：

- **Chandy-Lamport算法**：基于barrier的分布式快照算法
- **异步快照**：在不阻塞处理的情况下进行快照
- **增量checkpoint**：只保存状态变化，减少checkpoint开销

### 3.4.2. 端到端精确一次

Flink支持端到端的精确一次语义：

- **两阶段提交**：通过TwoPhaseCommitSinkFunction实现
- **事务性输出**：支持Kafka、文件系统等的外部事务
- **幂等性写入**：支持幂等性写入的目标系统

## 3.5. 性能优势

Flink在性能方面具有显著优势：

### 3.5.1. 高吞吐低延迟

- **流水线执行**：数据在算子间直接传输，减少序列化开销
- **原生流处理**：专为流处理设计，避免微批处理的额外开销
- **内存管理**：自主内存管理，减少GC开销

### 3.5.2. 可扩展性

- **弹性扩缩容**：支持动态调整并行度
- **状态重分布**：支持状态在扩缩容时的重新分布
- **资源管理**：与YARN、Kubernetes等资源管理器集成

### 3.5.3. 容错性

- **快速恢复**：从checkpoint快速恢复，减少停机时间
- **局部恢复**：只恢复失败的任务，提高恢复效率
- **背压处理**：优雅处理数据速率不匹配问题

## 3.6. 生态系统集成

Flink拥有丰富的生态系统集成：

### 3.6.1. 数据源和数据接收器

- **消息系统**：Kafka、RabbitMQ、Kinesis等
- **文件系统**：HDFS、S3、Local File System等
- **数据库**：JDBC、Cassandra、Elasticsearch等

### 3.6.2. 部署模式

- **Standalone**：独立部署模式
- **YARN**：Hadoop资源管理器集成
- **Kubernetes**：容器化部署
- **Mesos**：Mesos资源管理器集成

### 3.6.3. 监控和管理

- **Metrics**：丰富的度量指标
- **REST API**：完善的REST接口
- **Web UI**：友好的Web管理界面
- **与监控系统集成**：Prometheus、Grafana等

Flink的这些技术优势使其成为构建实时数据平台的理想选择。在接下来的章节中，我们将详细探讨如何基于Flink构建完整的实时数据平台。

# 4. 平台架构设计

## 4.1. 总体架构

基于Flink的实时数据平台采用分层架构设计，确保系统的可扩展性、可靠性和易维护性。总体架构如下图所示：

```
+----------------+    +----------------+    +----------------+
|   数据源层     |    |   数据处理层    |    |   数据存储层    |
|                |    |                |    |                |
| +------------+ |    | +------------+ |    | +------------+ |
| |   Kafka    |----->| |   Flink    |----->| |  Elastic   | |
| +------------+ |    | |  作业集群   | |    | |  Search    | |
|                |    | +------------+ |    | +------------+ |
| +------------+ |    |                |    |                |
| |   MySQL    |----->| +------------+ |    | +------------+ |
| +------------+ |    | |   Flink    |----->| |   Kafka    | |
|                |    | |  作业集群   | |    | +------------+ |
| +------------+ |    | +------------+ |    |                |
| |  日志文件   |----->|                |    | +------------+ |
| +------------+ |    | +------------+ |    | |   HDFS     | |
|                |    | |   Flink    |----->| +------------+ |
| +------------+ |    | |  作业集群   | |    |                |
| |  HTTP API  |----->| +------------+ |    | +------------+ |
| +------------+ |    |                |    | |   MySQL    | |
+----------------+    +----------------+    | +------------+ |
                                           |                |
                                           | +------------+ |
                                           | |  Redis     | |
                                           | +------------+ |
                                           +----------------+

+----------------+    +----------------+    +----------------+
|   数据服务层    |    |   监控管理层    |    |   安全治理层    |
|                |    |                |    |                |
| +------------+ |    | +------------+ |    | +------------+ |
| | 查询引擎   | |    | | 监控系统   | |    | | 权限管理   | |
| +------------+ |    | +------------+ |    | +------------+ |
|                |    |                |    |                |
| +------------+ |    | +------------+ |    | +------------+ |
| | API网关    | |    | | 告警系统   | |    | | 审计日志   | |
| +------------+ |    | +------------+ |    | +------------+ |
|                |    |                |    |                |
| +------------+ |    | +------------+ |    | +------------+ |
| | 仪表盘     | |    | | 作业管理   | |    | | 数据加密   | |
| +------------+ |    | +------------+ |    | +------------+ |
+----------------+    +----------------+    +----------------+
```

### 4.1.1. 架构设计原则

在架构设计过程中，我们遵循以下原则：

1. **松耦合**：各层之间通过标准接口通信，降低系统复杂度
2. **高可用**：关键组件采用集群部署，避免单点故障
3. **可扩展**：支持水平扩展，应对数据量增长
4. **易维护**：提供完善的监控和管理工具
5. **安全性**：内置安全机制，保护数据隐私

### 4.1.2. 架构层次说明

1. **数据源层**：负责从各种数据源采集数据
2. **数据处理层**：基于Flink进行实时数据处理
3. **数据存储层**：存储处理后的数据，支持多种存储引擎
4. **数据服务层**：提供数据查询和访问服务
5. **监控管理层**：负责系统监控和作业管理
6. **安全治理层**：提供安全和数据治理功能

## 4.2. 数据采集层

数据采集层负责从各种数据源实时采集数据，并将其发送到消息中间件供后续处理。

### 4.2.1. 数据源类型

支持的数据源类型包括：

- **数据库变更**：MySQL binlog、Oracle redo log等
- **日志文件**：应用日志、系统日志、访问日志等
- **消息队列**：Kafka、RabbitMQ、RocketMQ等
- **API接口**：REST API、WebSocket、gRPC等
- **物联网设备**：传感器数据、设备状态等

### 4.2.2. 采集工具选择

常用的数据采集工具：

- **Debezium**：用于捕获数据库变更
- **Filebeat**：用于采集日志文件
- **Logstash**：用于数据解析和转换
- **Flink CDC**：基于Flink的变更数据捕获
- **自定义采集器**：针对特定需求开发的采集程序

### 4.2.3. 数据格式规范

制定统一的数据格式规范：

```json
{
  "metadata": {
    "source": "mysql.user_table",
    "timestamp": 1640995200000,
    "operation": "INSERT",
    "version": "1.0"
  },
  "before": null,
  "after": {
    "id": 1,
    "name": "张三",
    "age": 25,
    "create_time": "2022-01-01 00:00:00"
  }
}
```

## 4.3. 数据处理层

数据处理层是基于Flink的核心层，负责实时数据处理和计算。

### 4.3.1. Flink集群架构

Flink集群采用高可用架构：

```
+----------------+      +----------------+
|   JobManager   |<---->|   JobManager   |
|   (Active)     |      |   (Standby)    |
+----------------+      +----------------+
        |
        | (协调)
        |
+----------------+      +----------------+
|  TaskManager   |      |  TaskManager   |
|   (Worker)     |      |   (Worker)     |
+----------------+      +----------------+
```

### 4.3.2. 作业类型分类

根据处理逻辑的不同，将Flink作业分为以下几类：

1

2025-08-25 13:32:53,982 - evaluation_logger_Flights-41 - INFO - Complete Result: {'score': 0, 'reason': "The response does not address any of the requested information in the user's query about economy class air tickets, flight details, or baggage limits."}
2025-08-25 13:32:59,688 - evaluation_logger_Flights-41 - INFO - Correct Result: {'score': 0, 'reason': 'All information in the response is incorrect.'}
2025-08-25 13:32:59,688 - evaluation_logger_Flights-41 - INFO - Message: Success.
2025-08-25 13:32:59,688 - evaluation_logger_Flights-41 - INFO - Success turn num = 3
2025-08-25 13:32:59,688 - evaluation_logger_Flights-41 - INFO - ----------------------------------------------------------------------------------------------------
