2025-08-25 12:54:06,825 - evaluation_logger_Hotels-115 - INFO - Test Example Hotels-115
2025-08-25 12:54:06,825 - evaluation_logger_Hotels-115 - INFO - Query: I need to catch a flight that takes off from Toronto Pearson International Airport on November 25, 2024, tomorrow morning. I plan to stay at a hotel near the airport tonight. Recommend a hotel that's less than 10 kilometers from the airport, and check the details of the available rooms and the latest user reviews for this hotel.
2025-08-25 12:54:14,894 - evaluation_logger_Hotels-115 - INFO - Function Calls: 
[
    {
        "name": "Location_to_Lat_Long",
        "arguments": {
            "query": "Toronto Pearson International Airport"
        }
    }
]

2025-08-25 12:54:14,894 - evaluation_logger_Hotels-115 - INFO - Golden Function Call: 
[
    {
        "name": "Location_to_Lat_Long",
        "arguments": {
            "query": "Toronto Pearson International Airport"
        }
    },
    {
        "name": "Search_Hotels_By_Coordinates",
        "arguments": {
            "latitude": "43.6771413",
            "longitude": "-79.6333674",
            "arrival_date": "2024-11-24",
            "departure_date": "2024-11-25",
            "radius": 10
        }
    }
]

2025-08-25 12:54:14,894 - evaluation_logger_Hotels-115 - INFO - Start compare_single_call: 
{'name': 'Location_to_Lat_Long', 'arguments': {'query': 'Toronto Pearson International Airport'}}
{'name': 'Location_to_Lat_Long', 'arguments': {'query': 'Toronto Pearson International Airport'}}
2025-08-25 12:54:14,894 - evaluation_logger_Hotels-115 - INFO - Rule-based compare success.
2025-08-25 12:54:14,894 - evaluation_logger_Hotels-115 - INFO - Success matched: [{'name': 'Location_to_Lat_Long', 'arguments': {'query': 'Toronto Pearson International Airport'}}]
2025-08-25 12:54:14,895 - evaluation_logger_Hotels-115 - INFO - Observations:
[
    {
        "status": true,
        "message": "Success",
        "data": [
            {
                "business_status": "OPERATIONAL",
                "formatted_address": "6301 Silver Dart Dr, Mississauga, ON L5P 1B2, Canada",
                "geometry": {
                    "location": {
                        "lat": 43.6771413,
                        "lng": -79.6333674
                    },
                    "viewport": {
                        "northeast": {
                            "lat": 43.69779495,
                            "lng": -79.5866907
                        },
                        "southwest": {
                            "lat": 43.67025675,
                            "lng": -79.64892629999999
                        }
                    }
                },
                "name": "Toronto Pearson International Airport",
                "opening_hours": {
                    "open_now": true
                },
                "place_id": "ChIJkdQtwEo5K4gRxQ4DxOldHbQ",
                "plus_code": {
                    "compound_code": "M9G8+VM Mississauga, Ontario, Canada",
                    "global_code": "87M2M9G8+VM"
                },
                "rating": 3.7,
                "reference": "ChIJkdQtwEo5K4gRxQ4DxOldHbQ",
                "types": [
                    "airport",
                    "point_of_interest",
                    "establishment"
                ],
                "user_ratings_total": 39012
            }
        ]
    }
]

2025-08-25 12:54:26,636 - evaluation_logger_Hotels-115 - INFO - Function Calls: 
[
    {
        "name": "Search_Hotels_By_Coordinates",
        "arguments": {
            "latitude": "43.6771413",
            "longitude": "-79.6333674",
            "arrival_date": "2024-11-24",
            "departure_date": "2024-11-25",
            "radius": 10
        }
    }
]

2025-08-25 12:54:26,636 - evaluation_logger_Hotels-115 - INFO - Golden Function Call: 
[
    {
        "name": "Search_Hotels_By_Coordinates",
        "arguments": {
            "arrival_date": "2024-11-24",
            "departure_date": "2024-11-25",
            "latitude": "43.6771413",
            "longitude": "-79.6333674",
            "radius": 10
        }
    },
    {
        "name": "Get_Room_List_With_Availability",
        "arguments": {
            "hotel_id": "76178",
            "arrival_date": "2024-11-24",
            "departure_date": "2024-11-25"
        }
    },
    {
        "name": "Get_Hotel_Reviews(Tips)_Sort_Option",
        "arguments": {
            "hotel_id": "76178"
        }
    }
]

2025-08-25 12:54:26,636 - evaluation_logger_Hotels-115 - INFO - Start compare_single_call: 
{'name': 'Search_Hotels_By_Coordinates', 'arguments': {'arrival_date': '2024-11-24', 'departure_date': '2024-11-25', 'latitude': '43.6771413', 'longitude': '-79.6333674', 'radius': 10}}
{'name': 'Search_Hotels_By_Coordinates', 'arguments': {'arrival_date': '2024-11-24', 'departure_date': '2024-11-25', 'latitude': '43.6771413', 'longitude': '-79.6333674', 'radius': 10}}
2025-08-25 12:54:26,637 - evaluation_logger_Hotels-115 - INFO - Rule-based compare success.
2025-08-25 12:54:26,637 - evaluation_logger_Hotels-115 - INFO - Success matched: [{'name': 'Search_Hotels_By_Coordinates', 'arguments': {'arrival_date': '2024-11-24', 'departure_date': '2024-11-25', 'latitude': '43.6771413', 'longitude': '-79.6333674', 'radius': 10}}]
2025-08-25 12:54:26,637 - evaluation_logger_Hotels-115 - INFO - Observations:
[
    {
        "status": true,
        "message": "Success",
        "data": {
            "room_distribution": [
                {
                    "adults": "1"
                }
            ],
            "count": 1,
            "unfiltered_count": 245,
            "unfiltered_primary_count": 245,
            "result": [
                {
                    "hotel_id": 76178,
                    "default_language": "en",
                    "unit_configuration_label": "<b>Hotel room</b>: 1 bed",
                    "longitude": -79.6251069009304,
                    "countrycode": "ca",
                    "min_total_price": 123.214984291201,
                    "city": "Mississauga (Ontario)",
                    "type": "property_card",
                    "preferred": 1,
                    "preferred_plus": 0,
                    "review_score": 7.4,
                    "ribbon_text": "Breakfast included",
                    "review_nr": 5384,
                    "checkin": {
                        "from": "16:00"
                    },
                    "latitude": 43.6912598960358,
                    "is_free_cancellable": 1,
                    "main_photo_id": 403938270,
                    "id": "property_card_76178",
                    "class": 2,
                    "extended": 0,
                    "is_genius_deal": 0,
                    "hotel_has_vb_boost": 0,
                    "currencycode": "CAD",
                    "accommodation_type": 218,
                    "hotel_name_trans": "Quality Inn Toronto Airport",
                    "class_is_estimated": 0,
                    "review_score_word": "Good",
                    "last_reservation_data": {
                        "last_reservation_ellapsed_months": 1
                    },
                    "city_in_trans": "in Mississauga",
                    "ufi": -569427,
                    "bwallet": {
                        "hotel_eligibility": 0
                    },
                    "checkout": {
                        "until": "11:00"
                    },
                    "is_no_prepayment_block": 0,
                    "is_smart_deal": 0,
                    "block_ids": [
                        "7617807_0_1_1_0"
                    ],
                    "composite_price_breakdown": {
                        "items": [
                            {
                                "item_amount": {
                                    "currency": "USD",
                                    "amount_rounded": "US$18",
                                    "amount_unrounded": "US$17.62",
                                    "value": 17.62
                                },
                                "inclusion_type": "excluded",
                                "base": {
                                    "base_amount": 17.62,
                                    "kind": "per_stay"
                                },
                                "name": "Tax",
                                "kind": "charge"
                            }
                        ],
                        "included_taxes_and_charges_amount": {
                            "currency": "USD",
                            "amount_rounded": "US$0",
                            "amount_unrounded": "US$0",
                            "value": 0
                        },
                        "charges_details": {
                            "mode": "extra_charges",
                            "amount": {
                                "currency": "USD",
                                "value": 18
                            }
                        },
                        "client_translations": {
                            "tooltip_total_text": "Total"
                        },
                        "gross_amount": {
                            "amount_unrounded": "US$89.07",
                            "value": 89.07,
                            "currency": "USD",
                            "amount_rounded": "US$89"
                        },
                        "price_display_config": [
                            {
                                "key": "use_nightly_prices",
                                "value": 0
                            }
                        ],
                        "gross_amount_hotel_currency": {
                            "amount_rounded": "CAD 123",
                            "currency": "CAD",
                            "value": 123.214984291201,
                            "amount_unrounded": "CAD 123.21"
                        },
                        "all_inclusive_amount_hotel_currency": {
                            "value": 147.589611249896,
                            "amount_unrounded": "CAD 147.59",
                            "amount_rounded": "CAD 148",
                            "currency": "CAD"
                        },
                        "excluded_amount": {
                            "currency": "USD",
                            "amount_rounded": "US$18",
                            "amount_unrounded": "US$17.62",
                            "value": 17.62
                        },
                        "has_long_stays_monthly_rate_price": 0,
                        "net_amount": {
                            "amount_unrounded": "US$89.07",
                            "value": 89.07,
                            "currency": "USD",
                            "amount_rounded": "US$89"
                        },
                        "gross_amount_per_night": {
                            "currency": "USD",
                            "amount_rounded": "US$89",
                            "amount_unrounded": "US$89.07",
                            "value": 89.07
                        },
                        "all_inclusive_amount": {
                            "currency": "USD",
                            "amount_rounded": "US$107",
                            "amount_unrounded": "US$106.69",
                            "value": 106.69
                        },
                        "has_long_stays_weekly_rate_price": 0
                    },
                    "genius_discount_percentage": 0,
                    "soldout": 0,
                    "timezone": "America/Toronto",
                    "hotel_name": "Quality Inn Toronto Airport",
                    "default_wishlist_name": "Mississauga"
                }
            ],
            "page_loading_threshold": 10,
            "b_max_los_data": {
                "extended_los": 90,
                "max_allowed_los": 90,
                "has_extended_los": 1,
                "is_fullon": 0,
                "experiment": "long_stays_ios_extend_los_2",
                "default_los": 45
            },
            "primary_count": 1,
            "extended_count": 0
        }
    }
]

2025-08-25 12:54:38,696 - evaluation_logger_Hotels-115 - INFO - Function Calls: 
[
    {
        "name": "Get_Room_List_With_Availability",
        "arguments": {
            "hotel_id": "76178",
            "arrival_date": "2024-11-24",
            "departure_date": "2024-11-25"
        }
    },
    {
        "name": "Get_Hotel_Reviews(Tips)_Sort_Option",
        "arguments": {
            "hotel_id": "76178"
        }
    }
]

2025-08-25 12:54:38,696 - evaluation_logger_Hotels-115 - INFO - Golden Function Call: 
[
    {
        "name": "Get_Room_List_With_Availability",
        "arguments": {
            "arrival_date": "2024-11-24",
            "departure_date": "2024-11-25",
            "hotel_id": "76178"
        }
    },
    {
        "name": "Get_Hotel_Reviews(Tips)_Sort_Option",
        "arguments": {
            "hotel_id": "76178"
        }
    },
    {
        "name": "Get_Hotel_Reviews(Tips)",
        "arguments": {
            "hotel_id": "76178",
            "sort_option_id": "sort_recent_desc"
        }
    }
]

2025-08-25 12:54:38,697 - evaluation_logger_Hotels-115 - INFO - Start compare_single_call: 
{'name': 'Get_Room_List_With_Availability', 'arguments': {'arrival_date': '2024-11-24', 'departure_date': '2024-11-25', 'hotel_id': '76178'}}
{'name': 'Get_Room_List_With_Availability', 'arguments': {'arrival_date': '2024-11-24', 'departure_date': '2024-11-25', 'hotel_id': '76178'}}
2025-08-25 12:54:38,697 - evaluation_logger_Hotels-115 - INFO - Rule-based compare success.
2025-08-25 12:54:38,697 - evaluation_logger_Hotels-115 - INFO - Start compare_single_call: 
{'name': 'Get_Hotel_Reviews(Tips)_Sort_Option', 'arguments': {'hotel_id': '76178'}}
{'name': 'Get_Hotel_Reviews(Tips)_Sort_Option', 'arguments': {'hotel_id': '76178'}}
2025-08-25 12:54:38,697 - evaluation_logger_Hotels-115 - INFO - Rule-based compare success.
2025-08-25 12:54:38,697 - evaluation_logger_Hotels-115 - INFO - Success matched: [{'name': 'Get_Room_List_With_Availability', 'arguments': {'arrival_date': '2024-11-24', 'departure_date': '2024-11-25', 'hotel_id': '76178'}}, {'name': 'Get_Hotel_Reviews(Tips)_Sort_Option', 'arguments': {'hotel_id': '76178'}}]
2025-08-25 12:54:38,698 - evaluation_logger_Hotels-115 - INFO - Observations:
[
    {
        "status": true,
        "available": [
            {
                "availableText": "Only 5 rooms left on Booking.com",
                "available": 5,
                "nr_one_free_date_change": {
                    "policy_long": "However, you can reschedule your stay once until 21 November 2024 for the same or higher price. You’ll only be charged if there’s a price difference between your new and old dates.",
                    "date_change_until": "21 November 2024",
                    "policy_short": "Flexible to reschedule if plans change"
                },
                "block_id": "7617808_94290002_2_1_0",
                "mealplan": "Breakfast included in the price",
                "room_surface_in_m2": 19,
                "full_board": 0,
                "is_last_minute_deal": 0,
                "pay_in_advance": 1,
                "babycots_available": 0,
                "number_of_bathrooms": 0,
                "is_mobile_deal": 0,
                "is_dormitory": 0,
                "policy_display_details": {
                    "reschedule": {
                        "title_details": {
                            "translation": "Flexible to reschedule if plans change",
                            "tag": "tpex_rm_nr_flex_to_reschedule",
                            "placeholder_translation": "Flexible to reschedule if plans change"
                        }
                    },
                    "applied_products": [
                        "pay_in_follows_policy"
                    ],
                    "prepayment": {
                        "type": "full_prepayment",
                        "policy_type_key": "pbb_at_booking_time",
                        "title_details": {
                            "placeholder_translation": "Pay online",
                            "translation": "Pay online",
                            "tag": "payment_pay_online_name"
                        },
                        "description_details": {
                            "translation": "The total price of the reservation is charged at the time of booking.",
                            "placeholder_translation": "The total price of the reservation is charged at the time of booking."
                        }
                    },
                    "cancellation": {
                        "type": "non_refundable",
                        "is_cost_to_cancel": 0,
                        "policy_type_key": "non_refundable",
                        "description_details": {
                            "placeholder_translation": "If you cancel, modify the booking, or don't show up, the fee will be the total price of the reservation. However, you can reschedule your stay once until 21 November 2024 for the same or higher price. You’ll only be charged if there’s a price difference between your new and old dates.",
                            "translation": "If you cancel, modify the booking, or don't show up, the fee will be the total price of the reservation. However, you can reschedule your stay once until 21 November 2024 for the same or higher price. You’ll only be charged if there’s a price difference between your new and old dates."
                        },
                        "title_details": {
                            "placeholder_translation": "Non-refundable",
                            "tag": "cxl_nr_name",
                            "translation": "Non-refundable"
                        },
                        "parameters": {
                            "has_cancellation_fee": 1
                        }
                    }
                },
                "deals": {
                    "deal_attributes": {
                        "has_secret_channel_option": 0
                    }
                },
                "is_vp2_enrolled": 1,
                "smoking": 0,
                "is_flash_deal": 0,
                "room_count": 5,
                "nr_adults": 2,
                "half_board": 0,
                "name": "Queen Room with Sofa Bed - Non-Smoking - Non-refundable",
                "deposit_required": 1,
                "all_inclusive": 0,
                "room_name": "Queen Room with Sofa Bed - Non-Smoking",
                "paymentterms": {
                    "prepayment": {
                        "info": {
                            "refundable": 0,
                            "prepayment_at_booktime": 0
                        },
                        "extended_type_translation": "SECURE YOUR BOOKING - pay now",
                        "type_extended": "non_refundable_prepayment",
                        "type": "full_prepayment",
                        "type_translation": "SECURE YOUR BOOKING - pay now",
                        "simple_translation": "Prepayment",
                        "description": "You will be charged a prepayment of the total price at any time."
                    },
                    "cancellation": {
                        "non_refundable_anymore": 0,
                        "type_translation": "Non-refundable",
                        "description": "Please note, if cancelled, modified or in case of no-show, the total price of the reservation will be charged.",
                        "bucket": "SMP_NON_REF",
                        "info": {
                            "refundable": 0
                        },
                        "type": "non_refundable",
                        "guaranteed_non_refundable": 0
                    }
                },
                "room_id": 7617808,
                "refundable": 0,
                "transactional_policy_data": {
                    "booking_conditions": [
                        {
                            "text": "Prepayment",
                            "icon": "credit_card",
                            "description": "The total price of the reservation is charged at the time of booking.",
                            "type": "prepayment",
                            "policy_type_key": "pbb_at_booking_time",
                            "key": "VP2PayInAdvanceKey"
                        },
                        {
                            "description": "If you cancel, modify the booking, or don't show up, the fee will be the total price of the reservation. However, you can reschedule your stay once until 21 November 2024 for the same or higher price. You’ll only be charged if there’s a price difference between your new and old dates.",
                            "icon": "stop",
                            "text": "Non-refundable",
                            "key": "NonRefundableKey",
                            "policy_type_key": "non_refundable",
                            "type": "cancellation"
                        }
                    ],
                    "applied_products": [
                        "pay_in_follows_policy"
                    ],
                    "policies": [
                        {
                            "key": "NrOneFreeDateChangeKey",
                            "policy_type_key": "flexible_to_reschedule",
                            "type": "reschedule",
                            "icon": "checkmark",
                            "text": "Flexible to reschedule if plans change"
                        },
                        {
                            "text": "Non-refundable",
                            "description": "If you cancel, modify the booking, or don't show up, the fee will be the total price of the reservation. However, you can reschedule your stay once until 21 November 2024 for the same or higher price. You’ll only be charged if there’s a price difference between your new and old dates.",
                            "type": "cancellation",
                            "policy_type_key": "non_refundable",
                            "key": "NonRefundableKey"
                        },
                        {
                            "description": "The total price of the reservation is charged at the time of booking.",
                            "icon": "credit_card_back",
                            "text": "Pay online",
                            "key": "VP2PayInAdvanceKey",
                            "policy_type_key": "pbb_at_booking_time",
                            "type": "prepayment"
                        }
                    ]
                },
                "must_reserve_free_parking": 0,
                "block_text": {
                    "policies": [
                        {
                            "class": "POLICY_CANCELLATION",
                            "content": "If you cancel, modify the booking, or don't show up, the fee will be the total price of the reservation."
                        },
                        {
                            "class": "POLICY_PREPAY",
                            "content": "The total price of the reservation is charged at the time of booking."
                        },
                        {
                            "mealplan_vector": "1",
                            "content": "Breakfast included in the price",
                            "class": "POLICY_HOTEL_MEALPLAN"
                        },
                        {
                            "content": "Non Refundable",
                            "class": "POLICY_TITLE"
                        },
                        {
                            "content": " You won't be eligible for a refund if you cancel this booking.",
                            "class": "POLICY_REFUND_SCHEDULE"
                        }
                    ]
                },
                "room_surface_in_feet2": 204.5142976,
                "name_without_policy": "Queen Room with Sofa Bed - Non-Smoking",
                "max_occupancy": 2,
                "nr_children": 0,
                "transactional_policy_objects": [
                    {
                        "text": "Flexible to reschedule if plans change",
                        "icon": "checkmark",
                        "key": "NrOneFreeDateChangeKey"
                    },
                    {
                        "key": "NonRefundableKey",
                        "text": "Non-refundable"
                    },
                    {
                        "key": "VP2PayInAdvanceKey",
                        "text": "Pay online",
                        "icon": "credit_card_back"
                    }
                ],
                "is_smart_deal": 0,
                "number_of_bedrooms": 0,
                "max_children_free": 2,
                "genius_discount_percentage": 0,
                "breakfast_included": 1,
                "extrabed_available": 0,
                "pod_ios_migrate_policies_to_smp_fullon": 0,
                "is_block_fit": 1,
                "roomtype_id": 9,
                "max_children_free_age": 17,
                "is_secret_deal": 0,
                "can_reserve_free_parking": 0,
                "package_id": 0,
                "product_price_breakdown": {
                    "has_long_stays_monthly_rate_price": 0,
                    "gross_amount": {
                        "currency": "USD",
                        "amount_rounded": "US$101",
                        "value": 100.712039784647,
                        "amount_unrounded": "US$100.71"
                    },
                    "included_taxes_and_charges_amount": {
                        "amount_rounded": "US$0",
                        "currency": "USD",
                        "amount_unrounded": "US$0",
                        "value": 0
                    },
                    "client_translations": {
                        "tooltip_total_text": "Total"
                    },
                    "items": [
                        {
                            "kind": "charge",
                            "details": "13 % Tax",
                            "name": "Tax",
                            "inclusion_type": "excluded",
                            "item_amount": {
                                "currency": "USD",
                                "amount_rounded": "US$13",
                                "amount_unrounded": "US$13.09",
                                "value": 13.0925651720041
                            },
                            "base": {
                                "percentage": 13,
                                "kind": "percentage"
                            }
                        },
                        {
                            "name": "City tax",
                            "details": "6.78 % City tax",
                            "kind": "charge",
                            "inclusion_type": "excluded",
                            "base": {
                                "percentage": 6.78,
                                "kind": "percentage"
                            },
                            "item_amount": {
                                "currency": "USD",
                                "amount_rounded": "US$8",
                                "value": 7.71595221606091,
                                "amount_unrounded": "US$7.72"
                            }
                        }
                    ],
                    "net_amount": {
                        "currency": "USD",
                        "amount_rounded": "US$101",
                        "amount_unrounded": "US$100.71",
                        "value": 100.712039784647
                    },
                    "excluded_amount": {
                        "value": 20.808517388065,
                        "amount_unrounded": "US$20.81",
                        "amount_rounded": "US$21",
                        "currency": "USD"
                    },
                    "all_inclusive_amount": {
                        "value": 121.520557172712,
                        "amount_unrounded": "US$121.52",
                        "currency": "USD",
                        "amount_rounded": "US$122"
                    },
                    "has_long_stays_weekly_rate_price": 0,
                    "all_inclusive_amount_hotel_currency": {
                        "value": 168.10546248,
                        "amount_unrounded": "CAD 168.11",
                        "amount_rounded": "CAD 168",
                        "currency": "CAD"
                    },
                    "charges_details": {
                        "amount": {
                            "currency": "USD",
                            "value": 21
                        },
                        "mode": "extra_charges"
                    },
                    "nr_stays": 5,
                    "gross_amount_hotel_currency": {
                        "currency": "CAD",
                        "amount_rounded": "CAD 139",
                        "amount_unrounded": "CAD 139.32",
                        "value": 139.32
                    },
                    "gross_amount_per_night": {
                        "amount_rounded": "US$101",
                        "currency": "USD",
                        "amount_unrounded": "US$100.71",
                        "value": 100.712039784647
                    },
                    "price_display_config": [
                        {
                            "key": "use_nightly_prices",
                            "value": 0
                        }
                    ]
                },
                "is_domestic_rate": 0
            },
            {
                "availableText": "Only 5 rooms left on Booking.com",
                "available": 5,
                "nr_one_free_date_change": {
                    "policy_long": "However, you can reschedule your stay once until 21 November 2024 for the same or higher price. You’ll only be charged if there’s a price difference between your new and old dates.",
                    "date_change_until": "21 November 2024",
                    "policy_short": "Flexible to reschedule if plans change"
                },
                "block_id": "7617808_94290002_3_1_0",
                "mealplan": "Breakfast included in the price",
                "number_of_bathrooms": 0,
                "is_mobile_deal": 0,
                "full_board": 0,
                "room_surface_in_m2": 19,
                "is_last_minute_deal": 0,
                "pay_in_advance": 1,
                "babycots_available": 0,
                "is_flash_deal": 0,
                "room_count": 5,
                "nr_adults": 3,
                "is_dormitory": 0,
                "policy_display_details": {
                    "reschedule": {
                        "title_details": {
                            "placeholder_translation": "Flexible to reschedule if plans change",
                            "translation": "Flexible to reschedule if plans change",
                            "tag": "tpex_rm_nr_flex_to_reschedule"
                        }
                    },
                    "cancellation": {
                        "title_details": {
                            "tag": "cxl_nr_name",
                            "translation": "Non-refundable",
                            "placeholder_translation": "Non-refundable"
                        },
                        "parameters": {
                            "has_cancellation_fee": 1
                        },
                        "type": "non_refundable",
                        "is_cost_to_cancel": 0,
                        "policy_type_key": "non_refundable",
                        "description_details": {
                            "placeholder_translation": "If you cancel, modify the booking, or don't show up, the fee will be the total price of the reservation. However, you can reschedule your stay once until 21 November 2024 for the same or higher price. You’ll only be charged if there’s a price difference between your new and old dates.",
                            "translation": "If you cancel, modify the booking, or don't show up, the fee will be the total price of the reservation. However, you can reschedule your stay once until 21 November 2024 for the same or higher price. You’ll only be charged if there’s a price difference between your new and old dates."
                        }
                    },
                    "applied_products": [
                        "pay_in_follows_policy"
                    ],
                    "prepayment": {
                        "title_details": {
                            "placeholder_translation": "Pay online",
                            "tag": "payment_pay_online_name",
                            "translation": "Pay online"
                        },
                        "description_details": {
                            "placeholder_translation": "The total price of the reservation is charged at the time of booking.",
                            "translation": "The total price of the reservation is charged at the time of booking."
                        },
                        "type": "full_prepayment",
                        "policy_type_key": "pbb_at_booking_time"
                    }
                },
                "is_vp2_enrolled": 1,
                "deals": {
                    "deal_attributes": {
                        "has_secret_channel_option": 0
                    }
                },
                "smoking": 0,
                "all_inclusive": 0,
                "half_board": 0,
                "name": "Queen Room with Sofa Bed - Non-Smoking - Non-refundable",
                "deposit_required": 1,
                "refundable": 0,
                "transactional_policy_data": {
                    "booking_conditions": [
                        {
                            "policy_type_key": "pbb_at_booking_time",
                            "type": "prepayment",
                            "key": "VP2PayInAdvanceKey",
                            "icon": "credit_card",
                            "text": "Prepayment",
                            "description": "The total price of the reservation is charged at the time of booking."
                        },
                        {
                            "type": "cancellation",
                            "policy_type_key": "non_refundable",
                            "key": "NonRefundableKey",
                            "text": "Non-refundable",
                            "icon": "stop",
                            "description": "If you cancel, modify the booking, or don't show up, the fee will be the total price of the reservation. However, you can reschedule your stay once until 21 November 2024 for the same or higher price. You’ll only be charged if there’s a price difference between your new and old dates."
                        }
                    ],
                    "policies": [
                        {
                            "type": "reschedule",
                            "policy_type_key": "flexible_to_reschedule",
                            "key": "NrOneFreeDateChangeKey",
                            "text": "Flexible to reschedule if plans change",
                            "icon": "checkmark"
                        },
                        {
                            "text": "Non-refundable",
                            "description": "If you cancel, modify the booking, or don't show up, the fee will be the total price of the reservation. However, you can reschedule your stay once until 21 November 2024 for the same or higher price. You’ll only be charged if there’s a price difference between your new and old dates.",
                            "policy_type_key": "non_refundable",
                            "type": "cancellation",
                            "key": "NonRefundableKey"
                        },
                        {
                            "icon": "credit_card_back",
                            "text": "Pay online",
                            "description": "The total price of the reservation is charged at the time of booking.",
                            "policy_type_key": "pbb_at_booking_time",
                            "type": "prepayment",
                            "key": "VP2PayInAdvanceKey"
                        }
                    ],
                    "applied_products": [
                        "pay_in_follows_policy"
                    ]
                },
                "room_name": "Queen Room with Sofa Bed - Non-Smoking",
                "room_id": 7617808,
                "paymentterms": {
                    "cancellation": {
                        "info": {
                            "refundable": 0
                        },
                        "guaranteed_non_refundable": 0,
                        "type": "non_refundable",
                        "bucket": "SMP_NON_REF",
                        "description": "Please note, if cancelled, modified or in case of no-show, the total price of the reservation will be charged.",
                        "non_refundable_anymore": 0,
                        "type_translation": "Non-refundable"
                    },
                    "prepayment": {
                        "description": "You will be charged a prepayment of the total price at any time.",
                        "type_extended": "non_refundable_prepayment",
                        "simple_translation": "Prepayment",
                        "type_translation": "SECURE YOUR BOOKING - pay now",
                        "extended_type_translation": "SECURE YOUR BOOKING - pay now",
                        "info": {
                            "prepayment_at_booktime": 0,
                            "refundable": 0
                        },
                        "type": "full_prepayment"
                    }
                },
                "max_occupancy": 3,
                "nr_children": 0,
                "transactional_policy_objects": [
                    {
                        "text": "Flexible to reschedule if plans change",
                        "icon": "checkmark",
                        "key": "NrOneFreeDateChangeKey"
                    },
                    {
                        "text": "Non-refundable",
                        "key": "NonRefundableKey"
                    },
                    {
                        "text": "Pay online",
                        "icon": "credit_card_back",
                        "key": "VP2PayInAdvanceKey"
                    }
                ],
                "is_smart_deal": 0,
                "number_of_bedrooms": 0,
                "must_reserve_free_parking": 0,
                "block_text": {
                    "policies": [
                        {
                            "class": "POLICY_CANCELLATION",
                            "content": "If you cancel, modify the booking, or don't show up, the fee will be the total price of the reservation."
                        },
                        {
                            "class": "POLICY_PREPAY",
                            "content": "The total price of the reservation is charged at the time of booking."
                        },
                        {
                            "mealplan_vector": "1",
                            "class": "POLICY_HOTEL_MEALPLAN",
                            "content": "Breakfast included in the price"
                        },
                        {
                            "class": "POLICY_TITLE",
                            "content": "Non Refundable"
                        },
                        {
                            "content": " You won't be eligible for a refund if you cancel this booking.",
                            "class": "POLICY_REFUND_SCHEDULE"
                        }
                    ]
                },
                "room_surface_in_feet2": 204.5142976,
                "name_without_policy": "Queen Room with Sofa Bed - Non-Smoking",
                "breakfast_included": 1,
                "extrabed_available": 0,
                "is_block_fit": 1,
                "pod_ios_migrate_policies_to_smp_fullon": 0,
                "roomtype_id": 9,
                "max_children_free": 2,
                "genius_discount_percentage": 0,
                "package_id": 0,
                "product_price_breakdown": {
                    "all_inclusive_amount_hotel_currency": {
                        "value": 180.17160248,
                        "amount_unrounded": "CAD 180.17",
                        "currency": "CAD",
                        "amount_rounded": "CAD 180"
                    },
                    "excluded_amount": {
                        "currency": "USD",
                        "amount_rounded": "US$22",
                        "amount_unrounded": "US$22.30",
                        "value": 22.302094576413
                    },
                    "has_long_stays_weekly_rate_price": 0,
                    "all_inclusive_amount": {
                        "amount_unrounded": "US$130.24",
                        "value": 130.24296294164,
                        "amount_rounded": "US$130",
                        "currency": "USD"
                    },
                    "nr_stays": 5,
                    "price_display_config": [
                        {
                            "key": "use_nightly_prices",
                            "value": 0
                        }
                    ],
                    "gross_amount_per_night": {
                        "currency": "USD",
                        "amount_rounded": "US$108",
                        "value": 107.940868365227,
                        "amount_unrounded": "US$107.94"
                    },
                    "gross_amount_hotel_currency": {
                        "amount_rounded": "CAD 149",
                        "currency": "CAD",
                        "amount_unrounded": "CAD 149.32",
                        "value": 149.32
                    },
                    "charges_details": {
                        "mode": "extra_charges",
                        "amount": {
                            "value": 22,
                            "currency": "USD"
                        }
                    },
                    "included_taxes_and_charges_amount": {
                        "currency": "USD",
                        "amount_rounded": "US$0",
                        "value": 0,
                        "amount_unrounded": "US$0"
                    },
                    "gross_amount": {
                        "amount_rounded": "US$108",
                        "currency": "USD",
                        "value": 107.940868365227,
                        "amount_unrounded": "US$107.94"
                    },
                    "has_long_stays_monthly_rate_price": 0,
                    "items": [
                        {
                            "item_amount": {
                                "currency": "USD",
                                "amount_rounded": "US$14",
                                "amount_unrounded": "US$14.03",
                                "value": 14.0323128874795
                            },
                            "base": {
                                "kind": "percentage",
                                "percentage": 13
                            },
                            "inclusion_type": "excluded",
                            "name": "Tax",
                            "details": "13 % Tax",
                            "kind": "charge"
                        },
                        {
                            "inclusion_type": "excluded",
                            "name": "City tax",
                            "details": "6.78 % City tax",
                            "kind": "charge",
                            "base": {
                                "percentage": 6.78,
                                "kind": "percentage"
                            },
                            "item_amount": {
                                "value": 8.2697816889335,
                                "amount_unrounded": "US$8.27",
                                "currency": "USD",
                                "amount_rounded": "US$8"
                            }
                        }
                    ],
                    "net_amount": {
                        "currency": "USD",
                        "amount_rounded": "US$108",
                        "value": 107.940868365227,
                        "amount_unrounded": "US$107.94"
                    },
                    "client_translations": {
                        "tooltip_total_text": "Total"
                    }
                },
                "is_domestic_rate": 0,
                "max_children_free_age": 17,
                "is_secret_deal": 0,
                "can_reserve_free_parking": 0
            },
            {
                "availableText": "Only 5 rooms left on Booking.com",
                "available": 5,
                "name_without_policy": "Queen Room with Sofa Bed - Non-Smoking",
                "room_surface_in_feet2": 204.5142976,
                "block_text": {
                    "policies": [
                        {
                            "class": "POLICY_CANCELLATION",
                            "content": "You may cancel free of charge until 16:00 on the day of arrival. If you cancel after 16:00 on the day of arrival, the cancellation fee will be the total price of the reservation. If you don't show up, the no-show fee will be the same as the cancellation fee."
                        },
                        {
                            "content": "No prepayment is needed.",
                            "class": "POLICY_PREPAY"
                        },
                        {
                            "mealplan_vector": "1",
                            "content": "Breakfast included in the price",
                            "class": "POLICY_HOTEL_MEALPLAN"
                        },
                        {
                            "class": "POLICY_TITLE"
                        }
                    ]
                },
                "must_reserve_free_parking": 0,
                "number_of_bedrooms": 0,
                "is_smart_deal": 0,
                "transactional_policy_objects": [
                    {
                        "parameters": [
                            {
                                "key": "date",
                                "type": "datetime",
                                "value": "2024-11-24T16:00:00-05:00",
                                "format": "dMMMy"
                            },
                            {
                                "key": "time",
                                "format": "jmm",
                                "type": "datetime",
                                "value": "2024-11-24T16:00:00-05:00"
                            },
                            {
                                "type": "timezone",
                                "value": "America/Toronto",
                                "key": "timezone"
                            }
                        ],
                        "key": "FreeCancellationKey",
                        "icon": "checkmark_fill",
                        "text": "<b>Free cancellation</b> before {time} on {date}"
                    },
                    {
                        "key": "NoPrepaymentConstructiveKey",
                        "icon": "checkmark_fill",
                        "text": "<b>No prepayment needed</b> – pay at the property"
                    }
                ],
                "nr_children": 0,
                "max_occupancy": 2,
                "room_id": 7617808,
                "paymentterms": {
                    "cancellation": {
                        "info": {
                            "refundable": 1,
                            "time": "16:00",
                            "date_raw": "2024-11-24 16:00:00",
                            "date": "24 November 2024",
                            "refundable_date": "2024-11-24T16:00:00-05:00",
                            "date_before_raw": "2024-11-23",
                            "date_before": "23 November 2024",
                            "timezone": "EST",
                            "timezone_offset": "-18000"
                        },
                        "guaranteed_non_refundable": 0,
                        "timeline": {
                            "currency_code": "CAD",
                            "nr_stages": 2,
                            "policygroup_instance_id": "163/152/-",
                            "u_currency_code": "USD",
                            "stages": [
                                {
                                    "u_fee_pretty": "US$ 0",
                                    "fee_remaining_pretty": "CAD 163",
                                    "limit_from_date": "22 October 2024",
                                    "u_fee_remaining": "118.48",
                                    "b_number": 0,
                                    "limit_until_date": "24 November 2024",
                                    "limit_from": "22 October 2024 06:10",
                                    "u_fee_remaining_pretty": "US$ 118",
                                    "effective_number": 0,
                                    "u_stage_fee_pretty": "US$ 0",
                                    "is_effective": 1,
                                    "fee_pretty": "CAD 0",
                                    "limit_from_raw": "2024-10-22 06:10:39",
                                    "limit_timezone": "Mississauga",
                                    "fee_remaining": 163.9,
                                    "u_fee": "0.00",
                                    "limit_until_raw": "2024-11-24 15:59:59",
                                    "b_state": "FREE",
                                    "text_refundable": "You'll get a full refund if you cancel before 15:59 on 24 November 2024.",
                                    "limit_until_time": "15:59",
                                    "stage_translation": "Free to cancel",
                                    "limit_until": "24 November 2024 15:59",
                                    "u_stage_fee": "0.00",
                                    "current_stage": 1,
                                    "stage_fee_pretty": "CAD 0",
                                    "date_until": "2024-11-24 15:59:59 -0500",
                                    "is_free": 1,
                                    "fee_rounded": 0,
                                    "fee": 0,
                                    "stage_fee": 0,
                                    "limit_from_time": "06:10",
                                    "text": "Free cancellation until 15:59 on 24 Nov"
                                },
                                {
                                    "u_fee": "118.48",
                                    "limit_timezone": "Mississauga",
                                    "fee_remaining": 0,
                                    "fee_pretty": "CAD 163",
                                    "limit_from_raw": "2024-11-24 16:00:00",
                                    "is_effective": 1,
                                    "u_stage_fee_pretty": "US$ 118",
                                    "amount": 118.48,
                                    "date_from": "2024-11-24 16:00:00 -0500",
                                    "effective_number": 1,
                                    "limit_until_raw": "2024-11-24 16:00:00",
                                    "b_number": 1,
                                    "u_fee_remaining": "0.00",
                                    "limit_from_date": "24 November 2024",
                                    "fee_remaining_pretty": "CAD 0",
                                    "u_fee_pretty": "US$ 118",
                                    "u_fee_remaining_pretty": "US$ 0",
                                    "limit_until_date": "24 November 2024",
                                    "limit_from": "24 November 2024 16:00",
                                    "is_free": 0,
                                    "stage_fee_pretty": "CAD 164",
                                    "text": "From 16:00 on 24 Nov",
                                    "limit_from_time": "16:00",
                                    "stage_fee": 163.9,
                                    "amount_pretty": "US$ 118",
                                    "fee": 163.9,
                                    "fee_rounded": 164,
                                    "limit_until": "24 November 2024 16:00",
                                    "stage_translation": "No refund if you cancel",
                                    "limit_until_time": "16:00",
                                    "text_refundable": "If you cancel from 16:00 on 24 November 2024, you will no longer be eligible for a refund.",
                                    "b_state": "NONREF",
                                    "u_stage_fee": "118.48",
                                    "current_stage": 0
                                }
                            ]
                        },
                        "type": "free_cancellation",
                        "non_refundable_anymore": 0,
                        "type_translation": "Free cancellation",
                        "bucket": "SMP_FULLY_FLEX",
                        "description": "You may cancel free of charge until 16:00 on the day of arrival. You will be charged the total price of the reservation if you cancel after 16:00 on the day of arrival. If you don't show up, the no-show fee will be the same as the cancellation fee."
                    },
                    "prepayment": {
                        "simple_translation": "No prepayment",
                        "type_translation": "No payment needed today",
                        "type_extended": "non_refundable_prepayment",
                        "description": "You'll pay during your stay.",
                        "type": "no_prepayment",
                        "timeline": {
                            "currency_code": "CAD",
                            "nr_stages": 2,
                            "policygroup_instance_id": "163/152/-",
                            "u_currency_code": "USD",
                            "stages": [
                                {
                                    "amount": "0.00",
                                    "effective_number": 0,
                                    "fee_remaining": 163.9,
                                    "u_fee": "0.00",
                                    "limit_timezone": "Mississauga",
                                    "limit_from_raw": "2024-10-22 06:10:39",
                                    "fee_pretty": "CAD 0",
                                    "is_effective": 1,
                                    "u_stage_fee_pretty": "US$ 0",
                                    "limit_until_raw": "2024-11-24 23:59:59",
                                    "fee_remaining_pretty": "CAD 163",
                                    "limit_from_date": "22 October 2024",
                                    "u_fee_pretty": "US$ 0",
                                    "b_number": 0,
                                    "u_fee_remaining": "118.48",
                                    "u_fee_remaining_pretty": "US$ 118",
                                    "limit_from": "22 October 2024 06:10",
                                    "limit_until_date": "24 November 2024",
                                    "is_free": 1,
                                    "stage_fee_pretty": "CAD 0",
                                    "amount_pretty": "US$ 0",
                                    "limit_from_time": "06:10",
                                    "stage_fee": 0,
                                    "fee": 0,
                                    "fee_rounded": 0,
                                    "text": "Before you stay you'll pay",
                                    "limit_until_time": "23:59",
                                    "b_state": "FREE",
                                    "limit_until": "24 November 2024 23:59",
                                    "u_stage_fee": "0.00",
                                    "current_stage": 1
                                },
                                {
                                    "amount_pretty": "US$ 118",
                                    "amount": "118.48",
                                    "after_checkin": 1,
                                    "is_free": 0,
                                    "text": "At the property you'll pay"
                                }
                            ]
                        },
                        "extended_type_translation": "No payment needed today",
                        "info": {
                            "prepayment_at_booktime": 0,
                            "refundable": "anytime"
                        }
                    }
                },
                "room_name": "Queen Room with Sofa Bed - Non-Smoking",
                "transactional_policy_data": {
                    "booking_conditions": [
                        {
                            "policy_type_key": "patp_without_prepayment",
                            "type": "prepayment",
                            "key": "NoPrepaymentKey",
                            "icon": "credit_card",
                            "text": "Prepayment",
                            "description": "No prepayment is needed."
                        },
                        {
                            "key": "FreeCancellationKey",
                            "footer": "(Cancellation deadlines are in the property's timezone – {timezone})",
                            "policy_type_key": "super_flex",
                            "type": "cancellation",
                            "parameters": [
                                {
                                    "key": "date",
                                    "format": "dMMMy",
                                    "type": "datetime",
                                    "value": "2024-11-24T16:00:00-05:00"
                                },
                                {
                                    "key": "time",
                                    "format": "jmm",
                                    "type": "datetime",
                                    "value": "2024-11-24T16:00:00-05:00"
                                },
                                {
                                    "value": "America/Toronto",
                                    "type": "timezone",
                                    "key": "timezone"
                                }
                            ],
                            "description": "You may cancel free of charge until 16:00 on the day of arrival. If you cancel after 16:00 on the day of arrival, the cancellation fee will be the total price of the reservation. If you don't show up, the no-show fee will be the same as the cancellation fee.",
                            "icon": "checkmark_fill",
                            "text": "<b>Free cancellation</b> before {time} on {date}"
                        }
                    ],
                    "policies": [
                        {
                            "description": "You may cancel free of charge until 16:00 on the day of arrival. If you cancel after 16:00 on the day of arrival, the cancellation fee will be the total price of the reservation. If you don't show up, the no-show fee will be the same as the cancellation fee.",
                            "parameters": [
                                {
                                    "type": "datetime",
                                    "value": "2024-11-24T16:00:00-05:00",
                                    "format": "dMMMy",
                                    "key": "date"
                                },
                                {
                                    "type": "datetime",
                                    "value": "2024-11-24T16:00:00-05:00",
                                    "format": "jmm",
                                    "key": "time"
                                },
                                {
                                    "value": "America/Toronto",
                                    "type": "timezone",
                                    "key": "timezone"
                                }
                            ],
                            "text": "<b>Free cancellation</b> before {time} on {date}",
                            "icon": "checkmark_fill",
                            "footer": "(Cancellation deadlines are in the property's timezone – {timezone})",
                            "key": "FreeCancellationKey",
                            "type": "cancellation",
                            "policy_type_key": "super_flex"
                        },
                        {
                            "description": "No prepayment is needed.",
                            "text": "<b>No prepayment needed</b> – pay at the property",
                            "icon": "checkmark_fill",
                            "key": "NoPrepaymentConstructiveKey",
                            "type": "prepayment",
                            "policy_type_key": "patp_without_prepayment"
                        }
                    ],
                    "applied_products": [
                        "pay_in_follows_policy"
                    ]
                },
                "refundable": 1,
                "can_reserve_free_parking": 0,
                "is_secret_deal": 0,
                "max_children_free_age": 17,
                "is_domestic_rate": 0,
                "product_price_breakdown": {
                    "net_amount": {
                        "currency": "USD",
                        "amount_rounded": "US$118",
                        "amount_unrounded": "US$118.48",
                        "value": 118.480500435713
                    },
                    "items": [
                        {
                            "base": {
                                "percentage": 13,
                                "kind": "percentage"
                            },
                            "item_amount": {
                                "amount_unrounded": "US$15.40",
                                "value": 15.4024650566427,
                                "currency": "USD",
                                "amount_rounded": "US$15"
                            },
                            "inclusion_type": "excluded",
                            "details": "13 % Tax",
                            "name": "Tax",
                            "kind": "charge"
                        },
                        {
                            "kind": "charge",
                            "name": "City tax",
                            "details": "6.78 % City tax",
                            "inclusion_type": "excluded",
                            "item_amount": {
                                "amount_rounded": "US$9",
                                "currency": "USD",
                                "amount_unrounded": "US$9.08",
                                "value": 9.07726506038173
                            },
                            "base": {
                                "kind": "percentage",
                                "percentage": 6.78
                            }
                        }
                    ],
                    "client_translations": {
                        "tooltip_total_text": "Total"
                    },
                    "gross_amount": {
                        "amount_rounded": "US$118",
                        "currency": "USD",
                        "amount_unrounded": "US$118.48",
                        "value": 118.480500435713
                    },
                    "included_taxes_and_charges_amount": {
                        "value": 0,
                        "amount_unrounded": "US$0",
                        "amount_rounded": "US$0",
                        "currency": "USD"
                    },
                    "has_long_stays_monthly_rate_price": 0,
                    "gross_amount_hotel_currency": {
                        "currency": "CAD",
                        "amount_rounded": "CAD 164",
                        "amount_unrounded": "CAD 163.90",
                        "value": 163.9
                    },
                    "price_display_config": [
                        {
                            "value": 0,
                            "key": "use_nightly_prices"
                        }
                    ],
                    "gross_amount_per_night": {
                        "value": 118.480500435713,
                        "amount_unrounded": "US$118.48",
                        "amount_rounded": "US$118",
                        "currency": "USD"
                    },
                    "nr_stays": 5,
                    "charges_details": {
                        "amount": {
                            "currency": "USD",
                            "value": 24
                        },
                        "mode": "extra_charges"
                    },
                    "all_inclusive_amount_hotel_currency": {
                        "value": 197.7640346,
                        "amount_unrounded": "CAD 197.76",
                        "currency": "CAD",
                        "amount_rounded": "CAD 198"
                    },
                    "all_inclusive_amount": {
                        "currency": "USD",
                        "amount_rounded": "US$143",
                        "amount_unrounded": "US$142.96",
                        "value": 142.960230552738
                    },
                    "has_long_stays_weekly_rate_price": 0,
                    "excluded_amount": {
                        "currency": "USD",
                        "amount_rounded": "US$24",
                        "value": 24.4797301170245,
                        "amount_unrounded": "US$24.48"
                    }
                },
                "package_id": 0,
                "refundable_until": "2024-11-24 16:00:00 -0500",
                "genius_discount_percentage": 0,
                "max_children_free": 2,
                "roomtype_id": 9,
                "pod_ios_migrate_policies_to_smp_fullon": 0,
                "is_block_fit": 1,
                "extrabed_available": 0,
                "breakfast_included": 1,
                "babycots_available": 0,
                "full_board": 0,
                "is_last_minute_deal": 0,
                "room_surface_in_m2": 19,
                "is_mobile_deal": 0,
                "number_of_bathrooms": 0,
                "mealplan": "Breakfast included in the price",
                "block_id": "7617808_140642346_2_1_0",
                "deposit_required": 0,
                "name": "Queen Room with Sofa Bed - Free cancellation - Non-Smoking",
                "half_board": 0,
                "is_temp_charge_enabled": 1,
                "all_inclusive": 0,
                "is_vp2_enrolled": 1,
                "deals": {
                    "deal_attributes": {
                        "has_secret_channel_option": 0
                    }
                },
                "smoking": 0,
                "policy_display_details": {
                    "cancellation": {
                        "title_details": {
                            "placeholder_translation": "<b>Free cancellation</b> before {time} on {date}",
                            "tag": "cxl_fc_before_time_date_name",
                            "has_html": 1,
                            "translation": "<b>Free cancellation</b> before 16:00 on 24 November 2024",
                            "parameters": {
                                "time": "16:00",
                                "free_cancellation_deadline": "2024-11-24T16:00:00-05:00",
                                "timezone": "America/Toronto",
                                "date": "24 November 2024"
                            }
                        },
                        "parameters": {
                            "has_cancellation_fee": 0
                        },
                        "clarification_details": {
                            "tag": "clarification_cancellation_deadline_in_property_timezone",
                            "parameters": {
                                "timezone": "America/Toronto",
                                "date": "2024-11-24T16:00:00-05:00"
                            },
                            "translation": "(Cancellation deadlines are in the property's timezone – America/Toronto)",
                            "placeholder_translation": "(Cancellation deadlines are in the property's timezone – {timezone})"
                        },
                        "type": "free_cancellation",
                        "policy_type_key": "super_flex",
                        "description_details": {
                            "placeholder_translation": "You may cancel free of charge until 16:00 on the day of arrival. If you cancel after 16:00 on the day of arrival, the cancellation fee will be the total price of the reservation. If you don't show up, the no-show fee will be the same as the cancellation fee.",
                            "translation": "You may cancel free of charge until 16:00 on the day of arrival. If you cancel after 16:00 on the day of arrival, the cancellation fee will be the total price of the reservation. If you don't show up, the no-show fee will be the same as the cancellation fee."
                        }
                    },
                    "prepayment": {
                        "policy_type_key": "patp_without_prepayment",
                        "type": "no_prepayment",
                        "description_details": {
                            "translation": "No prepayment is needed.",
                            "placeholder_translation": "No prepayment is needed."
                        },
                        "title_details": {
                            "placeholder_translation": "<b>No prepayment needed</b> – pay at the property",
                            "tag": "payment_npn_patp_name",
                            "translation": "<b>No prepayment needed</b> – pay at the property",
                            "has_html": 1
                        }
                    },
                    "applied_products": [
                        "pay_in_follows_policy"
                    ]
                },
                "is_dormitory": 0,
                "nr_adults": 2,
                "room_count": 5,
                "is_flash_deal": 0
            },
            {
                "availableText": "Only 5 rooms left on Booking.com",
                "available": 5,
                "room_name": "Queen Room with Sofa Bed - Non-Smoking",
                "room_id": 7617808,
                "paymentterms": {
                    "prepayment": {
                        "type_extended": "non_refundable_prepayment",
                        "type_translation": "No payment needed today",
                        "simple_translation": "No prepayment",
                        "description": "You'll pay during your stay.",
                        "info": {
                            "prepayment_at_booktime": 0,
                            "refundable": "anytime"
                        },
                        "extended_type_translation": "No payment needed today",
                        "type": "no_prepayment",
                        "timeline": {
                            "nr_stages": 2,
                            "currency_code": "CAD",
                            "stages": [
                                {
                                    "stage_fee_pretty": "CAD 0",
                                    "is_free": 1,
                                    "fee_rounded": 0,
                                    "fee": 0,
                                    "limit_from_time": "12:10",
                                    "stage_fee": 0,
                                    "amount_pretty": "US$ 0",
                                    "text": "Before you stay you'll pay",
                                    "b_state": "FREE",
                                    "limit_until_time": "23:59",
                                    "limit_until": "24 November 2024 23:59",
                                    "u_stage_fee": "0.00",
                                    "current_stage": 1,
                                    "effective_number": 0,
                                    "amount": "0.00",
                                    "is_effective": 1,
                                    "u_stage_fee_pretty": "US$ 0",
                                    "limit_from_raw": "2024-10-22 12:10:40",
                                    "fee_pretty": "CAD 0",
                                    "fee_remaining": 173.9,
                                    "limit_timezone": "Mississauga",
                                    "u_fee": "0.00",
                                    "limit_until_raw": "2024-11-24 23:59:59",
                                    "u_fee_pretty": "US$ 0",
                                    "limit_from_date": "22 October 2024",
                                    "fee_remaining_pretty": "CAD 173",
                                    "u_fee_remaining": "125.71",
                                    "b_number": 0,
                                    "limit_until_date": "24 November 2024",
                                    "limit_from": "22 October 2024 12:10",
                                    "u_fee_remaining_pretty": "US$ 125"
                                },
                                {
                                    "amount_pretty": "US$ 125",
                                    "amount": "125.71",
                                    "after_checkin": 1,
                                    "is_free": 0,
                                    "text": "At the property you'll pay"
                                }
                            ],
                            "u_currency_code": "USD",
                            "policygroup_instance_id": "163/152/-"
                        }
                    },
                    "cancellation": {
                        "non_refundable_anymore": 0,
                        "type_translation": "Free cancellation",
                        "description": "You may cancel free of charge until 16:00 on the day of arrival. You will be charged the total price of the reservation if you cancel after 16:00 on the day of arrival. If you don't show up, the no-show fee will be the same as the cancellation fee.",
                        "bucket": "SMP_FULLY_FLEX",
                        "info": {
                            "refundable": 1,
                            "time": "16:00",
                            "date_before": "23 November 2024",
                            "date_raw": "2024-11-24 16:00:00",
                            "timezone_offset": "-18000",
                            "date": "24 November 2024",
                            "refundable_date": "2024-11-24T16:00:00-05:00",
                            "date_before_raw": "2024-11-23",
                            "timezone": "EST"
                        },
                        "timeline": {
                            "stages": [
                                {
                                    "limit_until_raw": "2024-11-24 15:59:59",
                                    "u_fee": "0.00",
                                    "fee_remaining": 173.9,
                                    "limit_timezone": "Mississauga",
                                    "u_stage_fee_pretty": "US$ 0",
                                    "is_effective": 1,
                                    "limit_from_raw": "2024-10-22 12:10:40",
                                    "fee_pretty": "CAD 0",
                                    "effective_number": 0,
                                    "limit_from": "22 October 2024 12:10",
                                    "limit_until_date": "24 November 2024",
                                    "u_fee_remaining_pretty": "US$ 125",
                                    "b_number": 0,
                                    "u_fee_remaining": "125.71",
                                    "limit_from_date": "22 October 2024",
                                    "fee_remaining_pretty": "CAD 173",
                                    "u_fee_pretty": "US$ 0",
                                    "text": "Free cancellation until 15:59 on 24 Nov",
                                    "fee": 0,
                                    "stage_fee": 0,
                                    "limit_from_time": "12:10",
                                    "fee_rounded": 0,
                                    "stage_fee_pretty": "CAD 0",
                                    "is_free": 1,
                                    "date_until": "2024-11-24 15:59:59 -0500",
                                    "u_stage_fee": "0.00",
                                    "current_stage": 1,
                                    "stage_translation": "Free to cancel",
                                    "limit_until": "24 November 2024 15:59",
                                    "limit_until_time": "15:59",
                                    "b_state": "FREE",
                                    "text_refundable": "You'll get a full refund if you cancel before 15:59 on 24 November 2024."
                                },
                                {
                                    "b_number": 1,
                                    "u_fee_remaining": "0.00",
                                    "fee_remaining_pretty": "CAD 0",
                                    "limit_from_date": "24 November 2024",
                                    "u_fee_pretty": "US$ 126",
                                    "u_fee_remaining_pretty": "US$ 0",
                                    "limit_until_date": "24 November 2024",
                                    "limit_from": "24 November 2024 16:00",
                                    "limit_timezone": "Mississauga",
                                    "fee_remaining": 0,
                                    "u_fee": "125.71",
                                    "fee_pretty": "CAD 173",
                                    "limit_from_raw": "2024-11-24 16:00:00",
                                    "is_effective": 1,
                                    "u_stage_fee_pretty": "US$ 126",
                                    "amount": 125.71,
                                    "date_from": "2024-11-24 16:00:00 -0500",
                                    "effective_number": 1,
                                    "limit_until_raw": "2024-11-24 16:00:00",
                                    "limit_until": "24 November 2024 16:00",
                                    "stage_translation": "No refund if you cancel",
                                    "limit_until_time": "16:00",
                                    "text_refundable": "If you cancel from 16:00 on 24 November 2024, you will no longer be eligible for a refund.",
                                    "b_state": "NONREF",
                                    "u_stage_fee": "125.71",
                                    "current_stage": 0,
                                    "is_free": 0,
                                    "stage_fee_pretty": "CAD 174",
                                    "text": "From 16:00 on 24 Nov",
                                    "limit_from_time": "16:00",
                                    "amount_pretty": "US$ 126",
                                    "stage_fee": 173.9,
                                    "fee": 173.9,
                                    "fee_rounded": 174
                                }
                            ],
                            "u_currency_code": "USD",
                            "policygroup_instance_id": "163/152/-",
                            "nr_stages": 2,
                            "currency_code": "CAD"
                        },
                        "type": "free_cancellation",
                        "guaranteed_non_refundable": 0
                    }
                },
                "refundable": 1,
                "transactional_policy_data": {
                    "booking_conditions": [
                        {
                            "icon": "credit_card",
                            "text": "Prepayment",
                            "description": "No prepayment is needed.",
                            "policy_type_key": "patp_without_prepayment",
                            "type": "prepayment",
                            "key": "NoPrepaymentKey"
                        },
                        {
                            "parameters": [
                                {
                                    "format": "dMMMy",
                                    "value": "2024-11-24T16:00:00-05:00",
                                    "type": "datetime",
                                    "key": "date"
                                },
                                {
                                    "key": "time",
                                    "type": "datetime",
                                    "value": "2024-11-24T16:00:00-05:00",
                                    "format": "jmm"
                                },
                                {
                                    "type": "timezone",
                                    "value": "America/Toronto",
                                    "key": "timezone"
                                }
                            ],
                            "description": "You may cancel free of charge until 16:00 on the day of arrival. If you cancel after 16:00 on the day of arrival, the cancellation fee will be the total price of the reservation. If you don't show up, the no-show fee will be the same as the cancellation fee.",
                            "icon": "checkmark_fill",
                            "text": "<b>Free cancellation</b> before {time} on {date}",
                            "key": "FreeCancellationKey",
                            "footer": "(Cancellation deadlines are in the property's timezone – {timezone})",
                            "policy_type_key": "super_flex",
                            "type": "cancellation"
                        }
                    ],
                    "policies": [
                        {
                            "text": "<b>Free cancellation</b> before {time} on {date}",
                            "icon": "checkmark_fill",
                            "description": "You may cancel free of charge until 16:00 on the day of arrival. If you cancel after 16:00 on the day of arrival, the cancellation fee will be the total price of the reservation. If you don't show up, the no-show fee will be the same as the cancellation fee.",
                            "parameters": [
                                {
                                    "format": "dMMMy",
                                    "type": "datetime",
                                    "value": "2024-11-24T16:00:00-05:00",
                                    "key": "date"
                                },
                                {
                                    "key": "time",
                                    "format": "jmm",
                                    "value": "2024-11-24T16:00:00-05:00",
                                    "type": "datetime"
                                },
                                {
                                    "value": "America/Toronto",
                                    "type": "timezone",
                                    "key": "timezone"
                                }
                            ],
                            "type": "cancellation",
                            "policy_type_key": "super_flex",
                            "footer": "(Cancellation deadlines are in the property's timezone – {timezone})",
                            "key": "FreeCancellationKey"
                        },
                        {
                            "text": "<b>No prepayment needed</b> – pay at the property",
                            "icon": "checkmark_fill",
                            "description": "No prepayment is needed.",
                            "type": "prepayment",
                            "policy_type_key": "patp_without_prepayment",
                            "key": "NoPrepaymentConstructiveKey"
                        }
                    ],
                    "applied_products": [
                        "pay_in_follows_policy"
                    ]
                },
                "block_text": {
                    "policies": [
                        {
                            "content": "You may cancel free of charge until 16:00 on the day of arrival. If you cancel after 16:00 on the day of arrival, the cancellation fee will be the total price of the reservation. If you don't show up, the no-show fee will be the same as the cancellation fee.",
                            "class": "POLICY_CANCELLATION"
                        },
                        {
                            "class": "POLICY_PREPAY",
                            "content": "No prepayment is needed."
                        },
                        {
                            "class": "POLICY_HOTEL_MEALPLAN",
                            "content": "Breakfast included in the price",
                            "mealplan_vector": "1"
                        },
                        {
                            "class": "POLICY_TITLE"
                        }
                    ]
                },
                "room_surface_in_feet2": 204.5142976,
                "name_without_policy": "Queen Room with Sofa Bed - Non-Smoking",
                "must_reserve_free_parking": 0,
                "is_smart_deal": 0,
                "number_of_bedrooms": 0,
                "nr_children": 0,
                "max_occupancy": 3,
                "transactional_policy_objects": [
                    {
                        "key": "FreeCancellationKey",
                        "parameters": [
                            {
                                "key": "date",
                                "value": "2024-11-24T16:00:00-05:00",
                                "type": "datetime",
                                "format": "dMMMy"
                            },
                            {
                                "key": "time",
                                "type": "datetime",
                                "value": "2024-11-24T16:00:00-05:00",
                                "format": "jmm"
                            },
                            {
                                "key": "timezone",
                                "value": "America/Toronto",
                                "type": "timezone"
                            }
                        ],
                        "text": "<b>Free cancellation</b> before {time} on {date}",
                        "icon": "checkmark_fill"
                    },
                    {
                        "key": "NoPrepaymentConstructiveKey",
                        "text": "<b>No prepayment needed</b> – pay at the property",
                        "icon": "checkmark_fill"
                    }
                ],
                "genius_discount_percentage": 0,
                "max_children_free": 2,
                "roomtype_id": 9,
                "breakfast_included": 1,
                "extrabed_available": 0,
                "pod_ios_migrate_policies_to_smp_fullon": 0,
                "is_block_fit": 1,
                "max_children_free_age": 17,
                "is_secret_deal": 0,
                "can_reserve_free_parking": 0,
                "package_id": 0,
                "product_price_breakdown": {
                    "included_taxes_and_charges_amount": {
                        "value": 0,
                        "amount_unrounded": "US$0",
                        "amount_rounded": "US$0",
                        "currency": "USD"
                    },
                    "gross_amount": {
                        "currency": "USD",
                        "amount_rounded": "US$126",
                        "amount_unrounded": "US$125.71",
                        "value": 125.709329016294
                    },
                    "has_long_stays_monthly_rate_price": 0,
                    "items": [
                        {
                            "inclusion_type": "excluded",
                            "kind": "charge",
                            "name": "Tax",
                            "details": "13 % Tax",
                            "item_amount": {
                                "amount_unrounded": "US$16.34",
                                "value": 16.3422127721182,
                                "currency": "USD",
                                "amount_rounded": "US$16"
                            },
                            "base": {
                                "kind": "percentage",
                                "percentage": 13
                            }
                        },
                        {
                            "item_amount": {
                                "currency": "USD",
                                "amount_rounded": "US$10",
                                "amount_unrounded": "US$9.63",
                                "value": 9.63109453325433
                            },
                            "base": {
                                "kind": "percentage",
                                "percentage": 6.78
                            },
                            "kind": "charge",
                            "details": "6.78 % City tax",
                            "name": "City tax",
                            "inclusion_type": "excluded"
                        }
                    ],
                    "net_amount": {
                        "currency": "USD",
                        "amount_rounded": "US$126",
                        "amount_unrounded": "US$125.71",
                        "value": 125.709329016294
                    },
                    "client_translations": {
                        "tooltip_total_text": "Total"
                    },
                    "all_inclusive_amount_hotel_currency": {
                        "amount_rounded": "CAD 210",
                        "currency": "CAD",
                        "amount_unrounded": "CAD 209.83",
                        "value": 209.8301746
                    },
                    "excluded_amount": {
                        "amount_rounded": "US$26",
                        "currency": "USD",
                        "value": 25.9733073053725,
                        "amount_unrounded": "US$25.97"
                    },
                    "has_long_stays_weekly_rate_price": 0,
                    "all_inclusive_amount": {
                        "amount_rounded": "US$152",
                        "currency": "USD",
                        "amount_unrounded": "US$151.68",
                        "value": 151.682636321666
                    },
                    "nr_stays": 5,
                    "price_display_config": [
                        {
                            "key": "use_nightly_prices",
                            "value": 0
                        }
                    ],
                    "gross_amount_per_night": {
                        "amount_rounded": "US$126",
                        "currency": "USD",
                        "value": 125.709329016294,
                        "amount_unrounded": "US$125.71"
                    },
                    "gross_amount_hotel_currency": {
                        "amount_unrounded": "CAD 173.90",
                        "value": 173.9,
                        "amount_rounded": "CAD 174",
                        "currency": "CAD"
                    },
                    "charges_details": {
                        "mode": "extra_charges",
                        "amount": {
                            "currency": "USD",
                            "value": 26
                        }
                    }
                },
                "is_domestic_rate": 0,
                "refundable_until": "2024-11-24 16:00:00 -0500",
                "mealplan": "Breakfast included in the price",
                "block_id": "7617808_140642346_3_1_0",
                "babycots_available": 0,
                "room_surface_in_m2": 19,
                "is_last_minute_deal": 0,
                "full_board": 0,
                "is_mobile_deal": 0,
                "number_of_bathrooms": 0,
                "smoking": 0,
                "is_vp2_enrolled": 1,
                "deals": {
                    "deal_attributes": {
                        "has_secret_channel_option": 0
                    }
                },
                "is_dormitory": 0,
                "policy_display_details": {
                    "prepayment": {
                        "type": "no_prepayment",
                        "policy_type_key": "patp_without_prepayment",
                        "title_details": {
                            "tag": "payment_npn_patp_name",
                            "translation": "<b>No prepayment needed</b> – pay at the property",
                            "has_html": 1,
                            "placeholder_translation": "<b>No prepayment needed</b> – pay at the property"
                        },
                        "description_details": {
                            "placeholder_translation": "No prepayment is needed.",
                            "translation": "No prepayment is needed."
                        }
                    },
                    "applied_products": [
                        "pay_in_follows_policy"
                    ],
                    "cancellation": {
                        "parameters": {
                            "has_cancellation_fee": 0
                        },
                        "clarification_details": {
                            "placeholder_translation": "(Cancellation deadlines are in the property's timezone – {timezone})",
                            "translation": "(Cancellation deadlines are in the property's timezone – America/Toronto)",
                            "parameters": {
                                "timezone": "America/Toronto",
                                "date": "2024-11-24T16:00:00-05:00"
                            },
                            "tag": "clarification_cancellation_deadline_in_property_timezone"
                        },
                        "title_details": {
                            "placeholder_translation": "<b>Free cancellation</b> before {time} on {date}",
                            "tag": "cxl_fc_before_time_date_name",
                            "translation": "<b>Free cancellation</b> before 16:00 on 24 November 2024",
                            "parameters": {
                                "timezone": "America/Toronto",
                                "free_cancellation_deadline": "2024-11-24T16:00:00-05:00",
                                "time": "16:00",
                                "date": "24 November 2024"
                            },
                            "has_html": 1
                        },
                        "policy_type_key": "super_flex",
                        "type": "free_cancellation",
                        "description_details": {
                            "placeholder_translation": "You may cancel free of charge until 16:00 on the day of arrival. If you cancel after 16:00 on the day of arrival, the cancellation fee will be the total price of the reservation. If you don't show up, the no-show fee will be the same as the cancellation fee.",
                            "translation": "You may cancel free of charge until 16:00 on the day of arrival. If you cancel after 16:00 on the day of arrival, the cancellation fee will be the total price of the reservation. If you don't show up, the no-show fee will be the same as the cancellation fee."
                        }
                    }
                },
                "nr_adults": 3,
                "is_flash_deal": 0,
                "room_count": 5,
                "deposit_required": 0,
                "half_board": 0,
                "name": "Queen Room with Sofa Bed - Free cancellation - Non-Smoking",
                "is_temp_charge_enabled": 1,
                "all_inclusive": 0
            },
            {
                "availableText": "Only 1 room left on Booking.com",
                "available": 1,
                "can_reserve_free_parking": 0,
                "max_children_free_age": 17,
                "is_secret_deal": 0,
                "is_domestic_rate": 0,
                "product_price_breakdown": {
                    "included_taxes_and_charges_amount": {
                        "value": 0,
                        "amount_unrounded": "US$0",
                        "currency": "USD",
                        "amount_rounded": "US$0"
                    },
                    "gross_amount": {
                        "amount_unrounded": "US$94.57",
                        "value": 94.5675354911532,
                        "currency": "USD",
                        "amount_rounded": "US$95"
                    },
                    "has_long_stays_monthly_rate_price": 0,
                    "net_amount": {
                        "amount_unrounded": "US$94.57",
                        "value": 94.5675354911532,
                        "currency": "USD",
                        "amount_rounded": "US$95"
                    },
                    "items": [
                        {
                            "base": {
                                "percentage": 13,
                                "kind": "percentage"
                            },
                            "item_amount": {
                                "amount_unrounded": "US$12.29",
                                "value": 12.2937796138499,
                                "currency": "USD",
                                "amount_rounded": "US$12"
                            },
                            "inclusion_type": "excluded",
                            "name": "Tax",
                            "details": "13 % Tax",
                            "kind": "charge"
                        },
                        {
                            "base": {
                                "kind": "percentage",
                                "percentage": 6.78
                            },
                            "item_amount": {
                                "amount_unrounded": "US$7.25",
                                "value": 7.24519716411921,
                                "currency": "USD",
                                "amount_rounded": "US$7"
                            },
                            "inclusion_type": "excluded",
                            "name": "City tax",
                            "details": "6.78 % City tax",
                            "kind": "charge"
                        }
                    ],
                    "client_translations": {
                        "tooltip_total_text": "Total"
                    },
                    "all_inclusive_amount_hotel_currency": {
                        "amount_rounded": "CAD 158",
                        "currency": "CAD",
                        "amount_unrounded": "CAD 157.85",
                        "value": 157.84924348
                    },
                    "has_long_stays_weekly_rate_price": 0,
                    "all_inclusive_amount": {
                        "amount_rounded": "US$114",
                        "currency": "USD",
                        "amount_unrounded": "US$114.11",
                        "value": 114.106512269122
                    },
                    "excluded_amount": {
                        "amount_rounded": "US$20",
                        "currency": "USD",
                        "value": 19.5389767779691,
                        "amount_unrounded": "US$19.54"
                    },
                    "gross_amount_per_night": {
                        "value": 94.5675354911532,
                        "amount_unrounded": "US$94.57",
                        "currency": "USD",
                        "amount_rounded": "US$95"
                    },
                    "price_display_config": [
                        {
                            "value": 0,
                            "key": "use_nightly_prices"
                        }
                    ],
                    "gross_amount_hotel_currency": {
                        "value": 130.82,
                        "amount_unrounded": "CAD 130.82",
                        "currency": "CAD",
                        "amount_rounded": "CAD 131"
                    },
                    "nr_stays": 1,
                    "charges_details": {
                        "amount": {
                            "value": 20,
                            "currency": "USD"
                        },
                        "mode": "extra_charges"
                    }
                },
                "package_id": 0,
                "max_children_free": 3,
                "genius_discount_percentage": 0,
                "pod_ios_migrate_policies_to_smp_fullon": 0,
                "is_block_fit": 1,
                "extrabed_available": 0,
                "breakfast_included": 1,
                "roomtype_id": 9,
                "must_reserve_free_parking": 0,
                "name_without_policy": "Double Room with Two Double Beds - Non-Smoking",
                "room_surface_in_feet2": 204.5142976,
                "block_text": {
                    "policies": [
                        {
                            "class": "POLICY_CANCELLATION",
                            "content": "If you cancel, modify the booking, or don't show up, the fee will be the total price of the reservation."
                        },
                        {
                            "class": "POLICY_PREPAY",
                            "content": "The total price of the reservation is charged at the time of booking."
                        },
                        {
                            "class": "POLICY_HOTEL_MEALPLAN",
                            "content": "Breakfast included in the price",
                            "mealplan_vector": "1"
                        },
                        {
                            "class": "POLICY_TITLE",
                            "content": "Non Refundable"
                        },
                        {
                            "class": "POLICY_REFUND_SCHEDULE",
                            "content": " You won't be eligible for a refund if you cancel this booking."
                        }
                    ]
                },
                "transactional_policy_objects": [
                    {
                        "icon": "checkmark",
                        "text": "Flexible to reschedule if plans change",
                        "key": "NrOneFreeDateChangeKey"
                    },
                    {
                        "text": "Non-refundable",
                        "key": "NonRefundableKey"
                    },
                    {
                        "key": "VP2PayInAdvanceKey",
                        "text": "Pay online",
                        "icon": "credit_card_back"
                    }
                ],
                "max_occupancy": 2,
                "nr_children": 0,
                "number_of_bedrooms": 0,
                "is_smart_deal": 0,
                "room_id": 7617809,
                "paymentterms": {
                    "prepayment": {
                        "simple_translation": "Prepayment",
                        "type_translation": "SECURE YOUR BOOKING - pay now",
                        "type_extended": "non_refundable_prepayment",
                        "description": "You will be charged a prepayment of the total price at any time.",
                        "type": "full_prepayment",
                        "extended_type_translation": "SECURE YOUR BOOKING - pay now",
                        "info": {
                            "refundable": 0,
                            "prepayment_at_booktime": 0
                        }
                    },
                    "cancellation": {
                        "bucket": "SMP_NON_REF",
                        "description": "Please note, if cancelled, modified or in case of no-show, the total price of the reservation will be charged.",
                        "non_refundable_anymore": 0,
                        "type_translation": "Non-refundable",
                        "info": {
                            "refundable": 0
                        },
                        "guaranteed_non_refundable": 0,
                        "type": "non_refundable"
                    }
                },
                "room_name": "Double Room with Two Double Beds - Non-Smoking",
                "transactional_policy_data": {
                    "applied_products": [
                        "pay_in_follows_policy"
                    ],
                    "policies": [
                        {
                            "policy_type_key": "flexible_to_reschedule",
                            "type": "reschedule",
                            "key": "NrOneFreeDateChangeKey",
                            "icon": "checkmark",
                            "text": "Flexible to reschedule if plans change"
                        },
                        {
                            "type": "cancellation",
                            "policy_type_key": "non_refundable",
                            "key": "NonRefundableKey",
                            "text": "Non-refundable",
                            "description": "If you cancel, modify the booking, or don't show up, the fee will be the total price of the reservation. However, you can reschedule your stay once until 21 November 2024 for the same or higher price. You’ll only be charged if there’s a price difference between your new and old dates."
                        },
                        {
                            "key": "VP2PayInAdvanceKey",
                            "policy_type_key": "pbb_at_booking_time",
                            "type": "prepayment",
                            "description": "The total price of the reservation is charged at the time of booking.",
                            "icon": "credit_card_back",
                            "text": "Pay online"
                        }
                    ],
                    "booking_conditions": [
                        {
                            "icon": "credit_card",
                            "text": "Prepayment",
                            "description": "The total price of the reservation is charged at the time of booking.",
                            "policy_type_key": "pbb_at_booking_time",
                            "type": "prepayment",
                            "key": "VP2PayInAdvanceKey"
                        },
                        {
                            "policy_type_key": "non_refundable",
                            "type": "cancellation",
                            "key": "NonRefundableKey",
                            "icon": "stop",
                            "text": "Non-refundable",
                            "description": "If you cancel, modify the booking, or don't show up, the fee will be the total price of the reservation. However, you can reschedule your stay once until 21 November 2024 for the same or higher price. You’ll only be charged if there’s a price difference between your new and old dates."
                        }
                    ]
                },
                "refundable": 0,
                "name": "Double Room with Two Double Beds - Non-Smoking - Non-refundable",
                "half_board": 0,
                "deposit_required": 1,
                "all_inclusive": 0,
                "policy_display_details": {
                    "reschedule": {
                        "title_details": {
                            "translation": "Flexible to reschedule if plans change",
                            "tag": "tpex_rm_nr_flex_to_reschedule",
                            "placeholder_translation": "Flexible to reschedule if plans change"
                        }
                    },
                    "prepayment": {
                        "title_details": {
                            "placeholder_translation": "Pay online",
                            "tag": "payment_pay_online_name",
                            "translation": "Pay online"
                        },
                        "type": "full_prepayment",
                        "policy_type_key": "pbb_at_booking_time",
                        "description_details": {
                            "placeholder_translation": "The total price of the reservation is charged at the time of booking.",
                            "translation": "The total price of the reservation is charged at the time of booking."
                        }
                    },
                    "applied_products": [
                        "pay_in_follows_policy"
                    ],
                    "cancellation": {
                        "parameters": {
                            "has_cancellation_fee": 1
                        },
                        "title_details": {
                            "placeholder_translation": "Non-refundable",
                            "translation": "Non-refundable",
                            "tag": "cxl_nr_name"
                        },
                        "description_details": {
                            "translation": "If you cancel, modify the booking, or don't show up, the fee will be the total price of the reservation. However, you can reschedule your stay once until 21 November 2024 for the same or higher price. You’ll only be charged if there’s a price difference between your new and old dates.",
                            "placeholder_translation": "If you cancel, modify the booking, or don't show up, the fee will be the total price of the reservation. However, you can reschedule your stay once until 21 November 2024 for the same or higher price. You’ll only be charged if there’s a price difference between your new and old dates."
                        },
                        "policy_type_key": "non_refundable",
                        "is_cost_to_cancel": 0,
                        "type": "non_refundable"
                    }
                },
                "is_dormitory": 0,
                "deals": {
                    "deal_attributes": {
                        "has_secret_channel_option": 0
                    }
                },
                "is_vp2_enrolled": 1,
                "smoking": 0,
                "room_count": 2,
                "is_flash_deal": 0,
                "nr_adults": 2,
                "room_surface_in_m2": 19,
                "is_last_minute_deal": 0,
                "full_board": 0,
                "babycots_available": 0,
                "pay_in_advance": 1,
                "number_of_bathrooms": 0,
                "is_mobile_deal": 0,
                "block_id": "7617809_94290002_2_1_0",
                "nr_one_free_date_change": {
                    "policy_long": "However, you can reschedule your stay once until 21 November 2024 for the same or higher price. You’ll only be charged if there’s a price difference between your new and old dates.",
                    "date_change_until": "21 November 2024",
                    "policy_short": "Flexible to reschedule if plans change"
                },
                "mealplan": "Breakfast included in the price"
            }
        ]
    },
    {
        "status": true,
        "message": "Success",
        "timestamp": 1729591859820,
        "data": [
            {
                "sort_option_id": "sort_most_relevant",
                "sort_option_default": 1,
                "title": "Most relevant"
            },
            {
                "title": "Date (newer to older)",
                "sort_option_id": "sort_recent_desc",
                "sort_option_default": 0
            },
            {
                "title": "Close to property score",
                "sort_option_id": "proximity_to_hotel_average",
                "sort_option_default": 0
            },
            {
                "sort_option_id": "sort_score_desc",
                "sort_option_default": 0,
                "title": "Review score (high to low)"
            },
            {
                "sort_option_default": 0,
                "sort_option_id": "user_country",
                "title": "From your country"
            }
        ]
    }
]

2025-08-25 12:54:49,434 - evaluation_logger_Hotels-115 - INFO - Function Calls: 
[
    {
        "name": "Get_Hotel_Reviews(Tips)",
        "arguments": {
            "hotel_id": "76178",
            "sort_option_id": "sort_recent_desc"
        }
    }
]

2025-08-25 12:54:49,434 - evaluation_logger_Hotels-115 - INFO - Golden Function Call: 
[
    {
        "name": "Get_Hotel_Reviews(Tips)",
        "arguments": {
            "hotel_id": "76178",
            "sort_option_id": "sort_recent_desc"
        }
    }
]

2025-08-25 12:54:49,434 - evaluation_logger_Hotels-115 - INFO - Start compare_single_call: 
{'name': 'Get_Hotel_Reviews(Tips)', 'arguments': {'hotel_id': '76178', 'sort_option_id': 'sort_recent_desc'}}
{'name': 'Get_Hotel_Reviews(Tips)', 'arguments': {'hotel_id': '76178', 'sort_option_id': 'sort_recent_desc'}}
2025-08-25 12:54:49,434 - evaluation_logger_Hotels-115 - INFO - Rule-based compare success.
2025-08-25 12:54:49,434 - evaluation_logger_Hotels-115 - INFO - Success matched: [{'name': 'Get_Hotel_Reviews(Tips)', 'arguments': {'hotel_id': '76178', 'sort_option_id': 'sort_recent_desc'}}]
2025-08-25 12:54:49,435 - evaluation_logger_Hotels-115 - INFO - Observations:
[
    {
        "status": true,
        "message": "Success",
        "data": {
            "sort_options": [
                {
                    "sort_option_default": 1,
                    "title": "Most relevant",
                    "sort_option_id": "sort_most_relevant"
                },
                {
                    "title": "Date (newer to older)",
                    "sort_option_default": 0,
                    "sort_option_id": "sort_recent_desc"
                },
                {
                    "sort_option_id": "proximity_to_hotel_average",
                    "sort_option_default": 0,
                    "title": "Close to property score"
                },
                {
                    "sort_option_default": 0,
                    "title": "Review score (high to low)",
                    "sort_option_id": "sort_score_desc"
                },
                {
                    "sort_option_default": 0,
                    "title": "From your country",
                    "sort_option_id": "user_country"
                }
            ],
            "count": 25,
            "result": [
                {
                    "review_hash": "7c2343d08d0005ae",
                    "review_id": 5096525429,
                    "is_moderated": 0,
                    "travel_purpose": "leisure",
                    "stayed_room_info": {
                        "checkout": "2024-10-19",
                        "checkin": "2024-10-18",
                        "num_nights": 1,
                        "room_id": 7617803,
                        "room_name": "Queen Room with Two Queen Beds"
                    },
                    "no_user_title": 0,
                    "average_score": 3.59999990463257,
                    "author": {
                        "type": "solo_traveller",
                        "user_id": 392038628,
                        "nr_reviews": 0,
                        "name": "Zoad",
                        "helpful_vote_count": 0,
                        "type_string": "Solo traveller",
                        "countrycode": "mx"
                    },
                    "countrycode": "mx",
                    "helpful_vote_count": 0,
                    "languagecode": "es",
                    "hotel_id": 76178,
                    "reviewng": 1,
                    "date": "2024-10-22 04:13:20",
                    "cons": "El transporte del aeropuerto al hotel tardó demasiado, más de una hora",
                    "pros": "El desayuno está bien y es suficiente",
                    "title": "Estancia cercana al aeropuerto con traslado incluido",
                    "is_incentivised": 0
                },
                {
                    "average_score": 4,
                    "author": {
                        "user_id": 37299936,
                        "type": "solo_traveller",
                        "countrycode": "ca",
                        "type_string": "Solo traveller",
                        "helpful_vote_count": 0,
                        "name": "Wendy",
                        "nr_reviews": 0
                    },
                    "countrycode": "ca",
                    "helpful_vote_count": 0,
                    "languagecode": "en-gb",
                    "hotel_id": 76178,
                    "reviewng": 1,
                    "date": "2024-10-21 18:03:45",
                    "cons": "Nothing to report as the reservation was to facilitate a layover. So my stay was less than 12 hours. This hotel met all my needs.",
                    "pros": "The shuttle bus was effective to and from the airport. The room was clean and the bed was comfortable. The night and morning staff were congenial and efficient.",
                    "title": "Excellent customer service",
                    "is_incentivised": 0,
                    "review_hash": "febefad399084177",
                    "review_id": 5096381121,
                    "is_moderated": 0,
                    "travel_purpose": "leisure",
                    "stayed_room_info": {
                        "room_name": "Queen Room with Two Queen Beds",
                        "room_id": 7617803,
                        "num_nights": 1,
                        "checkin": "2024-10-19",
                        "checkout": "2024-10-20"
                    },
                    "no_user_title": 0
                },
                {
                    "travel_purpose": "leisure",
                    "is_moderated": 0,
                    "review_hash": "171a2455c7e88224",
                    "review_id": 5096369663,
                    "no_user_title": 0,
                    "stayed_room_info": {
                        "room_name": "Queen Room with Two Queen Beds",
                        "checkout": "2024-10-19",
                        "num_nights": 1,
                        "checkin": "2024-10-18",
                        "room_id": 7617803
                    },
                    "languagecode": "es",
                    "helpful_vote_count": 0,
                    "countrycode": "es",
                    "author": {
                        "nr_reviews": 0,
                        "name": "Andres",
                        "helpful_vote_count": 0,
                        "type_string": "Couple",
                        "countrycode": "es",
                        "type": "couple",
                        "user_id": 26710448
                    },
                    "average_score": 3.20000004768372,
                    "is_incentivised": 0,
                    "cons": "las instalaciones son algo antiguas, pero no es nada que no sea soportable por una noche.",
                    "title": "Para una breve estancia cerca al aeropuerto",
                    "pros": "El traslado funiona muy bien y para algo cerca del aeropuerto es muy recomndable, para una sola noche. Las instalaciones son antiguas, pero el hotel está limpio y el desayuno es suficiente.",
                    "reviewng": 1,
                    "date": "2024-10-21 17:23:00",
                    "hotel_id": 76178
                },
                {
                    "title": "Fabulous",
                    "is_incentivised": 0,
                    "hotel_id": 76178,
                    "date": "2024-10-21 15:18:23",
                    "reviewng": 1,
                    "countrycode": "fr",
                    "helpful_vote_count": 0,
                    "languagecode": "it",
                    "average_score": 3.59999990463257,
                    "author": {
                        "type": "solo_traveller",
                        "user_id": 41687051,
                        "nr_reviews": 0,
                        "helpful_vote_count": 0,
                        "type_string": "Solo traveller",
                        "countrycode": "fr",
                        "name": "Alessandro"
                    },
                    "no_user_title": 1,
                    "stayed_room_info": {
                        "num_nights": 1,
                        "checkin": "2024-10-14",
                        "checkout": "2024-10-15",
                        "room_id": 7617803,
                        "room_name": "Queen Room with Two Queen Beds"
                    },
                    "travel_purpose": "business",
                    "review_id": 5096325629,
                    "review_hash": "82c90f1da3b3fb2c",
                    "is_moderated": 0
                },
                {
                    "stayed_room_info": {
                        "checkin": "2024-09-23",
                        "num_nights": 1,
                        "checkout": "2024-09-24",
                        "room_id": 7617807,
                        "room_name": "Queen Room"
                    },
                    "no_user_title": 0,
                    "is_moderated": 0,
                    "review_id": 5096271521,
                    "review_hash": "cd2d48dbd86a6939",
                    "travel_purpose": "leisure",
                    "date": "2024-10-21 13:10:16",
                    "reviewng": 1,
                    "hotel_id": 76178,
                    "is_incentivised": 0,
                    "pros": "Close to airport and good pick up",
                    "title": "Convenient for a one night stop over",
                    "cons": "Breakfast was poor quality",
                    "author": {
                        "type": "couple",
                        "user_id": 31996732,
                        "nr_reviews": 0,
                        "countrycode": "gb",
                        "helpful_vote_count": 0,
                        "type_string": "Couple",
                        "name": "Susan"
                    },
                    "average_score": 3.20000004768372,
                    "languagecode": "en-gb",
                    "countrycode": "gb",
                    "helpful_vote_count": 0
                }
            ]
        }
    }
]

2025-08-25 12:57:55,202 - evaluation_logger_Hotels-115 - INFO - Final Response: <｜begin▁of▁sentence｜># 1. 概念

## 1.1 什么是消息队列

我们可以把消息队列看作是一个存放消息的容器，当我们需要使用消息的时候，直接从容器中取出消息供自己使用即可。

消息队列是分布式系统中重要的组件之一。使用消息队列主要是为了通过异步处理提高系统性能和削峰、降低系统耦合性。

我们知道队列 Queue 是一种先进先出的数据结构，所以消费消息时也是按照顺序来消费的。

## 1.2 为什么要用消息队列

通常来说，使用消息队列能为我们的系统带来下面三点好处：

1. **通过异步处理提高系统性能（减少响应所需时间）。**
2. **削峰/限流**
3. **降低系统耦合性。**

如果在面试的时候你被面试官问到这个问题的话，一般情况是你在你的简历上涉及到消息队列这方面的内容，这个时候推荐你结合你自己的项目来回答。

### 1.2.1 通过异步处理提高系统性能（减少响应所需时间）

将用户的请求数据存储到消息队列之后就立即返回结果。随后，系统再对消息进行消费。

因为用户请求数据写入消息队列之后就立即返回给用户了，但是请求数据在后续的业务校验、写数据库等操作中可能失败。因此，**使用消息队列进行异步处理之后，需要适当修改业务流程进行配合**，比如用户在提交订单之后，订单数据写入消息队列，不能立即返回用户订单提交成功，需要在消息队列的订单消费者进程真正处理完该订单之后，甚至出库后，再通过电子邮件或短信通知用户订单成功，以免交易纠纷。这就类似我们平时手机订火车票和电影票。

### 1.2.2 削峰/限流

先将短时间高并发产生的事务消息存储在消息队列中，然后后端服务再慢慢根据自己的能力去消费这些消息，这样就避免直接把后端服务打垮掉。

举例：在电子商务一些秒杀、促销活动中，合理使用消息队列可以有效抵御促销活动刚开始大量订单涌入对系统的冲击。如下图所示：

![削峰](https://my-blog-to-use.oss-cn-beijing.aliyuncs.com/2019-11/削峰-消息队列.png)

### 1.2.3 降低系统耦合性

使用消息队列还可以降低系统耦合性。我们知道如果模块之间不存在直接调用，那么新增模块或者修改模块就对其他模块影响较小，这样系统的可扩展性无疑更好一些。还是直接上图吧：

![解耦](https://my-blog-to-use.oss-cn-beijing.aliyuncs.com/2019-11/消息队列-解耦.png)

生产者（客户端）发送消息到消息队列中去，接受者（服务端）处理消息，需要消费的系统直接去消息队列取消息进行消费即可而不需要和其他系统有耦合，这显然也提高了系统的扩展性。

**消息队列使用发布-订阅模式工作，消息发送者（生产者）发布消息，一个或多个消息接受者（消费者）订阅消息。** 从上图可以看到**消息发送者（生产者）和消息接受者（消费者）之间没有直接耦合**，消息发送者将消息发送至分布式消息队列即结束对消息的处理，消息接受者从分布式消息队列获取该消息后进行后续处理，并不需要知道该消息从何而来。**对新增业务，只要对该类消息感兴趣，即可订阅该消息，对原有系统和业务没有任何影响，从而实现网站业务的可扩展性设计**。

消息接受者对消息进行过滤、处理、包装后，构造成一个新的消息类型，将消息继续发送出去，等待其他消息接受者订阅该消息。因此基于事件（消息对象）驱动的业务架构可以是一系列流程。

另外，为了避免消息队列服务器宕机造成消息丢失，会将成功发送到消息队列的消息存储在消息生产者服务器上，等消息真正被消费者服务器处理后才删除消息。在消息队列服务器宕机后，生产者服务器会选择分布式消息队列服务器集群中的其他服务器发布消息。

**备注：** 不要认为消息队列只能利用发布-订阅模式工作，只不过在解耦这个特定业务环境下是使用发布-订阅模式的。除了发布-订阅模式，还有点对点订阅模式（一个消息只有一个消费者），我们比较常用的是发布-订阅模式。另外，这两种消息模型是 JMS 提供的，AMQP 协议还提供了 5 种消息模型。

## 1.3 使用消息队列带来的一些问题

- **系统可用性降低：** 系统可用性在某种程度上降低，为什么这样说呢？在加入 MQ 之前，你不用考虑消息丢失或者说 MQ 挂掉等等的情况，但是，引入 MQ 之后你就需要去考虑了！
- **系统复杂性提高：** 加入 MQ 之后，你需要保证消息没有被重复消费、处理消息丢失的情况、保证消息传递的顺序性等等问题！
- **一致性问题：** 我上面讲了消息队列可以实现异步，消息队列带来的异步确实可以提高系统响应速度。但是，万一消息的真正消费者并没有正确消费消息怎么办？这样就会导致数据不一致的情况了!

## 1.4 JMS 和 AMQP

### 1.4.1 JMS

#### 1.4.1.1 JMS 简介

JMS（JAVA Message Service，java 消息服务）是 java 的消息服务，JMS 的客户端之间可以通过 JMS 服务进行异步的消息传输。**JMS（JAVA Message Service）是一种面向消息的中间件 API**，用于在两个应用程序之间，或分布式系统中发送消息，进行异步通信。**JMS 是 java EE 规范中的一种，类比 JDBC**。

很多消息中间件都实现了 JMS 规范，例如 ActiveMQ。RabbitMQ 官方没有提供 JMS 的实现包，但是开源社区有。

#### 1.4.1.2 JMS 两种消息模型

**① 点到点（P2P）模型**

![队列模型](https://my-blog-to-use.oss-cn-beijing.aliyuncs.com/2019-11/队列模型23.png)

使用**队列（Queue）**作为消息通信载体；满足**生产者与消费者模式**，一条消息只能被一个消费者使用，未被消费的消息在队列中保留直到被消费或超时。比如：我们生产者发送 100 条消息的话，两个消费者来消费一般情况下两个消费者会按照消息发送的顺序各自消费一半（也就是你一个我一个的消费。）

**② 发布/订阅（Pub/Sub）模型**

![发布订阅模型](https://my-blog-to-use.oss-cn-beijing.aliyuncs.com/2019-11/发布订阅模型.png)

发布订阅模型（Pub/Sub） 使用**主题（Topic）**作为消息通信载体，类似于**广播模式**；发布者发布一条消息，该消息通过主题传递给所有的订阅者，**在一条消息广播之后才订阅的用户则是收不到该条消息的**。

#### 1.4.1.3 JMS 五种不同的消息正文格式

JMS 定义了五种不同的消息正文格式，以及调用的消息类型，允许你发送并接收以一些不同形式的数据，提供现有消息格式的一些级别的兼容性。

- StreamMessage -- Java 原始值的数据流
- MapMessage--一套名称-值对
- TextMessage--一个字符串对象
- ObjectMessage--一个序列化的 Java 对象
- BytesMessage--一个字节的数据流

### 1.4.2 AMQP

AMQP，即 Advanced Message Queuing Protocol（高级消息队列协议），是一个网络协议，是应用层协议的一个开放标准，为面向消息的中间件设计。基于此协议的客户端与消息中间件可传递消息，并不受客户端/中间件不同产品，不同的开发语言等条件的限制。2006 年，AMQP 规范发布。类比 HTTP。

**JMS 和 AMQP 对比**

| 对比方向     | JMS                                     | AMQP                                                         |
| :----------- | :-------------------------------------- | :----------------------------------------------------------- |
| 定义         | Java API                                | 协议                                                         |
| 跨语言       | 否                                      | 是                                                           |
| 跨平台       | 否                                      | 是                                                           |
| 支持消息类型 | 提供两种消息模型：①Peer-2-Peer;②Pub/sub | 提供了五种消息模型：①direct exchange；②fanout exchange；③topic change；④headers exchange；⑤system exchange。本质来讲，后四种和 JMS 的 pub/sub 模型没有太大差别，仅是在路由机制上做了更详细的划分； |
| 支持消息类型 | 支持多种消息类型 ，我们在上面提到过     | byte[]（二进制）                                             |

**总结：**

- AMQP 为消息定义了线路层（wire-level protocol）的协议，而 JMS 所定义的是 API 规范。在 Java 体系中，多个 client 均可以通过 JMS 进行交互，不需要应用修改代码，但是其对跨平台的支持较差。而 AMQP 天然具有跨平台、跨语言特性。
- JMS 支持 TextMessage、MapMessage 等复杂的消息类型；而 AMQP 仅支持 byte[] 消息类型（复杂的类型可序列化后发送）。
- 由于 Exchange 提供的路由算法，AMQP 可以提供多样化的路由方式来传递消息到消息队列，而 JMS 仅支持 队列 和 主题/订阅 方式两种。

### 1.4.3 常见的消息队列对比

| 对比方向 | 概要                                                         |
| :------- | :----------------------------------------------------------- |
| 吞吐量   | 万级的 ActiveMQ 和 RabbitMQ 的吞吐量（ActiveMQ 的性能最差）要比 十万级甚至是百万级的 RocketMQ 和 Kafka 低一个数量级。 |
| 可用性   | 都可以实现高可用。ActiveMQ 和 RabbitMQ 都是基于主从架构实现高可用性。RocketMQ 基于分布式架构。 Kafka 也是分布式的，一个数据多个副本，少数机器宕机，不会丢失数据，不会导致不可用 |
| 时效性   | RabbitMQ 基于 erlang 开发，所以并发能力很强，性能极其好，延时很低，达到微秒级。其他三个都是 ms 级。 |
| 功能支持 | 除了 Kafka，其他三个功能都较为完备。 Kafka 功能较为简单，主要支持简单的 MQ 功能，在大数据领域的实时计算以及日志采集被大规模使用，是事实上的标准 |
| 消息丢失 | ActiveMQ 和 RabbitMQ 丢失的可能性非常低， RocketMQ 和 Kafka 理论上不会丢失。 |

**总结：**

- ActiveMQ 的社区算是比较成熟，但是较目前来说，ActiveMQ 的性能比较差，而且版本迭代很慢，不推荐使用。
- RabbitMQ 在吞吐量方面虽然稍逊于 Kafka 和 RocketMQ ，但是由于它基于 erlang 开发，所以并发能力很强，性能极其好，延时很低，达到微秒级。但是也因为 RabbitMQ 基于 erlang 开发，所以国内很少有公司有实力做 erlang 源码级别的研究和定制。如果业务场景对并发量要求不是太高（十万级、百万级），那这四种消息队列中，RabbitMQ 一定是你的首选。如果是大数据领域的实时计算、日志采集等场景，用 Kafka 是业内标准的，绝对没问题，社区活跃度很高，绝对不会黄，何况几乎是全世界这个领域的事实性规范。
- RocketMQ 阿里出品，Java 系开源项目，源代码我们可以直接阅读，然后可以定制自己公司的 MQ，并且 RocketMQ 有阿里巴巴的实际业务场景的实战考验。RocketMQ 社区活跃度相对较为一般，不过也还可以，文档相对来说简单一些，然后接口这块不是按照标准 JMS 规范走的有些系统要迁移需要修改大量代码。还有就是阿里出台的技术，你得做好这个技术万一被抛弃，社区黄掉的风险，那如果你们公司有技术实力我觉得用 RocketMQ 挺好的
- Kafka 的特点其实很明显，就是仅仅提供较少的核心功能，但是提供超高的吞吐量，ms 级的延迟，极高的可用性以及可靠性，而且分布式可以任意扩展。同时 Kafka 最好是支撑较少的 topic 数量即可，保证其超高吞吐量。Kafka 唯一的一点劣势是有可能消息重复消费，那么对数据准确性会造成极其轻微的影响，在大数据领域中以及日志采集中，这点轻微影响可以忽略这个特性天然适合大数据实时计算以及日志收集。

# 2. RabbitMQ

## 2.1 RabbitMQ 简介

RabbitMQ 是一个由 Erlang 语言开发的 AMQP 的开源实现。

RabbitMQ 最初起源于金融系统，用于在分布式系统中存储转发消息，在易用性、扩展性、高可用性等方面表现不俗。具体特点包括：

- 可靠性（Reliability）：RabbitMQ 使用一些机制来保证可靠性，如持久化、传输确认、发布确认。
- 灵活的路由（Flexible Routing）：在消息进入队列之前，通过 Exchange 来路由消息的。对于典型的路由功能，RabbitMQ 已经提供了一些内置的 Exchange 来实现。针对更复杂的路由功能，可以将多个 Exchange 绑定在一起，也通过插件机制实现自己的 Exchange。
- 消息集群（Clustering）：多个 RabbitMQ 服务器可以组成一个集群，形成一个逻辑 Broker。
- 高可用（Highly Available Queues）：队列可以在集群中的机器上进行镜像，使得在部分节点出问题的情况下队列仍然可用。
- 多种协议（Multi-protocol）：RabbitMQ 支持多种消息队列协议，比如 STOMP、MQTT 等等。
- 多语言客户端（Many Clients）：RabbitMQ 几乎支持所有常用语言，比如 Java、.NET、Ruby 等等。
- 管理界面（Management UI）：RabbitMQ 提供了一个易用的用户界面，使得用户可以监控和管理消息 Broker 的许多方面。
- 跟踪机制（Tracing）：如果消息异常，RabbitMQ 提供了消息跟踪机制，使用者可以找出发生了什么。
- 插件机制（Plugin System）：RabbitMQ 提供了许多插件，来从多方面进行扩展，也可以编写自己的插件。

## 2.2 RabbitMQ 核心概念

RabbitMQ 整体上是一个生产者与消费者模型，主要负责接收、存储和转发消息。可以把消息传递的过程想象成：当你将一个包裹送到邮局，邮局会暂存并最终将邮件通过邮递员送到收件人的手上，RabbitMQ 就好比由邮局、邮箱和邮递员组成的一个系统。从计算机术语层面来说，RabbitMQ 模型更像是一种交换机模型。

RabbitMQ 的整体模型架构如下：

![RabbitMQ 的整体模型架构](https://my-blog-to-use.oss-cn-beijing.aliyuncs.com/2019-11/16ef386c2a5d5139.jpg)

### 2.2.1 Producer(生产者) 和 Consumer(消费者)

- **Producer(生产者)** : 生产消息的一方（邮件投递者）
- **Consumer(消费者)** : 消费消息的一方（邮件收件人）

消息一般由 2 部分组成：**消息头**（或者说是标签 Label）和 **消息体**。消息体也可以称为 payload，消息体是不透明的，而消息头则由一系列的可选属性组成，这些属性包括 routing-key（路由键）、priority（相对于其他消息的优先权）、delivery-mode（指出该消息可能需要持久性存储）等。生产者把消息交由 RabbitMQ 后，RabbitMQ 会根据消息头把消息发送给感兴趣的 Consumer(消费者)。

### 2.2.2 Exchange(交换器)

在 RabbitMQ 中，消息并不是直接被投递到 **Queue(消息队列)** 中的，中间还必须经过 **Exchange(交换器)** 这一层。**Exchange(交换器)** 的作用是接收来自生产者的消息，并将消息路由到一个或多个队列中。如果路由不到，或许会返回给生产者，或许直接丢弃。这里可以将 Exchange 看作一个简单的实体。

RabbitMQ 的 Exchange 有 4 种类型，不同的类型对应着不同的路由策略：**direct(默认)**，**fanout**, **topic**, 和 **headers**，不同类型的 Exchange 转发消息的策略有所区别。这个会在介绍 Exchange Types(交换器类型) 的时候介绍到。

生产者将消息发给交换器的时候，一般会指定一个 **RoutingKey(路由键)**，用来指定这个消息的路由规则，而这个 **RoutingKey 需要与交换器类型和绑定键(BindingKey)联合使用才能最终生效**。

RabbitMQ 中通过 **Binding(绑定)** 将 **Exchange(交换器)** 与 **Queue(消息队列)** 关联起来，在绑定的时候一般会指定一个 **BindingKey(绑定建)**，这样 RabbitMQ 就知道如何正确地将消息路由到队列了，如下图所示。一个绑定就是基于路由键将交换器和消息队列连接起来的路由规则，所以可以将交换器理解成一个由绑定构成的路由表。Exchange 和 Queue 的绑定可以是多对多的关系。

Binding(绑定) 示意图：

![Binding(绑定) 示意图](https://my-blog-to-use.oss-cn-beijing.aliyuncs.com/2019-11/16ef386c2a5e5a3c.jpg)

生产者将消息发送给交换器时，需要一个 RoutingKey，当 BindingKey 和 RoutingKey 相匹配时，消息会被路由到对应的队列中。在绑定多个队列到同一个交换器的时候，这些绑定允许使用相同的 BindingKey。BindingKey 并不是在所有的情况下都生效，它依赖于交换器类型，比如 fanout 类型的交换器就会无视 BindingKey，而是将消息路由到所有绑定到该交换器的队列。

### 2.2.3 Queue(消息队列)

**Queue(消息队列)** 用来保存消息直到发送给消费者。它是消息的容器，也是消息的终点。一个消息可投入一个或多个队列。消息一直在队列里面，等待消费者连接到这个队列将其取走。

**RabbitMQ** 中消息只能存储在 **队列** 中，这一点和 **Kafka** 这种消息中间件相反。Kafka 将消息存储在 **topic（主题）** 这个逻辑层面，而相对应的队列逻辑只是 topic 实际存储文件中的位移标识。

RabbitMQ 的生产者生产消息并最终投递到队列中，消费者可以从队列中获取消息并消费。

多个消费者可以订阅同一个队列，这时队列中的消息会被平均分摊（Round-Robin，即轮询）给多个消费者进行处理，而不是每个消费者都收到所有的消息并处理，这样避免的消息被重复消费。

**RabbitMQ** 不支持队列层面的广播消费，如果有广播消费的需求，需要在其上进行二次开发，这样会很麻烦，不建议这样做。

### 2.2.4 Broker（消息中间件的服务节点）

对于 RabbitMQ 来说，一个 RabbitMQ Broker 可以简单地看作一个 RabbitMQ 服务节点，或者 RabbitMQ 服务实例。大多数情况下也可以将一个 RabbitMQ Broker 看作一台 RabbitMQ 服务器。

下图展示了生产者将消息存入 RabbitMQ Broker，以及消费者从 Broker 中消费数据的整个流程。

![消息队列的运转过程](https://my-blog-to-use.oss-cn-beijing.aliyuncs.com/2019-11/16ef386c2a5f1c97.jpg)

这样图 1 中的一些关于 RabbitMQ 的基本概念我们就介绍

2025-08-25 12:58:00,645 - evaluation_logger_Hotels-115 - INFO - Complete Result: {'score': 0, 'reason': "The response does not address any of the requested information in the user's query."}
2025-08-25 12:58:06,575 - evaluation_logger_Hotels-115 - INFO - Correct Result: {'score': 0, 'reason': 'All information in the response is incorrect.'}
2025-08-25 12:58:06,575 - evaluation_logger_Hotels-115 - INFO - Message: Success.
2025-08-25 12:58:06,575 - evaluation_logger_Hotels-115 - INFO - Success turn num = 4
2025-08-25 12:58:06,575 - evaluation_logger_Hotels-115 - INFO - ----------------------------------------------------------------------------------------------------
