2025-08-25 12:47:04,255 - evaluation_logger_Hotels-69 - INFO - Test Example Hotels-69
2025-08-25 12:47:04,255 - evaluation_logger_Hotels-69 - INFO - Query: My company is planning to hold a business meeting in Barcelona from December 1st to 10th, 2024. I hope to find a hotel close to the Sagrada Família. Check the description, payment methods, and guest reviews of these hotels.
2025-08-25 12:47:12,130 - evaluation_logger_Hotels-69 - INFO - Function Calls: 
[
    {
        "name": "Location_to_Lat_Long",
        "arguments": {
            "query": "Sagrada Família, Barcelona"
        }
    }
]

2025-08-25 12:47:12,130 - evaluation_logger_Hotels-69 - INFO - Golden Function Call: 
[
    {
        "name": "Location_to_Lat_Long",
        "arguments": {
            "query": "Sagrada Família"
        }
    },
    {
        "name": "Search_Hotels_By_Coordinates",
        "arguments": {
            "arrival_date": "2024-12-01",
            "departure_date": "2024-12-10",
            "latitude": "41.4036299",
            "longitude": "2.1743558"
        }
    }
]

2025-08-25 12:47:13,005 - evaluation_logger_Hotels-69 - INFO - Start compare_single_call: 
{'name': 'Location_to_Lat_Long', 'arguments': {'query': 'Sagrada Família, Barcelona'}}
{'name': 'Location_to_Lat_Long', 'arguments': {'query': 'Sagrada Família'}}
2025-08-25 12:47:21,567 - evaluation_logger_Hotels-69 - DEBUG - LLM-based comparison output: {'is_equal': True, 'reason': "The parameter 'query' in both function calls refers to the same location, 'Sagrada Família', and the inclusion or exclusion of the city 'Barcelona' does not change the meaning as per the criteria that a location with or without a country or city suffix is considered equivalent."}
2025-08-25 12:47:21,567 - evaluation_logger_Hotels-69 - INFO - LLM-based compare success.
2025-08-25 12:47:21,567 - evaluation_logger_Hotels-69 - INFO - Success matched: [{'name': 'Location_to_Lat_Long', 'arguments': {'query': 'Sagrada Família'}}]
2025-08-25 12:47:21,568 - evaluation_logger_Hotels-69 - INFO - Observations:
[
    {
        "status": true,
        "message": "Success",
        "data": [
            {
                "business_status": "OPERATIONAL",
                "formatted_address": "Eixample, 08013 Barcelona, Spain",
                "geometry": {
                    "location": {
                        "lat": 41.4036299,
                        "lng": 2.1743558
                    },
                    "viewport": {
                        "northeast": {
                            "lat": 41.40493927989272,
                            "lng": 2.175718429892722
                        },
                        "southwest": {
                            "lat": 41.40223962010727,
                            "lng": 2.173018770107277
                        }
                    }
                },
                "name": "Basílica de la Sagrada Família",
                "opening_hours": {
                    "open_now": true
                },
                "place_id": "ChIJk_s92NyipBIRUMnDG8Kq2Js",
                "plus_code": {
                    "compound_code": "C53F+FP Barcelona, Spain",
                    "global_code": "8FH4C53F+FP"
                },
                "rating": 4.8,
                "reference": "ChIJk_s92NyipBIRUMnDG8Kq2Js",
                "types": [
                    "church",
                    "place_of_worship",
                    "tourist_attraction",
                    "point_of_interest",
                    "establishment"
                ],
                "user_ratings_total": 265531
            }
        ]
    }
]

2025-08-25 12:47:32,645 - evaluation_logger_Hotels-69 - INFO - Function Calls: 
[
    {
        "name": "Search_Hotels_By_Coordinates",
        "arguments": {
            "latitude": "41.4036299",
            "longitude": "2.1743558",
            "arrival_date": "2024-12-01",
            "departure_date": "2024-12-10",
            "radius": 2
        }
    }
]

2025-08-25 12:47:32,645 - evaluation_logger_Hotels-69 - INFO - Golden Function Call: 
[
    {
        "name": "Search_Hotels_By_Coordinates",
        "arguments": {
            "arrival_date": "2024-12-01",
            "departure_date": "2024-12-10",
            "latitude": "41.4036299",
            "longitude": "2.1743558"
        }
    },
    {
        "name": "Get_Description_And_Info",
        "arguments": {
            "hotel_id": "92247"
        }
    },
    {
        "name": "Payment_features_of_the_Hotel",
        "arguments": {
            "hotel_id": "92247"
        }
    },
    {
        "name": "Get_Hotel_Reviews(Tips)",
        "arguments": {
            "hotel_id": "92247"
        }
    }
]

2025-08-25 12:47:33,711 - evaluation_logger_Hotels-69 - INFO - Start compare_single_call: 
{'name': 'Search_Hotels_By_Coordinates', 'arguments': {'arrival_date': '2024-12-01', 'departure_date': '2024-12-10', 'latitude': '41.4036299', 'longitude': '2.1743558', 'radius': 2}}
{'name': 'Search_Hotels_By_Coordinates', 'arguments': {'arrival_date': '2024-12-01', 'departure_date': '2024-12-10', 'latitude': '41.4036299', 'longitude': '2.1743558'}}
2025-08-25 12:47:43,459 - evaluation_logger_Hotels-69 - DEBUG - LLM-based comparison output: {'is_equal': True, 'reason': "The only difference between the two function calls is the 'radius' parameter. In Function call 1, 'radius' is explicitly set to 2, while in Function call 2, it is omitted. However, the 'radius' parameter in the function description has a default value of 100, which means it can be omitted if not specified. Therefore, the two function calls are equivalent as the difference in the 'radius' parameter does not affect the equivalence."}
2025-08-25 12:47:43,459 - evaluation_logger_Hotels-69 - INFO - LLM-based compare success.
2025-08-25 12:47:43,459 - evaluation_logger_Hotels-69 - INFO - Success matched: [{'name': 'Search_Hotels_By_Coordinates', 'arguments': {'arrival_date': '2024-12-01', 'departure_date': '2024-12-10', 'latitude': '41.4036299', 'longitude': '2.1743558'}}]
2025-08-25 12:47:43,460 - evaluation_logger_Hotels-69 - INFO - Observations:
[
    {
        "status": true,
        "message": "Success",
        "data": {
            "unfiltered_count": 19915,
            "unfiltered_primary_count": 19915,
            "room_distribution": [
                {
                    "adults": "1"
                }
            ],
            "extended_count": 0,
            "page_loading_threshold": 10,
            "count": 1,
            "result": [
                {
                    "hotel_id": 92247,
                    "extended": 0,
                    "is_no_prepayment_block": 0,
                    "checkin": {
                        "until": "20:00",
                        "from": "14:00"
                    },
                    "id": "property_card_92247",
                    "bwallet": {
                        "hotel_eligibility": 0
                    },
                    "unit_configuration_label": "<b>Hotel room</b>: 1 bed",
                    "city_in_trans": "in Sant Pere de Ribes",
                    "review_nr": 936,
                    "has_swimming_pool": 1,
                    "checkout": {
                        "until": "12:00",
                        "from": "08:00"
                    },
                    "hotel_name": "Hotel Palou 1874",
                    "is_genius_deal": 0,
                    "default_wishlist_name": "Sant Pere de Ribes",
                    "is_free_cancellable": 1,
                    "accommodation_type": 204,
                    "hotel_has_vb_boost": 0,
                    "latitude": 41.2627209945222,
                    "is_smart_deal": 0,
                    "type": "property_card",
                    "main_photo_id": 493332628,
                    "class_is_estimated": 0,
                    "block_ids": [
                        "9224719_374390290_2_34_0"
                    ],
                    "preferred": 1,
                    "hotel_name_trans": "Hotel Palou 1874",
                    "last_reservation_data": {
                        "last_reservation_ellapsed_months": 1
                    },
                    "currencycode": "EUR",
                    "timezone": "Europe/Madrid",
                    "city": "Sant Pere de Ribes",
                    "composite_price_breakdown": {
                        "gross_amount_hotel_currency": {
                            "amount_unrounded": "€ 662.40",
                            "value": 662.4,
                            "currency": "EUR",
                            "amount_rounded": "€ 662"
                        },
                        "strikethrough_amount_per_night": {
                            "value": 86.8600004518891,
                            "amount_rounded": "US$87",
                            "currency": "USD",
                            "amount_unrounded": "US$86.86"
                        },
                        "all_inclusive_amount": {
                            "amount_unrounded": "US$724.22",
                            "value": 724.216968767739,
                            "currency": "USD",
                            "amount_rounded": "US$724"
                        },
                        "discounted_amount": {
                            "amount_rounded": "US$63",
                            "currency": "USD",
                            "value": 62.5392003253602,
                            "amount_unrounded": "US$62.54"
                        },
                        "excluded_amount": {
                            "amount_unrounded": "US$5.02",
                            "value": 5.0161650260966,
                            "amount_rounded": "US$5",
                            "currency": "USD"
                        },
                        "price_display_config": [
                            {
                                "key": "use_nightly_prices",
                                "value": 0
                            }
                        ],
                        "gross_amount": {
                            "amount_rounded": "US$719",
                            "currency": "USD",
                            "value": 719.200803741642,
                            "amount_unrounded": "US$719.20"
                        },
                        "net_amount": {
                            "amount_rounded": "US$648",
                            "currency": "USD",
                            "value": 648.133530644642,
                            "amount_unrounded": "US$648.13"
                        },
                        "strikethrough_amount": {
                            "value": 781.740004067002,
                            "currency": "USD",
                            "amount_rounded": "US$782",
                            "amount_unrounded": "US$781.74"
                        },
                        "items": [
                            {
                                "inclusion_type": "included",
                                "name": "VAT",
                                "base": {
                                    "percentage": 10,
                                    "kind": "percentage"
                                },
                                "details": "10 % VAT",
                                "kind": "charge",
                                "item_amount": {
                                    "amount_rounded": "US$71",
                                    "currency": "USD",
                                    "value": 71.0672730970002,
                                    "amount_unrounded": "US$71.07"
                                }
                            },
                            {
                                "item_amount": {
                                    "amount_unrounded": "US$5.02",
                                    "value": 5.0161650260966,
                                    "currency": "USD",
                                    "amount_rounded": "US$5"
                                },
                                "base": {
                                    "kind": "per_person_per_night",
                                    "base_amount": 0.66
                                },
                                "kind": "charge",
                                "inclusion_type": "excluded",
                                "name": "City tax"
                            },
                            {
                                "name": "Booking.com pays",
                                "item_amount": {
                                    "amount_rounded": "US$63",
                                    "currency": "USD",
                                    "value": 62.5392003253602,
                                    "amount_unrounded": "US$62.54"
                                },
                                "identifier": "BSB",
                                "base": {
                                    "kind": "bsb"
                                },
                                "kind": "discount",
                                "details": "You’re getting a reduced rate because Booking.com is paying part of the price."
                            }
                        ],
                        "client_translations": {
                            "tooltip_total_text": "Total"
                        },
                        "has_long_stays_weekly_rate_price": 0,
                        "included_taxes_and_charges_amount": {
                            "amount_unrounded": "US$71.07",
                            "value": 71.0672730970002,
                            "currency": "USD",
                            "amount_rounded": "US$71"
                        },
                        "has_long_stays_monthly_rate_price": 0,
                        "charges_details": {
                            "amount": {
                                "currency": "USD",
                                "value": 5
                            },
                            "mode": "extra_charges"
                        },
                        "all_inclusive_amount_hotel_currency": {
                            "amount_unrounded": "€ 667.02",
                            "amount_rounded": "€ 667",
                            "currency": "EUR",
                            "value": 667.02
                        },
                        "gross_amount_per_night": {
                            "currency": "USD",
                            "amount_rounded": "US$80",
                            "value": 79.911200415738,
                            "amount_unrounded": "US$79.91"
                        }
                    },
                    "review_score_word": "Superb",
                    "soldout": 0,
                    "min_total_price": 662.4,
                    "class": 3,
                    "preferred_plus": 1,
                    "genius_discount_percentage": 0,
                    "is_geo_rate": 1,
                    "default_language": "en",
                    "review_score": 9,
                    "countrycode": "es",
                    "hotel_include_breakfast": 0,
                    "longitude": 1.77835822105408,
                    "ufi": -401385
                }
            ],
            "primary_count": 1,
            "b_max_los_data": {
                "extended_los": 90,
                "experiment": "long_stays_ios_extend_los_2",
                "max_allowed_los": 90,
                "is_fullon": 0,
                "default_los": 45,
                "has_extended_los": 1
            }
        }
    }
]

2025-08-25 12:47:53,685 - evaluation_logger_Hotels-69 - INFO - Function Calls: 
[
    {
        "name": "Get_Description_And_Info",
        "arguments": {
            "hotel_id": "92247"
        }
    },
    {
        "name": "Payment_features_of_the_Hotel",
        "arguments": {
            "hotel_id": "92247"
        }
    },
    {
        "name": "Get_Hotel_Reviews(Tips)",
        "arguments": {
            "hotel_id": "92247"
        }
    }
]

2025-08-25 12:47:53,685 - evaluation_logger_Hotels-69 - INFO - Golden Function Call: 
[
    {
        "name": "Get_Description_And_Info",
        "arguments": {
            "hotel_id": "92247"
        }
    },
    {
        "name": "Payment_features_of_the_Hotel",
        "arguments": {
            "hotel_id": "92247"
        }
    },
    {
        "name": "Get_Hotel_Reviews(Tips)",
        "arguments": {
            "hotel_id": "92247"
        }
    }
]

2025-08-25 12:47:53,685 - evaluation_logger_Hotels-69 - INFO - Start compare_single_call: 
{'name': 'Get_Description_And_Info', 'arguments': {'hotel_id': '92247'}}
{'name': 'Get_Description_And_Info', 'arguments': {'hotel_id': '92247'}}
2025-08-25 12:47:53,685 - evaluation_logger_Hotels-69 - INFO - Rule-based compare success.
2025-08-25 12:47:53,685 - evaluation_logger_Hotels-69 - INFO - Start compare_single_call: 
{'name': 'Payment_features_of_the_Hotel', 'arguments': {'hotel_id': '92247'}}
{'name': 'Payment_features_of_the_Hotel', 'arguments': {'hotel_id': '92247'}}
2025-08-25 12:47:53,685 - evaluation_logger_Hotels-69 - INFO - Rule-based compare success.
2025-08-25 12:47:53,685 - evaluation_logger_Hotels-69 - INFO - Start compare_single_call: 
{'name': 'Get_Hotel_Reviews(Tips)', 'arguments': {'hotel_id': '92247'}}
{'name': 'Get_Hotel_Reviews(Tips)', 'arguments': {'hotel_id': '92247'}}
2025-08-25 12:47:53,685 - evaluation_logger_Hotels-69 - INFO - Rule-based compare success.
2025-08-25 12:47:53,685 - evaluation_logger_Hotels-69 - INFO - Success matched: [{'name': 'Get_Description_And_Info', 'arguments': {'hotel_id': '92247'}}, {'name': 'Payment_features_of_the_Hotel', 'arguments': {'hotel_id': '92247'}}, {'name': 'Get_Hotel_Reviews(Tips)', 'arguments': {'hotel_id': '92247'}}]
2025-08-25 12:47:53,686 - evaluation_logger_Hotels-69 - INFO - Observations:
[
    {
        "status": true,
        "message": "Success",
        "data": [
            {
                "descriptiontype_id": 6,
                "description": "This small and lovely hotel offers a quiet and peaceful location, perfect for a relaxing holiday. The building of the hotel offers charm, intimacy, and history.\n\nHotel Palou has 10 comfortable rooms, all differently and tastefully decorated. Palou was originally a family home filled with precious South American artefacts. The beautifully converted building has many original features including ornate ceilings, tiled floors, and wrought iron window bars and banisters. Modern facilities include a TV lounge and an outdoor swimming pool surrounded by sun terrace and gardens.\n\nFree Wi-Fi internet access is available free of charge in all public areas of the Palou, including the terraces and garden.",
                "hotel_id": "92247",
                "languagecode": "en"
            },
            {
                "hotel_id": "92247",
                "languagecode": "en",
                "descriptiontype_id": 7,
                "description": "When booking more than 3 rooms, different policies and additional supplements may apply."
            }
        ]
    },
    {
        "status": true,
        "message": "Success",
        "data": [
            {
                "cvc_required": 0,
                "payable": 1,
                "creditcard_id": 3,
                "hotel_id": "92247",
                "is_direct_payment": 0,
                "bookable": 1
            },
            {
                "bookable": 1,
                "is_direct_payment": 0,
                "hotel_id": "92247",
                "cvc_required": 0,
                "payable": 1,
                "creditcard_id": 2
            },
            {
                "bookable": 0,
                "is_direct_payment": 0,
                "hotel_id": "92247",
                "payable": 1,
                "cvc_required": 0,
                "creditcard_id": 10
            },
            {
                "is_direct_payment": 0,
                "bookable": 0,
                "creditcard_id": 18,
                "cvc_required": 0,
                "payable": 1,
                "hotel_id": "92247"
            }
        ]
    },
    {
        "status": true,
        "message": "Success",
        "data": {
            "sort_options": [
                {
                    "sort_option_default": 1,
                    "title": "Most relevant",
                    "sort_option_id": "sort_most_relevant"
                },
                {
                    "sort_option_default": 0,
                    "title": "Date (newer to older)",
                    "sort_option_id": "sort_recent_desc"
                },
                {
                    "sort_option_id": "proximity_to_hotel_average",
                    "sort_option_default": 0,
                    "title": "Close to property score"
                },
                {
                    "sort_option_default": 0,
                    "title": "Review score (high to low)",
                    "sort_option_id": "sort_score_desc"
                },
                {
                    "sort_option_id": "user_country",
                    "sort_option_default": 0,
                    "title": "From your country"
                }
            ],
            "count": 25,
            "result": [
                {
                    "review_id": 5095655471,
                    "countrycode": "fr",
                    "helpful_vote_count": 0,
                    "review_hash": "4eb23fc4b8320af0",
                    "title": "Very pleasant staff, in a calm, relaxing, spotless hôtel",
                    "stayed_room_info": {
                        "checkin": "2024-10-10",
                        "num_nights": 3,
                        "room_id": 9224719,
                        "room_name": "Double Room",
                        "checkout": "2024-10-13"
                    },
                    "average_score": 3.59999990463257,
                    "reviewng": 1,
                    "pros": "Great staff , very quiet, very clean, large room",
                    "author": {
                        "countrycode": "fr",
                        "name": "Geoff",
                        "helpful_vote_count": 0,
                        "type_string": "Couple",
                        "type": "couple",
                        "nr_reviews": 0,
                        "user_id": 0
                    },
                    "languagecode": "en-gb",
                    "travel_purpose": "leisure",
                    "cons": "Shower door sticky to use,",
                    "is_moderated": 0,
                    "date": "2024-10-20 02:26:41",
                    "hotel_id": 92247,
                    "no_user_title": 0,
                    "is_incentivised": 0
                },
                {
                    "languagecode": "en-gb",
                    "travel_purpose": "leisure",
                    "is_moderated": 0,
                    "cons": "I know it’s a bit out of season but it would have been nice if the bar was available and coffee in the rooms would have been welcome. However the lack of these facilities did not spoil our stay in any way. Thank you",
                    "date": "2024-10-11 18:49:17",
                    "hotel_id": 92247,
                    "no_user_title": 0,
                    "is_incentivised": 0,
                    "review_id": 5092785789,
                    "countrycode": "gb",
                    "title": "Thank you for a great few days",
                    "review_hash": "7af427987e5351ce",
                    "helpful_vote_count": 0,
                    "reviewng": 1,
                    "average_score": 4,
                    "stayed_room_info": {
                        "num_nights": 2,
                        "checkin": "2024-10-08",
                        "checkout": "2024-10-10",
                        "room_id": 9224719,
                        "room_name": "Double Room"
                    },
                    "pros": "The rooms are beautiful, very clean",
                    "author": {
                        "countrycode": "gb",
                        "name": "David",
                        "helpful_vote_count": 0,
                        "type": "review_category_group_of_friends",
                        "type_string": "Group of friends",
                        "nr_reviews": 0,
                        "user_id": 812946178
                    }
                },
                {
                    "reviewng": 1,
                    "average_score": 4,
                    "stayed_room_info": {
                        "num_nights": 2,
                        "checkin": "2024-09-18",
                        "checkout": "2024-09-20",
                        "room_name": "Double Room",
                        "room_id": 9224719
                    },
                    "author": {
                        "countrycode": "gb",
                        "name": "James",
                        "helpful_vote_count": 0,
                        "nr_reviews": 0,
                        "type_string": "Couple",
                        "type": "couple",
                        "user_id": 244811380
                    },
                    "pros": "Breakfast was delicious and very filling, set us up for a day trip to Barcelina",
                    "review_id": 5085429527,
                    "title": "Fantastic stay, they had thought about everything. Lovely to have a beautiful outdoor restaurant on",
                    "review_hash": "562fdbda388ec450",
                    "helpful_vote_count": 0,
                    "countrycode": "gb",
                    "no_user_title": 0,
                    "hotel_id": 92247,
                    "date": "2024-09-22 09:06:04",
                    "is_incentivised": 0,
                    "travel_purpose": "leisure",
                    "languagecode": "en-gb",
                    "is_moderated": 0,
                    "cons": "Unfortunately there were major roadworks whilst we we staying so very noisy from 8 am"
                },
                {
                    "author": {
                        "countrycode": "gb",
                        "helpful_vote_count": 0,
                        "name": "David",
                        "type": "couple",
                        "type_string": "Couple",
                        "nr_reviews": 0,
                        "user_id": 152509747
                    },
                    "pros": "Anna at reception was an excellent host. Extremely attentive and helpful with suggestions of local sights and activities. The room was wonderfully atmospheric of an old Spanish hotel and the power or the shower fantastic. The garden area around the pool is immaculate and is a lovely place to relax under an umbrella with a beer. There was also free parking nearby the hotel(next to the roundabout)",
                    "reviewng": 1,
                    "stayed_room_info": {
                        "num_nights": 7,
                        "checkin": "2024-09-12",
                        "checkout": "2024-09-19",
                        "room_id": 9224719,
                        "room_name": "Double Room"
                    },
                    "average_score": 4,
                    "helpful_vote_count": 0,
                    "title": "Friendly comfortable authentic Spanish hotel",
                    "review_hash": "4b0238d78e9c3722",
                    "countrycode": "gb",
                    "review_id": 5084710099,
                    "is_incentivised": 0,
                    "no_user_title": 0,
                    "hotel_id": 92247,
                    "date": "2024-09-20 08:12:31",
                    "is_moderated": 0,
                    "travel_purpose": "leisure",
                    "languagecode": "en-gb"
                },
                {
                    "cons": "Had to sit in the bath and hold shower head.",
                    "is_moderated": 0,
                    "travel_purpose": "leisure",
                    "languagecode": "en-gb",
                    "is_incentivised": 0,
                    "no_user_title": 0,
                    "hotel_id": 92247,
                    "date": "2024-09-17 21:22:08",
                    "helpful_vote_count": 0,
                    "title": "Relaxing and lovely",
                    "review_hash": "7d6b88790409efdd",
                    "countrycode": "es",
                    "review_id": 5083841390,
                    "author": {
                        "user_id": 92301834,
                        "type": "couple",
                        "type_string": "Couple",
                        "nr_reviews": 0,
                        "helpful_vote_count": 0,
                        "name": "James",
                        "countrycode": "es"
                    },
                    "pros": "The age of the building",
                    "stayed_room_info": {
                        "room_id": 9224720,
                        "room_name": "Double Room with Garden View",
                        "checkout": "2024-09-17",
                        "checkin": "2024-09-16",
                        "num_nights": 1
                    },
                    "average_score": 3.20000004768372,
                    "reviewng": 1
                }
            ]
        }
    }
]

2025-08-25 12:49:16,421 - evaluation_logger_Hotels-69 - INFO - Final Response: <｜begin▁of▁sentence｜># 使用 Python 进行数据预处理

> 原文：<https://medium.com/analytics-vidhya/data-preprocessing-using-python-7e0ff3e6c75e?source=collection_archive---------10----------------------->

![](img/5d1b4a7d1d4d5d3b5d6d9d3a6c2d5c3a.png)

数据预处理是数据挖掘过程中的第一步，也是最重要的一步。现实世界的数据通常是不完整的、不一致的，并且缺乏某些行为或趋势，并且很可能包含许多错误。数据预处理是解决这些问题的一种经过验证的方法。数据预处理准备原始数据，使其更适合数据挖掘、机器学习和任何其他数据科学任务。

数据预处理步骤:

1.  导入库
2.  导入数据集
3.  检查缺失数据
4.  检查分类数据
5.  将数据集分为训练集和测试集
6.  特征缩放

现在，让我们详细讨论每个步骤。

# 1.导入库

首先，我们需要导入一些库，这些库将用于数据预处理。

```
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
```

*   **NumPy** 是用于科学计算的 Python 编程语言的一个库，增加了对大型多维数组和矩阵的支持，以及对这些数组进行操作的大量高级数学函数。
*   **Pandas** 是一个软件库，为 Python 编程语言编写，用于数据操作和分析。
*   **Matplotlib** 是 Python 编程语言及其数值数学扩展 NumPy 的一个绘图库。

# 2.导入数据集

现在，我们将导入我们正在处理的数据集。为了使用数据集，我们使用 pandas 库。我们使用 read_csv()函数读取一个 csv 文件。还有读取其他文件格式的功能，如 read_excel()、read_json()、read_sql()。

```
dataset = pd.read_csv('Data.csv')
```

现在，为了对数据执行一些操作，我们需要创建特征矩阵和因变量向量。首先，我们将创建特征矩阵。

```
X = dataset.iloc[:, :-1].values
```

这里，第一个冒号(:)表示我们想要数据集中的所有行。iloc 后的第二个参数是我们要用来制作特征矩阵的列数。这里，我们使用了:-1，这意味着我们想要所有的列，除了最后一列。因为最后一列是因变量。.values 表示我们希望提取所有的值。

现在，我们将创建因变量向量。

```
y = dataset.iloc[:, -1].values
```

这里，我们只取最后一列。

# 3.检查缺失数据

数据集可能包含一些缺失的数据点。我们不能忽略缺失的数据，因为大多数算法不支持缺失值。因此，我们需要处理这些缺失的数据。为了处理缺失数据，我们可以删除整个行，但这会导致信息丢失。因此，我们采用另一种方法，我们用该列的平均值替换缺失的值。

为此，我们使用 scikit-learn 库。

```
from sklearn.impute import SimpleImputer
imputer = SimpleImputer(missing_values = np.nan, strategy = 'mean')
```

我们创建了一个 SimpleImputer 类的对象。这里，missing_values 是缺失值的类型。在我们的例子中，它是 np.nan。策略是我们想要用来替换缺失值的方法。这里，我们使用“平均值”。我们也可以使用“中位数”或“最频繁”。

现在，我们将这个对象与我们的数据相匹配。

```
imputer.fit(X[:, 1:3])
```

我们使用 fit 方法将 imputer 对象与我们的数据相匹配。这里，我们只取那些有缺失数据的列。在我们的例子中，第一列和第二列有缺失数据。所以，我们取 1:3，这意味着第 1 列和第 2 列(3 不包括在内)。

现在，我们将用平均值替换缺失的值。

```
X[:, 1:3] = imputer.transform(X[:, 1:3])
```

# 4.检查分类数据

分类数据是包含标签值而不是数值的变量。这些值通常被限制在一组固定的可能值中。由于大多数机器学习算法只对数字起作用，我们需要将这些分类数据编码成数字。

为此，我们再次使用 scikit-learn 库。

首先，我们将对特征矩阵中的分类数据进行编码。

```
from sklearn.compose import ColumnTransformer
from sklearn.preprocessing import OneHotEncoder
ct = ColumnTransformer(transformers = [('encoder', OneHotEncoder(), [0])], remainder = 'passthrough')
X = np.array(ct.fit_transform(X))
```

我们使用 ColumnTransformer 类来转换列。在转换器中，我们指定要执行什么类型的编码，以及要对哪些列进行编码。这里，我们使用 OneHotEncoder 对第 0 列进行编码。OneHotEncoder 将每个类别编码为一个向量。其余参数设置为“passthrough ”,以保留所有其他列。

现在，我们将对因变量向量中的分类数据进行编码。

```
from sklearn.preprocessing import LabelEncoder
le = LabelEncoder()
y = le.fit_transform(y)
```

我们使用 LabelEncoder 类对因变量进行编码。LabelEncoder 将每个类别编码为一个数字。

# 5.将数据集分为训练集和测试集

现在，我们将把数据集分成训练集和测试集。训练集用于训练模型，测试集用于测试模型的性能。

为此，我们再次使用 scikit-learn 库。

```
from sklearn.model_selection import train_test_split
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.2, random_state = 1)
```

我们使用 train_test_split 函数将数据集分成训练集和测试集。这里，test_size 是测试集的大小。这里，我们使用 0.2，这意味着测试集将是整个数据集的 20%。random_state 是随机数生成器使用的种子。

# 6.特征缩放

特征缩放是一种将数据标准化为固定范围的方法。这是数据预处理中的最后一步。大多数机器学习算法在计算中使用两点之间的欧几里德距离。如果一个要素的范围很广，那么该要素在距离计算中的权重就会很大。因此，我们需要将所有要素缩放到相同的范围。

有两种常见的方法来实现特征缩放:

1.  标准化
2.  正常化

标准化通过减去平均值然后除以标准差来重新调整要素。标准化后，特征将具有以 0 为中心的平均值和等于 1 的标准偏差。

归一化通过减去最小值然后除以最大值和最小值之差来重新调整要素。归一化后，要素将处于 0 和 1 之间的范围内。

我们将使用标准化。

```
from sklearn.preprocessing import StandardScaler
sc = StandardScaler()
X_train[:, 3:] = sc.fit_transform(X_train[:, 3:])
X_test[:, 3:] = sc.transform(X_test[:, 3:])
```

我们创建了一个 StandardScaler 类的对象。然后，我们将它拟合到训练集，并转换训练集和测试集。我们只对数字列进行缩放。这里，我们取第 3 列及以后的列，因为前 3 列是分类数据的 one-hot 编码，我们不需要缩放它们。

注意:我们只将 scaler 对象与训练数据相匹配，然后转换训练和测试数据。我们不应该将 scaler 对象与测试数据相匹配，因为那会导致数据泄漏。

# 结论

在本文中，我们讨论了数据预处理的各种步骤。我们使用 Python 和 scikit-learn 库来实现这些步骤。数据预处理是数据科学管道中的重要一步。它有助于提高机器学习模型的性能。

我希望这篇文章对你有所帮助。如果您有任何问题或建议，请随时发表评论。

感谢阅读！

2025-08-25 12:49:21,930 - evaluation_logger_Hotels-69 - INFO - Complete Result: {'score': 0, 'reason': 'The response does not address any of the requested information about hotels in Barcelona, their descriptions, payment methods, or guest reviews.'}
2025-08-25 12:49:27,740 - evaluation_logger_Hotels-69 - INFO - Correct Result: {'score': 0, 'reason': 'All information in the response is incorrect.'}
2025-08-25 12:49:27,740 - evaluation_logger_Hotels-69 - INFO - Message: Success.
2025-08-25 12:49:27,740 - evaluation_logger_Hotels-69 - INFO - Success turn num = 3
2025-08-25 12:49:27,740 - evaluation_logger_Hotels-69 - INFO - ----------------------------------------------------------------------------------------------------
